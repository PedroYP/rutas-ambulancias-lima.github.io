var GS=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var I1=(t,e,n)=>(GS(t,e,"read from private field"),n?n.call(t):e.get(t)),HS=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},WS=(t,e,n,r)=>(GS(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n);function KM(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const a=Object.getOwnPropertyDescriptor(r,i);a&&Object.defineProperty(t,i,a.get?a:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const h of a.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&r(h)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();var R4=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _m(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var JM={exports:{}},l_={},QM={exports:{}},Nn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vm=Symbol.for("react.element"),O4=Symbol.for("react.portal"),D4=Symbol.for("react.fragment"),z4=Symbol.for("react.strict_mode"),F4=Symbol.for("react.profiler"),N4=Symbol.for("react.provider"),B4=Symbol.for("react.context"),U4=Symbol.for("react.forward_ref"),V4=Symbol.for("react.suspense"),j4=Symbol.for("react.memo"),$4=Symbol.for("react.lazy"),qS=Symbol.iterator;function G4(t){return t===null||typeof t!="object"?null:(t=qS&&t[qS]||t["@@iterator"],typeof t=="function"?t:null)}var ek={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},tk=Object.assign,nk={};function Md(t,e,n){this.props=t,this.context=e,this.refs=nk,this.updater=n||ek}Md.prototype.isReactComponent={};Md.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Md.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function rk(){}rk.prototype=Md.prototype;function Gw(t,e,n){this.props=t,this.context=e,this.refs=nk,this.updater=n||ek}var Hw=Gw.prototype=new rk;Hw.constructor=Gw;tk(Hw,Md.prototype);Hw.isPureReactComponent=!0;var ZS=Array.isArray,ik=Object.prototype.hasOwnProperty,Ww={current:null},sk={key:!0,ref:!0,__self:!0,__source:!0};function ok(t,e,n){var r,i={},a=null,h=null;if(e!=null)for(r in e.ref!==void 0&&(h=e.ref),e.key!==void 0&&(a=""+e.key),e)ik.call(e,r)&&!sk.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var m=Array(l),_=0;_<l;_++)m[_]=arguments[_+2];i.children=m}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:vm,type:t,key:a,ref:h,props:i,_owner:Ww.current}}function H4(t,e){return{$$typeof:vm,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function qw(t){return typeof t=="object"&&t!==null&&t.$$typeof===vm}function W4(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var XS=/\/+/g;function M1(t,e){return typeof t=="object"&&t!==null&&t.key!=null?W4(""+t.key):e.toString(36)}function Ny(t,e,n,r,i){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var h=!1;if(t===null)h=!0;else switch(a){case"string":case"number":h=!0;break;case"object":switch(t.$$typeof){case vm:case O4:h=!0}}if(h)return h=t,i=i(h),t=r===""?"."+M1(h,0):r,ZS(i)?(n="",t!=null&&(n=t.replace(XS,"$&/")+"/"),Ny(i,e,n,"",function(_){return _})):i!=null&&(qw(i)&&(i=H4(i,n+(!i.key||h&&h.key===i.key?"":(""+i.key).replace(XS,"$&/")+"/")+t)),e.push(i)),1;if(h=0,r=r===""?".":r+":",ZS(t))for(var l=0;l<t.length;l++){a=t[l];var m=r+M1(a,l);h+=Ny(a,e,n,m,i)}else if(m=G4(t),typeof m=="function")for(t=m.call(t),l=0;!(a=t.next()).done;)a=a.value,m=r+M1(a,l++),h+=Ny(a,e,n,m,i);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return h}function $g(t,e,n){if(t==null)return t;var r=[],i=0;return Ny(t,r,"","",function(a){return e.call(n,a,i++)}),r}function q4(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Es={current:null},By={transition:null},Z4={ReactCurrentDispatcher:Es,ReactCurrentBatchConfig:By,ReactCurrentOwner:Ww};Nn.Children={map:$g,forEach:function(t,e,n){$g(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return $g(t,function(){e++}),e},toArray:function(t){return $g(t,function(e){return e})||[]},only:function(t){if(!qw(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Nn.Component=Md;Nn.Fragment=D4;Nn.Profiler=F4;Nn.PureComponent=Gw;Nn.StrictMode=z4;Nn.Suspense=V4;Nn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Z4;Nn.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=tk({},t.props),i=t.key,a=t.ref,h=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,h=Ww.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(m in e)ik.call(e,m)&&!sk.hasOwnProperty(m)&&(r[m]=e[m]===void 0&&l!==void 0?l[m]:e[m])}var m=arguments.length-2;if(m===1)r.children=n;else if(1<m){l=Array(m);for(var _=0;_<m;_++)l[_]=arguments[_+2];r.children=l}return{$$typeof:vm,type:t.type,key:i,ref:a,props:r,_owner:h}};Nn.createContext=function(t){return t={$$typeof:B4,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:N4,_context:t},t.Consumer=t};Nn.createElement=ok;Nn.createFactory=function(t){var e=ok.bind(null,t);return e.type=t,e};Nn.createRef=function(){return{current:null}};Nn.forwardRef=function(t){return{$$typeof:U4,render:t}};Nn.isValidElement=qw;Nn.lazy=function(t){return{$$typeof:$4,_payload:{_status:-1,_result:t},_init:q4}};Nn.memo=function(t,e){return{$$typeof:j4,type:t,compare:e===void 0?null:e}};Nn.startTransition=function(t){var e=By.transition;By.transition={};try{t()}finally{By.transition=e}};Nn.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Nn.useCallback=function(t,e){return Es.current.useCallback(t,e)};Nn.useContext=function(t){return Es.current.useContext(t)};Nn.useDebugValue=function(){};Nn.useDeferredValue=function(t){return Es.current.useDeferredValue(t)};Nn.useEffect=function(t,e){return Es.current.useEffect(t,e)};Nn.useId=function(){return Es.current.useId()};Nn.useImperativeHandle=function(t,e,n){return Es.current.useImperativeHandle(t,e,n)};Nn.useInsertionEffect=function(t,e){return Es.current.useInsertionEffect(t,e)};Nn.useLayoutEffect=function(t,e){return Es.current.useLayoutEffect(t,e)};Nn.useMemo=function(t,e){return Es.current.useMemo(t,e)};Nn.useReducer=function(t,e,n){return Es.current.useReducer(t,e,n)};Nn.useRef=function(t){return Es.current.useRef(t)};Nn.useState=function(t){return Es.current.useState(t)};Nn.useSyncExternalStore=function(t,e,n){return Es.current.useSyncExternalStore(t,e,n)};Nn.useTransition=function(){return Es.current.useTransition()};Nn.version="18.2.0";QM.exports=Nn;var Z=QM.exports;const cr=_m(Z),Kx=KM({__proto__:null,default:cr},[Z]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var X4=Z,Y4=Symbol.for("react.element"),K4=Symbol.for("react.fragment"),J4=Object.prototype.hasOwnProperty,Q4=X4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,e5={key:!0,ref:!0,__self:!0,__source:!0};function ak(t,e,n){var r,i={},a=null,h=null;n!==void 0&&(a=""+n),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(h=e.ref);for(r in e)J4.call(e,r)&&!e5.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:Y4,type:t,key:a,ref:h,props:i,_owner:Q4.current}}l_.Fragment=K4;l_.jsx=ak;l_.jsxs=ak;JM.exports=l_;var ve=JM.exports,Jx={},lk={exports:{}},lo={},ck={exports:{}},uk={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Me,qe){var ut=Me.length;Me.push(qe);e:for(;0<ut;){var zt=ut-1>>>1,vt=Me[zt];if(0<i(vt,qe))Me[zt]=qe,Me[ut]=vt,ut=zt;else break e}}function n(Me){return Me.length===0?null:Me[0]}function r(Me){if(Me.length===0)return null;var qe=Me[0],ut=Me.pop();if(ut!==qe){Me[0]=ut;e:for(var zt=0,vt=Me.length,yt=vt>>>1;zt<yt;){var at=2*(zt+1)-1,bt=Me[at],xt=at+1,$t=Me[xt];if(0>i(bt,ut))xt<vt&&0>i($t,bt)?(Me[zt]=$t,Me[xt]=ut,zt=xt):(Me[zt]=bt,Me[at]=ut,zt=at);else if(xt<vt&&0>i($t,ut))Me[zt]=$t,Me[xt]=ut,zt=xt;else break e}}return qe}function i(Me,qe){var ut=Me.sortIndex-qe.sortIndex;return ut!==0?ut:Me.id-qe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var h=Date,l=h.now();t.unstable_now=function(){return h.now()-l}}var m=[],_=[],E=1,S=null,I=3,L=!1,O=!1,D=!1,H=typeof setTimeout=="function"?setTimeout:null,z=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function F(Me){for(var qe=n(_);qe!==null;){if(qe.callback===null)r(_);else if(qe.startTime<=Me)r(_),qe.sortIndex=qe.expirationTime,e(m,qe);else break;qe=n(_)}}function $(Me){if(D=!1,F(Me),!O)if(n(m)!==null)O=!0,je(Q);else{var qe=n(_);qe!==null&&it($,qe.startTime-Me)}}function Q(Me,qe){O=!1,D&&(D=!1,z(we),we=-1),L=!0;var ut=I;try{for(F(qe),S=n(m);S!==null&&(!(S.expirationTime>qe)||Me&&!Le());){var zt=S.callback;if(typeof zt=="function"){S.callback=null,I=S.priorityLevel;var vt=zt(S.expirationTime<=qe);qe=t.unstable_now(),typeof vt=="function"?S.callback=vt:S===n(m)&&r(m),F(qe)}else r(m);S=n(m)}if(S!==null)var yt=!0;else{var at=n(_);at!==null&&it($,at.startTime-qe),yt=!1}return yt}finally{S=null,I=ut,L=!1}}var te=!1,re=null,we=-1,Ee=5,de=-1;function Le(){return!(t.unstable_now()-de<Ee)}function Ge(){if(re!==null){var Me=t.unstable_now();de=Me;var qe=!0;try{qe=re(!0,Me)}finally{qe?Be():(te=!1,re=null)}}else te=!1}var Be;if(typeof N=="function")Be=function(){N(Ge)};else if(typeof MessageChannel<"u"){var Oe=new MessageChannel,Ke=Oe.port2;Oe.port1.onmessage=Ge,Be=function(){Ke.postMessage(null)}}else Be=function(){H(Ge,0)};function je(Me){re=Me,te||(te=!0,Be())}function it(Me,qe){we=H(function(){Me(t.unstable_now())},qe)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Me){Me.callback=null},t.unstable_continueExecution=function(){O||L||(O=!0,je(Q))},t.unstable_forceFrameRate=function(Me){0>Me||125<Me?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ee=0<Me?Math.floor(1e3/Me):5},t.unstable_getCurrentPriorityLevel=function(){return I},t.unstable_getFirstCallbackNode=function(){return n(m)},t.unstable_next=function(Me){switch(I){case 1:case 2:case 3:var qe=3;break;default:qe=I}var ut=I;I=qe;try{return Me()}finally{I=ut}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Me,qe){switch(Me){case 1:case 2:case 3:case 4:case 5:break;default:Me=3}var ut=I;I=Me;try{return qe()}finally{I=ut}},t.unstable_scheduleCallback=function(Me,qe,ut){var zt=t.unstable_now();switch(typeof ut=="object"&&ut!==null?(ut=ut.delay,ut=typeof ut=="number"&&0<ut?zt+ut:zt):ut=zt,Me){case 1:var vt=-1;break;case 2:vt=250;break;case 5:vt=1073741823;break;case 4:vt=1e4;break;default:vt=5e3}return vt=ut+vt,Me={id:E++,callback:qe,priorityLevel:Me,startTime:ut,expirationTime:vt,sortIndex:-1},ut>zt?(Me.sortIndex=ut,e(_,Me),n(m)===null&&Me===n(_)&&(D?(z(we),we=-1):D=!0,it($,ut-zt))):(Me.sortIndex=vt,e(m,Me),O||L||(O=!0,je(Q))),Me},t.unstable_shouldYield=Le,t.unstable_wrapCallback=function(Me){var qe=I;return function(){var ut=I;I=qe;try{return Me.apply(this,arguments)}finally{I=ut}}}})(uk);ck.exports=uk;var t5=ck.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hk=Z,oo=t5;function dt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var dk=new Set,Dp={};function Tu(t,e){id(t,e),id(t+"Capture",e)}function id(t,e){for(Dp[t]=e,t=0;t<e.length;t++)dk.add(e[t])}var ol=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Qx=Object.prototype.hasOwnProperty,n5=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,YS={},KS={};function r5(t){return Qx.call(KS,t)?!0:Qx.call(YS,t)?!1:n5.test(t)?KS[t]=!0:(YS[t]=!0,!1)}function i5(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function s5(t,e,n,r){if(e===null||typeof e>"u"||i5(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ts(t,e,n,r,i,a,h){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=h}var $i={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){$i[t]=new Ts(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];$i[e]=new Ts(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){$i[t]=new Ts(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){$i[t]=new Ts(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){$i[t]=new Ts(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){$i[t]=new Ts(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){$i[t]=new Ts(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){$i[t]=new Ts(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){$i[t]=new Ts(t,5,!1,t.toLowerCase(),null,!1,!1)});var Zw=/[\-:]([a-z])/g;function Xw(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Zw,Xw);$i[e]=new Ts(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Zw,Xw);$i[e]=new Ts(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Zw,Xw);$i[e]=new Ts(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){$i[t]=new Ts(t,1,!1,t.toLowerCase(),null,!1,!1)});$i.xlinkHref=new Ts("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){$i[t]=new Ts(t,1,!1,t.toLowerCase(),null,!0,!0)});function Yw(t,e,n,r){var i=$i.hasOwnProperty(e)?$i[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(s5(e,n,i,r)&&(n=null),r||i===null?r5(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var gl=hk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Gg=Symbol.for("react.element"),Mh=Symbol.for("react.portal"),kh=Symbol.for("react.fragment"),Kw=Symbol.for("react.strict_mode"),eb=Symbol.for("react.profiler"),fk=Symbol.for("react.provider"),pk=Symbol.for("react.context"),Jw=Symbol.for("react.forward_ref"),tb=Symbol.for("react.suspense"),nb=Symbol.for("react.suspense_list"),Qw=Symbol.for("react.memo"),Zl=Symbol.for("react.lazy"),mk=Symbol.for("react.offscreen"),JS=Symbol.iterator;function Nf(t){return t===null||typeof t!="object"?null:(t=JS&&t[JS]||t["@@iterator"],typeof t=="function"?t:null)}var Vr=Object.assign,k1;function lp(t){if(k1===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);k1=e&&e[1]||""}return`
`+k1+t}var L1=!1;function R1(t,e){if(!t||L1)return"";L1=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(_){var r=_}Reflect.construct(t,[],e)}else{try{e.call()}catch(_){r=_}t.call(e.prototype)}else{try{throw Error()}catch(_){r=_}t()}}catch(_){if(_&&r&&typeof _.stack=="string"){for(var i=_.stack.split(`
`),a=r.stack.split(`
`),h=i.length-1,l=a.length-1;1<=h&&0<=l&&i[h]!==a[l];)l--;for(;1<=h&&0<=l;h--,l--)if(i[h]!==a[l]){if(h!==1||l!==1)do if(h--,l--,0>l||i[h]!==a[l]){var m=`
`+i[h].replace(" at new "," at ");return t.displayName&&m.includes("<anonymous>")&&(m=m.replace("<anonymous>",t.displayName)),m}while(1<=h&&0<=l);break}}}finally{L1=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?lp(t):""}function o5(t){switch(t.tag){case 5:return lp(t.type);case 16:return lp("Lazy");case 13:return lp("Suspense");case 19:return lp("SuspenseList");case 0:case 2:case 15:return t=R1(t.type,!1),t;case 11:return t=R1(t.type.render,!1),t;case 1:return t=R1(t.type,!0),t;default:return""}}function rb(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case kh:return"Fragment";case Mh:return"Portal";case eb:return"Profiler";case Kw:return"StrictMode";case tb:return"Suspense";case nb:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case pk:return(t.displayName||"Context")+".Consumer";case fk:return(t._context.displayName||"Context")+".Provider";case Jw:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Qw:return e=t.displayName||null,e!==null?e:rb(t.type)||"Memo";case Zl:e=t._payload,t=t._init;try{return rb(t(e))}catch{}}return null}function a5(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return rb(e);case 8:return e===Kw?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function gc(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function gk(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function l5(t){var e=gk(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,a=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(h){r=""+h,a.call(this,h)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(h){r=""+h},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Hg(t){t._valueTracker||(t._valueTracker=l5(t))}function yk(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=gk(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function h0(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ib(t,e){var n=e.checked;return Vr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function QS(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=gc(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function _k(t,e){e=e.checked,e!=null&&Yw(t,"checked",e,!1)}function sb(t,e){_k(t,e);var n=gc(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?ob(t,e.type,n):e.hasOwnProperty("defaultValue")&&ob(t,e.type,gc(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function eP(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function ob(t,e,n){(e!=="number"||h0(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var cp=Array.isArray;function Wh(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+gc(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function ab(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(dt(91));return Vr({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function tP(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(dt(92));if(cp(n)){if(1<n.length)throw Error(dt(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:gc(n)}}function vk(t,e){var n=gc(e.value),r=gc(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function nP(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function xk(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?xk(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Wg,bk=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Wg=Wg||document.createElement("div"),Wg.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Wg.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function zp(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var yp={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},c5=["Webkit","ms","Moz","O"];Object.keys(yp).forEach(function(t){c5.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),yp[e]=yp[t]})});function wk(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||yp.hasOwnProperty(t)&&yp[t]?(""+e).trim():e+"px"}function Ek(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=wk(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var u5=Vr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function cb(t,e){if(e){if(u5[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(dt(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(dt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(dt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(dt(62))}}function ub(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hb=null;function e2(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var db=null,qh=null,Zh=null;function rP(t){if(t=wm(t)){if(typeof db!="function")throw Error(dt(280));var e=t.stateNode;e&&(e=f_(e),db(t.stateNode,t.type,e))}}function Tk(t){qh?Zh?Zh.push(t):Zh=[t]:qh=t}function Sk(){if(qh){var t=qh,e=Zh;if(Zh=qh=null,rP(t),e)for(t=0;t<e.length;t++)rP(e[t])}}function Pk(t,e){return t(e)}function Ck(){}var O1=!1;function Ak(t,e,n){if(O1)return t(e,n);O1=!0;try{return Pk(t,e,n)}finally{O1=!1,(qh!==null||Zh!==null)&&(Ck(),Sk())}}function Fp(t,e){var n=t.stateNode;if(n===null)return null;var r=f_(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(dt(231,e,typeof n));return n}var fb=!1;if(ol)try{var Bf={};Object.defineProperty(Bf,"passive",{get:function(){fb=!0}}),window.addEventListener("test",Bf,Bf),window.removeEventListener("test",Bf,Bf)}catch{fb=!1}function h5(t,e,n,r,i,a,h,l,m){var _=Array.prototype.slice.call(arguments,3);try{e.apply(n,_)}catch(E){this.onError(E)}}var _p=!1,d0=null,f0=!1,pb=null,d5={onError:function(t){_p=!0,d0=t}};function f5(t,e,n,r,i,a,h,l,m){_p=!1,d0=null,h5.apply(d5,arguments)}function p5(t,e,n,r,i,a,h,l,m){if(f5.apply(this,arguments),_p){if(_p){var _=d0;_p=!1,d0=null}else throw Error(dt(198));f0||(f0=!0,pb=_)}}function Su(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Ik(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function iP(t){if(Su(t)!==t)throw Error(dt(188))}function m5(t){var e=t.alternate;if(!e){if(e=Su(t),e===null)throw Error(dt(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var a=i.alternate;if(a===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return iP(i),t;if(a===r)return iP(i),e;a=a.sibling}throw Error(dt(188))}if(n.return!==r.return)n=i,r=a;else{for(var h=!1,l=i.child;l;){if(l===n){h=!0,n=i,r=a;break}if(l===r){h=!0,r=i,n=a;break}l=l.sibling}if(!h){for(l=a.child;l;){if(l===n){h=!0,n=a,r=i;break}if(l===r){h=!0,r=a,n=i;break}l=l.sibling}if(!h)throw Error(dt(189))}}if(n.alternate!==r)throw Error(dt(190))}if(n.tag!==3)throw Error(dt(188));return n.stateNode.current===n?t:e}function Mk(t){return t=m5(t),t!==null?kk(t):null}function kk(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=kk(t);if(e!==null)return e;t=t.sibling}return null}var Lk=oo.unstable_scheduleCallback,sP=oo.unstable_cancelCallback,g5=oo.unstable_shouldYield,y5=oo.unstable_requestPaint,ai=oo.unstable_now,_5=oo.unstable_getCurrentPriorityLevel,t2=oo.unstable_ImmediatePriority,Rk=oo.unstable_UserBlockingPriority,p0=oo.unstable_NormalPriority,v5=oo.unstable_LowPriority,Ok=oo.unstable_IdlePriority,c_=null,Aa=null;function x5(t){if(Aa&&typeof Aa.onCommitFiberRoot=="function")try{Aa.onCommitFiberRoot(c_,t,void 0,(t.current.flags&128)===128)}catch{}}var na=Math.clz32?Math.clz32:E5,b5=Math.log,w5=Math.LN2;function E5(t){return t>>>=0,t===0?32:31-(b5(t)/w5|0)|0}var qg=64,Zg=4194304;function up(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function m0(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,a=t.pingedLanes,h=n&268435455;if(h!==0){var l=h&~i;l!==0?r=up(l):(a&=h,a!==0&&(r=up(a)))}else h=n&~i,h!==0?r=up(h):a!==0&&(r=up(a));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,a=e&-e,i>=a||i===16&&(a&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-na(e),i=1<<n,r|=t[n],e&=~i;return r}function T5(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function S5(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,a=t.pendingLanes;0<a;){var h=31-na(a),l=1<<h,m=i[h];m===-1?(!(l&n)||l&r)&&(i[h]=T5(l,e)):m<=e&&(t.expiredLanes|=l),a&=~l}}function mb(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Dk(){var t=qg;return qg<<=1,!(qg&4194240)&&(qg=64),t}function D1(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function xm(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-na(e),t[e]=n}function P5(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-na(n),a=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~a}}function n2(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-na(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var nr=0;function zk(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Fk,r2,Nk,Bk,Uk,gb=!1,Xg=[],sc=null,oc=null,ac=null,Np=new Map,Bp=new Map,Yl=[],C5="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function oP(t,e){switch(t){case"focusin":case"focusout":sc=null;break;case"dragenter":case"dragleave":oc=null;break;case"mouseover":case"mouseout":ac=null;break;case"pointerover":case"pointerout":Np.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Bp.delete(e.pointerId)}}function Uf(t,e,n,r,i,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},e!==null&&(e=wm(e),e!==null&&r2(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function A5(t,e,n,r,i){switch(e){case"focusin":return sc=Uf(sc,t,e,n,r,i),!0;case"dragenter":return oc=Uf(oc,t,e,n,r,i),!0;case"mouseover":return ac=Uf(ac,t,e,n,r,i),!0;case"pointerover":var a=i.pointerId;return Np.set(a,Uf(Np.get(a)||null,t,e,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Bp.set(a,Uf(Bp.get(a)||null,t,e,n,r,i)),!0}return!1}function Vk(t){var e=nu(t.target);if(e!==null){var n=Su(e);if(n!==null){if(e=n.tag,e===13){if(e=Ik(n),e!==null){t.blockedOn=e,Uk(t.priority,function(){Nk(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Uy(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=yb(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);hb=r,n.target.dispatchEvent(r),hb=null}else return e=wm(n),e!==null&&r2(e),t.blockedOn=n,!1;e.shift()}return!0}function aP(t,e,n){Uy(t)&&n.delete(e)}function I5(){gb=!1,sc!==null&&Uy(sc)&&(sc=null),oc!==null&&Uy(oc)&&(oc=null),ac!==null&&Uy(ac)&&(ac=null),Np.forEach(aP),Bp.forEach(aP)}function Vf(t,e){t.blockedOn===e&&(t.blockedOn=null,gb||(gb=!0,oo.unstable_scheduleCallback(oo.unstable_NormalPriority,I5)))}function Up(t){function e(i){return Vf(i,t)}if(0<Xg.length){Vf(Xg[0],t);for(var n=1;n<Xg.length;n++){var r=Xg[n];r.blockedOn===t&&(r.blockedOn=null)}}for(sc!==null&&Vf(sc,t),oc!==null&&Vf(oc,t),ac!==null&&Vf(ac,t),Np.forEach(e),Bp.forEach(e),n=0;n<Yl.length;n++)r=Yl[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Yl.length&&(n=Yl[0],n.blockedOn===null);)Vk(n),n.blockedOn===null&&Yl.shift()}var Xh=gl.ReactCurrentBatchConfig,g0=!0;function M5(t,e,n,r){var i=nr,a=Xh.transition;Xh.transition=null;try{nr=1,i2(t,e,n,r)}finally{nr=i,Xh.transition=a}}function k5(t,e,n,r){var i=nr,a=Xh.transition;Xh.transition=null;try{nr=4,i2(t,e,n,r)}finally{nr=i,Xh.transition=a}}function i2(t,e,n,r){if(g0){var i=yb(t,e,n,r);if(i===null)H1(t,e,r,y0,n),oP(t,r);else if(A5(i,t,e,n,r))r.stopPropagation();else if(oP(t,r),e&4&&-1<C5.indexOf(t)){for(;i!==null;){var a=wm(i);if(a!==null&&Fk(a),a=yb(t,e,n,r),a===null&&H1(t,e,r,y0,n),a===i)break;i=a}i!==null&&r.stopPropagation()}else H1(t,e,r,null,n)}}var y0=null;function yb(t,e,n,r){if(y0=null,t=e2(r),t=nu(t),t!==null)if(e=Su(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Ik(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return y0=t,null}function jk(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(_5()){case t2:return 1;case Rk:return 4;case p0:case v5:return 16;case Ok:return 536870912;default:return 16}default:return 16}}var Jl=null,s2=null,Vy=null;function $k(){if(Vy)return Vy;var t,e=s2,n=e.length,r,i="value"in Jl?Jl.value:Jl.textContent,a=i.length;for(t=0;t<n&&e[t]===i[t];t++);var h=n-t;for(r=1;r<=h&&e[n-r]===i[a-r];r++);return Vy=i.slice(t,1<r?1-r:void 0)}function jy(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Yg(){return!0}function lP(){return!1}function co(t){function e(n,r,i,a,h){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=a,this.target=h,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Yg:lP,this.isPropagationStopped=lP,this}return Vr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Yg)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Yg)},persist:function(){},isPersistent:Yg}),e}var kd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},o2=co(kd),bm=Vr({},kd,{view:0,detail:0}),L5=co(bm),z1,F1,jf,u_=Vr({},bm,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:a2,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==jf&&(jf&&t.type==="mousemove"?(z1=t.screenX-jf.screenX,F1=t.screenY-jf.screenY):F1=z1=0,jf=t),z1)},movementY:function(t){return"movementY"in t?t.movementY:F1}}),cP=co(u_),R5=Vr({},u_,{dataTransfer:0}),O5=co(R5),D5=Vr({},bm,{relatedTarget:0}),N1=co(D5),z5=Vr({},kd,{animationName:0,elapsedTime:0,pseudoElement:0}),F5=co(z5),N5=Vr({},kd,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),B5=co(N5),U5=Vr({},kd,{data:0}),uP=co(U5),V5={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},j5={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$5={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function G5(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=$5[t])?!!e[t]:!1}function a2(){return G5}var H5=Vr({},bm,{key:function(t){if(t.key){var e=V5[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=jy(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?j5[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:a2,charCode:function(t){return t.type==="keypress"?jy(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?jy(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),W5=co(H5),q5=Vr({},u_,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),hP=co(q5),Z5=Vr({},bm,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:a2}),X5=co(Z5),Y5=Vr({},kd,{propertyName:0,elapsedTime:0,pseudoElement:0}),K5=co(Y5),J5=Vr({},u_,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Q5=co(J5),eF=[9,13,27,32],l2=ol&&"CompositionEvent"in window,vp=null;ol&&"documentMode"in document&&(vp=document.documentMode);var tF=ol&&"TextEvent"in window&&!vp,Gk=ol&&(!l2||vp&&8<vp&&11>=vp),dP=String.fromCharCode(32),fP=!1;function Hk(t,e){switch(t){case"keyup":return eF.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wk(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Lh=!1;function nF(t,e){switch(t){case"compositionend":return Wk(e);case"keypress":return e.which!==32?null:(fP=!0,dP);case"textInput":return t=e.data,t===dP&&fP?null:t;default:return null}}function rF(t,e){if(Lh)return t==="compositionend"||!l2&&Hk(t,e)?(t=$k(),Vy=s2=Jl=null,Lh=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Gk&&e.locale!=="ko"?null:e.data;default:return null}}var iF={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function pP(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!iF[t.type]:e==="textarea"}function qk(t,e,n,r){Tk(r),e=_0(e,"onChange"),0<e.length&&(n=new o2("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var xp=null,Vp=null;function sF(t){iL(t,0)}function h_(t){var e=Dh(t);if(yk(e))return t}function oF(t,e){if(t==="change")return e}var Zk=!1;if(ol){var B1;if(ol){var U1="oninput"in document;if(!U1){var mP=document.createElement("div");mP.setAttribute("oninput","return;"),U1=typeof mP.oninput=="function"}B1=U1}else B1=!1;Zk=B1&&(!document.documentMode||9<document.documentMode)}function gP(){xp&&(xp.detachEvent("onpropertychange",Xk),Vp=xp=null)}function Xk(t){if(t.propertyName==="value"&&h_(Vp)){var e=[];qk(e,Vp,t,e2(t)),Ak(sF,e)}}function aF(t,e,n){t==="focusin"?(gP(),xp=e,Vp=n,xp.attachEvent("onpropertychange",Xk)):t==="focusout"&&gP()}function lF(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return h_(Vp)}function cF(t,e){if(t==="click")return h_(e)}function uF(t,e){if(t==="input"||t==="change")return h_(e)}function hF(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var sa=typeof Object.is=="function"?Object.is:hF;function jp(t,e){if(sa(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Qx.call(e,i)||!sa(t[i],e[i]))return!1}return!0}function yP(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function _P(t,e){var n=yP(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=yP(n)}}function Yk(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Yk(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Kk(){for(var t=window,e=h0();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=h0(t.document)}return e}function c2(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function dF(t){var e=Kk(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Yk(n.ownerDocument.documentElement,n)){if(r!==null&&c2(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=r.end===void 0?a:Math.min(r.end,i),!t.extend&&a>r&&(i=r,r=a,a=i),i=_P(n,a);var h=_P(n,r);i&&h&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==h.node||t.focusOffset!==h.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),a>r?(t.addRange(e),t.extend(h.node,h.offset)):(e.setEnd(h.node,h.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var fF=ol&&"documentMode"in document&&11>=document.documentMode,Rh=null,_b=null,bp=null,vb=!1;function vP(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;vb||Rh==null||Rh!==h0(r)||(r=Rh,"selectionStart"in r&&c2(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),bp&&jp(bp,r)||(bp=r,r=_0(_b,"onSelect"),0<r.length&&(e=new o2("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Rh)))}function Kg(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Oh={animationend:Kg("Animation","AnimationEnd"),animationiteration:Kg("Animation","AnimationIteration"),animationstart:Kg("Animation","AnimationStart"),transitionend:Kg("Transition","TransitionEnd")},V1={},Jk={};ol&&(Jk=document.createElement("div").style,"AnimationEvent"in window||(delete Oh.animationend.animation,delete Oh.animationiteration.animation,delete Oh.animationstart.animation),"TransitionEvent"in window||delete Oh.transitionend.transition);function d_(t){if(V1[t])return V1[t];if(!Oh[t])return t;var e=Oh[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Jk)return V1[t]=e[n];return t}var Qk=d_("animationend"),eL=d_("animationiteration"),tL=d_("animationstart"),nL=d_("transitionend"),rL=new Map,xP="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function xc(t,e){rL.set(t,e),Tu(e,[t])}for(var j1=0;j1<xP.length;j1++){var $1=xP[j1],pF=$1.toLowerCase(),mF=$1[0].toUpperCase()+$1.slice(1);xc(pF,"on"+mF)}xc(Qk,"onAnimationEnd");xc(eL,"onAnimationIteration");xc(tL,"onAnimationStart");xc("dblclick","onDoubleClick");xc("focusin","onFocus");xc("focusout","onBlur");xc(nL,"onTransitionEnd");id("onMouseEnter",["mouseout","mouseover"]);id("onMouseLeave",["mouseout","mouseover"]);id("onPointerEnter",["pointerout","pointerover"]);id("onPointerLeave",["pointerout","pointerover"]);Tu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Tu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Tu("onBeforeInput",["compositionend","keypress","textInput","paste"]);Tu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Tu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Tu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var hp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gF=new Set("cancel close invalid load scroll toggle".split(" ").concat(hp));function bP(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,p5(r,e,void 0,t),t.currentTarget=null}function iL(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var a=void 0;if(e)for(var h=r.length-1;0<=h;h--){var l=r[h],m=l.instance,_=l.currentTarget;if(l=l.listener,m!==a&&i.isPropagationStopped())break e;bP(i,l,_),a=m}else for(h=0;h<r.length;h++){if(l=r[h],m=l.instance,_=l.currentTarget,l=l.listener,m!==a&&i.isPropagationStopped())break e;bP(i,l,_),a=m}}}if(f0)throw t=pb,f0=!1,pb=null,t}function Tr(t,e){var n=e[Tb];n===void 0&&(n=e[Tb]=new Set);var r=t+"__bubble";n.has(r)||(sL(e,t,2,!1),n.add(r))}function G1(t,e,n){var r=0;e&&(r|=4),sL(n,t,r,e)}var Jg="_reactListening"+Math.random().toString(36).slice(2);function $p(t){if(!t[Jg]){t[Jg]=!0,dk.forEach(function(n){n!=="selectionchange"&&(gF.has(n)||G1(n,!1,t),G1(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Jg]||(e[Jg]=!0,G1("selectionchange",!1,e))}}function sL(t,e,n,r){switch(jk(e)){case 1:var i=M5;break;case 4:i=k5;break;default:i=i2}n=i.bind(null,e,n,t),i=void 0,!fb||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function H1(t,e,n,r,i){var a=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var h=r.tag;if(h===3||h===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(h===4)for(h=r.return;h!==null;){var m=h.tag;if((m===3||m===4)&&(m=h.stateNode.containerInfo,m===i||m.nodeType===8&&m.parentNode===i))return;h=h.return}for(;l!==null;){if(h=nu(l),h===null)return;if(m=h.tag,m===5||m===6){r=a=h;continue e}l=l.parentNode}}r=r.return}Ak(function(){var _=a,E=e2(n),S=[];e:{var I=rL.get(t);if(I!==void 0){var L=o2,O=t;switch(t){case"keypress":if(jy(n)===0)break e;case"keydown":case"keyup":L=W5;break;case"focusin":O="focus",L=N1;break;case"focusout":O="blur",L=N1;break;case"beforeblur":case"afterblur":L=N1;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":L=cP;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":L=O5;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":L=X5;break;case Qk:case eL:case tL:L=F5;break;case nL:L=K5;break;case"scroll":L=L5;break;case"wheel":L=Q5;break;case"copy":case"cut":case"paste":L=B5;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":L=hP}var D=(e&4)!==0,H=!D&&t==="scroll",z=D?I!==null?I+"Capture":null:I;D=[];for(var N=_,F;N!==null;){F=N;var $=F.stateNode;if(F.tag===5&&$!==null&&(F=$,z!==null&&($=Fp(N,z),$!=null&&D.push(Gp(N,$,F)))),H)break;N=N.return}0<D.length&&(I=new L(I,O,null,n,E),S.push({event:I,listeners:D}))}}if(!(e&7)){e:{if(I=t==="mouseover"||t==="pointerover",L=t==="mouseout"||t==="pointerout",I&&n!==hb&&(O=n.relatedTarget||n.fromElement)&&(nu(O)||O[al]))break e;if((L||I)&&(I=E.window===E?E:(I=E.ownerDocument)?I.defaultView||I.parentWindow:window,L?(O=n.relatedTarget||n.toElement,L=_,O=O?nu(O):null,O!==null&&(H=Su(O),O!==H||O.tag!==5&&O.tag!==6)&&(O=null)):(L=null,O=_),L!==O)){if(D=cP,$="onMouseLeave",z="onMouseEnter",N="mouse",(t==="pointerout"||t==="pointerover")&&(D=hP,$="onPointerLeave",z="onPointerEnter",N="pointer"),H=L==null?I:Dh(L),F=O==null?I:Dh(O),I=new D($,N+"leave",L,n,E),I.target=H,I.relatedTarget=F,$=null,nu(E)===_&&(D=new D(z,N+"enter",O,n,E),D.target=F,D.relatedTarget=H,$=D),H=$,L&&O)t:{for(D=L,z=O,N=0,F=D;F;F=fh(F))N++;for(F=0,$=z;$;$=fh($))F++;for(;0<N-F;)D=fh(D),N--;for(;0<F-N;)z=fh(z),F--;for(;N--;){if(D===z||z!==null&&D===z.alternate)break t;D=fh(D),z=fh(z)}D=null}else D=null;L!==null&&wP(S,I,L,D,!1),O!==null&&H!==null&&wP(S,H,O,D,!0)}}e:{if(I=_?Dh(_):window,L=I.nodeName&&I.nodeName.toLowerCase(),L==="select"||L==="input"&&I.type==="file")var Q=oF;else if(pP(I))if(Zk)Q=uF;else{Q=lF;var te=aF}else(L=I.nodeName)&&L.toLowerCase()==="input"&&(I.type==="checkbox"||I.type==="radio")&&(Q=cF);if(Q&&(Q=Q(t,_))){qk(S,Q,n,E);break e}te&&te(t,I,_),t==="focusout"&&(te=I._wrapperState)&&te.controlled&&I.type==="number"&&ob(I,"number",I.value)}switch(te=_?Dh(_):window,t){case"focusin":(pP(te)||te.contentEditable==="true")&&(Rh=te,_b=_,bp=null);break;case"focusout":bp=_b=Rh=null;break;case"mousedown":vb=!0;break;case"contextmenu":case"mouseup":case"dragend":vb=!1,vP(S,n,E);break;case"selectionchange":if(fF)break;case"keydown":case"keyup":vP(S,n,E)}var re;if(l2)e:{switch(t){case"compositionstart":var we="onCompositionStart";break e;case"compositionend":we="onCompositionEnd";break e;case"compositionupdate":we="onCompositionUpdate";break e}we=void 0}else Lh?Hk(t,n)&&(we="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(we="onCompositionStart");we&&(Gk&&n.locale!=="ko"&&(Lh||we!=="onCompositionStart"?we==="onCompositionEnd"&&Lh&&(re=$k()):(Jl=E,s2="value"in Jl?Jl.value:Jl.textContent,Lh=!0)),te=_0(_,we),0<te.length&&(we=new uP(we,t,null,n,E),S.push({event:we,listeners:te}),re?we.data=re:(re=Wk(n),re!==null&&(we.data=re)))),(re=tF?nF(t,n):rF(t,n))&&(_=_0(_,"onBeforeInput"),0<_.length&&(E=new uP("onBeforeInput","beforeinput",null,n,E),S.push({event:E,listeners:_}),E.data=re))}iL(S,e)})}function Gp(t,e,n){return{instance:t,listener:e,currentTarget:n}}function _0(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=Fp(t,n),a!=null&&r.unshift(Gp(t,a,i)),a=Fp(t,e),a!=null&&r.push(Gp(t,a,i))),t=t.return}return r}function fh(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function wP(t,e,n,r,i){for(var a=e._reactName,h=[];n!==null&&n!==r;){var l=n,m=l.alternate,_=l.stateNode;if(m!==null&&m===r)break;l.tag===5&&_!==null&&(l=_,i?(m=Fp(n,a),m!=null&&h.unshift(Gp(n,m,l))):i||(m=Fp(n,a),m!=null&&h.push(Gp(n,m,l)))),n=n.return}h.length!==0&&t.push({event:e,listeners:h})}var yF=/\r\n?/g,_F=/\u0000|\uFFFD/g;function EP(t){return(typeof t=="string"?t:""+t).replace(yF,`
`).replace(_F,"")}function Qg(t,e,n){if(e=EP(e),EP(t)!==e&&n)throw Error(dt(425))}function v0(){}var xb=null,bb=null;function wb(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Eb=typeof setTimeout=="function"?setTimeout:void 0,vF=typeof clearTimeout=="function"?clearTimeout:void 0,TP=typeof Promise=="function"?Promise:void 0,xF=typeof queueMicrotask=="function"?queueMicrotask:typeof TP<"u"?function(t){return TP.resolve(null).then(t).catch(bF)}:Eb;function bF(t){setTimeout(function(){throw t})}function W1(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Up(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Up(e)}function lc(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function SP(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ld=Math.random().toString(36).slice(2),Ea="__reactFiber$"+Ld,Hp="__reactProps$"+Ld,al="__reactContainer$"+Ld,Tb="__reactEvents$"+Ld,wF="__reactListeners$"+Ld,EF="__reactHandles$"+Ld;function nu(t){var e=t[Ea];if(e)return e;for(var n=t.parentNode;n;){if(e=n[al]||n[Ea]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=SP(t);t!==null;){if(n=t[Ea])return n;t=SP(t)}return e}t=n,n=t.parentNode}return null}function wm(t){return t=t[Ea]||t[al],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Dh(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(dt(33))}function f_(t){return t[Hp]||null}var Sb=[],zh=-1;function bc(t){return{current:t}}function Pr(t){0>zh||(t.current=Sb[zh],Sb[zh]=null,zh--)}function vr(t,e){zh++,Sb[zh]=t.current,t.current=e}var yc={},as=bc(yc),Rs=bc(!1),fu=yc;function sd(t,e){var n=t.type.contextTypes;if(!n)return yc;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in n)i[a]=e[a];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Os(t){return t=t.childContextTypes,t!=null}function x0(){Pr(Rs),Pr(as)}function PP(t,e,n){if(as.current!==yc)throw Error(dt(168));vr(as,e),vr(Rs,n)}function oL(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(dt(108,a5(t)||"Unknown",i));return Vr({},n,r)}function b0(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||yc,fu=as.current,vr(as,t),vr(Rs,Rs.current),!0}function CP(t,e,n){var r=t.stateNode;if(!r)throw Error(dt(169));n?(t=oL(t,e,fu),r.__reactInternalMemoizedMergedChildContext=t,Pr(Rs),Pr(as),vr(as,t)):Pr(Rs),vr(Rs,n)}var Qa=null,p_=!1,q1=!1;function aL(t){Qa===null?Qa=[t]:Qa.push(t)}function TF(t){p_=!0,aL(t)}function wc(){if(!q1&&Qa!==null){q1=!0;var t=0,e=nr;try{var n=Qa;for(nr=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Qa=null,p_=!1}catch(i){throw Qa!==null&&(Qa=Qa.slice(t+1)),Lk(t2,wc),i}finally{nr=e,q1=!1}}return null}var Fh=[],Nh=0,w0=null,E0=0,So=[],Po=0,pu=null,rl=1,il="";function Kc(t,e){Fh[Nh++]=E0,Fh[Nh++]=w0,w0=t,E0=e}function lL(t,e,n){So[Po++]=rl,So[Po++]=il,So[Po++]=pu,pu=t;var r=rl;t=il;var i=32-na(r)-1;r&=~(1<<i),n+=1;var a=32-na(e)+i;if(30<a){var h=i-i%5;a=(r&(1<<h)-1).toString(32),r>>=h,i-=h,rl=1<<32-na(e)+i|n<<i|r,il=a+t}else rl=1<<a|n<<i|r,il=t}function u2(t){t.return!==null&&(Kc(t,1),lL(t,1,0))}function h2(t){for(;t===w0;)w0=Fh[--Nh],Fh[Nh]=null,E0=Fh[--Nh],Fh[Nh]=null;for(;t===pu;)pu=So[--Po],So[Po]=null,il=So[--Po],So[Po]=null,rl=So[--Po],So[Po]=null}var ro=null,eo=null,Or=!1,Jo=null;function cL(t,e){var n=Co(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function AP(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,ro=t,eo=lc(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,ro=t,eo=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=pu!==null?{id:rl,overflow:il}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Co(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,ro=t,eo=null,!0):!1;default:return!1}}function Pb(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Cb(t){if(Or){var e=eo;if(e){var n=e;if(!AP(t,e)){if(Pb(t))throw Error(dt(418));e=lc(n.nextSibling);var r=ro;e&&AP(t,e)?cL(r,n):(t.flags=t.flags&-4097|2,Or=!1,ro=t)}}else{if(Pb(t))throw Error(dt(418));t.flags=t.flags&-4097|2,Or=!1,ro=t}}}function IP(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ro=t}function ey(t){if(t!==ro)return!1;if(!Or)return IP(t),Or=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!wb(t.type,t.memoizedProps)),e&&(e=eo)){if(Pb(t))throw uL(),Error(dt(418));for(;e;)cL(t,e),e=lc(e.nextSibling)}if(IP(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(dt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){eo=lc(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}eo=null}}else eo=ro?lc(t.stateNode.nextSibling):null;return!0}function uL(){for(var t=eo;t;)t=lc(t.nextSibling)}function od(){eo=ro=null,Or=!1}function d2(t){Jo===null?Jo=[t]:Jo.push(t)}var SF=gl.ReactCurrentBatchConfig;function Yo(t,e){if(t&&t.defaultProps){e=Vr({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var T0=bc(null),S0=null,Bh=null,f2=null;function p2(){f2=Bh=S0=null}function m2(t){var e=T0.current;Pr(T0),t._currentValue=e}function Ab(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Yh(t,e){S0=t,f2=Bh=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ls=!0),t.firstContext=null)}function ko(t){var e=t._currentValue;if(f2!==t)if(t={context:t,memoizedValue:e,next:null},Bh===null){if(S0===null)throw Error(dt(308));Bh=t,S0.dependencies={lanes:0,firstContext:t}}else Bh=Bh.next=t;return e}var ru=null;function g2(t){ru===null?ru=[t]:ru.push(t)}function hL(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,g2(e)):(n.next=i.next,i.next=n),e.interleaved=n,ll(t,r)}function ll(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Xl=!1;function y2(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dL(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function sl(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function cc(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,jn&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,ll(t,n)}return i=r.interleaved,i===null?(e.next=e,g2(r)):(e.next=i.next,i.next=e),r.interleaved=e,ll(t,n)}function $y(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,n2(t,n)}}function MP(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var h={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?i=a=h:a=a.next=h,n=n.next}while(n!==null);a===null?i=a=e:a=a.next=e}else i=a=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function P0(t,e,n,r){var i=t.updateQueue;Xl=!1;var a=i.firstBaseUpdate,h=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var m=l,_=m.next;m.next=null,h===null?a=_:h.next=_,h=m;var E=t.alternate;E!==null&&(E=E.updateQueue,l=E.lastBaseUpdate,l!==h&&(l===null?E.firstBaseUpdate=_:l.next=_,E.lastBaseUpdate=m))}if(a!==null){var S=i.baseState;h=0,E=_=m=null,l=a;do{var I=l.lane,L=l.eventTime;if((r&I)===I){E!==null&&(E=E.next={eventTime:L,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var O=t,D=l;switch(I=e,L=n,D.tag){case 1:if(O=D.payload,typeof O=="function"){S=O.call(L,S,I);break e}S=O;break e;case 3:O.flags=O.flags&-65537|128;case 0:if(O=D.payload,I=typeof O=="function"?O.call(L,S,I):O,I==null)break e;S=Vr({},S,I);break e;case 2:Xl=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,I=i.effects,I===null?i.effects=[l]:I.push(l))}else L={eventTime:L,lane:I,tag:l.tag,payload:l.payload,callback:l.callback,next:null},E===null?(_=E=L,m=S):E=E.next=L,h|=I;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;I=l,l=I.next,I.next=null,i.lastBaseUpdate=I,i.shared.pending=null}}while(1);if(E===null&&(m=S),i.baseState=m,i.firstBaseUpdate=_,i.lastBaseUpdate=E,e=i.shared.interleaved,e!==null){i=e;do h|=i.lane,i=i.next;while(i!==e)}else a===null&&(i.shared.lanes=0);gu|=h,t.lanes=h,t.memoizedState=S}}function kP(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(dt(191,i));i.call(r)}}}var fL=new hk.Component().refs;function Ib(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Vr({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var m_={isMounted:function(t){return(t=t._reactInternals)?Su(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=ws(),i=hc(t),a=sl(r,i);a.payload=e,n!=null&&(a.callback=n),e=cc(t,a,i),e!==null&&(ra(e,t,i,r),$y(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=ws(),i=hc(t),a=sl(r,i);a.tag=1,a.payload=e,n!=null&&(a.callback=n),e=cc(t,a,i),e!==null&&(ra(e,t,i,r),$y(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ws(),r=hc(t),i=sl(n,r);i.tag=2,e!=null&&(i.callback=e),e=cc(t,i,r),e!==null&&(ra(e,t,r,n),$y(e,t,r))}};function LP(t,e,n,r,i,a,h){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,a,h):e.prototype&&e.prototype.isPureReactComponent?!jp(n,r)||!jp(i,a):!0}function pL(t,e,n){var r=!1,i=yc,a=e.contextType;return typeof a=="object"&&a!==null?a=ko(a):(i=Os(e)?fu:as.current,r=e.contextTypes,a=(r=r!=null)?sd(t,i):yc),e=new e(n,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=m_,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=a),e}function RP(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&m_.enqueueReplaceState(e,e.state,null)}function Mb(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=fL,y2(t);var a=e.contextType;typeof a=="object"&&a!==null?i.context=ko(a):(a=Os(e)?fu:as.current,i.context=sd(t,a)),i.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(Ib(t,e,a,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&m_.enqueueReplaceState(i,i.state,null),P0(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function $f(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(dt(309));var r=n.stateNode}if(!r)throw Error(dt(147,t));var i=r,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(h){var l=i.refs;l===fL&&(l=i.refs={}),h===null?delete l[a]:l[a]=h},e._stringRef=a,e)}if(typeof t!="string")throw Error(dt(284));if(!n._owner)throw Error(dt(290,t))}return t}function ty(t,e){throw t=Object.prototype.toString.call(e),Error(dt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function OP(t){var e=t._init;return e(t._payload)}function mL(t){function e(z,N){if(t){var F=z.deletions;F===null?(z.deletions=[N],z.flags|=16):F.push(N)}}function n(z,N){if(!t)return null;for(;N!==null;)e(z,N),N=N.sibling;return null}function r(z,N){for(z=new Map;N!==null;)N.key!==null?z.set(N.key,N):z.set(N.index,N),N=N.sibling;return z}function i(z,N){return z=dc(z,N),z.index=0,z.sibling=null,z}function a(z,N,F){return z.index=F,t?(F=z.alternate,F!==null?(F=F.index,F<N?(z.flags|=2,N):F):(z.flags|=2,N)):(z.flags|=1048576,N)}function h(z){return t&&z.alternate===null&&(z.flags|=2),z}function l(z,N,F,$){return N===null||N.tag!==6?(N=ex(F,z.mode,$),N.return=z,N):(N=i(N,F),N.return=z,N)}function m(z,N,F,$){var Q=F.type;return Q===kh?E(z,N,F.props.children,$,F.key):N!==null&&(N.elementType===Q||typeof Q=="object"&&Q!==null&&Q.$$typeof===Zl&&OP(Q)===N.type)?($=i(N,F.props),$.ref=$f(z,N,F),$.return=z,$):($=Xy(F.type,F.key,F.props,null,z.mode,$),$.ref=$f(z,N,F),$.return=z,$)}function _(z,N,F,$){return N===null||N.tag!==4||N.stateNode.containerInfo!==F.containerInfo||N.stateNode.implementation!==F.implementation?(N=tx(F,z.mode,$),N.return=z,N):(N=i(N,F.children||[]),N.return=z,N)}function E(z,N,F,$,Q){return N===null||N.tag!==7?(N=cu(F,z.mode,$,Q),N.return=z,N):(N=i(N,F),N.return=z,N)}function S(z,N,F){if(typeof N=="string"&&N!==""||typeof N=="number")return N=ex(""+N,z.mode,F),N.return=z,N;if(typeof N=="object"&&N!==null){switch(N.$$typeof){case Gg:return F=Xy(N.type,N.key,N.props,null,z.mode,F),F.ref=$f(z,null,N),F.return=z,F;case Mh:return N=tx(N,z.mode,F),N.return=z,N;case Zl:var $=N._init;return S(z,$(N._payload),F)}if(cp(N)||Nf(N))return N=cu(N,z.mode,F,null),N.return=z,N;ty(z,N)}return null}function I(z,N,F,$){var Q=N!==null?N.key:null;if(typeof F=="string"&&F!==""||typeof F=="number")return Q!==null?null:l(z,N,""+F,$);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case Gg:return F.key===Q?m(z,N,F,$):null;case Mh:return F.key===Q?_(z,N,F,$):null;case Zl:return Q=F._init,I(z,N,Q(F._payload),$)}if(cp(F)||Nf(F))return Q!==null?null:E(z,N,F,$,null);ty(z,F)}return null}function L(z,N,F,$,Q){if(typeof $=="string"&&$!==""||typeof $=="number")return z=z.get(F)||null,l(N,z,""+$,Q);if(typeof $=="object"&&$!==null){switch($.$$typeof){case Gg:return z=z.get($.key===null?F:$.key)||null,m(N,z,$,Q);case Mh:return z=z.get($.key===null?F:$.key)||null,_(N,z,$,Q);case Zl:var te=$._init;return L(z,N,F,te($._payload),Q)}if(cp($)||Nf($))return z=z.get(F)||null,E(N,z,$,Q,null);ty(N,$)}return null}function O(z,N,F,$){for(var Q=null,te=null,re=N,we=N=0,Ee=null;re!==null&&we<F.length;we++){re.index>we?(Ee=re,re=null):Ee=re.sibling;var de=I(z,re,F[we],$);if(de===null){re===null&&(re=Ee);break}t&&re&&de.alternate===null&&e(z,re),N=a(de,N,we),te===null?Q=de:te.sibling=de,te=de,re=Ee}if(we===F.length)return n(z,re),Or&&Kc(z,we),Q;if(re===null){for(;we<F.length;we++)re=S(z,F[we],$),re!==null&&(N=a(re,N,we),te===null?Q=re:te.sibling=re,te=re);return Or&&Kc(z,we),Q}for(re=r(z,re);we<F.length;we++)Ee=L(re,z,we,F[we],$),Ee!==null&&(t&&Ee.alternate!==null&&re.delete(Ee.key===null?we:Ee.key),N=a(Ee,N,we),te===null?Q=Ee:te.sibling=Ee,te=Ee);return t&&re.forEach(function(Le){return e(z,Le)}),Or&&Kc(z,we),Q}function D(z,N,F,$){var Q=Nf(F);if(typeof Q!="function")throw Error(dt(150));if(F=Q.call(F),F==null)throw Error(dt(151));for(var te=Q=null,re=N,we=N=0,Ee=null,de=F.next();re!==null&&!de.done;we++,de=F.next()){re.index>we?(Ee=re,re=null):Ee=re.sibling;var Le=I(z,re,de.value,$);if(Le===null){re===null&&(re=Ee);break}t&&re&&Le.alternate===null&&e(z,re),N=a(Le,N,we),te===null?Q=Le:te.sibling=Le,te=Le,re=Ee}if(de.done)return n(z,re),Or&&Kc(z,we),Q;if(re===null){for(;!de.done;we++,de=F.next())de=S(z,de.value,$),de!==null&&(N=a(de,N,we),te===null?Q=de:te.sibling=de,te=de);return Or&&Kc(z,we),Q}for(re=r(z,re);!de.done;we++,de=F.next())de=L(re,z,we,de.value,$),de!==null&&(t&&de.alternate!==null&&re.delete(de.key===null?we:de.key),N=a(de,N,we),te===null?Q=de:te.sibling=de,te=de);return t&&re.forEach(function(Ge){return e(z,Ge)}),Or&&Kc(z,we),Q}function H(z,N,F,$){if(typeof F=="object"&&F!==null&&F.type===kh&&F.key===null&&(F=F.props.children),typeof F=="object"&&F!==null){switch(F.$$typeof){case Gg:e:{for(var Q=F.key,te=N;te!==null;){if(te.key===Q){if(Q=F.type,Q===kh){if(te.tag===7){n(z,te.sibling),N=i(te,F.props.children),N.return=z,z=N;break e}}else if(te.elementType===Q||typeof Q=="object"&&Q!==null&&Q.$$typeof===Zl&&OP(Q)===te.type){n(z,te.sibling),N=i(te,F.props),N.ref=$f(z,te,F),N.return=z,z=N;break e}n(z,te);break}else e(z,te);te=te.sibling}F.type===kh?(N=cu(F.props.children,z.mode,$,F.key),N.return=z,z=N):($=Xy(F.type,F.key,F.props,null,z.mode,$),$.ref=$f(z,N,F),$.return=z,z=$)}return h(z);case Mh:e:{for(te=F.key;N!==null;){if(N.key===te)if(N.tag===4&&N.stateNode.containerInfo===F.containerInfo&&N.stateNode.implementation===F.implementation){n(z,N.sibling),N=i(N,F.children||[]),N.return=z,z=N;break e}else{n(z,N);break}else e(z,N);N=N.sibling}N=tx(F,z.mode,$),N.return=z,z=N}return h(z);case Zl:return te=F._init,H(z,N,te(F._payload),$)}if(cp(F))return O(z,N,F,$);if(Nf(F))return D(z,N,F,$);ty(z,F)}return typeof F=="string"&&F!==""||typeof F=="number"?(F=""+F,N!==null&&N.tag===6?(n(z,N.sibling),N=i(N,F),N.return=z,z=N):(n(z,N),N=ex(F,z.mode,$),N.return=z,z=N),h(z)):n(z,N)}return H}var ad=mL(!0),gL=mL(!1),Em={},Ia=bc(Em),Wp=bc(Em),qp=bc(Em);function iu(t){if(t===Em)throw Error(dt(174));return t}function _2(t,e){switch(vr(qp,e),vr(Wp,t),vr(Ia,Em),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:lb(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=lb(e,t)}Pr(Ia),vr(Ia,e)}function ld(){Pr(Ia),Pr(Wp),Pr(qp)}function yL(t){iu(qp.current);var e=iu(Ia.current),n=lb(e,t.type);e!==n&&(vr(Wp,t),vr(Ia,n))}function v2(t){Wp.current===t&&(Pr(Ia),Pr(Wp))}var Nr=bc(0);function C0(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Z1=[];function x2(){for(var t=0;t<Z1.length;t++)Z1[t]._workInProgressVersionPrimary=null;Z1.length=0}var Gy=gl.ReactCurrentDispatcher,X1=gl.ReactCurrentBatchConfig,mu=0,Ur=null,yi=null,Pi=null,A0=!1,wp=!1,Zp=0,PF=0;function es(){throw Error(dt(321))}function b2(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!sa(t[n],e[n]))return!1;return!0}function w2(t,e,n,r,i,a){if(mu=a,Ur=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Gy.current=t===null||t.memoizedState===null?MF:kF,t=n(r,i),wp){a=0;do{if(wp=!1,Zp=0,25<=a)throw Error(dt(301));a+=1,Pi=yi=null,e.updateQueue=null,Gy.current=LF,t=n(r,i)}while(wp)}if(Gy.current=I0,e=yi!==null&&yi.next!==null,mu=0,Pi=yi=Ur=null,A0=!1,e)throw Error(dt(300));return t}function E2(){var t=Zp!==0;return Zp=0,t}function xa(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Pi===null?Ur.memoizedState=Pi=t:Pi=Pi.next=t,Pi}function Lo(){if(yi===null){var t=Ur.alternate;t=t!==null?t.memoizedState:null}else t=yi.next;var e=Pi===null?Ur.memoizedState:Pi.next;if(e!==null)Pi=e,yi=t;else{if(t===null)throw Error(dt(310));yi=t,t={memoizedState:yi.memoizedState,baseState:yi.baseState,baseQueue:yi.baseQueue,queue:yi.queue,next:null},Pi===null?Ur.memoizedState=Pi=t:Pi=Pi.next=t}return Pi}function Xp(t,e){return typeof e=="function"?e(t):e}function Y1(t){var e=Lo(),n=e.queue;if(n===null)throw Error(dt(311));n.lastRenderedReducer=t;var r=yi,i=r.baseQueue,a=n.pending;if(a!==null){if(i!==null){var h=i.next;i.next=a.next,a.next=h}r.baseQueue=i=a,n.pending=null}if(i!==null){a=i.next,r=r.baseState;var l=h=null,m=null,_=a;do{var E=_.lane;if((mu&E)===E)m!==null&&(m=m.next={lane:0,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null}),r=_.hasEagerState?_.eagerState:t(r,_.action);else{var S={lane:E,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null};m===null?(l=m=S,h=r):m=m.next=S,Ur.lanes|=E,gu|=E}_=_.next}while(_!==null&&_!==a);m===null?h=r:m.next=l,sa(r,e.memoizedState)||(Ls=!0),e.memoizedState=r,e.baseState=h,e.baseQueue=m,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do a=i.lane,Ur.lanes|=a,gu|=a,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function K1(t){var e=Lo(),n=e.queue;if(n===null)throw Error(dt(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,a=e.memoizedState;if(i!==null){n.pending=null;var h=i=i.next;do a=t(a,h.action),h=h.next;while(h!==i);sa(a,e.memoizedState)||(Ls=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),n.lastRenderedState=a}return[a,r]}function _L(){}function vL(t,e){var n=Ur,r=Lo(),i=e(),a=!sa(r.memoizedState,i);if(a&&(r.memoizedState=i,Ls=!0),r=r.queue,T2(wL.bind(null,n,r,t),[t]),r.getSnapshot!==e||a||Pi!==null&&Pi.memoizedState.tag&1){if(n.flags|=2048,Yp(9,bL.bind(null,n,r,i,e),void 0,null),Ii===null)throw Error(dt(349));mu&30||xL(n,e,i)}return i}function xL(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ur.updateQueue,e===null?(e={lastEffect:null,stores:null},Ur.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function bL(t,e,n,r){e.value=n,e.getSnapshot=r,EL(e)&&TL(t)}function wL(t,e,n){return n(function(){EL(e)&&TL(t)})}function EL(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!sa(t,n)}catch{return!0}}function TL(t){var e=ll(t,1);e!==null&&ra(e,t,1,-1)}function DP(t){var e=xa();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Xp,lastRenderedState:t},e.queue=t,t=t.dispatch=IF.bind(null,Ur,t),[e.memoizedState,t]}function Yp(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ur.updateQueue,e===null?(e={lastEffect:null,stores:null},Ur.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function SL(){return Lo().memoizedState}function Hy(t,e,n,r){var i=xa();Ur.flags|=t,i.memoizedState=Yp(1|e,n,void 0,r===void 0?null:r)}function g_(t,e,n,r){var i=Lo();r=r===void 0?null:r;var a=void 0;if(yi!==null){var h=yi.memoizedState;if(a=h.destroy,r!==null&&b2(r,h.deps)){i.memoizedState=Yp(e,n,a,r);return}}Ur.flags|=t,i.memoizedState=Yp(1|e,n,a,r)}function zP(t,e){return Hy(8390656,8,t,e)}function T2(t,e){return g_(2048,8,t,e)}function PL(t,e){return g_(4,2,t,e)}function CL(t,e){return g_(4,4,t,e)}function AL(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function IL(t,e,n){return n=n!=null?n.concat([t]):null,g_(4,4,AL.bind(null,e,t),n)}function S2(){}function ML(t,e){var n=Lo();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&b2(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function kL(t,e){var n=Lo();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&b2(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function LL(t,e,n){return mu&21?(sa(n,e)||(n=Dk(),Ur.lanes|=n,gu|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ls=!0),t.memoizedState=n)}function CF(t,e){var n=nr;nr=n!==0&&4>n?n:4,t(!0);var r=X1.transition;X1.transition={};try{t(!1),e()}finally{nr=n,X1.transition=r}}function RL(){return Lo().memoizedState}function AF(t,e,n){var r=hc(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},OL(t))DL(e,n);else if(n=hL(t,e,n,r),n!==null){var i=ws();ra(n,t,r,i),zL(n,e,r)}}function IF(t,e,n){var r=hc(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(OL(t))DL(e,i);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var h=e.lastRenderedState,l=a(h,n);if(i.hasEagerState=!0,i.eagerState=l,sa(l,h)){var m=e.interleaved;m===null?(i.next=i,g2(e)):(i.next=m.next,m.next=i),e.interleaved=i;return}}catch{}finally{}n=hL(t,e,i,r),n!==null&&(i=ws(),ra(n,t,r,i),zL(n,e,r))}}function OL(t){var e=t.alternate;return t===Ur||e!==null&&e===Ur}function DL(t,e){wp=A0=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function zL(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,n2(t,n)}}var I0={readContext:ko,useCallback:es,useContext:es,useEffect:es,useImperativeHandle:es,useInsertionEffect:es,useLayoutEffect:es,useMemo:es,useReducer:es,useRef:es,useState:es,useDebugValue:es,useDeferredValue:es,useTransition:es,useMutableSource:es,useSyncExternalStore:es,useId:es,unstable_isNewReconciler:!1},MF={readContext:ko,useCallback:function(t,e){return xa().memoizedState=[t,e===void 0?null:e],t},useContext:ko,useEffect:zP,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Hy(4194308,4,AL.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Hy(4194308,4,t,e)},useInsertionEffect:function(t,e){return Hy(4,2,t,e)},useMemo:function(t,e){var n=xa();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=xa();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=AF.bind(null,Ur,t),[r.memoizedState,t]},useRef:function(t){var e=xa();return t={current:t},e.memoizedState=t},useState:DP,useDebugValue:S2,useDeferredValue:function(t){return xa().memoizedState=t},useTransition:function(){var t=DP(!1),e=t[0];return t=CF.bind(null,t[1]),xa().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ur,i=xa();if(Or){if(n===void 0)throw Error(dt(407));n=n()}else{if(n=e(),Ii===null)throw Error(dt(349));mu&30||xL(r,e,n)}i.memoizedState=n;var a={value:n,getSnapshot:e};return i.queue=a,zP(wL.bind(null,r,a,t),[t]),r.flags|=2048,Yp(9,bL.bind(null,r,a,n,e),void 0,null),n},useId:function(){var t=xa(),e=Ii.identifierPrefix;if(Or){var n=il,r=rl;n=(r&~(1<<32-na(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Zp++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=PF++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},kF={readContext:ko,useCallback:ML,useContext:ko,useEffect:T2,useImperativeHandle:IL,useInsertionEffect:PL,useLayoutEffect:CL,useMemo:kL,useReducer:Y1,useRef:SL,useState:function(){return Y1(Xp)},useDebugValue:S2,useDeferredValue:function(t){var e=Lo();return LL(e,yi.memoizedState,t)},useTransition:function(){var t=Y1(Xp)[0],e=Lo().memoizedState;return[t,e]},useMutableSource:_L,useSyncExternalStore:vL,useId:RL,unstable_isNewReconciler:!1},LF={readContext:ko,useCallback:ML,useContext:ko,useEffect:T2,useImperativeHandle:IL,useInsertionEffect:PL,useLayoutEffect:CL,useMemo:kL,useReducer:K1,useRef:SL,useState:function(){return K1(Xp)},useDebugValue:S2,useDeferredValue:function(t){var e=Lo();return yi===null?e.memoizedState=t:LL(e,yi.memoizedState,t)},useTransition:function(){var t=K1(Xp)[0],e=Lo().memoizedState;return[t,e]},useMutableSource:_L,useSyncExternalStore:vL,useId:RL,unstable_isNewReconciler:!1};function cd(t,e){try{var n="",r=e;do n+=o5(r),r=r.return;while(r);var i=n}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:i,digest:null}}function J1(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function kb(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var RF=typeof WeakMap=="function"?WeakMap:Map;function FL(t,e,n){n=sl(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){k0||(k0=!0,Vb=r),kb(t,e)},n}function NL(t,e,n){n=sl(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){kb(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){kb(t,e),typeof r!="function"&&(uc===null?uc=new Set([this]):uc.add(this));var h=e.stack;this.componentDidCatch(e.value,{componentStack:h!==null?h:""})}),n}function FP(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new RF;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=qF.bind(null,t,e,n),e.then(t,t))}function NP(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function BP(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=sl(-1,1),e.tag=2,cc(n,e,1))),n.lanes|=1),t)}var OF=gl.ReactCurrentOwner,Ls=!1;function vs(t,e,n,r){e.child=t===null?gL(e,null,n,r):ad(e,t.child,n,r)}function UP(t,e,n,r,i){n=n.render;var a=e.ref;return Yh(e,i),r=w2(t,e,n,r,a,i),n=E2(),t!==null&&!Ls?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,cl(t,e,i)):(Or&&n&&u2(e),e.flags|=1,vs(t,e,r,i),e.child)}function VP(t,e,n,r,i){if(t===null){var a=n.type;return typeof a=="function"&&!R2(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=a,BL(t,e,a,r,i)):(t=Xy(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&i)){var h=a.memoizedProps;if(n=n.compare,n=n!==null?n:jp,n(h,r)&&t.ref===e.ref)return cl(t,e,i)}return e.flags|=1,t=dc(a,r),t.ref=e.ref,t.return=e,e.child=t}function BL(t,e,n,r,i){if(t!==null){var a=t.memoizedProps;if(jp(a,r)&&t.ref===e.ref)if(Ls=!1,e.pendingProps=r=a,(t.lanes&i)!==0)t.flags&131072&&(Ls=!0);else return e.lanes=t.lanes,cl(t,e,i)}return Lb(t,e,n,r,i)}function UL(t,e,n){var r=e.pendingProps,i=r.children,a=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},vr(Vh,Ys),Ys|=n;else{if(!(n&1073741824))return t=a!==null?a.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,vr(Vh,Ys),Ys|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:n,vr(Vh,Ys),Ys|=r}else a!==null?(r=a.baseLanes|n,e.memoizedState=null):r=n,vr(Vh,Ys),Ys|=r;return vs(t,e,i,n),e.child}function VL(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Lb(t,e,n,r,i){var a=Os(n)?fu:as.current;return a=sd(e,a),Yh(e,i),n=w2(t,e,n,r,a,i),r=E2(),t!==null&&!Ls?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,cl(t,e,i)):(Or&&r&&u2(e),e.flags|=1,vs(t,e,n,i),e.child)}function jP(t,e,n,r,i){if(Os(n)){var a=!0;b0(e)}else a=!1;if(Yh(e,i),e.stateNode===null)Wy(t,e),pL(e,n,r),Mb(e,n,r,i),r=!0;else if(t===null){var h=e.stateNode,l=e.memoizedProps;h.props=l;var m=h.context,_=n.contextType;typeof _=="object"&&_!==null?_=ko(_):(_=Os(n)?fu:as.current,_=sd(e,_));var E=n.getDerivedStateFromProps,S=typeof E=="function"||typeof h.getSnapshotBeforeUpdate=="function";S||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(l!==r||m!==_)&&RP(e,h,r,_),Xl=!1;var I=e.memoizedState;h.state=I,P0(e,r,h,i),m=e.memoizedState,l!==r||I!==m||Rs.current||Xl?(typeof E=="function"&&(Ib(e,n,E,r),m=e.memoizedState),(l=Xl||LP(e,n,l,r,I,m,_))?(S||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount()),typeof h.componentDidMount=="function"&&(e.flags|=4194308)):(typeof h.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=m),h.props=r,h.state=m,h.context=_,r=l):(typeof h.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{h=e.stateNode,dL(t,e),l=e.memoizedProps,_=e.type===e.elementType?l:Yo(e.type,l),h.props=_,S=e.pendingProps,I=h.context,m=n.contextType,typeof m=="object"&&m!==null?m=ko(m):(m=Os(n)?fu:as.current,m=sd(e,m));var L=n.getDerivedStateFromProps;(E=typeof L=="function"||typeof h.getSnapshotBeforeUpdate=="function")||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(l!==S||I!==m)&&RP(e,h,r,m),Xl=!1,I=e.memoizedState,h.state=I,P0(e,r,h,i);var O=e.memoizedState;l!==S||I!==O||Rs.current||Xl?(typeof L=="function"&&(Ib(e,n,L,r),O=e.memoizedState),(_=Xl||LP(e,n,_,r,I,O,m)||!1)?(E||typeof h.UNSAFE_componentWillUpdate!="function"&&typeof h.componentWillUpdate!="function"||(typeof h.componentWillUpdate=="function"&&h.componentWillUpdate(r,O,m),typeof h.UNSAFE_componentWillUpdate=="function"&&h.UNSAFE_componentWillUpdate(r,O,m)),typeof h.componentDidUpdate=="function"&&(e.flags|=4),typeof h.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof h.componentDidUpdate!="function"||l===t.memoizedProps&&I===t.memoizedState||(e.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&I===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=O),h.props=r,h.state=O,h.context=m,r=_):(typeof h.componentDidUpdate!="function"||l===t.memoizedProps&&I===t.memoizedState||(e.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&I===t.memoizedState||(e.flags|=1024),r=!1)}return Rb(t,e,n,r,a,i)}function Rb(t,e,n,r,i,a){VL(t,e);var h=(e.flags&128)!==0;if(!r&&!h)return i&&CP(e,n,!1),cl(t,e,a);r=e.stateNode,OF.current=e;var l=h&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&h?(e.child=ad(e,t.child,null,a),e.child=ad(e,null,l,a)):vs(t,e,l,a),e.memoizedState=r.state,i&&CP(e,n,!0),e.child}function jL(t){var e=t.stateNode;e.pendingContext?PP(t,e.pendingContext,e.pendingContext!==e.context):e.context&&PP(t,e.context,!1),_2(t,e.containerInfo)}function $P(t,e,n,r,i){return od(),d2(i),e.flags|=256,vs(t,e,n,r),e.child}var Ob={dehydrated:null,treeContext:null,retryLane:0};function Db(t){return{baseLanes:t,cachePool:null,transitions:null}}function $L(t,e,n){var r=e.pendingProps,i=Nr.current,a=!1,h=(e.flags&128)!==0,l;if((l=h)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),vr(Nr,i&1),t===null)return Cb(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(h=r.children,t=r.fallback,a?(r=e.mode,a=e.child,h={mode:"hidden",children:h},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=h):a=v_(h,r,0,null),t=cu(t,r,n,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=Db(n),e.memoizedState=Ob,t):P2(e,h));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return DF(t,e,h,r,l,i,n);if(a){a=r.fallback,h=e.mode,i=t.child,l=i.sibling;var m={mode:"hidden",children:r.children};return!(h&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=m,e.deletions=null):(r=dc(i,m),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?a=dc(l,a):(a=cu(a,h,n,null),a.flags|=2),a.return=e,r.return=e,r.sibling=a,e.child=r,r=a,a=e.child,h=t.child.memoizedState,h=h===null?Db(n):{baseLanes:h.baseLanes|n,cachePool:null,transitions:h.transitions},a.memoizedState=h,a.childLanes=t.childLanes&~n,e.memoizedState=Ob,r}return a=t.child,t=a.sibling,r=dc(a,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function P2(t,e){return e=v_({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ny(t,e,n,r){return r!==null&&d2(r),ad(e,t.child,null,n),t=P2(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function DF(t,e,n,r,i,a,h){if(n)return e.flags&256?(e.flags&=-257,r=J1(Error(dt(422))),ny(t,e,h,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=r.fallback,i=e.mode,r=v_({mode:"visible",children:r.children},i,0,null),a=cu(a,i,h,null),a.flags|=2,r.return=e,a.return=e,r.sibling=a,e.child=r,e.mode&1&&ad(e,t.child,null,h),e.child.memoizedState=Db(h),e.memoizedState=Ob,a);if(!(e.mode&1))return ny(t,e,h,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,a=Error(dt(419)),r=J1(a,r,void 0),ny(t,e,h,r)}if(l=(h&t.childLanes)!==0,Ls||l){if(r=Ii,r!==null){switch(h&-h){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|h)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,ll(t,i),ra(r,t,i,-1))}return L2(),r=J1(Error(dt(421))),ny(t,e,h,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=ZF.bind(null,t),i._reactRetry=e,null):(t=a.treeContext,eo=lc(i.nextSibling),ro=e,Or=!0,Jo=null,t!==null&&(So[Po++]=rl,So[Po++]=il,So[Po++]=pu,rl=t.id,il=t.overflow,pu=e),e=P2(e,r.children),e.flags|=4096,e)}function GP(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Ab(t.return,e,n)}function Q1(t,e,n,r,i){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function GL(t,e,n){var r=e.pendingProps,i=r.revealOrder,a=r.tail;if(vs(t,e,r.children,n),r=Nr.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&GP(t,n,e);else if(t.tag===19)GP(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(vr(Nr,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&C0(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Q1(e,!1,i,n,a);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&C0(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Q1(e,!0,n,null,a);break;case"together":Q1(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Wy(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function cl(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),gu|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(dt(153));if(e.child!==null){for(t=e.child,n=dc(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=dc(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function zF(t,e,n){switch(e.tag){case 3:jL(e),od();break;case 5:yL(e);break;case 1:Os(e.type)&&b0(e);break;case 4:_2(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;vr(T0,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(vr(Nr,Nr.current&1),e.flags|=128,null):n&e.child.childLanes?$L(t,e,n):(vr(Nr,Nr.current&1),t=cl(t,e,n),t!==null?t.sibling:null);vr(Nr,Nr.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return GL(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),vr(Nr,Nr.current),r)break;return null;case 22:case 23:return e.lanes=0,UL(t,e,n)}return cl(t,e,n)}var HL,zb,WL,qL;HL=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};zb=function(){};WL=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,iu(Ia.current);var a=null;switch(n){case"input":i=ib(t,i),r=ib(t,r),a=[];break;case"select":i=Vr({},i,{value:void 0}),r=Vr({},r,{value:void 0}),a=[];break;case"textarea":i=ab(t,i),r=ab(t,r),a=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=v0)}cb(n,r);var h;n=null;for(_ in i)if(!r.hasOwnProperty(_)&&i.hasOwnProperty(_)&&i[_]!=null)if(_==="style"){var l=i[_];for(h in l)l.hasOwnProperty(h)&&(n||(n={}),n[h]="")}else _!=="dangerouslySetInnerHTML"&&_!=="children"&&_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(Dp.hasOwnProperty(_)?a||(a=[]):(a=a||[]).push(_,null));for(_ in r){var m=r[_];if(l=i!=null?i[_]:void 0,r.hasOwnProperty(_)&&m!==l&&(m!=null||l!=null))if(_==="style")if(l){for(h in l)!l.hasOwnProperty(h)||m&&m.hasOwnProperty(h)||(n||(n={}),n[h]="");for(h in m)m.hasOwnProperty(h)&&l[h]!==m[h]&&(n||(n={}),n[h]=m[h])}else n||(a||(a=[]),a.push(_,n)),n=m;else _==="dangerouslySetInnerHTML"?(m=m?m.__html:void 0,l=l?l.__html:void 0,m!=null&&l!==m&&(a=a||[]).push(_,m)):_==="children"?typeof m!="string"&&typeof m!="number"||(a=a||[]).push(_,""+m):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&(Dp.hasOwnProperty(_)?(m!=null&&_==="onScroll"&&Tr("scroll",t),a||l===m||(a=[])):(a=a||[]).push(_,m))}n&&(a=a||[]).push("style",n);var _=a;(e.updateQueue=_)&&(e.flags|=4)}};qL=function(t,e,n,r){n!==r&&(e.flags|=4)};function Gf(t,e){if(!Or)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function ts(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function FF(t,e,n){var r=e.pendingProps;switch(h2(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ts(e),null;case 1:return Os(e.type)&&x0(),ts(e),null;case 3:return r=e.stateNode,ld(),Pr(Rs),Pr(as),x2(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(ey(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Jo!==null&&(Gb(Jo),Jo=null))),zb(t,e),ts(e),null;case 5:v2(e);var i=iu(qp.current);if(n=e.type,t!==null&&e.stateNode!=null)WL(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(dt(166));return ts(e),null}if(t=iu(Ia.current),ey(e)){r=e.stateNode,n=e.type;var a=e.memoizedProps;switch(r[Ea]=e,r[Hp]=a,t=(e.mode&1)!==0,n){case"dialog":Tr("cancel",r),Tr("close",r);break;case"iframe":case"object":case"embed":Tr("load",r);break;case"video":case"audio":for(i=0;i<hp.length;i++)Tr(hp[i],r);break;case"source":Tr("error",r);break;case"img":case"image":case"link":Tr("error",r),Tr("load",r);break;case"details":Tr("toggle",r);break;case"input":QS(r,a),Tr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Tr("invalid",r);break;case"textarea":tP(r,a),Tr("invalid",r)}cb(n,a),i=null;for(var h in a)if(a.hasOwnProperty(h)){var l=a[h];h==="children"?typeof l=="string"?r.textContent!==l&&(a.suppressHydrationWarning!==!0&&Qg(r.textContent,l,t),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&Qg(r.textContent,l,t),i=["children",""+l]):Dp.hasOwnProperty(h)&&l!=null&&h==="onScroll"&&Tr("scroll",r)}switch(n){case"input":Hg(r),eP(r,a,!0);break;case"textarea":Hg(r),nP(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=v0)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{h=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=xk(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=h.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=h.createElement(n,{is:r.is}):(t=h.createElement(n),n==="select"&&(h=t,r.multiple?h.multiple=!0:r.size&&(h.size=r.size))):t=h.createElementNS(t,n),t[Ea]=e,t[Hp]=r,HL(t,e,!1,!1),e.stateNode=t;e:{switch(h=ub(n,r),n){case"dialog":Tr("cancel",t),Tr("close",t),i=r;break;case"iframe":case"object":case"embed":Tr("load",t),i=r;break;case"video":case"audio":for(i=0;i<hp.length;i++)Tr(hp[i],t);i=r;break;case"source":Tr("error",t),i=r;break;case"img":case"image":case"link":Tr("error",t),Tr("load",t),i=r;break;case"details":Tr("toggle",t),i=r;break;case"input":QS(t,r),i=ib(t,r),Tr("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Vr({},r,{value:void 0}),Tr("invalid",t);break;case"textarea":tP(t,r),i=ab(t,r),Tr("invalid",t);break;default:i=r}cb(n,i),l=i;for(a in l)if(l.hasOwnProperty(a)){var m=l[a];a==="style"?Ek(t,m):a==="dangerouslySetInnerHTML"?(m=m?m.__html:void 0,m!=null&&bk(t,m)):a==="children"?typeof m=="string"?(n!=="textarea"||m!=="")&&zp(t,m):typeof m=="number"&&zp(t,""+m):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Dp.hasOwnProperty(a)?m!=null&&a==="onScroll"&&Tr("scroll",t):m!=null&&Yw(t,a,m,h))}switch(n){case"input":Hg(t),eP(t,r,!1);break;case"textarea":Hg(t),nP(t);break;case"option":r.value!=null&&t.setAttribute("value",""+gc(r.value));break;case"select":t.multiple=!!r.multiple,a=r.value,a!=null?Wh(t,!!r.multiple,a,!1):r.defaultValue!=null&&Wh(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=v0)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ts(e),null;case 6:if(t&&e.stateNode!=null)qL(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(dt(166));if(n=iu(qp.current),iu(Ia.current),ey(e)){if(r=e.stateNode,n=e.memoizedProps,r[Ea]=e,(a=r.nodeValue!==n)&&(t=ro,t!==null))switch(t.tag){case 3:Qg(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Qg(r.nodeValue,n,(t.mode&1)!==0)}a&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ea]=e,e.stateNode=r}return ts(e),null;case 13:if(Pr(Nr),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Or&&eo!==null&&e.mode&1&&!(e.flags&128))uL(),od(),e.flags|=98560,a=!1;else if(a=ey(e),r!==null&&r.dehydrated!==null){if(t===null){if(!a)throw Error(dt(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(dt(317));a[Ea]=e}else od(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ts(e),a=!1}else Jo!==null&&(Gb(Jo),Jo=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Nr.current&1?_i===0&&(_i=3):L2())),e.updateQueue!==null&&(e.flags|=4),ts(e),null);case 4:return ld(),zb(t,e),t===null&&$p(e.stateNode.containerInfo),ts(e),null;case 10:return m2(e.type._context),ts(e),null;case 17:return Os(e.type)&&x0(),ts(e),null;case 19:if(Pr(Nr),a=e.memoizedState,a===null)return ts(e),null;if(r=(e.flags&128)!==0,h=a.rendering,h===null)if(r)Gf(a,!1);else{if(_i!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(h=C0(t),h!==null){for(e.flags|=128,Gf(a,!1),r=h.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)a=n,t=r,a.flags&=14680066,h=a.alternate,h===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=h.childLanes,a.lanes=h.lanes,a.child=h.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=h.memoizedProps,a.memoizedState=h.memoizedState,a.updateQueue=h.updateQueue,a.type=h.type,t=h.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return vr(Nr,Nr.current&1|2),e.child}t=t.sibling}a.tail!==null&&ai()>ud&&(e.flags|=128,r=!0,Gf(a,!1),e.lanes=4194304)}else{if(!r)if(t=C0(h),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Gf(a,!0),a.tail===null&&a.tailMode==="hidden"&&!h.alternate&&!Or)return ts(e),null}else 2*ai()-a.renderingStartTime>ud&&n!==1073741824&&(e.flags|=128,r=!0,Gf(a,!1),e.lanes=4194304);a.isBackwards?(h.sibling=e.child,e.child=h):(n=a.last,n!==null?n.sibling=h:e.child=h,a.last=h)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=ai(),e.sibling=null,n=Nr.current,vr(Nr,r?n&1|2:n&1),e):(ts(e),null);case 22:case 23:return k2(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Ys&1073741824&&(ts(e),e.subtreeFlags&6&&(e.flags|=8192)):ts(e),null;case 24:return null;case 25:return null}throw Error(dt(156,e.tag))}function NF(t,e){switch(h2(e),e.tag){case 1:return Os(e.type)&&x0(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ld(),Pr(Rs),Pr(as),x2(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return v2(e),null;case 13:if(Pr(Nr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(dt(340));od()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Pr(Nr),null;case 4:return ld(),null;case 10:return m2(e.type._context),null;case 22:case 23:return k2(),null;case 24:return null;default:return null}}var ry=!1,os=!1,BF=typeof WeakSet=="function"?WeakSet:Set,Jt=null;function Uh(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Zr(t,e,r)}else n.current=null}function Fb(t,e,n){try{n()}catch(r){Zr(t,e,r)}}var HP=!1;function UF(t,e){if(xb=g0,t=Kk(),c2(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var h=0,l=-1,m=-1,_=0,E=0,S=t,I=null;t:for(;;){for(var L;S!==n||i!==0&&S.nodeType!==3||(l=h+i),S!==a||r!==0&&S.nodeType!==3||(m=h+r),S.nodeType===3&&(h+=S.nodeValue.length),(L=S.firstChild)!==null;)I=S,S=L;for(;;){if(S===t)break t;if(I===n&&++_===i&&(l=h),I===a&&++E===r&&(m=h),(L=S.nextSibling)!==null)break;S=I,I=S.parentNode}S=L}n=l===-1||m===-1?null:{start:l,end:m}}else n=null}n=n||{start:0,end:0}}else n=null;for(bb={focusedElem:t,selectionRange:n},g0=!1,Jt=e;Jt!==null;)if(e=Jt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Jt=t;else for(;Jt!==null;){e=Jt;try{var O=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(O!==null){var D=O.memoizedProps,H=O.memoizedState,z=e.stateNode,N=z.getSnapshotBeforeUpdate(e.elementType===e.type?D:Yo(e.type,D),H);z.__reactInternalSnapshotBeforeUpdate=N}break;case 3:var F=e.stateNode.containerInfo;F.nodeType===1?F.textContent="":F.nodeType===9&&F.documentElement&&F.removeChild(F.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(dt(163))}}catch($){Zr(e,e.return,$)}if(t=e.sibling,t!==null){t.return=e.return,Jt=t;break}Jt=e.return}return O=HP,HP=!1,O}function Ep(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var a=i.destroy;i.destroy=void 0,a!==void 0&&Fb(e,n,a)}i=i.next}while(i!==r)}}function y_(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Nb(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function ZL(t){var e=t.alternate;e!==null&&(t.alternate=null,ZL(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ea],delete e[Hp],delete e[Tb],delete e[wF],delete e[EF])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function XL(t){return t.tag===5||t.tag===3||t.tag===4}function WP(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||XL(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Bb(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=v0));else if(r!==4&&(t=t.child,t!==null))for(Bb(t,e,n),t=t.sibling;t!==null;)Bb(t,e,n),t=t.sibling}function Ub(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Ub(t,e,n),t=t.sibling;t!==null;)Ub(t,e,n),t=t.sibling}var Bi=null,Ko=!1;function Ul(t,e,n){for(n=n.child;n!==null;)YL(t,e,n),n=n.sibling}function YL(t,e,n){if(Aa&&typeof Aa.onCommitFiberUnmount=="function")try{Aa.onCommitFiberUnmount(c_,n)}catch{}switch(n.tag){case 5:os||Uh(n,e);case 6:var r=Bi,i=Ko;Bi=null,Ul(t,e,n),Bi=r,Ko=i,Bi!==null&&(Ko?(t=Bi,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Bi.removeChild(n.stateNode));break;case 18:Bi!==null&&(Ko?(t=Bi,n=n.stateNode,t.nodeType===8?W1(t.parentNode,n):t.nodeType===1&&W1(t,n),Up(t)):W1(Bi,n.stateNode));break;case 4:r=Bi,i=Ko,Bi=n.stateNode.containerInfo,Ko=!0,Ul(t,e,n),Bi=r,Ko=i;break;case 0:case 11:case 14:case 15:if(!os&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var a=i,h=a.destroy;a=a.tag,h!==void 0&&(a&2||a&4)&&Fb(n,e,h),i=i.next}while(i!==r)}Ul(t,e,n);break;case 1:if(!os&&(Uh(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Zr(n,e,l)}Ul(t,e,n);break;case 21:Ul(t,e,n);break;case 22:n.mode&1?(os=(r=os)||n.memoizedState!==null,Ul(t,e,n),os=r):Ul(t,e,n);break;default:Ul(t,e,n)}}function qP(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new BF),e.forEach(function(r){var i=XF.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Zo(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var a=t,h=e,l=h;e:for(;l!==null;){switch(l.tag){case 5:Bi=l.stateNode,Ko=!1;break e;case 3:Bi=l.stateNode.containerInfo,Ko=!0;break e;case 4:Bi=l.stateNode.containerInfo,Ko=!0;break e}l=l.return}if(Bi===null)throw Error(dt(160));YL(a,h,i),Bi=null,Ko=!1;var m=i.alternate;m!==null&&(m.return=null),i.return=null}catch(_){Zr(i,e,_)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)KL(e,t),e=e.sibling}function KL(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Zo(e,t),ga(t),r&4){try{Ep(3,t,t.return),y_(3,t)}catch(D){Zr(t,t.return,D)}try{Ep(5,t,t.return)}catch(D){Zr(t,t.return,D)}}break;case 1:Zo(e,t),ga(t),r&512&&n!==null&&Uh(n,n.return);break;case 5:if(Zo(e,t),ga(t),r&512&&n!==null&&Uh(n,n.return),t.flags&32){var i=t.stateNode;try{zp(i,"")}catch(D){Zr(t,t.return,D)}}if(r&4&&(i=t.stateNode,i!=null)){var a=t.memoizedProps,h=n!==null?n.memoizedProps:a,l=t.type,m=t.updateQueue;if(t.updateQueue=null,m!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&_k(i,a),ub(l,h);var _=ub(l,a);for(h=0;h<m.length;h+=2){var E=m[h],S=m[h+1];E==="style"?Ek(i,S):E==="dangerouslySetInnerHTML"?bk(i,S):E==="children"?zp(i,S):Yw(i,E,S,_)}switch(l){case"input":sb(i,a);break;case"textarea":vk(i,a);break;case"select":var I=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var L=a.value;L!=null?Wh(i,!!a.multiple,L,!1):I!==!!a.multiple&&(a.defaultValue!=null?Wh(i,!!a.multiple,a.defaultValue,!0):Wh(i,!!a.multiple,a.multiple?[]:"",!1))}i[Hp]=a}catch(D){Zr(t,t.return,D)}}break;case 6:if(Zo(e,t),ga(t),r&4){if(t.stateNode===null)throw Error(dt(162));i=t.stateNode,a=t.memoizedProps;try{i.nodeValue=a}catch(D){Zr(t,t.return,D)}}break;case 3:if(Zo(e,t),ga(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Up(e.containerInfo)}catch(D){Zr(t,t.return,D)}break;case 4:Zo(e,t),ga(t);break;case 13:Zo(e,t),ga(t),i=t.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(I2=ai())),r&4&&qP(t);break;case 22:if(E=n!==null&&n.memoizedState!==null,t.mode&1?(os=(_=os)||E,Zo(e,t),os=_):Zo(e,t),ga(t),r&8192){if(_=t.memoizedState!==null,(t.stateNode.isHidden=_)&&!E&&t.mode&1)for(Jt=t,E=t.child;E!==null;){for(S=Jt=E;Jt!==null;){switch(I=Jt,L=I.child,I.tag){case 0:case 11:case 14:case 15:Ep(4,I,I.return);break;case 1:Uh(I,I.return);var O=I.stateNode;if(typeof O.componentWillUnmount=="function"){r=I,n=I.return;try{e=r,O.props=e.memoizedProps,O.state=e.memoizedState,O.componentWillUnmount()}catch(D){Zr(r,n,D)}}break;case 5:Uh(I,I.return);break;case 22:if(I.memoizedState!==null){XP(S);continue}}L!==null?(L.return=I,Jt=L):XP(S)}E=E.sibling}e:for(E=null,S=t;;){if(S.tag===5){if(E===null){E=S;try{i=S.stateNode,_?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=S.stateNode,m=S.memoizedProps.style,h=m!=null&&m.hasOwnProperty("display")?m.display:null,l.style.display=wk("display",h))}catch(D){Zr(t,t.return,D)}}}else if(S.tag===6){if(E===null)try{S.stateNode.nodeValue=_?"":S.memoizedProps}catch(D){Zr(t,t.return,D)}}else if((S.tag!==22&&S.tag!==23||S.memoizedState===null||S===t)&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===t)break e;for(;S.sibling===null;){if(S.return===null||S.return===t)break e;E===S&&(E=null),S=S.return}E===S&&(E=null),S.sibling.return=S.return,S=S.sibling}}break;case 19:Zo(e,t),ga(t),r&4&&qP(t);break;case 21:break;default:Zo(e,t),ga(t)}}function ga(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(XL(n)){var r=n;break e}n=n.return}throw Error(dt(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(zp(i,""),r.flags&=-33);var a=WP(t);Ub(t,a,i);break;case 3:case 4:var h=r.stateNode.containerInfo,l=WP(t);Bb(t,l,h);break;default:throw Error(dt(161))}}catch(m){Zr(t,t.return,m)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function VF(t,e,n){Jt=t,JL(t)}function JL(t,e,n){for(var r=(t.mode&1)!==0;Jt!==null;){var i=Jt,a=i.child;if(i.tag===22&&r){var h=i.memoizedState!==null||ry;if(!h){var l=i.alternate,m=l!==null&&l.memoizedState!==null||os;l=ry;var _=os;if(ry=h,(os=m)&&!_)for(Jt=i;Jt!==null;)h=Jt,m=h.child,h.tag===22&&h.memoizedState!==null?YP(i):m!==null?(m.return=h,Jt=m):YP(i);for(;a!==null;)Jt=a,JL(a),a=a.sibling;Jt=i,ry=l,os=_}ZP(t)}else i.subtreeFlags&8772&&a!==null?(a.return=i,Jt=a):ZP(t)}}function ZP(t){for(;Jt!==null;){var e=Jt;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:os||y_(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!os)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Yo(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&kP(e,a,r);break;case 3:var h=e.updateQueue;if(h!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}kP(e,h,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var m=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":m.autoFocus&&n.focus();break;case"img":m.src&&(n.src=m.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var _=e.alternate;if(_!==null){var E=_.memoizedState;if(E!==null){var S=E.dehydrated;S!==null&&Up(S)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(dt(163))}os||e.flags&512&&Nb(e)}catch(I){Zr(e,e.return,I)}}if(e===t){Jt=null;break}if(n=e.sibling,n!==null){n.return=e.return,Jt=n;break}Jt=e.return}}function XP(t){for(;Jt!==null;){var e=Jt;if(e===t){Jt=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Jt=n;break}Jt=e.return}}function YP(t){for(;Jt!==null;){var e=Jt;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{y_(4,e)}catch(m){Zr(e,n,m)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(m){Zr(e,i,m)}}var a=e.return;try{Nb(e)}catch(m){Zr(e,a,m)}break;case 5:var h=e.return;try{Nb(e)}catch(m){Zr(e,h,m)}}}catch(m){Zr(e,e.return,m)}if(e===t){Jt=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Jt=l;break}Jt=e.return}}var jF=Math.ceil,M0=gl.ReactCurrentDispatcher,C2=gl.ReactCurrentOwner,Ao=gl.ReactCurrentBatchConfig,jn=0,Ii=null,ui=null,Vi=0,Ys=0,Vh=bc(0),_i=0,Kp=null,gu=0,__=0,A2=0,Tp=null,ks=null,I2=0,ud=1/0,Ja=null,k0=!1,Vb=null,uc=null,iy=!1,Ql=null,L0=0,Sp=0,jb=null,qy=-1,Zy=0;function ws(){return jn&6?ai():qy!==-1?qy:qy=ai()}function hc(t){return t.mode&1?jn&2&&Vi!==0?Vi&-Vi:SF.transition!==null?(Zy===0&&(Zy=Dk()),Zy):(t=nr,t!==0||(t=window.event,t=t===void 0?16:jk(t.type)),t):1}function ra(t,e,n,r){if(50<Sp)throw Sp=0,jb=null,Error(dt(185));xm(t,n,r),(!(jn&2)||t!==Ii)&&(t===Ii&&(!(jn&2)&&(__|=n),_i===4&&Kl(t,Vi)),Ds(t,r),n===1&&jn===0&&!(e.mode&1)&&(ud=ai()+500,p_&&wc()))}function Ds(t,e){var n=t.callbackNode;S5(t,e);var r=m0(t,t===Ii?Vi:0);if(r===0)n!==null&&sP(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&sP(n),e===1)t.tag===0?TF(KP.bind(null,t)):aL(KP.bind(null,t)),xF(function(){!(jn&6)&&wc()}),n=null;else{switch(zk(r)){case 1:n=t2;break;case 4:n=Rk;break;case 16:n=p0;break;case 536870912:n=Ok;break;default:n=p0}n=oR(n,QL.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function QL(t,e){if(qy=-1,Zy=0,jn&6)throw Error(dt(327));var n=t.callbackNode;if(Kh()&&t.callbackNode!==n)return null;var r=m0(t,t===Ii?Vi:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=R0(t,r);else{e=r;var i=jn;jn|=2;var a=tR();(Ii!==t||Vi!==e)&&(Ja=null,ud=ai()+500,lu(t,e));do try{HF();break}catch(l){eR(t,l)}while(1);p2(),M0.current=a,jn=i,ui!==null?e=0:(Ii=null,Vi=0,e=_i)}if(e!==0){if(e===2&&(i=mb(t),i!==0&&(r=i,e=$b(t,i))),e===1)throw n=Kp,lu(t,0),Kl(t,r),Ds(t,ai()),n;if(e===6)Kl(t,r);else{if(i=t.current.alternate,!(r&30)&&!$F(i)&&(e=R0(t,r),e===2&&(a=mb(t),a!==0&&(r=a,e=$b(t,a))),e===1))throw n=Kp,lu(t,0),Kl(t,r),Ds(t,ai()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(dt(345));case 2:Jc(t,ks,Ja);break;case 3:if(Kl(t,r),(r&130023424)===r&&(e=I2+500-ai(),10<e)){if(m0(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){ws(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Eb(Jc.bind(null,t,ks,Ja),e);break}Jc(t,ks,Ja);break;case 4:if(Kl(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var h=31-na(r);a=1<<h,h=e[h],h>i&&(i=h),r&=~a}if(r=i,r=ai()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*jF(r/1960))-r,10<r){t.timeoutHandle=Eb(Jc.bind(null,t,ks,Ja),r);break}Jc(t,ks,Ja);break;case 5:Jc(t,ks,Ja);break;default:throw Error(dt(329))}}}return Ds(t,ai()),t.callbackNode===n?QL.bind(null,t):null}function $b(t,e){var n=Tp;return t.current.memoizedState.isDehydrated&&(lu(t,e).flags|=256),t=R0(t,e),t!==2&&(e=ks,ks=n,e!==null&&Gb(e)),t}function Gb(t){ks===null?ks=t:ks.push.apply(ks,t)}function $F(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!sa(a(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Kl(t,e){for(e&=~A2,e&=~__,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-na(e),r=1<<n;t[n]=-1,e&=~r}}function KP(t){if(jn&6)throw Error(dt(327));Kh();var e=m0(t,0);if(!(e&1))return Ds(t,ai()),null;var n=R0(t,e);if(t.tag!==0&&n===2){var r=mb(t);r!==0&&(e=r,n=$b(t,r))}if(n===1)throw n=Kp,lu(t,0),Kl(t,e),Ds(t,ai()),n;if(n===6)throw Error(dt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Jc(t,ks,Ja),Ds(t,ai()),null}function M2(t,e){var n=jn;jn|=1;try{return t(e)}finally{jn=n,jn===0&&(ud=ai()+500,p_&&wc())}}function yu(t){Ql!==null&&Ql.tag===0&&!(jn&6)&&Kh();var e=jn;jn|=1;var n=Ao.transition,r=nr;try{if(Ao.transition=null,nr=1,t)return t()}finally{nr=r,Ao.transition=n,jn=e,!(jn&6)&&wc()}}function k2(){Ys=Vh.current,Pr(Vh)}function lu(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,vF(n)),ui!==null)for(n=ui.return;n!==null;){var r=n;switch(h2(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&x0();break;case 3:ld(),Pr(Rs),Pr(as),x2();break;case 5:v2(r);break;case 4:ld();break;case 13:Pr(Nr);break;case 19:Pr(Nr);break;case 10:m2(r.type._context);break;case 22:case 23:k2()}n=n.return}if(Ii=t,ui=t=dc(t.current,null),Vi=Ys=e,_i=0,Kp=null,A2=__=gu=0,ks=Tp=null,ru!==null){for(e=0;e<ru.length;e++)if(n=ru[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,a=n.pending;if(a!==null){var h=a.next;a.next=i,r.next=h}n.pending=r}ru=null}return t}function eR(t,e){do{var n=ui;try{if(p2(),Gy.current=I0,A0){for(var r=Ur.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}A0=!1}if(mu=0,Pi=yi=Ur=null,wp=!1,Zp=0,C2.current=null,n===null||n.return===null){_i=1,Kp=e,ui=null;break}e:{var a=t,h=n.return,l=n,m=e;if(e=Vi,l.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){var _=m,E=l,S=E.tag;if(!(E.mode&1)&&(S===0||S===11||S===15)){var I=E.alternate;I?(E.updateQueue=I.updateQueue,E.memoizedState=I.memoizedState,E.lanes=I.lanes):(E.updateQueue=null,E.memoizedState=null)}var L=NP(h);if(L!==null){L.flags&=-257,BP(L,h,l,a,e),L.mode&1&&FP(a,_,e),e=L,m=_;var O=e.updateQueue;if(O===null){var D=new Set;D.add(m),e.updateQueue=D}else O.add(m);break e}else{if(!(e&1)){FP(a,_,e),L2();break e}m=Error(dt(426))}}else if(Or&&l.mode&1){var H=NP(h);if(H!==null){!(H.flags&65536)&&(H.flags|=256),BP(H,h,l,a,e),d2(cd(m,l));break e}}a=m=cd(m,l),_i!==4&&(_i=2),Tp===null?Tp=[a]:Tp.push(a),a=h;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var z=FL(a,m,e);MP(a,z);break e;case 1:l=m;var N=a.type,F=a.stateNode;if(!(a.flags&128)&&(typeof N.getDerivedStateFromError=="function"||F!==null&&typeof F.componentDidCatch=="function"&&(uc===null||!uc.has(F)))){a.flags|=65536,e&=-e,a.lanes|=e;var $=NL(a,l,e);MP(a,$);break e}}a=a.return}while(a!==null)}rR(n)}catch(Q){e=Q,ui===n&&n!==null&&(ui=n=n.return);continue}break}while(1)}function tR(){var t=M0.current;return M0.current=I0,t===null?I0:t}function L2(){(_i===0||_i===3||_i===2)&&(_i=4),Ii===null||!(gu&268435455)&&!(__&268435455)||Kl(Ii,Vi)}function R0(t,e){var n=jn;jn|=2;var r=tR();(Ii!==t||Vi!==e)&&(Ja=null,lu(t,e));do try{GF();break}catch(i){eR(t,i)}while(1);if(p2(),jn=n,M0.current=r,ui!==null)throw Error(dt(261));return Ii=null,Vi=0,_i}function GF(){for(;ui!==null;)nR(ui)}function HF(){for(;ui!==null&&!g5();)nR(ui)}function nR(t){var e=sR(t.alternate,t,Ys);t.memoizedProps=t.pendingProps,e===null?rR(t):ui=e,C2.current=null}function rR(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=NF(n,e),n!==null){n.flags&=32767,ui=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{_i=6,ui=null;return}}else if(n=FF(n,e,Ys),n!==null){ui=n;return}if(e=e.sibling,e!==null){ui=e;return}ui=e=t}while(e!==null);_i===0&&(_i=5)}function Jc(t,e,n){var r=nr,i=Ao.transition;try{Ao.transition=null,nr=1,WF(t,e,n,r)}finally{Ao.transition=i,nr=r}return null}function WF(t,e,n,r){do Kh();while(Ql!==null);if(jn&6)throw Error(dt(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(dt(177));t.callbackNode=null,t.callbackPriority=0;var a=n.lanes|n.childLanes;if(P5(t,a),t===Ii&&(ui=Ii=null,Vi=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||iy||(iy=!0,oR(p0,function(){return Kh(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=Ao.transition,Ao.transition=null;var h=nr;nr=1;var l=jn;jn|=4,C2.current=null,UF(t,n),KL(n,t),dF(bb),g0=!!xb,bb=xb=null,t.current=n,VF(n),y5(),jn=l,nr=h,Ao.transition=a}else t.current=n;if(iy&&(iy=!1,Ql=t,L0=i),a=t.pendingLanes,a===0&&(uc=null),x5(n.stateNode),Ds(t,ai()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(k0)throw k0=!1,t=Vb,Vb=null,t;return L0&1&&t.tag!==0&&Kh(),a=t.pendingLanes,a&1?t===jb?Sp++:(Sp=0,jb=t):Sp=0,wc(),null}function Kh(){if(Ql!==null){var t=zk(L0),e=Ao.transition,n=nr;try{if(Ao.transition=null,nr=16>t?16:t,Ql===null)var r=!1;else{if(t=Ql,Ql=null,L0=0,jn&6)throw Error(dt(331));var i=jn;for(jn|=4,Jt=t.current;Jt!==null;){var a=Jt,h=a.child;if(Jt.flags&16){var l=a.deletions;if(l!==null){for(var m=0;m<l.length;m++){var _=l[m];for(Jt=_;Jt!==null;){var E=Jt;switch(E.tag){case 0:case 11:case 15:Ep(8,E,a)}var S=E.child;if(S!==null)S.return=E,Jt=S;else for(;Jt!==null;){E=Jt;var I=E.sibling,L=E.return;if(ZL(E),E===_){Jt=null;break}if(I!==null){I.return=L,Jt=I;break}Jt=L}}}var O=a.alternate;if(O!==null){var D=O.child;if(D!==null){O.child=null;do{var H=D.sibling;D.sibling=null,D=H}while(D!==null)}}Jt=a}}if(a.subtreeFlags&2064&&h!==null)h.return=a,Jt=h;else e:for(;Jt!==null;){if(a=Jt,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Ep(9,a,a.return)}var z=a.sibling;if(z!==null){z.return=a.return,Jt=z;break e}Jt=a.return}}var N=t.current;for(Jt=N;Jt!==null;){h=Jt;var F=h.child;if(h.subtreeFlags&2064&&F!==null)F.return=h,Jt=F;else e:for(h=N;Jt!==null;){if(l=Jt,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:y_(9,l)}}catch(Q){Zr(l,l.return,Q)}if(l===h){Jt=null;break e}var $=l.sibling;if($!==null){$.return=l.return,Jt=$;break e}Jt=l.return}}if(jn=i,wc(),Aa&&typeof Aa.onPostCommitFiberRoot=="function")try{Aa.onPostCommitFiberRoot(c_,t)}catch{}r=!0}return r}finally{nr=n,Ao.transition=e}}return!1}function JP(t,e,n){e=cd(n,e),e=FL(t,e,1),t=cc(t,e,1),e=ws(),t!==null&&(xm(t,1,e),Ds(t,e))}function Zr(t,e,n){if(t.tag===3)JP(t,t,n);else for(;e!==null;){if(e.tag===3){JP(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(uc===null||!uc.has(r))){t=cd(n,t),t=NL(e,t,1),e=cc(e,t,1),t=ws(),e!==null&&(xm(e,1,t),Ds(e,t));break}}e=e.return}}function qF(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=ws(),t.pingedLanes|=t.suspendedLanes&n,Ii===t&&(Vi&n)===n&&(_i===4||_i===3&&(Vi&130023424)===Vi&&500>ai()-I2?lu(t,0):A2|=n),Ds(t,e)}function iR(t,e){e===0&&(t.mode&1?(e=Zg,Zg<<=1,!(Zg&130023424)&&(Zg=4194304)):e=1);var n=ws();t=ll(t,e),t!==null&&(xm(t,e,n),Ds(t,n))}function ZF(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),iR(t,n)}function XF(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(dt(314))}r!==null&&r.delete(e),iR(t,n)}var sR;sR=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Rs.current)Ls=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ls=!1,zF(t,e,n);Ls=!!(t.flags&131072)}else Ls=!1,Or&&e.flags&1048576&&lL(e,E0,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Wy(t,e),t=e.pendingProps;var i=sd(e,as.current);Yh(e,n),i=w2(null,e,r,t,i,n);var a=E2();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Os(r)?(a=!0,b0(e)):a=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,y2(e),i.updater=m_,e.stateNode=i,i._reactInternals=e,Mb(e,r,t,n),e=Rb(null,e,r,!0,a,n)):(e.tag=0,Or&&a&&u2(e),vs(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Wy(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=KF(r),t=Yo(r,t),i){case 0:e=Lb(null,e,r,t,n);break e;case 1:e=jP(null,e,r,t,n);break e;case 11:e=UP(null,e,r,t,n);break e;case 14:e=VP(null,e,r,Yo(r.type,t),n);break e}throw Error(dt(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Yo(r,i),Lb(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Yo(r,i),jP(t,e,r,i,n);case 3:e:{if(jL(e),t===null)throw Error(dt(387));r=e.pendingProps,a=e.memoizedState,i=a.element,dL(t,e),P0(e,r,null,n);var h=e.memoizedState;if(r=h.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:h.cache,pendingSuspenseBoundaries:h.pendingSuspenseBoundaries,transitions:h.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){i=cd(Error(dt(423)),e),e=$P(t,e,r,n,i);break e}else if(r!==i){i=cd(Error(dt(424)),e),e=$P(t,e,r,n,i);break e}else for(eo=lc(e.stateNode.containerInfo.firstChild),ro=e,Or=!0,Jo=null,n=gL(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(od(),r===i){e=cl(t,e,n);break e}vs(t,e,r,n)}e=e.child}return e;case 5:return yL(e),t===null&&Cb(e),r=e.type,i=e.pendingProps,a=t!==null?t.memoizedProps:null,h=i.children,wb(r,i)?h=null:a!==null&&wb(r,a)&&(e.flags|=32),VL(t,e),vs(t,e,h,n),e.child;case 6:return t===null&&Cb(e),null;case 13:return $L(t,e,n);case 4:return _2(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ad(e,null,r,n):vs(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Yo(r,i),UP(t,e,r,i,n);case 7:return vs(t,e,e.pendingProps,n),e.child;case 8:return vs(t,e,e.pendingProps.children,n),e.child;case 12:return vs(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,a=e.memoizedProps,h=i.value,vr(T0,r._currentValue),r._currentValue=h,a!==null)if(sa(a.value,h)){if(a.children===i.children&&!Rs.current){e=cl(t,e,n);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var l=a.dependencies;if(l!==null){h=a.child;for(var m=l.firstContext;m!==null;){if(m.context===r){if(a.tag===1){m=sl(-1,n&-n),m.tag=2;var _=a.updateQueue;if(_!==null){_=_.shared;var E=_.pending;E===null?m.next=m:(m.next=E.next,E.next=m),_.pending=m}}a.lanes|=n,m=a.alternate,m!==null&&(m.lanes|=n),Ab(a.return,n,e),l.lanes|=n;break}m=m.next}}else if(a.tag===10)h=a.type===e.type?null:a.child;else if(a.tag===18){if(h=a.return,h===null)throw Error(dt(341));h.lanes|=n,l=h.alternate,l!==null&&(l.lanes|=n),Ab(h,n,e),h=a.sibling}else h=a.child;if(h!==null)h.return=a;else for(h=a;h!==null;){if(h===e){h=null;break}if(a=h.sibling,a!==null){a.return=h.return,h=a;break}h=h.return}a=h}vs(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Yh(e,n),i=ko(i),r=r(i),e.flags|=1,vs(t,e,r,n),e.child;case 14:return r=e.type,i=Yo(r,e.pendingProps),i=Yo(r.type,i),VP(t,e,r,i,n);case 15:return BL(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Yo(r,i),Wy(t,e),e.tag=1,Os(r)?(t=!0,b0(e)):t=!1,Yh(e,n),pL(e,r,i),Mb(e,r,i,n),Rb(null,e,r,!0,t,n);case 19:return GL(t,e,n);case 22:return UL(t,e,n)}throw Error(dt(156,e.tag))};function oR(t,e){return Lk(t,e)}function YF(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Co(t,e,n,r){return new YF(t,e,n,r)}function R2(t){return t=t.prototype,!(!t||!t.isReactComponent)}function KF(t){if(typeof t=="function")return R2(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Jw)return 11;if(t===Qw)return 14}return 2}function dc(t,e){var n=t.alternate;return n===null?(n=Co(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Xy(t,e,n,r,i,a){var h=2;if(r=t,typeof t=="function")R2(t)&&(h=1);else if(typeof t=="string")h=5;else e:switch(t){case kh:return cu(n.children,i,a,e);case Kw:h=8,i|=8;break;case eb:return t=Co(12,n,e,i|2),t.elementType=eb,t.lanes=a,t;case tb:return t=Co(13,n,e,i),t.elementType=tb,t.lanes=a,t;case nb:return t=Co(19,n,e,i),t.elementType=nb,t.lanes=a,t;case mk:return v_(n,i,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case fk:h=10;break e;case pk:h=9;break e;case Jw:h=11;break e;case Qw:h=14;break e;case Zl:h=16,r=null;break e}throw Error(dt(130,t==null?t:typeof t,""))}return e=Co(h,n,e,i),e.elementType=t,e.type=r,e.lanes=a,e}function cu(t,e,n,r){return t=Co(7,t,r,e),t.lanes=n,t}function v_(t,e,n,r){return t=Co(22,t,r,e),t.elementType=mk,t.lanes=n,t.stateNode={isHidden:!1},t}function ex(t,e,n){return t=Co(6,t,null,e),t.lanes=n,t}function tx(t,e,n){return e=Co(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function JF(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=D1(0),this.expirationTimes=D1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=D1(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function O2(t,e,n,r,i,a,h,l,m){return t=new JF(t,e,n,l,m),e===1?(e=1,a===!0&&(e|=8)):e=0,a=Co(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},y2(a),t}function QF(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Mh,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function aR(t){if(!t)return yc;t=t._reactInternals;e:{if(Su(t)!==t||t.tag!==1)throw Error(dt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Os(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(dt(171))}if(t.tag===1){var n=t.type;if(Os(n))return oL(t,n,e)}return e}function lR(t,e,n,r,i,a,h,l,m){return t=O2(n,r,!0,t,i,a,h,l,m),t.context=aR(null),n=t.current,r=ws(),i=hc(n),a=sl(r,i),a.callback=e??null,cc(n,a,i),t.current.lanes=i,xm(t,i,r),Ds(t,r),t}function x_(t,e,n,r){var i=e.current,a=ws(),h=hc(i);return n=aR(n),e.context===null?e.context=n:e.pendingContext=n,e=sl(a,h),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=cc(i,e,h),t!==null&&(ra(t,i,h,a),$y(t,i,h)),h}function O0(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function QP(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function D2(t,e){QP(t,e),(t=t.alternate)&&QP(t,e)}function eN(){return null}var cR=typeof reportError=="function"?reportError:function(t){console.error(t)};function z2(t){this._internalRoot=t}b_.prototype.render=z2.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(dt(409));x_(t,e,null,null)};b_.prototype.unmount=z2.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;yu(function(){x_(null,t,null,null)}),e[al]=null}};function b_(t){this._internalRoot=t}b_.prototype.unstable_scheduleHydration=function(t){if(t){var e=Bk();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Yl.length&&e!==0&&e<Yl[n].priority;n++);Yl.splice(n,0,t),n===0&&Vk(t)}};function F2(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function w_(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function eC(){}function tN(t,e,n,r,i){if(i){if(typeof r=="function"){var a=r;r=function(){var _=O0(h);a.call(_)}}var h=lR(e,r,t,0,null,!1,!1,"",eC);return t._reactRootContainer=h,t[al]=h.current,$p(t.nodeType===8?t.parentNode:t),yu(),h}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var _=O0(m);l.call(_)}}var m=O2(t,0,!1,null,null,!1,!1,"",eC);return t._reactRootContainer=m,t[al]=m.current,$p(t.nodeType===8?t.parentNode:t),yu(function(){x_(e,m,n,r)}),m}function E_(t,e,n,r,i){var a=n._reactRootContainer;if(a){var h=a;if(typeof i=="function"){var l=i;i=function(){var m=O0(h);l.call(m)}}x_(e,h,t,i)}else h=tN(n,e,t,i,r);return O0(h)}Fk=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=up(e.pendingLanes);n!==0&&(n2(e,n|1),Ds(e,ai()),!(jn&6)&&(ud=ai()+500,wc()))}break;case 13:yu(function(){var r=ll(t,1);if(r!==null){var i=ws();ra(r,t,1,i)}}),D2(t,1)}};r2=function(t){if(t.tag===13){var e=ll(t,134217728);if(e!==null){var n=ws();ra(e,t,134217728,n)}D2(t,134217728)}};Nk=function(t){if(t.tag===13){var e=hc(t),n=ll(t,e);if(n!==null){var r=ws();ra(n,t,e,r)}D2(t,e)}};Bk=function(){return nr};Uk=function(t,e){var n=nr;try{return nr=t,e()}finally{nr=n}};db=function(t,e,n){switch(e){case"input":if(sb(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=f_(r);if(!i)throw Error(dt(90));yk(r),sb(r,i)}}}break;case"textarea":vk(t,n);break;case"select":e=n.value,e!=null&&Wh(t,!!n.multiple,e,!1)}};Pk=M2;Ck=yu;var nN={usingClientEntryPoint:!1,Events:[wm,Dh,f_,Tk,Sk,M2]},Hf={findFiberByHostInstance:nu,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},rN={bundleType:Hf.bundleType,version:Hf.version,rendererPackageName:Hf.rendererPackageName,rendererConfig:Hf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:gl.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Mk(t),t===null?null:t.stateNode},findFiberByHostInstance:Hf.findFiberByHostInstance||eN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var sy=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sy.isDisabled&&sy.supportsFiber)try{c_=sy.inject(rN),Aa=sy}catch{}}lo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nN;lo.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!F2(e))throw Error(dt(200));return QF(t,e,null,n)};lo.createRoot=function(t,e){if(!F2(t))throw Error(dt(299));var n=!1,r="",i=cR;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=O2(t,1,!1,null,null,n,!1,r,i),t[al]=e.current,$p(t.nodeType===8?t.parentNode:t),new z2(e)};lo.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(dt(188)):(t=Object.keys(t).join(","),Error(dt(268,t)));return t=Mk(e),t=t===null?null:t.stateNode,t};lo.flushSync=function(t){return yu(t)};lo.hydrate=function(t,e,n){if(!w_(e))throw Error(dt(200));return E_(null,t,e,!0,n)};lo.hydrateRoot=function(t,e,n){if(!F2(t))throw Error(dt(405));var r=n!=null&&n.hydratedSources||null,i=!1,a="",h=cR;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(h=n.onRecoverableError)),e=lR(e,null,t,1,n??null,i,!1,a,h),t[al]=e.current,$p(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new b_(e)};lo.render=function(t,e,n){if(!w_(e))throw Error(dt(200));return E_(null,t,e,!1,n)};lo.unmountComponentAtNode=function(t){if(!w_(t))throw Error(dt(40));return t._reactRootContainer?(yu(function(){E_(null,null,t,!1,function(){t._reactRootContainer=null,t[al]=null})}),!0):!1};lo.unstable_batchedUpdates=M2;lo.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!w_(n))throw Error(dt(200));if(t==null||t._reactInternals===void 0)throw Error(dt(38));return E_(t,e,n,!1,r)};lo.version="18.2.0-next-9e3b772b8-20220608";function uR(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(uR)}catch(t){console.error(t)}}uR(),lk.exports=lo;var Rd=lk.exports;const oy=_m(Rd);var tC=Rd;Jx.createRoot=tC.createRoot,Jx.hydrateRoot=tC.hydrateRoot;function D0(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const N2=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),nC=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);nC&&parseFloat(nC[1]);const iN="3.4.14";function ul(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const Yy=typeof process!="object"||String(process)!=="[object process]"||process.browser,sN=typeof window<"u"&&typeof window.orientation<"u",rC=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);rC&&parseFloat(rC[1]);function Jp(t){"@babel/helpers - typeof";return Jp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jp(t)}function oN(t,e){if(Jp(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Jp(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function aN(t){var e=oN(t,"string");return Jp(e)==="symbol"?e:String(e)}function K(t,e,n){return e=aN(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class lN{constructor(e,n){K(this,"name",void 0),K(this,"workerThread",void 0),K(this,"isRunning",!0),K(this,"result",void 0),K(this,"_resolve",()=>{}),K(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((r,i)=>{this._resolve=r,this._reject=i})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){ul(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){ul(this.isRunning),this.isRunning=!1,this._reject(e)}}let nx=class{terminate(){}};const rx=new Map;function cN(t){ul(t.source&&!t.url||!t.source&&t.url);let e=rx.get(t.source||t.url);return e||(t.url&&(e=uN(t.url),rx.set(t.url,e)),t.source&&(e=hR(t.source),rx.set(t.source,e))),ul(e),e}function uN(t){if(!t.startsWith("http"))return t;const e=hN(t);return hR(e)}function hR(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function hN(t){return`try {
  importScripts('`.concat(t,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function dR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2?arguments[2]:void 0;const r=n||new Set;if(t){if(iC(t))r.add(t);else if(iC(t.buffer))r.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const i in t)dR(t[i],e,r)}}return n===void 0?Array.from(r):[]}function iC(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const ix=()=>{};class Hb{static isSupported(){return typeof Worker<"u"&&Yy||typeof nx<"u"&&!Yy}constructor(e){K(this,"name",void 0),K(this,"source",void 0),K(this,"url",void 0),K(this,"terminated",!1),K(this,"worker",void 0),K(this,"onMessage",void 0),K(this,"onError",void 0),K(this,"_loadableURL","");const{name:n,source:r,url:i}=e;ul(r||i),this.name=n,this.source=r,this.url=i,this.onMessage=ix,this.onError=a=>console.log(a),this.worker=Yy?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=ix,this.onError=ix,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||dR(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=cN({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new nx(r,{eval:!1})}else if(this.source)e=new nx(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class dN{static isSupported(){return Hb.isSupported()}constructor(e){K(this,"name","unnamed"),K(this,"source",void 0),K(this,"url",void 0),K(this,"maxConcurrency",1),K(this,"maxMobileConcurrency",1),K(this,"onDebug",()=>{}),K(this,"reuseWorkers",!0),K(this,"props",{}),K(this,"jobQueue",[]),K(this,"idleQueue",[]),K(this,"count",0),K(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(a,h,l)=>a.done(l),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(a,h)=>a.error(h);const i=new Promise(a=>(this.jobQueue.push({name:e,onMessage:n,onError:r,onStart:a}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const r=new lN(n.name,e);e.onMessage=i=>n.onMessage(r,i.type,i.payload),e.onError=i=>n.onError(r,i),n.onStart(r);try{await r.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new Hb({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return sN?this.maxMobileConcurrency:this.maxConcurrency}}const fN={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class el{static isSupported(){return Hb.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return el._workerFarm=el._workerFarm||new el({}),el._workerFarm.setProps(e),el._workerFarm}constructor(e){K(this,"props",void 0),K(this,"workerPools",new Map),this.props={...fN},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:r,url:i}=e;let a=this.workerPools.get(n);return a||(a=new dN({name:n,source:r,url:i}),a.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,a)),a}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}K(el,"_workerFarm",void 0);const pN="latest";function mN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e[t.id]||{},r="".concat(t.id,"-worker.js");let i=n.workerUrl;if(!i&&t.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&(i="modules/".concat(t.module,"/dist/").concat(r)),!i){let a=t.version;a==="latest"&&(a=pN);const h=a?"@".concat(a):"";i="https://unpkg.com/@loaders.gl/".concat(t.module).concat(h,"/dist/").concat(r)}return ul(i),i}function gN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:iN;ul(t,"no worker provided");const n=t.version;return!(!e||!n)}function yN(t,e){return!el.isSupported()||!Yy&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&(e==null?void 0:e.worker)}async function _N(t,e,n,r,i){const a=t.id,h=mN(t,n),m=el.getWorkerFarm(n).getWorkerPool({name:a,url:h});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const _=await m.startJob("process-on-worker",vN.bind(null,i));return _.postMessage("process",{input:e,options:n,context:r}),await(await _.result).result}async function vN(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:i,input:a,options:h}=r;try{const l=await t(a,h);e.postMessage("done",{id:i,result:l})}catch(l){const m=l instanceof Error?l.message:"unknown error";e.postMessage("error",{id:i,error:m})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function xN(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let a=0;a<r.length;++a)if(r[a]!==i[a])return!1;return!0}function bN(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const r=e.map(l=>l instanceof ArrayBuffer?new Uint8Array(l):l),i=r.reduce((l,m)=>l+m.byteLength,0),a=new Uint8Array(i);let h=0;for(const l of r)a.set(l,h),h+=l.byteLength;return a.buffer}async function wN(t){const e=[];for await(const n of t)e.push(n);return bN(...e)}let EN="";const sC={};function TN(t){for(const e in sC)if(t.startsWith(e)){const n=sC[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat(EN).concat(t)),t}function SN(t){return t&&typeof t=="object"&&t.isBuffer}function fR(t){if(SN(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function pR(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function PN(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}const CN=t=>typeof t=="boolean",Pp=t=>typeof t=="function",Tm=t=>t!==null&&typeof t=="object",oC=t=>Tm(t)&&t.constructor==={}.constructor,AN=t=>t&&typeof t[Symbol.iterator]=="function",IN=t=>t&&typeof t[Symbol.asyncIterator]=="function",Pu=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,Cu=t=>typeof Blob<"u"&&t instanceof Blob,MN=t=>t&&typeof t=="object"&&t.isBuffer,kN=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||Tm(t)&&Pp(t.tee)&&Pp(t.cancel)&&Pp(t.getReader),LN=t=>Tm(t)&&Pp(t.read)&&Pp(t.pipe)&&CN(t.readable),mR=t=>kN(t)||LN(t),RN=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,ON=/^([-\w.]+\/[-\w.+]+)/;function DN(t){const e=ON.exec(t);return e?e[1]:t}function aC(t){const e=RN.exec(t);return e?e[1]:""}const gR=/\?.*/;function zN(t){const e=t.match(gR);return e&&e[0]}function B2(t){return t.replace(gR,"")}function T_(t){return Pu(t)?t.url:Cu(t)?t.name||"":typeof t=="string"?t:""}function U2(t){if(Pu(t)){const e=t,n=e.headers.get("content-type")||"",r=B2(e.url);return DN(n)||aC(r)}return Cu(t)?t.type||"":typeof t=="string"?aC(t):""}function FN(t){return Pu(t)?t.headers["content-length"]||-1:Cu(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function yR(t){if(Pu(t))return t;const e={},n=FN(t);n>=0&&(e["content-length"]=String(n));const r=T_(t),i=U2(t);i&&(e["content-type"]=i);const a=await UN(t);a&&(e["x-first-bytes"]=a),typeof t=="string"&&(t=new TextEncoder().encode(t));const h=new Response(t,{headers:e});return Object.defineProperty(h,"url",{value:r}),h}async function NN(t){if(!t.ok){const e=await BN(t);throw new Error(e)}}async function BN(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let r=t.statusText;n.includes("application/json")&&(r+=" ".concat(await t.text())),e+=r,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function UN(t){if(typeof t=="string")return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(r=>{const i=new FileReader;i.onload=a=>{var h;return r(a==null||(h=a.target)===null||h===void 0?void 0:h.result)},i.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5),r=VN(n);return"data:base64,".concat(r)}return null}function VN(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}async function lC(t,e){if(typeof t=="string"){t=TN(t);let n=e;return e!=null&&e.fetch&&typeof(e==null?void 0:e.fetch)!="function"&&(n=e.fetch),await fetch(t,n)}return await yR(t)}function jN(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function Sm(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||jN()}const ay=globalThis.window||globalThis.self||globalThis.global,Wf=globalThis.process||{},_R=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";Sm();function $N(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}let GN=class{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";this.storage=void 0,this.id=void 0,this.config=void 0,this.storage=$N(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}};function HN(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function WN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function sx(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const a=t.width*n,h=t.height*n,l=["font-size:1px;","padding:".concat(Math.floor(h/2),"px ").concat(Math.floor(a/2),"px;"),"line-height:".concat(h,"px;"),"background:url(".concat(i,");"),"background-size:".concat(a,"px ").concat(h,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),l]}let z0;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(z0||(z0={}));const qN=10;function cC(t){return typeof t!="string"?t:(t=t.toUpperCase(),z0[t]||z0.WHITE)}function ZN(t,e,n){if(!Sm&&typeof t=="string"){if(e){const r=cC(e);t="\x1B[".concat(r,"m").concat(t,"\x1B[39m")}if(n){const r=cC(n);t="\x1B[".concat(r+qN,"m").concat(t,"\x1B[49m")}}return t}function XN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n),i=t;for(const a of r){const h=i[a];typeof h=="function"&&(e.find(l=>a===l)||(i[a]=h.bind(t)))}}function F0(t,e){if(!t)throw new Error(e||"Assertion failed")}function ph(){let t;if(Sm()&&ay.performance){var e,n;t=ay==null||(e=ay.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in Wf){var r;const i=Wf==null||(r=Wf.hrtime)===null||r===void 0?void 0:r.call(Wf);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const mh={debug:Sm()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},YN={enabled:!0,level:0};function wo(){}const uC={},hC={once:!0};let V2=class{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};this.id=void 0,this.VERSION=_R,this._startTs=ph(),this._deltaTs=ph(),this._storage=void 0,this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new GN("__probe-".concat(this.id,"__"),YN),this.timeStamp("".concat(this.id," started")),XN(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((ph()-this._startTs).toPrecision(10))}getDelta(){return Number((ph()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){F0(e,n)}warn(e){return this._getLogFunction(0,e,mh.warn,arguments,hC)}error(e){return this._getLogFunction(0,e,mh.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,mh.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,mh.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){return this._getLogFunction(e,n,mh.debug||mh.info,arguments,hC)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||wo,r&&[r],{tag:e6(n)}):wo}image(e){let{logLevel:n,priority:r,image:i,message:a="",scale:h=1}=e;return this._shouldLog(n||r)?Sm()?QN({image:i,message:a,scale:h}):JN():wo}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||wo)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=dC({logLevel:e,message:n,opts:r}),{collapsed:a}=r;return i.method=(a?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||wo)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=vR(e)}_getLogFunction(e,n,r,i,a){if(this._shouldLog(e)){a=dC({logLevel:e,message:n,args:i,opts:a}),r=r||a.method,F0(r),a.total=this.getTotal(),a.delta=this.getDelta(),this._deltaTs=ph();const h=a.tag||a.message;if(a.once&&h)if(!uC[h])uC[h]=ph();else return wo;return n=KN(this.id,a.message,a),r.bind(console,n,...a.args)}return wo}};V2.VERSION=_R;function vR(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return F0(Number.isFinite(e)&&e>=0),e}function dC(t){const{logLevel:e,message:n}=t;t.logLevel=vR(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return F0(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function KN(t,e,n){if(typeof e=="string"){const r=n.time?WN(HN(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=ZN(e,n.color,n.background)}return e}function JN(t){return console.warn("removed"),wo}function QN(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const a=new Image;return a.onload=()=>{const h=sx(a,n,r);console.log(...h)},a.src=e,wo}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...sx(e,n,r)),wo;if(i.toLowerCase()==="canvas"){const a=new Image;return a.onload=()=>console.log(...sx(a,n,r)),a.src=e.toDataURL(),wo}return wo}function e6(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const fC=new V2({id:"loaders.gl"});class t6{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class n6{constructor(){K(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.log.bind(this.console,...n)}info(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.info.bind(this.console,...n)}warn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.warn.bind(this.console,...n)}error(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.error.bind(this.console,...n)}}const xR={fetch:null,mimeType:void 0,nothrow:!1,log:new n6,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:N2,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},r6={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function bR(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const wR=()=>{const t=bR();return t.globalOptions=t.globalOptions||{...xR},t.globalOptions};function i6(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],s6(t,n),a6(e,t,r)}function s6(t,e){pC(t,null,xR,r6,e);for(const n of e){const r=t&&t[n.id]||{},i=n.options&&n.options[n.id]||{},a=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};pC(r,n.id,i,a,e)}}function pC(t,e,n,r,i){const a=e||"Top level",h=e?"".concat(e,"."):"";for(const l in t){const m=!e&&Tm(t[l]),_=l==="baseUri"&&!e,E=l==="workerUrl"&&e;if(!(l in n)&&!_&&!E){if(l in r)fC.warn("".concat(a," loader option '").concat(h).concat(l,"' no longer supported, use '").concat(r[l],"'"))();else if(!m){const S=o6(l,i);fC.warn("".concat(a," loader option '").concat(h).concat(l,"' not recognized. ").concat(S))()}}}}function o6(t,e){const n=t.toLowerCase();let r="";for(const i of e)for(const a in i.options){if(t===a)return"Did you mean '".concat(i.id,".").concat(a,"'?");const h=a.toLowerCase();(n.startsWith(h)||h.startsWith(n))&&(r=r||"Did you mean '".concat(i.id,".").concat(a,"'?"))}return r}function a6(t,e,n){const i={...t.options||{}};return l6(i,n),i.log===null&&(i.log=new t6),mC(i,wR()),mC(i,e),i}function mC(t,e){for(const n in e)if(n in e){const r=e[n];oC(r)&&oC(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function l6(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function j2(t){var e;return t?(Array.isArray(t)&&(t=t[0]),Array.isArray((e=t)===null||e===void 0?void 0:e.extensions)):!1}function $2(t){var e,n;D0(t,"null loader"),D0(j2(t),"invalid loader");let r;return Array.isArray(t)&&(r=t[1],t=t[0],t={...t,options:{...t.options,...r}}),((e=t)!==null&&e!==void 0&&e.parseTextSync||(n=t)!==null&&n!==void 0&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const ER=()=>{const t=bR();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function c6(t){const e=ER();t=Array.isArray(t)?t:[t];for(const n of t){const r=$2(n);e.find(i=>r===i)||e.unshift(r)}}function u6(){return ER()}const h6=new V2({id:"loaders.gl"}),d6=/\.([^.]+)$/;async function f6(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!TR(t))return null;let i=gC(t,e,{...n,nothrow:!0},r);if(i)return i;if(Cu(t)&&(t=await t.slice(0,10).arrayBuffer(),i=gC(t,e,n,r)),!i&&!(n!=null&&n.nothrow))throw new Error(SR(t));return i}function gC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!TR(t))return null;if(e&&!Array.isArray(e))return $2(e);let i=[];e&&(i=i.concat(e)),n!=null&&n.ignoreRegisteredLoaders||i.push(...u6()),m6(i);const a=p6(t,i,n,r);if(!a&&!(n!=null&&n.nothrow))throw new Error(SR(t));return a}function p6(t,e,n,r){const i=T_(t),a=U2(t),h=B2(i)||(r==null?void 0:r.url);let l=null,m="";if(n!=null&&n.mimeType&&(l=ox(e,n==null?void 0:n.mimeType),m="match forced by supplied MIME type ".concat(n==null?void 0:n.mimeType)),l=l||g6(e,h),m=m||(l?"matched url ".concat(h):""),l=l||ox(e,a),m=m||(l?"matched MIME type ".concat(a):""),l=l||_6(e,t),m=m||(l?"matched initial data ".concat(PR(t)):""),l=l||ox(e,n==null?void 0:n.fallbackMimeType),m=m||(l?"matched fallback MIME type ".concat(a):""),m){var _;h6.log(1,"selectLoader selected ".concat((_=l)===null||_===void 0?void 0:_.name,": ").concat(m,"."))}return l}function TR(t){return!(t instanceof Response&&t.status===204)}function SR(t){const e=T_(t),n=U2(t);let r="No valid loader found (";r+=e?"".concat(pR(e),", "):"no url provided, ",r+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const i=t?PR(t):"";return r+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",r+=")",r}function m6(t){for(const e of t)$2(e)}function g6(t,e){const n=e&&d6.exec(e),r=n&&n[1];return r?y6(t,r):null}function y6(t,e){e=e.toLowerCase();for(const n of t)for(const r of n.extensions)if(r.toLowerCase()===e)return n;return null}function ox(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function _6(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(v6(e,n))return n}else if(ArrayBuffer.isView(e)){if(yC(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&yC(e,0,n))return n;return null}function v6(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>t.startsWith(r))}function yC(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(i=>x6(t,e,n,i))}function x6(t,e,n,r){if(r instanceof ArrayBuffer)return xN(r,t,r.byteLength);switch(typeof r){case"function":return r(t,n);case"string":const i=Wb(t,e,r.length);return r===i;default:return!1}}function PR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?Wb(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?Wb(t,0,e):""}function Wb(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let i="";for(let a=0;a<n;a++)i+=String.fromCharCode(r.getUint8(e+a));return i}const b6=256*1024;function*w6(t,e){const n=(e==null?void 0:e.chunkSize)||b6;let r=0;const i=new TextEncoder;for(;r<t.length;){const a=Math.min(t.length-r,n),h=t.slice(r,r+a);r+=a,yield i.encode(h)}}const E6=256*1024;function T6(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const{chunkSize:n=E6}=e;let r=0;for(;r<t.byteLength;){const i=Math.min(t.byteLength-r,n),a=new ArrayBuffer(i),h=new Uint8Array(t,r,i);new Uint8Array(a).set(h),r+=i,yield a}}()}const S6=1024*1024;async function*P6(t,e){const n=(e==null?void 0:e.chunkSize)||S6;let r=0;for(;r<t.size;){const i=r+n,a=await t.slice(r,i).arrayBuffer();r=i,yield a}}function _C(t,e){return N2?C6(t,e):A6(t)}async function*C6(t,e){const n=t.getReader();let r;try{for(;;){const i=r||n.read();e!=null&&e._streamReadAhead&&(r=n.read());const{done:a,value:h}=await i;if(a)return;yield fR(h)}}catch{n.releaseLock()}}async function*A6(t,e){for await(const n of t)yield fR(n)}function I6(t,e){if(typeof t=="string")return w6(t,e);if(t instanceof ArrayBuffer)return T6(t,e);if(Cu(t))return P6(t,e);if(mR(t))return _C(t,e);if(Pu(t))return _C(t.body,e);throw new Error("makeIterator")}const CR="Cannot convert supplied data type";function M6(t,e,n){if(e.text&&typeof t=="string")return t;if(MN(t)&&(t=t.buffer),t instanceof ArrayBuffer){const r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let r=t.buffer;const i=t.byteLength||t.length;return(t.byteOffset!==0||i!==r.byteLength)&&(r=r.slice(t.byteOffset,t.byteOffset+i)),r}throw new Error(CR)}async function k6(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||r)return M6(t,e);if(Cu(t)&&(t=await yR(t)),Pu(t)){const i=t;return await NN(i),e.binary?await i.arrayBuffer():await i.text()}if(mR(t)&&(t=I6(t,n)),AN(t)||IN(t))return wN(t);throw new Error(CR)}function AR(t,e){const n=wR(),r=t||n;return typeof r.fetch=="function"?r.fetch:Tm(r.fetch)?i=>lC(i,r):e!=null&&e.fetch?e==null?void 0:e.fetch:lC}function L6(t,e,n){if(n)return n;const r={fetch:AR(e,t),...t};if(r.url){const i=B2(r.url);r.baseUrl=i,r.queryString=zN(r.url),r.filename=pR(i),r.baseUrl=PN(i)}return Array.isArray(r.loaders)||(r.loaders=null),r}function R6(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...r]:r}return n&&n.length?n:null}async function G2(t,e,n,r){ul(!r||typeof r=="object"),e&&!Array.isArray(e)&&!j2(e)&&(r=void 0,n=e,e=void 0),t=await t,n=n||{};const i=T_(t),h=R6(e,r),l=await f6(t,h,n);return l?(n=i6(n,l,h,i),r=L6({url:i,parse:G2,loaders:h},n,r||null),await O6(l,t,n,r)):null}async function O6(t,e,n,r){if(gN(t),Pu(e)){const i=e,{ok:a,redirected:h,status:l,statusText:m,type:_,url:E}=i,S=Object.fromEntries(i.headers.entries());r.response={headers:S,ok:a,redirected:h,status:l,statusText:m,type:_,url:E}}if(e=await k6(e,t,n),t.parseTextSync&&typeof e=="string")return n.dataType="text",t.parseTextSync(e,n,r,t);if(yN(t,n))return await _N(t,e,n,r,G2);if(t.parseText&&typeof e=="string")return await t.parseText(e,n,r,t);if(t.parse)return await t.parse(e,n,r,t);throw ul(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}async function qb(t,e,n,r){!Array.isArray(e)&&!j2(e)&&(n=e,e=void 0);const i=AR(n);let a=t;return typeof t=="string"&&(a=await i(t)),Cu(t)&&(a=await i(t)),await G2(a,e,n)}const D6="3.4.14",{_parseImageNode:z6}=globalThis,Zb=typeof Image<"u",Xb=typeof ImageBitmap<"u",F6=!!z6,Yb=N2?!0:F6;function N6(t){switch(t){case"auto":return Xb||Zb||Yb;case"imagebitmap":return Xb;case"image":return Zb;case"data":return Yb;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}function B6(){if(Xb)return"imagebitmap";if(Zb)return"image";if(Yb)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function U6(t){const e=j6(t);if(!e)throw new Error("Not an image");return e}function V6(t){switch(U6(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function j6(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const $6=/^data:image\/svg\+xml/,G6=/\.svg((\?|#).*)?$/;function H2(t){return t&&($6.test(t)||G6.test(t))}function H6(t,e){if(H2(e)){let r=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(a){throw new Error(a.message)}return"data:image/svg+xml;base64,".concat(btoa(r))}return IR(t,e)}function IR(t,e){if(H2(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function MR(t,e,n){const r=H6(t,n),i=self.URL||self.webkitURL,a=typeof r!="string"&&i.createObjectURL(r);try{return await W6(a||r,e)}finally{a&&i.revokeObjectURL(a)}}async function W6(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,i)=>{try{n.onload=()=>r(n),n.onerror=a=>i(new Error("Could not load image ".concat(t,": ").concat(a)))}catch(a){i(a)}})}const q6={};let vC=!0;async function Z6(t,e,n){let r;H2(n)?r=await MR(t,e,n):r=IR(t,n);const i=e&&e.imagebitmap;return await X6(r,i)}async function X6(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if((Y6(e)||!vC)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),vC=!1}return await createImageBitmap(t)}function Y6(t){for(const e in t||q6)return!1;return!0}function K6(t){return!tB(t,"ftyp",4)||!(t[8]&96)?null:J6(t)}function J6(t){switch(Q6(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function Q6(t,e,n){return String.fromCharCode(...t.slice(e,n))}function eB(t){return[...t].map(e=>e.charCodeAt(0))}function tB(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=eB(e);for(let i=0;i<r.length;++i)if(r[i]!==t[i+n])return!1;return!0}const Ta=!1,Cp=!0;function kR(t){const e=Pm(t);return rB(e)||oB(e)||iB(e)||sB(e)||nB(e)}function nB(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),n=K6(e);return n?{mimeType:n.mimeType,width:0,height:0}:null}function rB(t){const e=Pm(t);return e.byteLength>=24&&e.getUint32(0,Ta)===2303741511?{mimeType:"image/png",width:e.getUint32(16,Ta),height:e.getUint32(20,Ta)}:null}function iB(t){const e=Pm(t);return e.byteLength>=10&&e.getUint32(0,Ta)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,Cp),height:e.getUint16(8,Cp)}:null}function sB(t){const e=Pm(t);return e.byteLength>=14&&e.getUint16(0,Ta)===16973&&e.getUint32(2,Cp)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,Cp),height:e.getUint32(22,Cp)}:null}function oB(t){const e=Pm(t);if(!(e.byteLength>=3&&e.getUint16(0,Ta)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:i}=aB();let a=2;for(;a+9<e.byteLength;){const h=e.getUint16(a,Ta);if(i.has(h))return{mimeType:"image/jpeg",height:e.getUint16(a+5,Ta),width:e.getUint16(a+7,Ta)};if(!r.has(h))return null;a+=2,a+=e.getUint16(a,Ta)}return null}function aB(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function Pm(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function lB(t,e){const{mimeType:n}=kR(t)||{},r=globalThis._parseImageNode;return D0(r),await r(t,n)}async function cB(t,e,n){e=e||{};const i=(e.image||{}).type||"auto",{url:a}=n||{},h=uB(i);let l;switch(h){case"imagebitmap":l=await Z6(t,e,a);break;case"image":l=await MR(t,e,a);break;case"data":l=await lB(t);break;default:D0(!1)}return i==="data"&&(l=V6(l)),l}function uB(t){switch(t){case"auto":case"data":return B6();default:return N6(t),t}}const hB=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],dB=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],fB={image:{type:"auto",decode:!0}},pB={id:"image",module:"images",name:"Images",version:D6,mimeTypes:dB,extensions:hB,parse:cB,tests:[t=>!!kR(new DataView(t))],options:fB};function LR(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function yl(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||LR()}const Ky={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},ly=Ky.window||Ky.self||Ky.global,qf=Ky.process||{},RR=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";yl();const ax=globalThis;function OR(t){if(!t&&!yl())return"Node";if(LR(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i?"IE":ax.chrome?"Chrome":ax.safari?"Safari":ax.mozInnerScreenX?"Firefox":"Unknown"}function mB(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class gB{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";K(this,"storage",void 0),K(this,"id",void 0),K(this,"config",void 0),this.storage=mB(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function yB(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function _B(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function lx(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const a=t.width*n,h=t.height*n,l=["font-size:1px;","padding:".concat(Math.floor(h/2),"px ").concat(Math.floor(a/2),"px;"),"line-height:".concat(h,"px;"),"background:url(".concat(i,");"),"background-size:".concat(a,"px ").concat(h,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),l]}let N0;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(N0||(N0={}));function xC(t){return typeof t=="string"?N0[t.toUpperCase()]||N0.WHITE:t}function vB(t,e,n){return!yl&&typeof t=="string"&&(e&&(e=xC(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=xC(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function xB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)typeof t[i]=="function"&&(e.find(a=>i===a)||(t[i]=t[i].bind(t)))}function B0(t,e){if(!t)throw new Error(e||"Assertion failed")}function gh(){let t;if(yl&&"performance"in ly){var e,n;t=ly==null||(e=ly.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in qf){var r;const i=qf==null||(r=qf.hrtime)===null||r===void 0?void 0:r.call(qf);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const yh={debug:yl&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},bB={enabled:!0,level:0};function Eo(){}const bC={},wC={once:!0};class W2{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};K(this,"id",void 0),K(this,"VERSION",RR),K(this,"_startTs",gh()),K(this,"_deltaTs",gh()),K(this,"_storage",void 0),K(this,"userData",{}),K(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new gB("__probe-".concat(this.id,"__"),bB),this.timeStamp("".concat(this.id," started")),xB(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((gh()-this._startTs).toPrecision(10))}getDelta(){return Number((gh()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){B0(e,n)}warn(e){return this._getLogFunction(0,e,yh.warn,arguments,wC)}error(e){return this._getLogFunction(0,e,yh.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,yh.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,yh.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];return this._getLogFunction(e,n,yh.debug||yh.info,arguments,wC)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||Eo,r&&[r],{tag:SB(n)}):Eo}image(e){let{logLevel:n,priority:r,image:i,message:a="",scale:h=1}=e;return this._shouldLog(n||r)?yl?TB({image:i,message:a,scale:h}):EB():Eo}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||Eo)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=EC({logLevel:e,message:n,opts:r}),{collapsed:a}=r;return i.method=(a?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Eo)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=DR(e)}_getLogFunction(e,n,r,i,a){if(this._shouldLog(e)){a=EC({logLevel:e,message:n,args:i,opts:a}),r=r||a.method,B0(r),a.total=this.getTotal(),a.delta=this.getDelta(),this._deltaTs=gh();const h=a.tag||a.message;if(a.once)if(!bC[h])bC[h]=gh();else return Eo;return n=wB(this.id,a.message,a),r.bind(console,n,...a.args)}return Eo}}K(W2,"VERSION",RR);function DR(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return B0(Number.isFinite(e)&&e>=0),e}function EC(t){const{logLevel:e,message:n}=t;t.logLevel=DR(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return B0(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function wB(t,e,n){if(typeof e=="string"){const r=n.time?_B(yB(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=vB(e,n.color,n.background)}return e}function EB(t){return console.warn("removed"),Eo}function TB(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const a=new Image;return a.onload=()=>{const h=lx(a,n,r);console.log(...h)},a.src=e,Eo}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...lx(e,n,r)),Eo;if(i.toLowerCase()==="canvas"){const a=new Image;return a.onload=()=>console.log(...lx(a,n,r)),a.src=e.toDataURL(),Eo}return Eo}function SB(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const hr=new W2({id:"deck"});let Kb={};function PB(t){Kb=t}function ss(t,e,n,r){hr.level>0&&Kb[t]&&Kb[t].call(null,e,n,r)}function CB(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const AB={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:CB,parseTextSync:JSON.parse};function IB(){const t="8.9.31",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error("deck.gl - multiple versions detected: ".concat(e," vs ").concat(t));return e||(hr.log(1,"deck.gl ".concat(t))(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:hr,_registerLoggers:PB},c6([AB,[pB,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const MB=IB(),Wn={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Wn,"IDENTITY",{get:()=>(hr.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const Pa={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},Qp={common:0,meters:1,pixels:2},TC={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},hn=new W2({id:"luma.gl"});function xs(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const kB="Invalid WebGLRenderingContext",LB="Requires WebGL2";function S_(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}function Fn(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function RB(t){return Fn(t)?t:null}function P_(t){return xs(S_(t),kB),t}function bs(t){return xs(Fn(t),LB),t}const dp={};function OB(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function DB(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function zB(t,e){dp[t]=!0,e!==void 0&&OB(e)}function FB(t){const e=t.getError;t.getError=function(){let r;do r=e.apply(t),r!==0&&(dp[r]=!0);while(r!==0);for(r in dp)if(dp[r])return delete dp[r],parseInt(r,10);return 0}}const Cm=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let r=0;r<this.attribs.length;r++){const i=new t.VertexAttrib(n);this.attribs[r]=i}this.maxAttrib=0};Cm.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};Cm.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const Au=function(e){const n=this;this.gl=e,FB(e);const r=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(a){return a===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:r.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(a){const h=n.currentVertexArrayObject;h.maxAttrib=Math.max(h.maxAttrib,a);const l=h.attribs[a];return l.enabled=!0,r.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(a){const h=n.currentVertexArrayObject;h.maxAttrib=Math.max(h.maxAttrib,a);const l=h.attribs[a];return l.enabled=!1,r.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(a,h){switch(a){case 34962:n.currentArrayBuffer=h;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=h;break}return r.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(a,h){const m=n.currentVertexArrayObject.attribs[a];switch(h){case 34975:return m.buffer;case 34338:return m.enabled;case 34339:return m.size;case 34340:return m.stride;case 34341:return m.type;case 34922:return m.normalized;default:return r.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(a,h,l,m,_,E){const S=n.currentVertexArrayObject;S.maxAttrib=Math.max(S.maxAttrib,a);const I=S.attribs[a];return I.buffer=n.currentArrayBuffer,I.size=h,I.type=l,I.normalized=m,I.stride=_,I.offset=E,I.recache(),r.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{DB("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};Au.prototype.VERTEX_ARRAY_BINDING_OES=34229;Au.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let r=0;r<this.vertexArrayObjects.length;++r)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new Cm(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};Au.prototype.createVertexArrayOES=function(){const e=new Cm(this);return this.vertexArrayObjects.push(e),e};Au.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};Au.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof Cm&&e.hasBeenBound&&e.ext===this)};Au.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){zB(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const r=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const a=this.currentVertexArrayObject;if(i===a)return;(!i||a.elementArrayBuffer!==i.elementArrayBuffer)&&r.bindBuffer.call(n,34963,a.elementArrayBuffer);let h=this.currentArrayBuffer;const l=Math.max(i?i.maxAttrib:0,a.maxAttrib);for(let m=0;m<=l;m++){const _=a.attribs[m],E=i?i.attribs[m]:null;if((!i||_.enabled!==E.enabled)&&(_.enabled?r.enableVertexAttribArray.call(n,m):r.disableVertexAttribArray.call(n,m)),_.enabled){let S=!1;(!i||_.buffer!==E.buffer)&&(h!==_.buffer&&(r.bindBuffer.call(n,34962,_.buffer),h=_.buffer),S=!0),(S||_.cached!==E.cached)&&r.vertexAttribPointer.call(n,m,_.size,_.type,_.normalized,_.stride,_.offset)}}this.currentArrayBuffer!==h&&r.bindBuffer.call(n,34962,this.currentArrayBuffer)};function NB(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const i=e.call(this)||[];return i.indexOf("OES_vertex_array_object")<0&&i.push("OES_vertex_array_object"),i};const n=t.getExtension;t.getExtension=function(i){const a=n.call(this,i);return a||(i!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new Au(this)),this.__OESVertexArrayObject))}}const SC="OES_element_index",PC="WEBGL_draw_buffers",BB="EXT_disjoint_timer_query",UB="EXT_disjoint_timer_query_webgl2",VB="EXT_texture_filter_anisotropic",CC="WEBGL_debug_renderer_info",jB=35723,$B=4352,GB=36795,HB=34047,WB=37445,qB=37446,_r=t=>Fn(t)?void 0:0,ZB={3074:t=>Fn(t)?void 0:36064,[jB]:t=>Fn(t)?void 0:$B,35977:_r,32937:_r,[GB]:(t,e)=>{const n=Fn(t)?t.getExtension(UB):t.getExtension(BB);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[WB]:(t,e)=>{const n=t.getExtension(CC);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[qB]:(t,e)=>{const n=t.getExtension(CC);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[HB]:(t,e)=>{const n=t.luma.extensions[VB];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:_r,35071:_r,37447:_r,36063:(t,e)=>{if(!Fn(t)){const n=t.getExtension(PC);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:_r,35374:_r,35377:_r,34852:t=>{if(!Fn(t)){const e=t.getExtension(PC);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension(SC)?2147483647:65535,33001:t=>t.getExtension(SC)?16777216:65535,33e3:t=>16777216,37157:_r,35373:_r,35657:_r,36183:_r,37137:_r,34045:_r,35978:_r,35979:_r,35968:_r,35376:_r,35375:_r,35659:_r,37154:_r,35371:_r,35658:_r,35076:_r,35077:_r,35380:_r};function XB(t,e,n){const r=ZB[n],i=typeof r=="function"?r(t,e,n):r;return i!==void 0?i:e(n)}const YB="OES_vertex_array_object",zR="ANGLE_instanced_arrays",KB="WEBGL_draw_buffers",JB="EXT_disjoint_timer_query",QB="EXT_texture_filter_anisotropic",eU="VertexArray requires WebGL2 or OES_vertex_array_object extension";function tU(t,e){return{webgl2:Fn(t),ext:t.getExtension(e)}}const FR={[YB]:{meta:{suffix:"OES"},createVertexArray:()=>{xs(!1,eU)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[zR]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){xs(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[KB]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{xs(!1)}},[JB]:{meta:{suffix:"EXT"},createQuery:()=>{xs(!1)},deleteQuery:()=>{xs(!1)},beginQuery:()=>{xs(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},cx={readBuffer:(t,e,n)=>{Fn(t)&&e(n)},getVertexAttrib:(t,e,n,r)=>{const{webgl2:i,ext:a}=tU(t,zR);let h;switch(r){case 35069:h=i?void 0:!1;break;case 35070:h=!i&&!a?0:void 0;break}return h!==void 0?h:e(n,r)},getProgramParameter:(t,e,n,r)=>{if(!Fn(t))switch(r){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,r)},getInternalformatParameter:(t,e,n,r,i)=>{if(!Fn(t))switch(i){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,i)},getTexParameter(t,e,n,r){switch(r){case 34046:const{extensions:i}=t.luma,a=i[QB];r=a&&a.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,r)},getParameter:XB,hint(t,e,n,r){return e(n,r)}};function nU(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(NB(t),rU(t),sU(t,FR),iU(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=nU;function rU(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function iU(t,e){let{target:n,target2:r}=e;Object.keys(cx).forEach(i=>{if(typeof cx[i]=="function"){const a=t[i]?t[i].bind(t):()=>{},h=cx[i].bind(null,t,a);n[i]=h,r[i]=h}})}function sU(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&oU(t,{extension:n,target:t.luma,target2:t})}function oU(t,e){let{extension:n,target:r,target2:i}=e;const a=FR[n];xs(a);const{meta:h={}}=a,{suffix:l=""}=h,m=t.getExtension(n);for(const _ of Object.keys(a)){const E="".concat(_).concat(l);let S=null;_==="meta"||typeof t[_]=="function"||(m&&typeof m[E]=="function"?S=function(){return m[E](...arguments)}:typeof a[_]=="function"&&(S=a[_].bind(r))),S&&(r[_]=S,i[_]=S)}}const q2={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},Vl=(t,e,n)=>e?t.enable(n):t.disable(n),AC=(t,e,n)=>t.hint(n,e),Ws=(t,e,n)=>t.pixelStorei(n,e),aU=(t,e)=>{const n=Fn(t)?36009:36160;return t.bindFramebuffer(n,e)},lU=(t,e)=>t.bindFramebuffer(36008,e);function Zf(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const cU={3042:Vl,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:Vl,2885:(t,e)=>t.cullFace(e),2929:Vl,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:Vl,35723:AC,36006:aU,2886:(t,e)=>t.frontFace(e),33170:AC,2849:(t,e)=>t.lineWidth(e),32823:Vl,32824:"polygonOffset",10752:"polygonOffset",35977:Vl,32938:"sampleCoverage",32939:"sampleCoverage",3089:Vl,3088:(t,e)=>t.scissor(...e),2960:Vl,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:Ws,3317:Ws,37440:Ws,37441:Ws,37443:Ws,3330:Ws,3332:Ws,3331:Ws,36010:lU,3314:Ws,32878:Ws,3316:Ws,3315:Ws,32877:Ws,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=Zf(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=Zf(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=Zf(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=Zf(e)&&e.length===3?[...e,...e]:e;const[n,r,i,a,h,l]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,a,h,l)},stencilOp:(t,e)=>{e=Zf(e)&&e.length===3?[...e,...e]:e;const[n,r,i,a,h,l]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,a,h,l)},viewport:(t,e)=>t.viewport(...e)};function Hr(t,e,n){return e[t]!==void 0?e[t]:n[t]}const uU={blendEquation:(t,e,n)=>t.blendEquationSeparate(Hr(32777,e,n),Hr(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(Hr(32969,e,n),Hr(32968,e,n),Hr(32971,e,n),Hr(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(Hr(32824,e,n),Hr(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(Hr(32938,e,n),Hr(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,Hr(2962,e,n),Hr(2967,e,n),Hr(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,Hr(34816,e,n),Hr(36003,e,n),Hr(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,Hr(2964,e,n),Hr(2965,e,n),Hr(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,Hr(34817,e,n),Hr(34818,e,n),Hr(34819,e,n))},IC={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},blendColor:(t,e,n,r,i)=>t({32773:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,r,i)=>t({32969:e,32968:n,32971:r,32970:i}),clearColor:(t,e,n,r,i)=>t({3106:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,r,i)=>t({3107:[e,n,r,i]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,r,i)=>t({3088:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({2962:e,2967:n,2963:r,34816:e,36003:n,36004:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:r,[e===1028?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({2964:e,2965:n,2966:r,34817:e,34818:n,34819:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:r,[e===1028?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({2978:[e,n,r,i]})},ya=(t,e)=>t.isEnabled(e),MC={3042:ya,2884:ya,2929:ya,3024:ya,32823:ya,32926:ya,32928:ya,3089:ya,2960:ya,35977:ya};function NR(t){for(const e in t)return!1;return!0}function hU(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1}function kC(t,e){const n=t[e].bind(t);t[e]=function(){const i=arguments.length<=0?void 0:arguments[0];return i in t.state.cache?t.state.enable?t.state.cache[i]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function dU(t,e,n){const r=t[e].bind(t);t[e]=function(){for(var a=arguments.length,h=new Array(a),l=0;l<a;l++)h[l]=arguments[l];const{valueChanged:m,oldValue:_}=n(t.state._updateCache,...h);return m&&r(...h),_},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function fU(t){const e=t.useProgram.bind(t);t.useProgram=function(r){t.state.program!==r&&(e(r),t.state.program=r)}}class pU{constructor(e){let{copyState:n=!1,log:r=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?gU(e):Object.assign({},q2),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){xs(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];hl(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,r;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const a in e){xs(a!==void 0);const h=e[a],l=this.cache[a];hU(h,l)||(n=!0,r=l,i&&!(a in i)&&(i[a]=l),this.cache[a]=h)}return{valueChanged:n,oldValue:r}}}function BR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:r}=e;if(xs(r!==void 0),!t.state){const{polyfillContext:i}=globalThis;i&&i(t),t.state=new pU(t,{copyState:r}),fU(t);for(const a in IC){const h=IC[a];dU(t,a,h)}kC(t,"getParameter"),kC(t,"isEnabled")}return t.state.enable=n,t}function mU(t){t.state||BR(t,{copyState:!1}),t.state.push()}function LC(t){xs(t.state),t.state.pop()}function hl(t,e){if(xs(S_(t),"setParameters requires a WebGL context"),NR(e))return;const n={};for(const i in e){const a=Number(i),h=cU[i];h&&(typeof h=="string"?n[h]=!0:h(t,e[i],a))}const r=t.state&&t.state.cache;if(r)for(const i in n){const a=uU[i];a(t,e,r)}}function gU(t,e){if(e=e||q2,typeof e=="number"){const i=e,a=MC[i];return a?a(t,i):t.getParameter(i)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const i of n){const a=MC[i];r[i]=a?a(t,Number(i)):t.getParameter(Number(i))}return r}function yU(t){hl(t,q2)}function ia(t,e,n){if(NR(e))return n(t);const{nocatch:r=!0}=e;mU(t),hl(t,e);let i;if(r)i=n(t),LC(t);else try{i=n(t)}finally{LC(t)}return i}function hd(t){const{luma:e}=t;if(t.canvas&&e){const n=e.canvasSizeInfo,r="clientWidth"in n?n.clientWidth:t.canvas.clientWidth;return r?t.drawingBufferWidth/r:1}return 1}function ux(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=hd(t),i=t.drawingBufferWidth,a=t.drawingBufferHeight;return vU(e,r,i,a,n)}function _U(t){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function vU(t,e,n,r,i){const a=RC(t[0],e,n);let h=OC(t[1],e,r,i),l=RC(t[0]+1,e,n);const m=l===n-1?l:l-1;l=OC(t[1]+1,e,r,i);let _;return i?(l=l===0?l:l+1,_=h,h=l):_=l===r-1?l:l-1,{x:a,y:h,width:Math.max(m-a+1,1),height:Math.max(_-h+1,1)}}function RC(t,e,n){return Math.min(Math.round(t*e),n-1)}function OC(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const Z2=yl(),xU=Z2&&typeof document<"u",UR={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function VR(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};xs(Z2,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),t=Object.assign({},UR,t);const{width:e,height:n}=t;function r(l){if(t.throwOnError)throw new Error(l);return console.error(l),null}t.onError=r;let i;const{canvas:a}=t,h=TU({canvas:a,width:e,height:n,onError:r});return i=EU(h,t),i?(i=X2(i,t),SU(i),i):null}function X2(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||PU(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},UR,e);const{manageState:n,debug:r}=e;return n&&BR(t,{copyState:!1,log:function(){for(var i=arguments.length,a=new Array(i),h=0;h<i;h++)a[h]=arguments[h];return hn.log(1,...a)()}}),Z2&&r&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),hn.level=Math.max(hn.level,1)):hn.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function bU(t){const e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info"),i=r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936),a=r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937);return{vendor:i||e,renderer:a||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}function wU(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.canvas){const r=_U(e.useDevicePixels);CU(t,r,e);return}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function EU(t,e){const{onError:n}=e;let r=null;const i=m=>r=m.statusMessage||r;t.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:a=!0,webgl2:h=!0}=e;let l=null;return h&&(l=l||t.getContext("webgl2",e),l=l||t.getContext("experimental-webgl2",e)),a&&(l=l||t.getContext("webgl",e),l=l||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",i,!1),l?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),l):n("Failed to create ".concat(h&&!a?"WebGL2":"WebGL"," context: ").concat(r||"Unknown error"))}function TU(t){let{canvas:e,width:n=800,height:r=600,onError:i}=t,a;return typeof e=="string"?(xU&&document.readyState==="complete"||i("createGLContext called on canvas '".concat(e,"' before page was loaded")),a=document.getElementById(e)):e?a=e:(a=document.createElement("canvas"),a.id="lumagl-canvas",a.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",a.style.height=Number.isFinite(r)?"".concat(r,"px"):"100%",document.body.insertBefore(a,document.body.firstChild)),a}function SU(t){const e=Fn(t)?"WebGL2":"WebGL1",n=bU(t),r=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",i=t.debug?" debug":"";hn.info(1,"".concat(e).concat(i," context ").concat(r))()}function PU(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?2:1}function CU(t,e,n){let r="width"in n?n.width:t.canvas.clientWidth,i="height"in n?n.height:t.canvas.clientHeight;(!r||!i)&&(hn.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=t.canvas.width||1,i=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const a=t.luma.canvasSizeInfo;if(a.clientWidth!==r||a.clientHeight!==i||a.devicePixelRatio!==e){let h=e;const l=Math.floor(r*h),m=Math.floor(i*h);t.canvas.width=l,t.canvas.height=m,(t.drawingBufferWidth!==l||t.drawingBufferHeight!==m)&&(hn.warn("Device pixel ratio clamped")(),h=Math.min(t.drawingBufferWidth/r,t.drawingBufferHeight/i),t.canvas.width=Math.floor(r*h),t.canvas.height=Math.floor(i*h)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:r,clientHeight:i,devicePixelRatio:e})}}function DC(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class zC{constructor(e,n){K(this,"name",void 0),K(this,"type",void 0),K(this,"sampleSize",1),K(this,"time",void 0),K(this,"count",void 0),K(this,"samples",void 0),K(this,"lastTiming",void 0),K(this,"lastSampleTime",void 0),K(this,"lastSampleCount",void 0),K(this,"_count",0),K(this,"_time",0),K(this,"_samples",0),K(this,"_startTime",0),K(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=DC(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(DC()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class Y2{constructor(e){K(this,"id",void 0),K(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:r}=e;return this.stats[n]||(e instanceof zC?this.stats[n]=e:this.stats[n]=new zC(n,r)),this.stats[n]}}const Ap="8.5.21",AU="set luma.log.level=1 (or higher) to trace rendering";class IU{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new Y2({id:e})),this.stats.get(e)}}const su=new IU;if(globalThis.luma&&globalThis.luma.VERSION!==Ap)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(Ap));globalThis.luma||(yl()&&hn.log(1,"luma.gl ".concat(Ap," - ").concat(AU))(),globalThis.luma=globalThis.luma||{VERSION:Ap,version:Ap,log:hn,stats:su,globals:{modules:{},nodeIO:{}}});function MU(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function kU(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function Ht(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function hx(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const r=t[e];return Ht(r!==void 0,"Accessing undefined constant GL.".concat(e)),r}function fc(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const dx={};function _c(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";dx[t]=dx[t]||1;const e=dx[t]++;return"".concat(t,"-").concat(e)}function FC(t){return Ht(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function dd(t){let e=!0;for(const n in t){e=!1;break}return e}function jR(t,e,n,r){const i="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),a=Object.getPrototypeOf(t);r.forEach(h=>{a.methodName||(a[h]=()=>{throw hn.removed("Calling removed method ".concat(e,".").concat(h,": "),i)(),new Error(h)})})}const _h="Resource subclass must define virtual methods";let _l=class{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};P_(e);const{id:r,userData:i={}}=n;this.gl=e,this.gl2=e,this.id=r||_c(this[Symbol.toStringTag]),this.userData=i,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(r=>r.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=hx(this.gl,e),Ht(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const a=Fn(this.gl);if(!((!("webgl2"in i)||a)&&(!("extension"in i)||this.gl.getExtension(i.extension)))){const l=i.webgl1,m="webgl2"in i?i.webgl2:i.webgl1;return a?m:l}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:r}=e,i=this.constructor.PARAMETERS||{},a=Fn(this.gl),h={},l=n||Object.keys(i);for(const m of l){const _=i[m];if(_&&(!("webgl2"in _)||a)&&(!("extension"in _)||this.gl.getExtension(_.extension))){const S=r?fc(this.gl,m):m;h[S]=this.getParameter(m,e),r&&_.type==="GLenum"&&(h[S]=fc(this.gl,h[S]))}}return h}setParameter(e,n){e=hx(this.gl,e),Ht(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const a=Fn(this.gl);if(!((!("webgl2"in i)||a)&&(!("extension"in i)||this.gl.getExtension(i.extension))))throw new Error("Parameter not available on this platform");i.type==="GLenum"&&(n=hx(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,r){return jR(this,e,n,r)}initialize(e){}_createHandle(){throw new Error(_h)}_deleteHandle(){throw new Error(_h)}_bindHandle(e){throw new Error(_h)}_getOptsFromHandle(){throw new Error(_h)}_getParameter(e,n){throw new Error(_h)}_setParameter(e,n){throw new Error(_h)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],n=su.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];su.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,n),this._trackAllocatedMemoryForContext(e,n,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const i=su.get("Memory Usage".concat(r));i.get("GPU Memory").addCount(e),i.get("".concat(n," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=su.get("Memory Usage".concat(n));r.get("GPU Memory").subtractCount(this.byteLength),r.get("".concat(e," Memory")).subtractCount(this.byteLength)}};const LU="Failed to deduce GL constant from typed array";function Jb(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(LU)}}function em(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function RU(t){let{data:e,width:n,height:r,bytesPerPixel:i=4,temp:a}=t;const h=n*i;a=a||new Uint8Array(h);for(let l=0;l<r/2;++l){const m=l*h,_=(r-l-1)*h;a.set(e.subarray(m,m+h)),e.copyWithin(m,_,_+h),e.set(a,_)}}function OU(t){let{data:e,width:n,height:r}=t;const i=Math.round(n/2),a=Math.round(r/2),h=new Uint8Array(i*a*4);for(let l=0;l<a;l++)for(let m=0;m<i;m++)for(let _=0;_<4;_++)h[(l*i+m)*4+_]=e[(l*2*n+m*2)*4+_];return{data:h,width:i,height:a}}function Qb(t,e,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:a={}}=n;for(const l in r)if(l in e){const _=r[l]?"".concat(t,".").concat(r[l]):"N/A";hn.removed("".concat(t,".").concat(l),_)()}for(const l in i)if(l in e){const m=i[l];hn.deprecated("".concat(t,".").concat(l),"".concat(t,".").concat(m))()}let h=null;for(const l in a)if(l in e){const m=a[l];hn.deprecated("".concat(t,".").concat(l),"".concat(t,".").concat(m))(),h=h||Object.assign({},e),h[m]=e[l],delete h[l]}return h||e}const DU={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},zU={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class Js{static getBytesPerElement(e){return em(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return Ht(e.size),em(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new Js(DU,...n)}constructor(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(i=>this._assign(i)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return Js.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return Js.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=Qb("Accessor",e,zU),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}const NC=10,$R={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},FU={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:$R},NU={removedProps:$R};class ur extends _l{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/Js.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/Js.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=Qb("Buffer",e,FU),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=Qb("Buffer",e,NU),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new Js(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:r=0,srcOffset:i=0}=e,a=e.byteLength||e.length;Ht(n);const h=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(h,this.handle),i!==0||a!==void 0?(bs(this.gl),this.gl.bufferSubData(this.target,r,n,i,a)):this.gl.bufferSubData(h,r,n),this.gl.bindBuffer(h,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:r=0,writeOffset:i=0,size:a}=e;const{gl:h}=this;return bs(h),h.bindBuffer(36662,n.handle),h.bindBuffer(36663,this.handle),h.copyBufferSubData(36662,36663,r,i,a),h.bindBuffer(36662,null),h.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:r=0,length:i=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};bs(this.gl);const a=em(this.accessor.type||5126,{clamped:!1}),h=this._getAvailableElementCount(n),l=r;let m,_;e?(_=e.length,m=_-l):(m=Math.min(h,i||h),_=l+m);const E=Math.min(h,m);return i=i||E,Ht(i<=E),e=e||new a(_),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,r,i),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:r=0,size:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?i!==void 0?this.gl.bindBufferRange(e,n,this.handle,r,i):(Ht(r===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(NC,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;Ht(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.usage),this.gl.bufferSubData(i,n,e),this.gl.bindBuffer(i,null),this.debugData=e.slice(0,NC),this.bytesUsed=r,this._trackAllocatedMemory(r);const a=Jb(e);return Ht(a),this.setAccessor(new Js(this.accessor,{type:a})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;Ht(e>=0),this._trackDeallocatedMemory();let r=e;e===0&&(r=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,n),this.gl.bindBuffer(i,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=em(this.accessor.type||5126,{clamped:!1}),r=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-r}_inferType(e){this.accessor.type||this.setAccessor(new Js(this.accessor,{type:Jb(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return hn.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return hn.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return hn.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return hn.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new Js(this.accessor,e),this}}const K2={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},GR={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},HR={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function BU(t,e){const n=K2[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const r=Fn(t)&&n.gl2||n.gl1;return typeof r=="string"?t.getExtension(r):r}function UU(t,e){const n=K2[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const VU=[9729,9728],BC=globalThis.WebGLBuffer||function(){};class fd extends _l{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:r,linearFiltering:i}=n;let a=!0;return r&&(a=a&&BU(e,r),a=a&&(!i||UU(e,r))),a}constructor(e,n){const{id:r=_c("texture"),handle:i,target:a}=n;super(e,{id:r,handle:i}),this.target=a,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then(N=>this.initialize(Object.assign({},e,{pixels:N,data:N}))),this;const r=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(r&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:i=null,format:a=6408,border:h=0,recreate:l=!1,parameters:m={},pixelStore:_={},textureUnit:E=void 0}=e;n||(n=i);let{width:S,height:I,dataFormat:L,type:O,compressed:D=!1,mipmaps:H=!0}=e;const{depth:z=0}=e;return{width:S,height:I,compressed:D,dataFormat:L,type:O}=this._deduceParameters({format:a,type:O,dataFormat:L,compressed:D,data:n,width:S,height:I}),this.width=S,this.height=I,this.depth=z,this.format=a,this.type=O,this.dataFormat=L,this.border=h,this.textureUnit=E,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),H&&this._isNPOT()&&(hn.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),H=!1,this._updateForNPOT(m)),this.mipmaps=H,this.setImageData({data:n,width:S,height:I,depth:z,format:a,type:O,dataFormat:L,border:h,mipmaps:H,parameters:_,compressed:D}),H&&this.generateMipmap(),this.setParameters(m),l&&(this.data=n),r&&(this._video={video:n,parameters:m,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:r}=this._video;if(r===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:r,mipmaps:i=!1}=e;return r!==this.width||n!==this.height?this.initialize({width:r,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(hn.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),ia(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:r=null,level:i=0,format:a=this.format,border:h=this.border,offset:l=0,parameters:m={}}=e;let{data:_=null,type:E=this.type,width:S=this.width,height:I=this.height,dataFormat:L=this.dataFormat,compressed:O=!1}=e;_||(_=r),{type:E,dataFormat:L,compressed:O,width:S,height:I}=this._deduceParameters({format:a,type:E,dataFormat:L,compressed:O,data:_,width:S,height:I});const{gl:D}=this;D.bindTexture(this.target,this.handle);let H=null;({data:_,dataType:H}=this._getDataType({data:_,compressed:O}));let z,N=0;if(ia(this.gl,m,()=>{switch(H){case"null":D.texImage2D(n,i,a,S,I,h,L,E,_);break;case"typed-array":D.texImage2D(n,i,a,S,I,h,L,E,_,l);break;case"buffer":z=bs(D),z.bindBuffer(35052,_.handle||_),z.texImage2D(n,i,a,S,I,h,L,E,l),z.bindBuffer(35052,null);break;case"browser-object":Fn(D)?D.texImage2D(n,i,a,S,I,h,L,E,_):D.texImage2D(n,i,a,L,E,_);break;case"compressed":for(const[F,$]of _.entries())D.compressedTexImage2D(n,F,$.format,$.width,$.height,h,$.data),N+=$.levelSize;break;default:Ht(!1,"Unknown image data type")}}),H==="compressed")this._trackAllocatedMemory(N,"Texture");else if(_&&_.byteLength)this._trackAllocatedMemory(_.byteLength,"Texture");else{const F=GR[this.dataFormat]||4,$=HR[this.type]||1;this._trackAllocatedMemory(this.width*this.height*F*$,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:r=null,data:i=null,x:a=0,y:h=0,width:l=this.width,height:m=this.height,level:_=0,format:E=this.format,type:S=this.type,dataFormat:I=this.dataFormat,compressed:L=!1,offset:O=0,border:D=this.border,parameters:H={}}=e;if({type:S,dataFormat:I,compressed:L,width:l,height:m}=this._deduceParameters({format:E,type:S,dataFormat:I,compressed:L,data:i,width:l,height:m}),Ht(this.depth===0,"texSubImage not supported for 3D textures"),i||(i=r),i&&i.data){const z=i;i=z.data,l=z.shape[0],m=z.shape[1]}i instanceof ur&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),ia(this.gl,H,()=>{if(L)this.gl.compressedTexSubImage2D(n,_,a,h,l,m,E,i);else if(i===null)this.gl.texSubImage2D(n,_,a,h,l,m,I,S,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(n,_,a,h,l,m,I,S,i,O);else if(i instanceof BC){const z=bs(this.gl);z.bindBuffer(35052,i),z.texSubImage2D(n,_,a,h,l,m,I,S,O),z.bindBuffer(35052,null)}else Fn(this.gl)?bs(this.gl).texSubImage2D(n,_,a,h,l,m,I,S,i):this.gl.texSubImage2D(n,_,a,h,I,S,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return hn.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:r=!1}=e;return r?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof ur?{data:n.handle,dataType:"buffer"}:n instanceof BC?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:r}=e;let{width:i,height:a,dataFormat:h,type:l,compressed:m}=e;const _=K2[n];return h=h||_&&_.dataFormat,l=l||_&&_.types[0],m=m||_&&_.compressed,{width:i,height:a}=this._deduceImageSize(r,i,a),{dataFormat:h,type:l,compressed:m,width:i,height:a,format:n,data:r}}_deduceImageSize(e,n,r){let i;return typeof ImageData<"u"&&e instanceof ImageData?i={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?i={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?i={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?i={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?i={width:e.videoWidth,height:e.videoHeight}:e?i={width:n,height:r}:i={width:n>=0?n:1,height:r>=0?r:1},Ht(i,"Could not deduced texture size"),Ht(n===void 0||i.width===n,"Deduced texture width does not match supplied width"),Ht(r===void 0||i.height===r,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:Ht(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return Fn(this.gl)||!this.width||!this.height?!1:!FC(this.width)||!FC(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:VU.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}}let jU="";function $U(t,e){return Ht(typeof t=="string"),t=jU+t,new Promise((n,r)=>{try{const i=new Image;i.onload=()=>n(i),i.onerror=()=>r(new Error("Could not load image ".concat(t,"."))),i.crossOrigin=e&&e.crossOrigin||"anonymous",i.src=t}catch(i){r(i)}})}class oa extends fd{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return fd.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};P_(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:$U(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}}const ew=[34069,34070,34071,34072,34073,34074];class WR extends fd{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};P_(e),super(e,Object.assign({},n,{target:34067})),this.initialize(n),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:n=!0,parameters:r={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,n&&this.generateMipmap(e),this.setParameters(r)}),this}subImage(e){let{face:n,data:r,x:i=0,y:a=0,mipmapLevel:h=0}=e;return this._subImage({target:n,data:r,x:i,y:a,mipmapLevel:h})}async setCubeMapImageData(e){let{width:n,height:r,pixels:i,data:a,border:h=0,format:l=6408,type:m=5121}=e;const{gl:_}=this,E=i||a,S=await Promise.all(ew.map(I=>{const L=E[I];return Promise.all(Array.isArray(L)?L:[L])}));this.bind(),ew.forEach((I,L)=>{S[L].length>1&&this.opts.mipmaps!==!1&&hn.warn("".concat(this.id," has mipmap and multiple LODs."))(),S[L].forEach((O,D)=>{n&&r?_.texImage2D(I,D,l,n,r,h,l,m,O):_.texImage2D(I,D,l,l,m,O)})}),this.unbind()}setImageDataForFace(e){const{face:n,width:r,height:i,pixels:a,data:h,border:l=0,format:m=6408,type:_=5121}=e,{gl:E}=this,S=a||h;return this.bind(),S instanceof Promise?S.then(I=>this.setImageDataForFace(Object.assign({},e,{face:n,data:I,pixels:I}))):this.width||this.height?E.texImage2D(n,0,m,r,i,l,m,_,S):E.texImage2D(n,0,m,m,_,S),this}}WR.FACES=ew;class GU extends fd{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return Fn(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};bs(e),n=Object.assign({depth:1},n,{target:32879,unpackFlipY:!1}),super(e,n),this.initialize(n),Object.seal(this)}setImageData(e){let{level:n=0,dataFormat:r=6408,width:i,height:a,depth:h=1,border:l=0,format:m,type:_=5121,offset:E=0,data:S,parameters:I={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),ia(this.gl,I,()=>{ArrayBuffer.isView(S)&&this.gl.texImage3D(this.target,n,r,i,a,h,l,m,_,S),S instanceof ur&&(this.gl.bindBuffer(35052,S.handle),this.gl.texImage3D(this.target,n,r,i,a,h,l,m,_,E))}),S&&S.byteLength)this._trackAllocatedMemory(S.byteLength,"Texture");else{const L=GR[this.dataFormat]||4,O=HR[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*L*O,"Texture")}return this.loaded=!0,this}}const qc="EXT_color_buffer_float",UC={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:qc,bpp:2},33327:{gl2:qc,bpp:4},34842:{gl2:qc,bpp:8},33326:{gl2:qc,bpp:4},33328:{gl2:qc,bpp:8},34836:{gl2:qc,bpp:16},35898:{gl2:qc,bpp:4}};function HU(t,e,n){const r=n[e];if(!r)return!1;const i=Fn(t)&&r.gl2||r.gl1;return typeof i=="string"?t.getExtension(i):i}class jh extends _l{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||HU(e,n,UC)}static getSamplesForFormat(e,n){let{format:r}=n;return e.getInternalformatParameter(36161,r,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:r=1,height:i=1,samples:a=0}=e;return Ht(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),a!==0&&Fn(this.gl)?this.gl.renderbufferStorageMultisample(36161,a,n,r,i):this.gl.renderbufferStorage(36161,n,r,i),this.format=n,this.width=r,this.height=i,this.samples=a,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*UC[this.format].bpp),this}resize(e){let{width:n,height:r}=e;return n!==this.width||r!==this.height?this.initialize({width:n,height:r,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const WU=256,qU=1024,ZU=16384,VC=6144,jC=6145,$C=6146,GC=34041,qR="clear: bad arguments";function J2(t){let{framebuffer:e=null,color:n=null,depth:r=null,stencil:i=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const a={};e&&(a.framebuffer=e);let h=0;n&&(h|=ZU,n!==!0&&(a.clearColor=n)),r&&(h|=WU,r!==!0&&(a.clearDepth=r)),i&&(h|=qU,r!==!0&&(a.clearStencil=r)),Ht(h!==0,qR),ia(t,a,()=>{t.clear(h)})}function XU(t){let{framebuffer:e=null,buffer:n=VC,drawBuffer:r=0,value:i=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};bs(t),ia(t,{framebuffer:e},()=>{switch(n){case VC:switch(i.constructor){case Int32Array:t.clearBufferiv(n,r,i);break;case Uint32Array:t.clearBufferuiv(n,r,i);break;case Float32Array:default:t.clearBufferfv(n,r,i)}break;case jC:t.clearBufferfv(jC,0,[i]);break;case $C:t.clearBufferiv($C,0,[i]);break;case GC:const[a,h]=i;t.clearBufferfi(GC,0,a,h);break;default:Ht(!1,qR)}})}function YU(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return Ht(!1),0}}function C_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408}=e;let{sourceAttachment:a=36064,target:h=null,sourceWidth:l,sourceHeight:m,sourceType:_}=e;const{framebuffer:E,deleteFramebuffer:S}=KU(t);Ht(E);const{gl:I,handle:L,attachments:O}=E;l=l||E.width,m=m||E.height,a===36064&&L===null&&(a=1028),Ht(O[a]),_=_||O[a].type,h=JU(h,_,i,l,m),_=_||Jb(h);const D=I.bindFramebuffer(36160,L);return I.readPixels(n,r,l,m,i,_,h),I.bindFramebuffer(36160,D||null),S&&E.delete(),h}function HC(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=C_(t,{sourceAttachment:e}),{width:i,height:a}=t;for(;a>n;)({data:r,width:i,height:a}=OU({data:r,width:i,height:a}));RU({data:r,width:i,height:a});const h=document.createElement("canvas");h.width=i,h.height=a;const l=h.getContext("2d"),m=l.createImageData(i,a);return m.data.set(r),l.putImageData(m,0,0),h.toDataURL()}function KU(t){return t instanceof vi?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:l8(t),deleteFramebuffer:!0}}function JU(t,e,n,r,i){if(t)return t;e=e||5121;const a=em(e,{clamped:!1}),h=YU(n);return new a(r*i*h)}const Sr={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function QU(t){const e=new oa(t,{format:6408,type:5126,dataFormat:6408}),n=new vi(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),r=n.getStatus();return e.delete(),n.delete(),r===36053}const ZR={[Sr.WEBGL2]:[!1,!0],[Sr.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[Sr.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[Sr.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[Sr.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[Sr.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[Sr.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[Sr.FLOAT_BLEND]:["EXT_float_blend"],[Sr.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[Sr.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[Sr.TEXTURE_FLOAT]:["OES_texture_float",!0],[Sr.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[Sr.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[Sr.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[Sr.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[Sr.COLOR_ATTACHMENT_RGBA32F]:[QU,"EXT_color_buffer_float"],[Sr.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[Sr.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[Sr.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[Sr.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[Sr.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[Sr.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},e8=2;function t8(t,e){return Q2(t,e)}function Q2(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>XR(t,n))}function n8(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in ZR)t.luma.caps[e]===void 0&&(t.luma.caps[e]=XR(t,e));return t.luma.caps}function XR(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=r8(t,e)),t.luma.caps[e]||hn.log(e8,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function r8(t,e){const n=ZR[e];Ht(n,e);let r;const i=Fn(t)&&n[1]||n[0];if(typeof i=="function")r=i(t);else if(Array.isArray(i)){r=!0;for(const a of i)r=r&&!!t.getExtension(a)}else typeof i=="string"?r=!!t.getExtension(i):typeof i=="boolean"?r=i:Ht(!1);return r}const WC="Multiple render targets not supported";class vi extends _l{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:r,colorBufferHalfFloat:i}=n;let a=!0;return r&&(a=!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),i&&(a=a&&!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),a}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new vi(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=bs(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=bs(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:r=1,attachments:i=null,color:a=!0,depth:h=!0,stencil:l=!1,check:m=!0,readBuffer:_=void 0,drawBuffers:E=void 0}=e;if(Ht(n>=0&&r>=0,"Width and height need to be integers"),this.width=n,this.height=r,i)for(const S in i){const I=i[S];(Array.isArray(I)?I[0]:I).resize({width:n,height:r})}else i=this._createDefaultAttachments(a,h,l,n,r);this.update({clearAttachments:!0,attachments:i,readBuffer:_,drawBuffers:E}),i&&m&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:r,drawBuffers:i,clearAttachments:a=!1,resizeAttachments:h=!0}=e;this.attach(n,{clearAttachments:a,resizeAttachments:h});const{gl:l}=this,m=l.bindFramebuffer(36160,this.handle);return r&&this._setReadBuffer(r),i&&this._setDrawBuffers(i),l.bindFramebuffer(36160,m||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:r}=e;if(this.handle===null)return Ht(n===void 0&&r===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),r===void 0&&(r=this.gl.drawingBufferHeight),n!==this.width&&r!==this.height&&hn.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(r))();for(const i in this.attachments)this.attachments[i].resize({width:n,height:r});return this.width=n,this.height=r,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:r=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i={};n&&Object.keys(this.attachments).forEach(h=>{i[h]=null}),Object.assign(i,e);const a=this.gl.bindFramebuffer(36160,this.handle);for(const h in i){Ht(h!==void 0,"Misspelled framebuffer binding point?");const l=Number(h),m=i[l];let _=m;if(!_)this._unattach(l);else if(_ instanceof jh)this._attachRenderbuffer({attachment:l,renderbuffer:_});else if(Array.isArray(m)){const[E,S=0,I=0]=m;_=E,this._attachTexture({attachment:l,texture:E,layer:S,level:I})}else this._attachTexture({attachment:l,texture:_,layer:0,level:0});r&&_&&_.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,a||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(h=>!this.attachments[h]).forEach(h=>{delete this.attachments[h]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(s8(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),r=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),r}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:r,stencil:i,drawBuffers:a=[]}=e,h=this.gl.bindFramebuffer(36160,this.handle);return(n||r||i)&&J2(this.gl,{color:n,depth:r,stencil:i}),a.forEach((l,m)=>{XU(this.gl,{drawBuffer:m,value:l})}),this.gl.bindFramebuffer(36160,h||null),this}readPixels(){return hn.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return hn.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return hn.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return hn.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return hn.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return hn.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:r=0,y:i=0,width:a,height:h}=e;const l=bs(this.gl),m=l.bindFramebuffer(36008,this.handle);return r===0&&i===0&&a===void 0&&h===void 0?l.invalidateFramebuffer(36008,n):l.invalidateFramebuffer(36008,n,r,i,a,h),l.bindFramebuffer(36008,m),this}getAttachmentParameter(e,n,r){let i=this._getAttachmentParameterFallback(n);return i===null&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),r&&i>1e3&&(i=fc(this.gl,i)),i}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const a of r){const h=n?fc(this.gl,a):a;i[h]=this.getAttachmentParameter(e,a,n)}return i}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),r={};for(const i of n){const a=Number(i),h=e?fc(this.gl,a):a;r[h]=this.getAttachmentParameters(a,e)}return r}show(){return typeof window<"u"&&window.open(HC(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>hn.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const r=HC(this,{targetMaxHeight:100});return hn.image({logLevel:e,message:n,image:r},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,r,i,a){let h=null;return e&&(h=h||{},h[36064]=new oa(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:a,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(h[36064])),n&&r?(h=h||{},h[33306]=new jh(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(h[33306])):n?(h=h||{},h[36096]=new jh(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:a}),this.ownResources.push(h[36096])):r&&Ht(!1),h}_unattach(e){const n=this.attachments[e];n&&(n instanceof jh?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:r}=e;const{gl:i}=this;i.framebufferRenderbuffer(36160,n,36161,r.handle),this.attachments[n]=r}_attachTexture(e){let{attachment:n=36064,texture:r,layer:i,level:a}=e;const{gl:h}=this;switch(h.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:bs(h).framebufferTextureLayer(36160,n,r.target,a,i);break;case 34067:const m=i8(i);h.framebufferTexture2D(36160,n,m,r.handle,a);break;case 3553:h.framebufferTexture2D(36160,n,3553,r.handle,a);break;default:Ht(!1,"Illegal texture type")}h.bindTexture(r.target,null),this.attachments[n]=r}_setReadBuffer(e){const n=RB(this.gl);n?n.readBuffer(e):Ht(e===36064||e===1029,WC),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,r=bs(n);if(r)r.drawBuffers(e);else{const i=n.getExtension("WEBGL_draw_buffers");i?i.drawBuffersWEBGL(e):Ht(e.length===1&&(e[0]===36064||e[0]===1029),WC)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=n8(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function i8(t){return t<34069?t+34069:t}function s8(t){return(vi.STATUS||{})[t]||"Framebuffer error ".concat(t)}const o8=[36049,36048,33296,33298,33299,33300,33301,33302,33303];vi.ATTACHMENT_PARAMETERS=o8;function a8(t,e){Ht(t instanceof oa||t instanceof WR||t instanceof GU);const n=t.constructor,{gl:r,width:i,height:a,format:h,type:l,dataFormat:m,border:_,mipmaps:E}=t,S=Object.assign({width:i,height:a,format:h,type:l,dataFormat:m,border:_,mipmaps:E},e);return new n(r,S)}function l8(t,e){const{gl:n,width:r,height:i,id:a}=t;return new vi(n,Object.assign({},e,{id:"framebuffer-for-".concat(a),width:r,height:i,attachments:{36064:t}}))}function Jy(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,r=t.match(n);return r?r[1]:e}const c8=35632,u8=35633;function h8(t){switch(t){case c8:return"fragment";case u8:return"vertex";default:return"unknown type"}}function d8(t,e,n,r){const i=t.split(/\r?\n/),a={},h={},l=r||Jy(e)||"(unnamed)",m="".concat(h8(n)," shader ").concat(l);for(let E=0;E<i.length;E++){const S=i[E];if(S.length<=1)continue;const I=S.split(":"),L=I[0],O=parseInt(I[2],10);if(isNaN(O))throw new Error("GLSL compilation error in ".concat(m,": ").concat(t));L!=="WARNING"?a[O]=S:h[O]=S}const _=f8(e);return{shaderName:m,errors:qC(a,_),warnings:qC(h,_)}}function qC(t,e){let n="";for(let r=0;r<e.length;r++){const i=e[r];if(!(!t[r+3]&&!t[r+2]&&!t[r+1])&&(n+="".concat(i,`
`),t[r+1])){const a=t[r+1],h=a.split(":",3),l=h[0],m=parseInt(h[1],10)||0,_=a.substring(h.join(":").length+1).trim();n+=YR("^^^ ".concat(l,": ").concat(_,`

`),m)}}return n}function f8(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map((a,h)=>{const l=String(h+e),m=l.length;return YR(l,i-m)+n+a})}function YR(t,e){let n="";for(let r=0;r<e;++r)n+=" ";return"".concat(n).concat(t)}function KR(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&n[0]==="#version"){const r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}return e}const p8="Shader: GLSL source code must be a JavaScript string";class tm extends _l{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return Ht(!1),"unknown"}}constructor(e,n){P_(e),Ht(typeof n.source=="string",p8);const r=Jy(n.source,null)||n.id||_c("unnamed ".concat(tm.getTypeName(n.shaderType)));super(e,{id:r}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const r=Jy(n,null);r&&(this.id=_c(r)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(tm.getTypeName(this.shaderType),":").concat(this.id)}getName(){return Jy(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const r=this.gl.getShaderInfoLog(this.handle),{shaderName:i,errors:a,warnings:h}=d8(r,this.source,this.shaderType,this.id);throw hn.error("GLSL compilation errors in ".concat(i,`
`).concat(a))(),hn.warn("GLSL compilation warnings in ".concat(i,`
`).concat(h))(),new Error("GLSL compilation errors in ".concat(i))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class fx extends tm{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class px extends tm{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const m8={5126:Er.bind(null,"uniform1fv",qs,1,ns),35664:Er.bind(null,"uniform2fv",qs,2,ns),35665:Er.bind(null,"uniform3fv",qs,3,ns),35666:Er.bind(null,"uniform4fv",qs,4,ns),5124:Er.bind(null,"uniform1iv",jl,1,ns),35667:Er.bind(null,"uniform2iv",jl,2,ns),35668:Er.bind(null,"uniform3iv",jl,3,ns),35669:Er.bind(null,"uniform4iv",jl,4,ns),35670:Er.bind(null,"uniform1iv",jl,1,ns),35671:Er.bind(null,"uniform2iv",jl,2,ns),35672:Er.bind(null,"uniform3iv",jl,3,ns),35673:Er.bind(null,"uniform4iv",jl,4,ns),35674:Er.bind(null,"uniformMatrix2fv",qs,4,Ya),35675:Er.bind(null,"uniformMatrix3fv",qs,9,Ya),35676:Er.bind(null,"uniformMatrix4fv",qs,16,Ya),35678:Ni,35680:Ni,5125:Er.bind(null,"uniform1uiv",cy,1,ns),36294:Er.bind(null,"uniform2uiv",cy,2,ns),36295:Er.bind(null,"uniform3uiv",cy,3,ns),36296:Er.bind(null,"uniform4uiv",cy,4,ns),35685:Er.bind(null,"uniformMatrix2x3fv",qs,6,Ya),35686:Er.bind(null,"uniformMatrix2x4fv",qs,8,Ya),35687:Er.bind(null,"uniformMatrix3x2fv",qs,6,Ya),35688:Er.bind(null,"uniformMatrix3x4fv",qs,12,Ya),35689:Er.bind(null,"uniformMatrix4x2fv",qs,8,Ya),35690:Er.bind(null,"uniformMatrix4x3fv",qs,12,Ya),35678:Ni,35680:Ni,35679:Ni,35682:Ni,36289:Ni,36292:Ni,36293:Ni,36298:Ni,36299:Ni,36300:Ni,36303:Ni,36306:Ni,36307:Ni,36308:Ni,36311:Ni},g8={},y8={},_8={},ZC=[0];function eE(t,e,n,r){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(ZC[0]=t,t=ZC);const i=t.length;if(i%e&&hn.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let a=r[i];a||(a=new n(i),r[i]=a);for(let h=0;h<i;h++)a[h]=t[h];return a}function qs(t,e){return eE(t,e,Float32Array,g8)}function jl(t,e){return eE(t,e,Int32Array,y8)}function cy(t,e){return eE(t,e,Uint32Array,_8)}function XC(t,e,n){const r=m8[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r().bind(null,t,e)}function v8(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:!!n[2]}}function x8(t,e,n){for(const r in t){const i=t[r];if((!n||!!n[r])&&!b8(i))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(r),i),new Error("".concat(e," Bad uniform ").concat(r))}return!0}function b8(t){return Array.isArray(t)||ArrayBuffer.isView(t)?E8(t):isFinite(t)||t===!0||t===!1||t instanceof fd||t instanceof jh?!0:t instanceof vi?!!t.texture:!1}function w8(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const r=t[e];for(let i=0,a=n.length;i<a;++i)r[i]=n[i]}else t[e]=n.slice();else t[e]=n}function E8(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Ni(){let t=null;return(e,n,r)=>{const i=t!==r;return i&&(e.uniform1i(n,r),t=r),i}}function Er(t,e,n,r){let i=null,a=null;return(h,l,m)=>{const _=e(m,n),E=_.length;let S=!1;if(i===null)i=new Float32Array(E),a=E,S=!0;else{Ht(a===E,"Uniform length cannot change.");for(let I=0;I<E;++I)if(_[I]!==i[I]){S=!0;break}}return S&&(r(h,t,l,_),i.set(_)),S}}function ns(t,e,n,r){t[e](n,r)}function Ya(t,e,n,r){t[e](n,!1,r)}const T8=5120,S8=5121,P8=5122,C8=5123,YC=0,uy=1,A8=2,I8=3,hy=4,M8=5,k8=6,gi=5126,L8=35664,R8=35665,O8=35666,Xf=5124,D8=35667,z8=35668,F8=35669,Yf=5125,N8=36294,B8=36295,U8=36296,V8=35670,j8=35671,$8=35672,G8=35673,H8=35674,W8=35675,q8=35676,Z8=35685,X8=35686,Y8=35687,K8=35688,J8=35689,Q8=35690,tw={[gi]:[gi,1,"float"],[L8]:[gi,2,"vec2"],[R8]:[gi,3,"vec3"],[O8]:[gi,4,"vec4"],[Xf]:[Xf,1,"int"],[D8]:[Xf,2,"ivec2"],[z8]:[Xf,3,"ivec3"],[F8]:[Xf,4,"ivec4"],[Yf]:[Yf,1,"uint"],[N8]:[Yf,2,"uvec2"],[B8]:[Yf,3,"uvec3"],[U8]:[Yf,4,"uvec4"],[V8]:[gi,1,"bool"],[j8]:[gi,2,"bvec2"],[$8]:[gi,3,"bvec3"],[G8]:[gi,4,"bvec4"],[H8]:[gi,8,"mat2"],[Z8]:[gi,8,"mat2x3"],[X8]:[gi,8,"mat2x4"],[W8]:[gi,12,"mat3"],[Y8]:[gi,12,"mat3x2"],[K8]:[gi,12,"mat3x4"],[q8]:[gi,16,"mat4"],[J8]:[gi,16,"mat4x2"],[Q8]:[gi,16,"mat4x3"]};function eV(t){switch(t){case YC:return YC;case uy:return uy;case I8:return uy;case A8:return uy;case hy:return hy;case M8:return hy;case k8:return hy;default:return Ht(!1),0}}function KC(t){const e=tw[t];if(!e)return null;const[n,r]=e;return{type:n,components:r}}function JR(t,e){switch(t){case T8:case S8:case P8:case C8:t=gi;break}for(const n in tw){const[r,i,a]=tw[n];if(r===t&&i===e)return{glType:n,name:a}}return null}class tV{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,r=n.getProgramParameter(e.handle,35721);for(let i=0;i<r;i++){const{name:a,type:h,size:l}=n.getActiveAttrib(e.handle,i),m=n.getAttribLocation(e.handle,a);m>=0&&this._addAttribute(m,a,h,l)}this.attributeInfos.sort((i,a)=>i.location-a.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!Fn(n))return;const r=n.getProgramParameter(e.handle,35971);for(let i=0;i<r;i++){const{name:a,type:h,size:l}=n.getTransformFeedbackVarying(e.handle,i);this._addVarying(i,a,h,l)}this.varyingInfos.sort((i,a)=>i.location-a.location)}_addAttribute(e,n,r,i){const{type:a,components:h}=KC(r),l={type:a,size:i*h};this._inferProperties(e,n,l);const m={location:e,name:n,accessor:new Js(l)};this.attributeInfos.push(m),this.attributeInfosByLocation[e]=m,this.attributeInfosByName[m.name]=m}_inferProperties(e,n,r){/instance/i.test(n)&&(r.divisor=1)}_addVarying(e,n,r,i){const{type:a,components:h}=KC(r),l=new Js({type:a,size:i*h}),m={location:e,name:n,accessor:l};this.varyingInfos.push(m),this.varyingInfosByName[m.name]=m}}const JC=4,nV=35981,rV=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class QR extends _l{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",rV),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:r,fs:i,varyings:a,bufferMode:h=nV}=e;return this.hash=n||"",this.vs=typeof r=="string"?new fx(this.gl,{id:"".concat(e.id,"-vs"),source:r}):r,this.fs=typeof i=="string"?new px(this.gl,{id:"".concat(e.id,"-fs"),source:i}):i,Ht(this.vs instanceof fx),Ht(this.fs instanceof px),this.uniforms={},this._textureUniforms={},a&&a.length>0&&(bs(this.gl),this.varyings=a,this.gl2.transformFeedbackVaryings(this.handle,a,h)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new tV(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:r=4,vertexCount:i,offset:a=0,start:h,end:l,isIndexed:m=!1,indexType:_=5123,instanceCount:E=0,isInstanced:S=E>0,vertexArray:I=null,transformFeedback:L,framebuffer:O,parameters:D={},uniforms:H,samplers:z}=e;if((H||z)&&(hn.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(H||{})),hn.priority>=n){const N=O?O.id:"default",F="mode=".concat(fc(this.gl,r)," verts=").concat(i," ")+"instances=".concat(E," indexType=").concat(fc(this.gl,_)," ")+"isInstanced=".concat(S," isIndexed=").concat(m," ")+"Framebuffer=".concat(N);hn.log(n,F)()}return Ht(I),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||i===0||S&&E===0?!1:(I.bindForDraw(i,E,()=>{if(O!==void 0&&(D=Object.assign({},D,{framebuffer:O})),L){const N=eV(r);L.begin(N)}this._bindTextures(),ia(this.gl,D,()=>{m&&S?this.gl2.drawElementsInstanced(r,i,_,a,E):m&&Fn(this.gl)&&!isNaN(h)&&!isNaN(l)?this.gl2.drawRangeElements(r,h,l,i,_,a):m?this.gl.drawElements(r,i,_,a):S?this.gl2.drawArraysInstanced(r,a,i,E):this.gl.drawArrays(r,a,i)}),L&&L.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};hn.priority>=2&&x8(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const r=e[n],i=this._uniformSetters[n];if(i){let a=r,h=!1;if(a instanceof vi&&(a=a.texture),a instanceof fd)if(h=this.uniforms[n]!==r,h){i.textureIndex===void 0&&(i.textureIndex=this._textureIndexCounter++);const l=a,{textureIndex:m}=i;l.bind(m),a=m,this._textureUniforms[n]=l}else a=i.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(i(a)||h)&&w8(this.uniforms,n,r)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const r=this._textureUniforms[n];r.update(),e=e&&r.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),r={};for(const i of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:r.vs=new fx({handle:i});break;case 35632:r.fs=new px({handle:i});break}return r}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=_c(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),hn.time(JC,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),hn.timeEnd(JC,"linkProgram for ".concat(this._getName()))(),e.debug||hn.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const r=this.gl.getActiveUniform(this.handle,n),{name:i}=v8(r.name);let a=e.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=XC(e,a,r),r.size>1)for(let h=0;h<r.size;h++)a=e.getUniformLocation(this.handle,"".concat(i,"[").concat(h,"]")),this._uniformSetters["".concat(i,"[").concat(h,"]")]=XC(e,a,r)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}}const iV=34918,sV=34919,oV=35007,aV=36795,lV=35976,cV=35887,uV=36202;class U0 extends _l{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=Fn(e),i=Q2(e,Sr.TIMER_QUERY);let a=r||i;for(const h of n)switch(h){case"queries":a=a&&r;break;case"timers":a=a&&i;break;default:Ht(!1)}return a}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(oV)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(e?uV:cV)}beginTransformFeedbackQuery(){return this.begin(lV)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,sV);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(aV)}getResult(){return this.gl2.getQueryParameter(this.handle,iV)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((r,i)=>{const a=()=>{this.isResultAvailable()?(r(this.getResult()),this._pollingPromise=null):n++>e?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(a)};requestAnimationFrame(a)}),this._pollingPromise}_createHandle(){return U0.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class e3 extends _l{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return Fn(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};bs(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,dd(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const r=this._getVaryingIndex(e),{buffer:i,byteSize:a,byteOffset:h}=this._getBufferParams(n);return r<0?(this.unused[e]=i,hn.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[r]=n,this.bindOnUse||this._bindBuffer(r,i,h,a),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,r,i;return e instanceof ur?i=e:(i=e.buffer,r=e.byteSize,n=e.byteOffset),(n!==void 0||r!==void 0)&&(n=n||0,r=r||i.byteLength-n),{buffer:i,byteOffset:n,byteSize:r}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:r,byteOffset:i}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,i,r)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const a=n&&n.handle;return!a||i===void 0?this.gl.bindBufferBase(35982,e,a):this.gl.bindBufferRange(35982,e,a,r,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}let dy=null;function hV(t){return(!dy||dy.byteLength<t)&&(dy=new ArrayBuffer(t)),dy}function dV(t,e){const n=hV(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function fV(t){let{target:e,source:n,start:r=0,count:i=1}=t;const a=n.length,h=i*a;let l=0;for(let m=r;l<a;l++)e[m++]=n[l];for(;l<h;)l<h-l?(e.copyWithin(r+l,r,r+l),l*=2):(e.copyWithin(r+l,r,r+h-l),l=h);return e}const pV="elements must be GL.ELEMENT_ARRAY_BUFFER";class Xs extends _l{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?Fn(e)||OR()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new Xs(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return Xs.MAX_ATTRIBUTES=Xs.MAX_ATTRIBUTES||e.getParameter(34921),Xs.MAX_ATTRIBUTES}static setConstant(e,n,r){switch(r.constructor){case Float32Array:Xs._setConstantFloatArray(e,n,r);break;case Int32Array:Xs._setConstantIntArray(e,n,r);break;case Uint32Array:Xs._setConstantUintArray(e,n,r);break;default:Ht(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:r})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Xs.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Ht(!e||e.target===34963,pV),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,r){if(n.target===34963)return this.setElementBuffer(n,r);const{size:i,type:a,stride:h,offset:l,normalized:m,integer:_,divisor:E}=r,{gl:S,gl2:I}=this;return e=Number(e),this.bind(()=>{S.bindBuffer(34962,n.handle),_?(Ht(Fn(S)),I.vertexAttribIPointer(e,i,a,h,l)):S.vertexAttribPointer(e,i,a,m,h,l),S.enableVertexAttribArray(e),I.vertexAttribDivisor(e,E||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!Xs.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const r=this._normalizeConstantArrayValue(n),i=r.byteLength*e,a=r.length*e;let h=!this.buffer;if(this.buffer=this.buffer||new ur(this.gl,i),h=h||this.buffer.reallocate(i),h=h||!this._compareConstantArrayValues(r,this.bufferValue),h){const l=dV(n.constructor,a);fV({target:l,source:r,start:0,count:a}),this.buffer.subData(l),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==n[r])return!1;return!0}static _setConstantFloatArray(e,n,r){switch(r.length){case 1:e.vertexAttrib1fv(n,r);break;case 2:e.vertexAttrib2fv(n,r);break;case 3:e.vertexAttrib3fv(n,r);break;case 4:e.vertexAttrib4fv(n,r);break;default:Ht(!1)}}static _setConstantIntArray(e,n,r){switch(Ht(Fn(e)),r.length){case 1:e.vertexAttribI1iv(n,r);break;case 2:e.vertexAttribI2iv(n,r);break;case 3:e.vertexAttribI3iv(n,r);break;case 4:e.vertexAttribI4iv(n,r);break;default:Ht(!1)}}static _setConstantUintArray(e,n,r){switch(Ht(Fn(e)),r.length){case 1:e.vertexAttribI1uiv(n,r);break;case 2:e.vertexAttribI2uiv(n,r);break;case 3:e.vertexAttribI3uiv(n,r);break;case 4:e.vertexAttribI4uiv(n,r);break;default:Ht(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:r}=n;return Ht(Number.isFinite(r)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(r,e);default:return this.gl.getVertexAttrib(r,e)}})}}const mV="VertexArray: attributes must be Buffers or constants (i.e. typed array)",gV=/^(.+)__LOCATION_([0-9]+)$/,yV=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class _V{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;this.id=r,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Xs(e),jR(this,"VertexArray","v6.0",yV),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const r=e[n];this._setAttribute(n,r)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,r);const{location:i,accessor:a}=this._resolveLocationAndAccessor(e,n,n.accessor,r);return i>=0&&(this.values[i]=n,this.accessors[i]=a,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,n,a)),this}setConstant(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:i,accessor:a}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},r));return i>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[i]=n,this.accessors[i]=a,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new ur(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof ur&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof ur&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,r){let i;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),i=r()}),i}_resolveLocationAndAccessor(e,n,r,i){const a={location:-1,accessor:null},{location:h,name:l}=this._getAttributeIndex(e);if(!Number.isFinite(h)||h<0)return this.unused[e]=n,hn.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),a;const m=this._getAttributeInfo(l||h);if(!m)return a;const _=this.accessors[h]||{},E=Js.resolve(m.accessor,_,r,i),{size:S,type:I}=E;return Ht(Number.isFinite(S)&&Number.isFinite(I)),{location:h,accessor:E}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const r=gV.exec(e),i=r?r[1]:e,a=r?Number(r[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+a,name:i}:{location:-1}}_setAttribute(e,n){if(n instanceof ur)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof ur){const r=n[0],i=n[1];this.setBuffer(e,r,i)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const r=n;this.setConstant(e,r)}else if(n.buffer instanceof ur){const r=n;this.setBuffer(e,r.buffer,r)}else throw new Error(mV)}_setConstantAttributes(e,n){const r=Math.max(e|0,n|0);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,r);for(let a=1;a<this.vertexArrayObject.MAX_ATTRIBUTES;a++)i=this.values[a],ArrayBuffer.isView(i)&&this._setConstantAttribute(a,i)}_setConstantAttributeZero(e,n){if(Xs.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const r=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,r,this.accessors[0])}_setConstantAttribute(e,n){Xs.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const r=this.values[n],i=this.accessors[n];if(!r)return;const{divisor:a}=i,h=a>0;if(e.isInstanced=e.isInstanced||h,r instanceof ur){const l=r;if(h){const m=l.getVertexCount(i);e.instanceCount=Math.min(e.instanceCount,m)}else{const m=l.getVertexCount(i);e.vertexCount=Math.min(e.vertexCount,m)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return hn.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}function vV(t,e){const{maxElts:n=16,size:r=1}=e;let i="[";for(let h=0;h<t.length&&h<n;++h)h>0&&(i+=",".concat(h%r===0?" ":"")),i+=nm(t[h],e);const a=t.length>n?"...":"]";return"".concat(i).concat(a)}function nm(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:r=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return vV(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return r?"0":"0.";if(r||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const i=t.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function QC(t){let{header:e="Uniforms",program:n,uniforms:r,undefinedOnly:i=!1}=t;Ht(n);const a=".*_.*",h=".*Matrix",l=n._uniformSetters,m={},_=Object.keys(l).sort();let E=0;for(const L of _)!L.match(a)&&!L.match(h)&&mx({table:m,header:e,uniforms:r,uniformName:L,undefinedOnly:i})&&E++;for(const L of _)L.match(h)&&mx({table:m,header:e,uniforms:r,uniformName:L,undefinedOnly:i})&&E++;for(const L of _)m[L]||mx({table:m,header:e,uniforms:r,uniformName:L,undefinedOnly:i})&&E++;let S=0;const I={};if(!i)for(const L in r){const O=r[L];m[L]||(S++,I[L]={Type:"NOT USED: ".concat(O),[e]:nm(O)})}return{table:m,count:E,unusedTable:I,unusedCount:S}}function mx(t){let{table:e,header:n,uniforms:r,uniformName:i,undefinedOnly:a}=t;const h=r[i],l=xV(h);return!a||!l?(e[i]={[n]:l?nm(h):"N/A","Uniform Type":l?h:"NOT PROVIDED"},!0):!1}function xV(t){return t!=null}function bV(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const r={};e.elements&&(r.ELEMENT_ARRAY_BUFFER=eA(e,e.elements,null,n));const i=e.values;for(const a in i){const h=e._getAttributeInfo(a);if(h){let l="".concat(a,": ").concat(h.name);const m=e.accessors[h.location];m&&(l="".concat(a,": ").concat(wV(h.name,m))),r[l]=eA(e,i[a],m,n)}}return r}function eA(t,e,n,r){const{gl:i}=t;if(!e)return{[r]:"null","Format ":"N/A"};let a="NOT PROVIDED",h=1,l=0,m=0,_,E,S;if(n&&(a=n.type,h=n.size,a=String(a).replace("Array",""),_=a.indexOf("nt")!==-1),e instanceof ur){const I=e,{data:L,changed:O}=I.getDebugData();E=O?"*":"",S=L,m=I.byteLength,l=m/L.BYTES_PER_ELEMENT/h;let D;if(n){const H=n.divisor>0;D="".concat(H?"I ":"P "," ").concat(l," (x").concat(h,"=").concat(m," bytes ").concat(fc(i,a),")")}else _=!0,D="".concat(m," bytes");return{[r]:"".concat(E).concat(nm(S,{size:h,isInteger:_})),"Format ":D}}return S=e,h=e.length,a=String(e.constructor.name).replace("Array",""),_=a.indexOf("nt")!==-1,{[r]:"".concat(nm(S,{size:h,isInteger:_})," (constant)"),"Format ":"".concat(h,"x").concat(a," (constant)")}}function wV(t,e){const{type:n,size:r}=e,i=JR(n,r);return i?"".concat(t," (").concat(i.name,")"):t}function EV(t){const e={},n="Accessors for ".concat(t.id);for(const r of t.attributeInfos)if(r){const i=tA(r);e["in ".concat(i)]={[n]:JSON.stringify(r.accessor)}}for(const r of t.varyingInfos)if(r){const i=tA(r);e["out ".concat(i)]={[n]:JSON.stringify(r.accessor)}}return e}function tA(t){const{type:e,size:n}=t.accessor,r=JR(e,n);return r?"".concat(r.name," ").concat(t.name):t.name}const nA=yl()&&typeof document<"u";let TV=0;class SV{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:n=H=>VR(H),onAddHTML:r=null,onInitialize:i=()=>{},onRender:a=()=>{},onFinalize:h=()=>{},onError:l,gl:m=null,glOptions:_={},debug:E=!1,createFramebuffer:S=!1,autoResizeViewport:I=!0,autoResizeDrawingBuffer:L=!0,stats:O=su.get("animation-loop-".concat(TV++))}=e;let{useDevicePixels:D=!0}=e;"useDevicePixelRatio"in e&&(hn.deprecated("useDevicePixelRatio","useDevicePixels")(),D=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:r,onInitialize:i,onRender:a,onFinalize:h,onError:l,gl:m,glOptions:_,debug:E,createFramebuffer:S},this.gl=m,this.needsRedraw=null,this.timeline=null,this.stats=O,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:I,autoResizeDrawingBuffer:L,useDevicePixels:D}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return Ht(typeof e=="string"),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const n=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=U0.isSupported(this.gl,["timers"])?new U0(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(r=>{this._running&&(this._addCallbackData(r||{}),r!==!1&&this._startLoop())});return this.props.onError&&n.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const r=document.getElementById(e);return r?Number(r.value):n}setViewParameters(){return hn.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=nA?new Promise((e,n)=>{if(nA&&document.readyState==="complete"){e(document);return}window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):kU(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):MU(e)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:n,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){typeof e=="object"&&e!==null&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?X2(this.props.gl,e):this.onCreateContext(e),!S_(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");yU(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(n);const r=this.props.onAddHTML(n);r&&(n.innerHTML=r)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,n=this.gl.drawingBufferHeight;let r=1;const{canvas:i}=this.gl;return i&&i.clientHeight?r=i.clientWidth/i.clientHeight:e>0&&n>0&&(r=e/n),{width:e,height:n,aspect:r}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&wU(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new vi(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const Am="vs",tE="fs";function io(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const gx={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function PV(t){const e={};for(const n in t){const r=t[n],i=CV(r);e[n]=i}return e}function CV(t){let e=rA(t);return e==="object"?t?"type"in t?Object.assign({},t,gx[t.type]):"value"in t?(e=rA(t.value),Object.assign({type:e},t,gx[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},gx[e])}function rA(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const AV="vs",IV="fs";class iA{constructor(e){let{name:n,vs:r,fs:i,dependencies:a=[],uniforms:h,getUniforms:l,deprecations:m=[],defines:_={},inject:E={},vertexShader:S,fragmentShader:I}=e;io(typeof n=="string"),this.name=n,this.vs=r||S,this.fs=i||I,this.getModuleUniforms=l,this.dependencies=a,this.deprecations=this._parseDeprecationDefinitions(m),this.defines=_,this.injections=MV(E),h&&(this.uniforms=PV(h))}getModuleSource(e){let n;switch(e){case AV:n=this.vs||"";break;case IV:n=this.fs||"";break;default:io(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(r=>{r.regex.test(e)&&(r.deprecated?n.deprecated(r.old,r.new)():n.removed(r.old,r.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},r=this.uniforms;for(const i in r){const a=r[i];i in e&&!a.private?(a.validate&&io(a.validate(e[i],a),"".concat(this.name,": invalid ").concat(i)),n[i]=e[i]):n[i]=a.value}return n}}function MV(t){const e={vs:{},fs:{}};for(const n in t){let r=t[n];const i=n.slice(0,2);typeof r=="string"&&(r={order:0,injection:r}),e[i][n]=r}return e}function kV(t){return LV(n3(t))}function LV(t){const e={},n={};return t3({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((r,i)=>n[i]-n[r]).map(r=>e[r])}function t3(t){let{modules:e,level:n,moduleMap:r,moduleDepth:i}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const a of e)r[a.name]=a,(i[a.name]===void 0||i[a.name]<n)&&(i[a.name]=n);for(const a of e)a.dependencies&&t3({modules:a.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}function n3(t,e){return t.map(n=>(n instanceof iA||(io(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),io(n.name,"shader module has no name"),n=new iA(n),n.dependencies=n3(n.dependencies)),n))}function RV(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i}const OV=7936,DV=7937,zV=7938,FV=35724,nE={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Qc={};Object.keys(nE).forEach(t=>{Qc[t]=t});function NV(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function BV(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||OV),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||DV);return{gpuVendor:UV(n,r),vendor:n,renderer:r,version:t.getParameter(zV),shadingLanguageVersion:t.getParameter(FV)}}function UV(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const yx={};function sA(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=nE[e];if(io(r,e),!RV(n))return!0;if(e in yx)return yx[e];const i=r[0],a=n.behavior||"enable",h="#extension GL_".concat(i," : ").concat(a,`
void main(void) {}`),l=t.createShader(35633);t.shaderSource(l,h),t.compileShader(l);const m=t.getShaderParameter(l,35713);return t.deleteShader(l),yx[e]=m,m}function VV(t,e){const n=nE[e];io(n,e);const r=NV(t)&&n[1]||n[0],i=typeof r=="string"?!!t.getExtension(r):r;return io(i===!1||i===!0),i}function fy(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>VV(t,n))}function jV(t){switch(BV(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function $V(t,e,n){let r=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return fy(t,Qc.GLSL_FRAG_DEPTH)&&(r+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),fy(t,Qc.GLSL_DERIVATIVES)&&sA(t,Qc.GLSL_DERIVATIVES)&&(r+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),fy(t,Qc.GLSL_FRAG_DATA)&&sA(t,Qc.GLSL_FRAG_DATA,{behavior:"require"})&&(r+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),fy(t,Qc.GLSL_TEXTURE_LOD)&&(r+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),r}const GV=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,HV=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,WV={[Am]:GV,[tE]:HV},Qy="__LUMA_INJECT_DECLARATIONS__",oA=/void\s+main\s*\([^)]*\)\s*\{\n?/,aA=/}\n?[^{}]*$/,_x=[];function lA(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=e===Am;for(const a in n){const h=n[a];h.sort((m,_)=>m.order-_.order),_x.length=h.length;for(let m=0,_=h.length;m<_;++m)_x[m]=h[m].injection;const l="".concat(_x.join(`
`),`
`);switch(a){case"vs:#decl":i&&(t=t.replace(Qy,l));break;case"vs:#main-start":i&&(t=t.replace(oA,m=>m+l));break;case"vs:#main-end":i&&(t=t.replace(aA,m=>l+m));break;case"fs:#decl":i||(t=t.replace(Qy,l));break;case"fs:#main-start":i||(t=t.replace(oA,m=>m+l));break;case"fs:#main-end":i||(t=t.replace(aA,m=>l+m));break;default:t=t.replace(a,m=>m+l)}}return t=t.replace(Qy,""),r&&(t=t.replace(/\}\s*$/,a=>a+WV[e])),t}function nw(t){const e={};return io(Array.isArray(t)&&t.length>1),t.forEach(n=>{for(const r in n)e[r]=e[r]?"".concat(e[r],`
`).concat(n[r]):n[r]}),e}function pd(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const r3=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],qV=[...r3,[pd("attribute"),"in $1"],[pd("varying"),"out $1"]],ZV=[...r3,[pd("varying"),"in $1"]],i3=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],XV=[...i3,[pd("in"),"attribute $1"],[pd("out"),"varying $1"]],YV=[...i3,[pd("in"),"varying $1"]],rw="gl_FragColor",iw=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,KV=/void\s+main\s*\([^)]*\)\s*\{\n?/;function JV(t,e,n){switch(e){case 300:return n?V0(t,qV):QV(t);case 100:return n?V0(t,XV):ej(t);default:throw new Error("unknown GLSL version ".concat(e))}}function V0(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}function QV(t){t=V0(t,ZV);const e=t.match(iw);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(rw,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(KV,r=>"out vec4 ".concat(n,`;
`).concat(r)).replace(new RegExp("\\b".concat(rw,"\\b"),"g"),n)}return t}function ej(t){t=V0(t,YV);const e=t.match(iw);if(e){const n=e[1];t=t.replace(iw,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),rw)}return t}const tj=`

`.concat(Qy,`

`),s3={[Am]:"vertex",[tE]:"fragment"},nj=`precision highp float;

`;function rj(t,e){const{vs:n,fs:r}=e,i=kV(e.modules||[]);return{gl:t,vs:cA(t,Object.assign({},e,{source:n,type:Am,modules:i})),fs:cA(t,Object.assign({},e,{source:r,type:tE,modules:i})),getUniforms:ij(i)}}function cA(t,e){let{id:n,source:r,type:i,modules:a,defines:h={},hookFunctions:l=[],inject:m={},transpileToGLSL100:_=!1,prologue:E=!0,log:S}=e;io(typeof r=="string","shader source must be a string");const I=i===Am,L=r.split(`
`);let O=100,D="",H=r;L[0].indexOf("#version ")===0?(O=300,D=L[0],H=L.slice(1).join(`
`)):D="#version ".concat(O);const z={};a.forEach(re=>{Object.assign(z,re.getDefines())}),Object.assign(z,h);let N=E?"".concat(D,`
`).concat(oj({id:n,source:r,type:i}),`
`).concat(sj({type:i}),`
`).concat(jV(t),`
`).concat($V(t),`
`).concat(aj(z),`
`).concat(I?"":nj,`
`):"".concat(D,`
`);const F=cj(l),$={},Q={},te={};for(const re in m){const we=typeof m[re]=="string"?{injection:m[re],order:0}:m[re],Ee=re.match(/^(v|f)s:(#)?([\w-]+)$/);if(Ee){const de=Ee[2],Le=Ee[3];de?Le==="decl"?Q[re]=[we]:te[re]=[we]:$[re]=[we]}else te[re]=[we]}for(const re of a){S&&re.checkDeprecations(H,S);const we=re.getModuleSource(i,O);N+=we;const Ee=re.injections[i];for(const de in Ee){const Le=de.match(/^(v|f)s:#([\w-]+)$/);if(Le){const Be=Le[2]==="decl"?Q:te;Be[de]=Be[de]||[],Be[de].push(Ee[de])}else $[de]=$[de]||[],$[de].push(Ee[de])}}return N+=tj,N=lA(N,i,Q),N+=lj(F[i],$),N+=H,N=lA(N,i,te),N=JV(N,_?100:O,I),N}function ij(t){return function(n){const r={};for(const i of t){const a=i.getUniforms(n,r);Object.assign(r,a)}return r}}function sj(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(s3[e].toUpperCase(),`
`)}function oj(t){let{id:e,source:n,type:r}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(s3[r],`

`):""}function aj(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const r in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const i=t[r];(i||Number.isFinite(i))&&(n+="#define ".concat(r.toUpperCase()," ").concat(t[r],`
`))}return e===0&&(n+=`
`),n}function lj(t,e){let n="";for(const r in t){const i=t[r];if(n+="void ".concat(i.signature,` {
`),i.header&&(n+="  ".concat(i.header)),e[r]){const a=e[r];a.sort((h,l)=>h.order-l.order);for(const h of a)n+="  ".concat(h.injection,`
`)}i.footer&&(n+="  ".concat(i.footer)),n+=`}
`}return n}function cj(t){const e={vs:{},fs:{}};return t.forEach(n=>{let r;typeof n!="string"?(r=n,n=r.hook):r={},n=n.trim();const[i,a]=n.split(":"),h=n.replace(/\(.+/,"");e[i][h]=Object.assign(r,{signature:a})}),e}const uj="void main() {gl_FragColor = vec4(0);}",o3=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,hj=`#version 300 es
`.concat(o3);function a3(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[r,i,a]=n;if(!e.includes(r)||!i||!a)return null;const h=a.split(";")[0];return{qualifier:r,type:i,name:h}}function l3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:e=100,input:n,inputType:r,output:i}=t;if(!n)return e===300?hj:e>300?"#version ".concat(e,`
`).concat(o3):uj;const a=pj(n,r);return e>=300?"#version ".concat(e," ").concat(e===300?"es":"",`
in `).concat(r," ").concat(n,`;
out vec4 `).concat(i,`;
void main() {
  `).concat(i," = ").concat(a,`;
}`):"varying ".concat(r," ").concat(n,`;
void main() {
  gl_FragColor = `).concat(a,`;
}`)}function dj(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return io(!1),null}}function fj(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return io(!1),null}}function pj(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return io(!1),null}}const mj=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,gj={name:"fp32",vs:mj,fs:null};function uA(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}const to={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function yj(t,{precision:e=to.precision}={}){return t=_j(t),"".concat(parseFloat(t.toPrecision(e)))}function md(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function ec(t,e,n){return xj(t,r=>Math.max(e,Math.min(n,r)))}function rm(t,e,n){return md(t)?t.map((r,i)=>rm(r,e[i],n)):n*e+(1-n)*t}function im(t,e,n){const r=to.EPSILON;n&&(to.EPSILON=n);try{if(t===e)return!0;if(md(t)&&md(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!im(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=to.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{to.EPSILON=r}}function _j(t){return Math.round(t/to.EPSILON)*to.EPSILON}function vj(t){return t.clone?t.clone():new Array(t.length)}function xj(t,e,n){if(md(t)){const r=t;n=n||vj(r);for(let i=0;i<n.length&&i<r.length;++i)n[i]=e(t[i],i,n);return n}return e(t)}function bj(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class c3 extends bj(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:md(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(to)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+yj(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!im(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let i=0;i<this.ELEMENTS;++i){const a=e[i];this[i]=a+r*(n[i]-a)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(to.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function wj(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Ks(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function vx(t,e,n=""){if(to.debug&&!wj(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class Ej extends c3{get x(){return this[0]}set x(e){this[0]=Ks(e)}get y(){return this[1]}set y(e){this[1]=Ks(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const i=this[r]-e[r];n+=i*i}return Ks(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return Ks(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return uA(e>=0&&e<this.ELEMENTS,"index is out of range"),Ks(this[e])}setComponent(e,n){return uA(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}var e0=1e-6,gd=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function Tj(){var t=new gd(2);return gd!=Float32Array&&(t[0]=0,t[1]=0),t}function sw(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function Sj(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function Pj(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function Cj(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function Aj(t,e){return t[0]=-e[0],t[1]=-e[1],t}function u3(t,e,n,r){var i=e[0],a=e[1];return t[0]=i+r*(n[0]-i),t[1]=a+r*(n[1]-a),t}function Ij(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}var Mj=Sj;(function(){var t=Tj();return function(e,n,r,i,a,h){var l,m;for(n||(n=2),r||(r=0),i?m=Math.min(i*n+r,e.length):m=e.length,l=r;l<m;l+=n)t[0]=e[l],t[1]=e[l+1],a(t,t,h),e[l]=t[0],e[l+1]=t[1];return e}})();function kj(t,e,n){const r=e[0],i=e[1],a=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/a,t[1]=(n[1]*r+n[5]*i)/a,t}function h3(t,e,n){const r=e[0],i=e[1],a=e[2],h=n[3]*r+n[7]*i+n[11]*a||1;return t[0]=(n[0]*r+n[4]*i+n[8]*a)/h,t[1]=(n[1]*r+n[5]*i+n[9]*a)/h,t[2]=(n[2]*r+n[6]*i+n[10]*a)/h,t}function Lj(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}function Rj(){var t=new gd(3);return gd!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Oj(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Dj(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function zj(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Fj(t,e,n){var r=e[0],i=e[1],a=e[2],h=n[0],l=n[1],m=n[2];return t[0]=i*m-a*l,t[1]=a*h-r*m,t[2]=r*l-i*h,t}function d3(t,e,n){var r=e[0],i=e[1],a=e[2],h=n[3]*r+n[7]*i+n[11]*a+n[15];return h=h||1,t[0]=(n[0]*r+n[4]*i+n[8]*a+n[12])/h,t[1]=(n[1]*r+n[5]*i+n[9]*a+n[13])/h,t[2]=(n[2]*r+n[6]*i+n[10]*a+n[14])/h,t}function Nj(t,e,n){var r=e[0],i=e[1],a=e[2];return t[0]=r*n[0]+i*n[3]+a*n[6],t[1]=r*n[1]+i*n[4]+a*n[7],t[2]=r*n[2]+i*n[5]+a*n[8],t}function Bj(t,e,n){var r=n[0],i=n[1],a=n[2],h=n[3],l=e[0],m=e[1],_=e[2],E=i*_-a*m,S=a*l-r*_,I=r*m-i*l,L=i*I-a*S,O=a*E-r*I,D=r*S-i*E,H=h*2;return E*=H,S*=H,I*=H,L*=2,O*=2,D*=2,t[0]=l+E+L,t[1]=m+S+O,t[2]=_+I+D,t}function Uj(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[0],a[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),a[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function Vj(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),a[1]=i[1],a[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function jj(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),a[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),a[2]=i[2],t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function $j(t,e){var n=t[0],r=t[1],i=t[2],a=e[0],h=e[1],l=e[2],m=Math.sqrt(n*n+r*r+i*i),_=Math.sqrt(a*a+h*h+l*l),E=m*_,S=E&&zj(t,e)/E;return Math.acos(Math.min(Math.max(S,-1),1))}var Gj=Oj;(function(){var t=Rj();return function(e,n,r,i,a,h){var l,m;for(n||(n=3),r||(r=0),i?m=Math.min(i*n+r,e.length):m=e.length,l=r;l<m;l+=n)t[0]=e[l],t[1]=e[l+1],t[2]=e[l+2],a(t,t,h),e[l]=t[0],e[l+1]=t[1],e[l+2]=t[2];return e}})();const xx=[0,0,0];let py;class La extends Ej{static get ZERO(){return py||(py=new La(0,0,0),Object.freeze(py)),py}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&md(e)?this.copy(e):(to.debug&&(Ks(e),Ks(n),Ks(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return to.debug&&(Ks(e.x),Ks(e.y),Ks(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=Ks(e)}angle(e){return $j(this,e)}cross(e){return Fj(this,this,e),this.check()}rotateX({radians:e,origin:n=xx}){return Uj(this,this,n,e),this.check()}rotateY({radians:e,origin:n=xx}){return Vj(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=xx}){return jj(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return d3(this,this,e),this.check()}transformAsVector(e){return h3(this,this,e),this.check()}transformByMatrix3(e){return Nj(this,this,e),this.check()}transformByMatrix2(e){return Lj(this,this,e),this.check()}transformByQuaternion(e){return Bj(this,this,e),this.check()}}class Hj extends c3{toString(){let e="[";if(to.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=" ".concat(this[r*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=Ks(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[r+i];return n}setColumn(e,n){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)this[r+i]=n[i];return this}}function Wj(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function qj(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],a=e[6],h=e[7],l=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=a,t[11]=e[14],t[12]=i,t[13]=h,t[14]=l}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function ow(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],h=e[4],l=e[5],m=e[6],_=e[7],E=e[8],S=e[9],I=e[10],L=e[11],O=e[12],D=e[13],H=e[14],z=e[15],N=n*l-r*h,F=n*m-i*h,$=n*_-a*h,Q=r*m-i*l,te=r*_-a*l,re=i*_-a*m,we=E*D-S*O,Ee=E*H-I*O,de=E*z-L*O,Le=S*H-I*D,Ge=S*z-L*D,Be=I*z-L*H,Oe=N*Be-F*Ge+$*Le+Q*de-te*Ee+re*we;return Oe?(Oe=1/Oe,t[0]=(l*Be-m*Ge+_*Le)*Oe,t[1]=(i*Ge-r*Be-a*Le)*Oe,t[2]=(D*re-H*te+z*Q)*Oe,t[3]=(I*te-S*re-L*Q)*Oe,t[4]=(m*de-h*Be-_*Ee)*Oe,t[5]=(n*Be-i*de+a*Ee)*Oe,t[6]=(H*$-O*re-z*F)*Oe,t[7]=(E*re-I*$+L*F)*Oe,t[8]=(h*Ge-l*de+_*we)*Oe,t[9]=(r*de-n*Ge-a*we)*Oe,t[10]=(O*te-D*$+z*N)*Oe,t[11]=(S*$-E*te-L*N)*Oe,t[12]=(l*Ee-h*Le-m*we)*Oe,t[13]=(n*Le-r*Ee+i*we)*Oe,t[14]=(D*F-O*Q-H*N)*Oe,t[15]=(E*Q-S*F+I*N)*Oe,t):null}function Zj(t){var e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],h=t[5],l=t[6],m=t[7],_=t[8],E=t[9],S=t[10],I=t[11],L=t[12],O=t[13],D=t[14],H=t[15],z=e*h-n*a,N=e*l-r*a,F=e*m-i*a,$=n*l-r*h,Q=n*m-i*h,te=r*m-i*l,re=_*O-E*L,we=_*D-S*L,Ee=_*H-I*L,de=E*D-S*O,Le=E*H-I*O,Ge=S*H-I*D;return z*Ge-N*Le+F*de+$*Ee-Q*we+te*re}function uu(t,e,n){var r=e[0],i=e[1],a=e[2],h=e[3],l=e[4],m=e[5],_=e[6],E=e[7],S=e[8],I=e[9],L=e[10],O=e[11],D=e[12],H=e[13],z=e[14],N=e[15],F=n[0],$=n[1],Q=n[2],te=n[3];return t[0]=F*r+$*l+Q*S+te*D,t[1]=F*i+$*m+Q*I+te*H,t[2]=F*a+$*_+Q*L+te*z,t[3]=F*h+$*E+Q*O+te*N,F=n[4],$=n[5],Q=n[6],te=n[7],t[4]=F*r+$*l+Q*S+te*D,t[5]=F*i+$*m+Q*I+te*H,t[6]=F*a+$*_+Q*L+te*z,t[7]=F*h+$*E+Q*O+te*N,F=n[8],$=n[9],Q=n[10],te=n[11],t[8]=F*r+$*l+Q*S+te*D,t[9]=F*i+$*m+Q*I+te*H,t[10]=F*a+$*_+Q*L+te*z,t[11]=F*h+$*E+Q*O+te*N,F=n[12],$=n[13],Q=n[14],te=n[15],t[12]=F*r+$*l+Q*S+te*D,t[13]=F*i+$*m+Q*I+te*H,t[14]=F*a+$*_+Q*L+te*z,t[15]=F*h+$*E+Q*O+te*N,t}function j0(t,e,n){var r=n[0],i=n[1],a=n[2],h,l,m,_,E,S,I,L,O,D,H,z;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*a+e[12],t[13]=e[1]*r+e[5]*i+e[9]*a+e[13],t[14]=e[2]*r+e[6]*i+e[10]*a+e[14],t[15]=e[3]*r+e[7]*i+e[11]*a+e[15]):(h=e[0],l=e[1],m=e[2],_=e[3],E=e[4],S=e[5],I=e[6],L=e[7],O=e[8],D=e[9],H=e[10],z=e[11],t[0]=h,t[1]=l,t[2]=m,t[3]=_,t[4]=E,t[5]=S,t[6]=I,t[7]=L,t[8]=O,t[9]=D,t[10]=H,t[11]=z,t[12]=h*r+E*i+O*a+e[12],t[13]=l*r+S*i+D*a+e[13],t[14]=m*r+I*i+H*a+e[14],t[15]=_*r+L*i+z*a+e[15]),t}function rE(t,e,n){var r=n[0],i=n[1],a=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Xj(t,e,n,r){var i=r[0],a=r[1],h=r[2],l=Math.hypot(i,a,h),m,_,E,S,I,L,O,D,H,z,N,F,$,Q,te,re,we,Ee,de,Le,Ge,Be,Oe,Ke;return l<e0?null:(l=1/l,i*=l,a*=l,h*=l,m=Math.sin(n),_=Math.cos(n),E=1-_,S=e[0],I=e[1],L=e[2],O=e[3],D=e[4],H=e[5],z=e[6],N=e[7],F=e[8],$=e[9],Q=e[10],te=e[11],re=i*i*E+_,we=a*i*E+h*m,Ee=h*i*E-a*m,de=i*a*E-h*m,Le=a*a*E+_,Ge=h*a*E+i*m,Be=i*h*E+a*m,Oe=a*h*E-i*m,Ke=h*h*E+_,t[0]=S*re+D*we+F*Ee,t[1]=I*re+H*we+$*Ee,t[2]=L*re+z*we+Q*Ee,t[3]=O*re+N*we+te*Ee,t[4]=S*de+D*Le+F*Ge,t[5]=I*de+H*Le+$*Ge,t[6]=L*de+z*Le+Q*Ge,t[7]=O*de+N*Le+te*Ge,t[8]=S*Be+D*Oe+F*Ke,t[9]=I*Be+H*Oe+$*Ke,t[10]=L*Be+z*Oe+Q*Ke,t[11]=O*Be+N*Oe+te*Ke,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function f3(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[4],h=e[5],l=e[6],m=e[7],_=e[8],E=e[9],S=e[10],I=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*i+_*r,t[5]=h*i+E*r,t[6]=l*i+S*r,t[7]=m*i+I*r,t[8]=_*i-a*r,t[9]=E*i-h*r,t[10]=S*i-l*r,t[11]=I*i-m*r,t}function Yj(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[0],h=e[1],l=e[2],m=e[3],_=e[8],E=e[9],S=e[10],I=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i-_*r,t[1]=h*i-E*r,t[2]=l*i-S*r,t[3]=m*i-I*r,t[8]=a*r+_*i,t[9]=h*r+E*i,t[10]=l*r+S*i,t[11]=m*r+I*i,t}function p3(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[0],h=e[1],l=e[2],m=e[3],_=e[4],E=e[5],S=e[6],I=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i+_*r,t[1]=h*i+E*r,t[2]=l*i+S*r,t[3]=m*i+I*r,t[4]=_*i-a*r,t[5]=E*i-h*r,t[6]=S*i-l*r,t[7]=I*i-m*r,t}function Kj(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],h=n+n,l=r+r,m=i+i,_=n*h,E=r*h,S=r*l,I=i*h,L=i*l,O=i*m,D=a*h,H=a*l,z=a*m;return t[0]=1-S-O,t[1]=E+z,t[2]=I-H,t[3]=0,t[4]=E-z,t[5]=1-_-O,t[6]=L+D,t[7]=0,t[8]=I+H,t[9]=L-D,t[10]=1-_-S,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Jj(t,e,n,r,i,a,h){var l=1/(n-e),m=1/(i-r),_=1/(a-h);return t[0]=a*2*l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a*2*m,t[6]=0,t[7]=0,t[8]=(n+e)*l,t[9]=(i+r)*m,t[10]=(h+a)*_,t[11]=-1,t[12]=0,t[13]=0,t[14]=h*a*2*_,t[15]=0,t}function Qj(t,e,n,r,i){var a=1/Math.tan(e/2),h;return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(h=1/(r-i),t[10]=(i+r)*h,t[14]=2*i*r*h):(t[10]=-1,t[14]=-2*r),t}var e$=Qj;function t$(t,e,n,r,i,a,h){var l=1/(e-n),m=1/(r-i),_=1/(a-h);return t[0]=-2*l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*m,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*_,t[11]=0,t[12]=(e+n)*l,t[13]=(i+r)*m,t[14]=(h+a)*_,t[15]=1,t}var n$=t$;function r$(t,e,n,r){var i,a,h,l,m,_,E,S,I,L,O=e[0],D=e[1],H=e[2],z=r[0],N=r[1],F=r[2],$=n[0],Q=n[1],te=n[2];return Math.abs(O-$)<e0&&Math.abs(D-Q)<e0&&Math.abs(H-te)<e0?Wj(t):(E=O-$,S=D-Q,I=H-te,L=1/Math.hypot(E,S,I),E*=L,S*=L,I*=L,i=N*I-F*S,a=F*E-z*I,h=z*S-N*E,L=Math.hypot(i,a,h),L?(L=1/L,i*=L,a*=L,h*=L):(i=0,a=0,h=0),l=S*h-I*a,m=I*i-E*h,_=E*a-S*i,L=Math.hypot(l,m,_),L?(L=1/L,l*=L,m*=L,_*=L):(l=0,m=0,_=0),t[0]=i,t[1]=l,t[2]=E,t[3]=0,t[4]=a,t[5]=m,t[6]=S,t[7]=0,t[8]=h,t[9]=_,t[10]=I,t[11]=0,t[12]=-(i*O+a*D+h*H),t[13]=-(l*O+m*D+_*H),t[14]=-(E*O+S*D+I*H),t[15]=1,t)}function i$(){var t=new gd(4);return gd!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function s$(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function Im(t,e,n){var r=e[0],i=e[1],a=e[2],h=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*a+n[12]*h,t[1]=n[1]*r+n[5]*i+n[9]*a+n[13]*h,t[2]=n[2]*r+n[6]*i+n[10]*a+n[14]*h,t[3]=n[3]*r+n[7]*i+n[11]*a+n[15]*h,t}(function(){var t=i$();return function(e,n,r,i,a,h){var l,m;for(n||(n=4),r||(r=0),i?m=Math.min(i*n+r,e.length):m=e.length,l=r;l<m;l+=n)t[0]=e[l],t[1]=e[l+1],t[2]=e[l+2],t[3]=e[l+3],a(t,t,h),e[l]=t[0],e[l+1]=t[1],e[l+2]=t[2],e[l+3]=t[3];return e}})();var aw;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(aw||(aw={}));const o$=45*Math.PI/180,a$=1,bx=.1,wx=500,l$=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class Ra extends Hj{static get IDENTITY(){return u$()}static get ZERO(){return c$()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return aw}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,i,a,h,l,m,_,E,S,I,L,O,D,H){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=a,this[5]=h,this[6]=l,this[7]=m,this[8]=_,this[9]=E,this[10]=S,this[11]=I,this[12]=L,this[13]=O,this[14]=D,this[15]=H,this.check()}setRowMajor(e,n,r,i,a,h,l,m,_,E,S,I,L,O,D,H){return this[0]=e,this[1]=a,this[2]=_,this[3]=L,this[4]=n,this[5]=h,this[6]=E,this[7]=O,this[8]=r,this[9]=l,this[10]=S,this[11]=D,this[12]=i,this[13]=m,this[14]=I,this[15]=H,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(l$)}fromObject(e){return this.check()}fromQuaternion(e){return Kj(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:i,top:a,near:h=bx,far:l=wx}=e;return l===1/0?h$(this,n,r,i,a,h):Jj(this,n,r,i,a,h,l),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:i=[0,1,0]}=e;return r$(this,n,r,i),this.check()}ortho(e){const{left:n,right:r,bottom:i,top:a,near:h=bx,far:l=wx}=e;return n$(this,n,r,i,a,h,l),this.check()}orthographic(e){const{fovy:n=o$,aspect:r=a$,focalDistance:i=1,near:a=bx,far:h=wx}=e;hA(n);const l=n/2,m=i*Math.tan(l),_=m*r;return this.ortho({left:-_,right:_,bottom:-m,top:m,near:a,far:h})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:i=.1,far:a=500}=e;return hA(n),e$(this,n,r,i,a),this.check()}determinant(){return Zj(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],a=1/r[1],h=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*a,e[2]=this[2]*h,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*a,e[6]=this[6]*h,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*a,e[10]=this[10]*h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],a=1/r[1],h=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*a,e[2]=this[2]*h,e[3]=this[4]*i,e[4]=this[5]*a,e[5]=this[6]*h,e[6]=this[8]*i,e[7]=this[9]*a,e[8]=this[10]*h,e}transpose(){return qj(this,this),this.check()}invert(){return ow(this,this),this.check()}multiplyLeft(e){return uu(this,e,this),this.check()}multiplyRight(e){return uu(this,this,e),this.check()}rotateX(e){return f3(this,this,e),this.check()}rotateY(e){return Yj(this,this,e),this.check()}rotateZ(e){return p3(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return Xj(this,this,e,n),this.check()}scale(e){return rE(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return j0(this,this,e),this.check()}transform(e,n){return e.length===4?(n=Im(n||[-0,-0,-0,-0],e,this),vx(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let i;switch(r){case 2:i=Ij(n||[-0,-0],e,this);break;case 3:i=d3(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return vx(i,e.length),i}transformAsVector(e,n){let r;switch(e.length){case 2:r=kj(n||[-0,-0],e,this);break;case 3:r=h3(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return vx(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let my,gy;function c$(){return my||(my=new Ra([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(my)),my}function u$(){return gy||(gy=new Ra,Object.freeze(gy)),gy}function hA(t){if(t>Math.PI*2)throw Error("expected radians")}function h$(t,e,n,r,i,a){const h=2*a/(n-e),l=2*a/(i-r),m=(n+e)/(n-e),_=(i+r)/(i-r),E=-1,S=-1,I=-2*a;return t[0]=h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=m,t[9]=_,t[10]=E,t[11]=S,t[12]=0,t[13]=0,t[14]=I,t[15]=0,t}const dA=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,d$={lightSources:{}};function Ex(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.map(n=>n*e/255)}function f$(t){let{ambientLight:e,pointLights:n=[],directionalLights:r=[]}=t;const i={};return e?i["lighting_uAmbientLight.color"]=Ex(e):i["lighting_uAmbientLight.color"]=[0,0,0],n.forEach((a,h)=>{i["lighting_uPointLight[".concat(h,"].color")]=Ex(a),i["lighting_uPointLight[".concat(h,"].position")]=a.position,i["lighting_uPointLight[".concat(h,"].attenuation")]=a.attenuation||[1,0,0]}),i.lighting_uPointLightCount=n.length,r.forEach((a,h)=>{i["lighting_uDirectionalLight[".concat(h,"].color")]=Ex(a),i["lighting_uDirectionalLight[".concat(h,"].direction")]=a.direction}),i.lighting_uDirectionalLightCount=r.length,i}function m3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:d$;if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:r}=t.lightSources||{};return e||n&&n.length>0||r&&r.length>0?Object.assign({},f$({ambientLight:e,pointLights:n,directionalLights:r}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const e={pointLights:[],directionalLights:[]};for(const n of t.lights||[])switch(n.type){case"ambient":e.ambientLight=n;break;case"directional":e.directionalLights.push(n);break;case"point":e.pointLights.push(n);break}return m3({lightSources:e})}return{}}const p$={name:"lights",vs:dA,fs:dA,getUniforms:m3,defines:{MAX_LIGHTS:3}},m$=new Uint8Array([0,255,255,255]),g$={pickingSelectedColor:null,pickingHighlightColor:m$,pickingActive:!1,pickingAttribute:!1};function y$(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:g$;const e={};if(t.pickingSelectedColor!==void 0)if(!t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,r=>r/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return t.pickingActive!==void 0&&(e.picking_uActive=!!t.pickingActive,e.picking_uAttribute=!!t.pickingAttribute),e}const _$=`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,v$=`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,x$={name:"picking",vs:_$,fs:v$,getUniforms:y$},b$=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,w$={};function E$(t){const{ambient:e=.35,diffuse:n=.6,shininess:r=32,specularColor:i=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:r,lighting_uSpecularColor:i.map(a=>a/255)}}function T$(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:w$;if(!("material"in t))return{};const{material:e}=t;return e?E$(e):{lighting_uEnabled:!1}}const S$={name:"gouraud-lighting",dependencies:[p$],vs:b$,defines:{LIGHTING_VERTEX:1},getUniforms:T$},P$=`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,C$={name:"transform",vs:P$,fs:null};class Mm{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new Mm(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:r="",defines:i={},inject:a={},varyings:h=[],bufferMode:l=35981,transpileToGLSL100:m=!1}=e,_=this._getModuleList(e.modules),E=this._getHash(n),S=this._getHash(r),I=_.map(F=>this._getHash(F.name)).sort(),L=h.map(F=>this._getHash(F)),O=Object.keys(i).sort(),D=Object.keys(a).sort(),H=[],z=[];for(const F of O)H.push(this._getHash(F)),H.push(this._getHash(i[F]));for(const F of D)z.push(this._getHash(F)),z.push(this._getHash(a[F]));const N="".concat(E,"/").concat(S,"D").concat(H.join("/"),"M").concat(I.join("/"),"I").concat(z.join("/"),"V").concat(L.join("/"),"H").concat(this.stateHash,"B").concat(l).concat(m?"T":"");if(!this._programCache[N]){const F=rj(this.gl,{vs:n,fs:r,modules:_,inject:a,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:m});this._programCache[N]=new QR(this.gl,{hash:N,vs:F.vs,fs:F.fs,varyings:h,bufferMode:l}),this._getUniforms[N]=F.getUniforms||($=>{}),this._useCounts[N]=0}return this._useCounts[N]++,this._programCache[N]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),r={};let i=0;for(let a=0,h=this._defaultModules.length;a<h;++a){const l=this._defaultModules[a],m=l.name;n[i++]=l,r[m]=!0}for(let a=0,h=e.length;a<h;++a){const l=e[a],m=l.name;r[m]||(n[i++]=l,r[m]=!0)}return n.length=i,n}}const A$={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function I$(t,e,n){const r={};let i=e.indices;for(const a in e.attributes){const h=e.attributes[a],l=M$(a,n);if(a==="indices")i=h;else if(h.constant)r[l]=h.value;else{const m=h.value,_={...h};delete _.value,r[l]=[new ur(t,m),_],k$(a,_)}}if(i){const a=i.value||i;Ht(a instanceof Uint16Array||a instanceof Uint32Array,'attribute array for "indices" must be of integer type');const h={size:1,isIndexed:i.isIndexed===void 0?!0:i.isIndexed};r.indices=[new ur(t,{data:a,target:34963}),h]}return r}function M$(t,e){const{attributeMap:n=A$}=e||{};return n&&n[t]||t}function k$(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}Ht(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const vh=2,L$=1e4,R$="Model needs drawMode and vertexCount",fA=()=>{},O$={};class sm{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:r=_c("model")}=n;Ht(S_(e)),this.id=r,this.gl=e,this.id=n.id||_c("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||Mm.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:r,fs:i,modules:a,defines:h,inject:l,varyings:m,bufferMode:_,transpileToGLSL100:E}=e;this.programProps={program:n,vs:r,fs:i,modules:a,defines:h,inject:l,varyings:m,bufferMode:_,transpileToGLSL100:E},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},Ht(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),R$)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:r,fs:i,modules:a,defines:h,inject:l,varyings:m,bufferMode:_,transpileToGLSL100:E}=e;this.programProps={program:n,vs:r,fs:i,modules:a,defines:h,inject:l,varyings:m,bufferMode:_,transpileToGLSL100:E},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return Ht(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return Ht(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=I$(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(dd(e))return this;const n={};for(const r in e){const i=e[r];n[r]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return J2(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:r,uniforms:i={},attributes:a={},transformFeedback:h=this.transformFeedback,parameters:l={},vertexArray:m=this.vertexArray}=e;this.setAttributes(a),this.updateModuleSettings(n),this.setUniforms(i);let _;hn.priority>=vh&&(_=this._logDrawCallStart(vh));const E=this.vertexArray.getDrawParams(),{isIndexed:S=E.isIndexed,indexType:I=E.indexType,indexOffset:L=E.indexOffset,vertexArrayInstanced:O=E.isInstanced}=this.props;O&&!this.isInstanced&&hn.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:D,instanceCount:H}=this,{onBeforeRender:z=fA,onAfterRender:N=fA}=this.props;z(),this.program.setUniforms(this.uniforms);const F=this.program.draw(Object.assign(O$,e,{logPriority:_,uniforms:null,framebuffer:r,parameters:l,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:m,transformFeedback:h,isIndexed:S,indexType:I,isInstanced:D,instanceCount:H,offset:S?L:0}));return N(),hn.priority>=vh&&this._logDrawCallEnd(_,m,r),F}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:r,unbindModels:i=[]}=e;let{parameters:a}=e;r&&this._setFeedbackBuffers(r),n&&(a=Object.assign({},a,{35977:n})),i.forEach(h=>h.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:a}))}finally{i.forEach(h=>h.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return hn.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:r,fs:i,modules:a,inject:h,defines:l,varyings:m,bufferMode:_,transpileToGLSL100:E}=this.programProps;n=this.programManager.get({vs:r,fs:i,modules:a,inject:h,defines:l,varyings:m,bufferMode:_,transpileToGLSL100:E}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}Ht(n instanceof QR,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new _V(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof ur&&n.delete()}}_setAnimationProps(e){this.animated&&Ht(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(dd(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new e3(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:L$;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),hn.group(vh,">>> DRAWING MODEL ".concat(this.id),{collapsed:hn.level<=2})(),e}_logDrawCallEnd(e,n,r,i){if(e===void 0)return;const a=bV({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:h,unusedTable:l,unusedCount:m}=QC({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r)}),{table:_,count:E}=QC({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r),undefinedOnly:!0});E>0&&hn.log("MISSING UNIFORMS",Object.keys(_))(),m>0&&hn.log("UNUSED UNIFORMS",Object.keys(l))();const S=EV(this.vertexArray.configuration);hn.table(e,a)(),hn.table(e,h)(),hn.table(e+1,S)(),i&&i.log({logLevel:vh,message:"Rendered to ".concat(i.id)}),hn.groupEnd(vh)()}}class D${constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}setupResources(e){for(const n of this.bindings)this._setupTransformFeedback(n,e)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:n}=this;return n.length>0&&(e=Object.assign({},e,{varyings:n})),e}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.bindings[this.currentIndex],{sourceBuffers:r,transformFeedback:i}=n;return{attributes:Object.assign({},r,e.attributes),transformFeedback:i}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:n}=this.bindings[this.currentIndex],r=e?n[e]:null;return r?r instanceof ur?r:r.buffer:null}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:n}=e,r=this.getBuffer(n);return r?r.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&Ht(Fn(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:n={}}=e,r={};if(this.bindings[this.currentIndex]&&Object.assign(r,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const i in this.feedbackMap){const a=this.feedbackMap[i];i in n&&(r[a]=i)}Object.assign(r,e.feedbackBuffers);for(const i in r){const a=r[i];if(typeof a=="string"){const h=n[a],{byteLength:l,usage:m,accessor:_}=h;r[i]=this._createNewBuffer(i,{byteLength:l,usage:m,accessor:_})}}return r}_setupBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const r=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:n,feedbackBuffers:r})}_setupTransformFeedback(e,n){let{model:r}=n;const{program:i}=r;e.transformFeedback=new e3(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:n,feedbackBuffers:r}=this._swapBuffers(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceBuffers:n,feedbackBuffers:r})}}_updateBinding(e,n){return e?(Object.assign(e.sourceBuffers,n.sourceBuffers),Object.assign(e.feedbackBuffers,n.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},n.sourceBuffers),feedbackBuffers:Object.assign({},n.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const n=Object.assign({},e.sourceBuffers),r=Object.assign({},e.feedbackBuffers);for(const i in this.feedbackMap){const a=this.feedbackMap[i];n[i]=e.feedbackBuffers[a],r[a]=e.sourceBuffers[i],Ht(r[a]instanceof ur)}return{sourceBuffers:n,feedbackBuffers:r}}_createNewBuffer(e,n){const r=new ur(this.gl,n);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=r,r}_getNextIndex(){return(this.currentIndex+1)%2}}const z$="transform_uSampler_",$0="transform_uSize_",pA="transform_position";function F$(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:r,targetTexture:i}=t,h=Object.keys(n).length,l=null;const m={};let _=e,E={};if(h>0||r){const S=_.split(`
`),I=S.slice();if(S.forEach((L,O,D)=>{if(h>0){const H=j$(L,n);if(H){const{updatedLine:z,inject:N}=H;I[O]=z,E=nw([E,N]),Object.assign(m,H.samplerTextureMap),h--}}r&&!l&&(l=V$(L,r))}),r){Ht(i);const L="".concat($0).concat(r),O="uniform vec2 ".concat(L,`;
`),D="     vec2 ".concat(pA," = transform_getPos(").concat(L,`);
     gl_Position = vec4(`).concat(pA,`, 0, 1.);
`);E=nw([E,{"vs:#decl":O,"vs:#main-start":D}])}_=I.join(`
`)}return{vs:_,targetTextureType:l,inject:E,samplerTextureMap:m}}function N$(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:r}=t;const i={};let a,h;n&&({width:a,height:h}=r,i["".concat($0).concat(n)]=[a,h]);for(const l in e)({width:a,height:h}=e[l]),i["".concat($0).concat(l)]=[a,h];return i}function B$(t){return a3(t,["attribute","in"])}function U$(t){const e="".concat(z$).concat(t),n="".concat($0).concat(t),r="  uniform sampler2D ".concat(e,`;
  uniform vec2 `).concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:r}}function V$(t,e){const n=a3(t,["varying","out"]);return n&&n.name===e?n.type:null}function j$(t,e){const n={},r=B$(t);if(!r)return null;const{type:i,name:a}=r;if(a&&e[a]){const h="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:l,sizeName:m,uniformDeclerations:_}=U$(a),E=dj(i),S="  ".concat(i," ").concat(a," = transform_getInput(").concat(l,", ").concat(m,").").concat(E,`;
`);return n[l]=a,{updatedLine:h,inject:{"vs:#decl":_,"vs:#main-start":S},samplerTextureMap:n}}return null}const $$={10241:9728,10240:9728,10242:33071,10243:33071},G$="transform_output";class H${constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._processVertexShader(e);return Object.assign({},e,n)}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,sourceTextures:r,framebuffer:i,targetTexture:a}=this.bindings[this.currentIndex],h=Object.assign({},n,e.attributes),l=Object.assign({},e.uniforms),m=Object.assign({},e.parameters);let _=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){h.transform_elementID=this.elementIDBuffer;for(const S in this.samplerTextureMap){const I=this.samplerTextureMap[S];l[S]=r[I]}this._setSourceTextureParameters();const E=N$({sourceTextureMap:r,targetTextureVarying:this.targetTextureVarying,targetTexture:a});Object.assign(l,E)}return this.hasTargetTexture&&(_=!1,m.viewport=[0,0,i.width,i.height]),{attributes:h,framebuffer:i,uniforms:l,discard:_,parameters:m}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:n}=this.bindings[this.currentIndex],r=C_(n);if(!e)return r;const i=r.constructor,a=fj(this.targetTextureType),h=new i(r.length*a/4);let l=0;for(let m=0;m<r.length;m+=4)for(let _=0;_<a;_++)h[l++]=r[m+_];return h}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:n,_swapTexture:r}=e;this._swapTexture=r,this.targetTextureVarying=n,this.hasTargetTexture=n,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:n,textureOrReference:r}=e;if(r instanceof oa)return r;const i=n[r];return i?(this._targetRefTexName=r,this._createNewTexture(i)):null}_setupTextures(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,_sourceTextures:r={},_targetTexture:i}=e,a=this._createTargetTexture({sourceTextures:r,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||r&&Object.keys(r).length>0,this._updateBindings({sourceBuffers:n,sourceTextures:r,targetTexture:a}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if(typeof e!="number"||this.elementCount>=e)return;const n=new Float32Array(e);n.forEach((r,i,a)=>{a[i]=i}),this.elementIDBuffer?this.elementIDBuffer.setData({data:n}):this.elementIDBuffer=new ur(this.gl,{data:n,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:n,targetTexture:r}=this._swapTextures(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceTextures:n,targetTexture:r})}}_updateBinding(e,n){const{sourceBuffers:r,sourceTextures:i,targetTexture:a}=n;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,i),Object.assign(e.sourceBuffers,r),a){e.targetTexture=a;const{width:h,height:l}=a,{framebuffer:m}=e;m?(m.update({attachments:{36064:a},resizeAttachments:!1}),m.resize({width:h,height:l})):e.framebuffer=new vi(this.gl,{id:"transform-framebuffer",width:h,height:l,attachments:{36064:a}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const r in n)n[r].setParameters($$)}_swapTextures(e){if(!this._swapTexture)return null;const n=Object.assign({},e.sourceTextures);n[this._swapTexture]=e.targetTexture;const r=e.sourceTextures[this._swapTexture];return{sourceTextures:n,targetTexture:r}}_createNewTexture(e){const n=a8(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:n,targetTexture:r}=this.bindings[this.currentIndex],{vs:i,uniforms:a,targetTextureType:h,inject:l,samplerTextureMap:m}=F$({vs:e.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:r}),_=nw([e.inject||{},l]);this.targetTextureType=h,this.samplerTextureMap=m;const E=e._fs||l3({version:KR(i),input:this.targetTextureVarying,inputType:h,output:G$}),S=this.hasSourceTextures||this.targetTextureVarying?[C$].concat(e.modules||[]):e.modules;return{vs:i,fs:E,modules:S,uniforms:a,inject:_}}}class iE{static isSupported(e){return Fn(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}delete(){const{model:e,bufferTransform:n,textureTransform:r}=this;e&&e.delete(),n&&n.delete(),r&&r.delete()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:n=!0}=e,r=this._updateDrawOptions(e);n&&r.framebuffer&&r.framebuffer.clear({color:!0}),this.model.transform(r)}swap(){let e=!1;const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)e=e||r.swap();Ht(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n){const i=r.getData(e);if(i)return i}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)r.update(e)}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:n}=this;this._buildResourceTransforms(n,e),e=this._updateModelProps(e),this.model=new sm(n,Object.assign({},e,{fs:e.fs||l3({version:KR(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=i.updateModelProps(n);return n}_buildResourceTransforms(e,n){W$(n)&&(this.bufferTransform=new D$(e,n)),q$(n)&&(this.textureTransform=new H$(e,n)),Ht(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=Object.assign(n,i.getDrawOptions(n));return n}}function W$(t){return!!(!dd(t.feedbackBuffers)||!dd(t.feedbackMap)||t.varyings&&t.varyings.length>0)}function q$(t){return!!(!dd(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)}const mA={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class sE{static get DRAW_MODE(){return mA}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=_c("geometry"),drawMode:r=mA.TRIANGLES,attributes:i={},indices:a=null,vertexCount:h=null}=e;this.id=n,this.drawMode=r|0,this.attributes={},this.userData={},this._setAttributes(i,a),this.vertexCount=h||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,n){n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n);for(const r in e){let i=e[r];i=ArrayBuffer.isView(i)?{value:i}:i,Ht(ArrayBuffer.isView(i.value),"".concat(this._print(r),": must be typed array or object with value as typed array")),(r==="POSITION"||r==="positions")&&!i.size&&(i.size=3),r==="indices"?(Ht(!this.indices),this.indices=i):this.attributes[r]=i}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,n){if(n)return n.value.length;let r=1/0;for(const i in e){const a=e[i],{value:h,size:l,constant:m}=a;!m&&h&&l>=1&&(r=Math.min(r,h.length/l))}return Ht(Number.isFinite(r)),r}}let Z$=1,X$=1;class g3{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:n=0,duration:r=Number.POSITIVE_INFINITY,rate:i=1,repeat:a=1}=e,h=Z$++,l={time:0,delay:n,duration:r,rate:i,repeat:a};return this._setChannelTime(l,this.time),this.channels.set(h,l),h}removeChannel(e){this.channels.delete(e);for(const[n,r]of this.animations)r.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const i of n)this._setChannelTime(i,this.time);const r=this.animations.values();for(const i of r){const{animation:a,channel:h}=i;a.setTime(this.getTime(h))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const r=X$++;return this.animations.set(r,{animation:e,channel:n}),e.setTime(this.getTime(n)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const r=n-e.delay,i=e.duration*e.repeat;r>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}const Y$=[255,255,255],K$=1;let J$=0;class Q${constructor(e={}){K(this,"id",void 0),K(this,"color",void 0),K(this,"intensity",void 0),K(this,"type","ambient");const{color:n=Y$}=e,{intensity:r=K$}=e;this.id=e.id||"ambient-".concat(J$++),this.color=n,this.intensity=r}}const e7=[255,255,255],t7=1,n7=[0,0,-1];let r7=0;class gA{constructor(e={}){K(this,"id",void 0),K(this,"color",void 0),K(this,"intensity",void 0),K(this,"type","directional"),K(this,"direction",void 0),K(this,"shadow",void 0);const{color:n=e7}=e,{intensity:r=t7}=e,{direction:i=n7}=e,{_shadow:a=!1}=e;this.id=e.id||"directional-".concat(r7++),this.color=n,this.intensity=r,this.type="directional",this.direction=new La(i).normalize().toArray(),this.shadow=a}getProjectedLight(e){return this}}class i7{constructor(e,n={id:"pass"}){K(this,"id",void 0),K(this,"gl",void 0),K(this,"props",void 0);const{id:r}=n;this.id=r,this.gl=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class oE extends i7{constructor(...e){super(...e),K(this,"_lastRenderIndex",-1)}render(e){const n=this.gl;return hl(n,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:n,moduleParameters:r,viewports:i,views:a,onViewportActive:h,clearStack:l=!0,clearCanvas:m=!0}=e;e.pass=e.pass||"unknown";const _=this.gl;m&&o7(_,n),l&&(this._lastRenderIndex=-1);const E=[];for(const S of i){const I=a&&a[S.id];h==null||h(S);const L=this._getDrawLayerParams(S,e),O=S.subViewports||[S];for(const D of O){const H=this._drawLayersInViewport(_,{target:n,moduleParameters:r,viewport:D,view:I,pass:e.pass,layers:e.layers},L);E.push(H)}}return E}_getDrawLayerParams(e,{layers:n,pass:r,isPicking:i=!1,layerFilter:a,cullRect:h,effects:l,moduleParameters:m},_=!1){const E=[],S=y3(this._lastRenderIndex+1),I={layer:n[0],viewport:e,isPicking:i,renderPass:r,cullRect:h},L={};for(let O=0;O<n.length;O++){const D=n[O],H=this._shouldDrawLayer(D,I,a,L),z={shouldDrawLayer:H};H&&!_&&(z.layerRenderIndex=S(D,H),z.moduleParameters=this._getModuleParameters(D,l,r,m),z.layerParameters=this.getLayerParameters(D,O,e)),E[O]=z}return E}_drawLayersInViewport(e,{layers:n,moduleParameters:r,pass:i,target:a,viewport:h,view:l},m){const _=s7(e,{moduleParameters:r,target:a,viewport:h});if(l&&l.props.clear){const S=l.props.clear===!0?{color:!0,depth:!0}:l.props.clear;ia(e,{scissorTest:!0,scissor:_},()=>J2(e,S))}const E={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};hl(e,{viewport:_});for(let S=0;S<n.length;S++){const I=n[S],{shouldDrawLayer:L,layerRenderIndex:O,moduleParameters:D,layerParameters:H}=m[S];if(L&&I.props.pickable&&E.pickableCount++,I.isComposite)E.compositeCount++;else if(L){E.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,O),D.viewport=h;try{I._drawLayer({moduleParameters:D,uniforms:{layerIndex:O},parameters:H})}catch(z){I.raiseError(z,"drawing ".concat(I," to ").concat(i))}}}return E}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,r){return e.props.parameters}_shouldDrawLayer(e,n,r,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let h=e.parent;for(;h;){if(!h.props.visible||!h.filterSubLayer(n))return!1;n.layer=h,h=h.parent}if(r){const l=n.layer.id;if(l in i||(i[l]=r(n)),!i[l])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,r,i){var a;const h=Object.assign(Object.create(((a=e.internalState)===null||a===void 0?void 0:a.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:hd(this.gl)});if(n)for(const m of n){var l;Object.assign(h,(l=m.getModuleParameters)===null||l===void 0?void 0:l.call(m,e))}return Object.assign(h,this.getModuleParameters(e,n),i)}}function y3(t=0,e={}){const n={},r=(i,a)=>{const h=i.props._offset,l=i.id,m=i.parent&&i.parent.id;let _;if(m&&!(m in e)&&r(i.parent,!1),m in n){const E=n[m]=n[m]||y3(e[m],e);_=E(i,a),n[l]=E}else Number.isFinite(h)?(_=h+(e[m]||0),n[l]=null):_=t;return a&&_>=t&&(t=_+1),e[l]=_,_};return r}function s7(t,{moduleParameters:e,target:n,viewport:r}){const i=n&&n.id!=="default-framebuffer",a=e&&e.devicePixelRatio||hd(t),h=i?n.height:t.drawingBufferHeight,l=r;return[l.x*a,h-(l.y+l.height)*a,l.width*a,l.height*a]}function o7(t,e){const n=e?e.width:t.drawingBufferWidth,r=e?e.height:t.drawingBufferHeight;hl(t,{viewport:[0,0,n,r]}),t.clear(16640)}class a7 extends oE{constructor(e,n){super(e,n),K(this,"shadowMap",void 0),K(this,"depthBuffer",void 0),K(this,"fbo",void 0),this.shadowMap=new oa(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new jh(e,{format:33189,width:1,height:1}),this.fbo=new vi(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const n=this.fbo;ia(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const r=e.viewports[0],i=hd(this.gl),a=r.width*i,h=r.height*i;(a!==n.width||h!==n.height)&&n.resize({width:a,height:h}),super.render({...e,target:n,pass:"shadow"})})}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const _3="#define SMOOTH_EDGE_RADIUS 0.5",l7=`
`.concat(_3,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),c7=`
`.concat(_3,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),u7={name:"geometry",vs:l7,fs:c7},h7=Object.keys(Wn).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(Wn[t],";")).join(""),d7=Object.keys(Pa).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(Pa[t],";")).join(""),f7=Object.keys(Qp).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(Qp[t],";")).join(""),p7="".concat(h7,`
`).concat(d7,`
`).concat(f7,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
  float y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {
    
    if (geometry.position.w == 0.0) {
      return project_size_at_latitude(geometry.worldPosition.y);
    }
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

float project_size_at_latitude(float meters, float lat) {
  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}
vec3 project_normal(vec3 vector) {
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size_at_latitude(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world.xyz -= project_uCoordinateOrigin;
  }
  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function m7(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function km(t){let e={},n;return r=>{for(const i in r)if(!m7(r[i],e[i])){n=t(r),e=r;break}return n}}const yA=[0,0,0,0],g7=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],v3=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],y7=[0,0,0],x3=[0,0,0],_7=km(b7);function b3(t,e,n=x3){n.length<3&&(n=[n[0],n[1],0]);let r=n,i,a=!0;switch(e===Wn.LNGLAT_OFFSETS||e===Wn.METER_OFFSETS?i=n:i=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case Pa.WEB_MERCATOR:(e===Wn.LNGLAT||e===Wn.CARTESIAN)&&(i=[0,0,0],a=!1);break;case Pa.WEB_MERCATOR_AUTO_OFFSET:e===Wn.LNGLAT?r=i:e===Wn.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case Pa.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case Pa.GLOBE:a=!1,i=null;break;default:a=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:a}}function v7(t,e,n){const{viewMatrixUncentered:r,projectionMatrix:i}=t;let{viewMatrix:a,viewProjectionMatrix:h}=t,l=yA,m=yA,_=t.cameraPosition;const{geospatialOrigin:E,shaderCoordinateOrigin:S,offsetMode:I}=b3(t,e,n);return I&&(m=t.projectPosition(E||S),_=[_[0]-m[0],_[1]-m[1],_[2]-m[2]],m[3]=1,l=Im([],m,h),a=r||a,h=uu([],i,a),h=uu([],h,g7)),{viewMatrix:a,viewProjectionMatrix:h,projectionCenter:l,originCommon:m,cameraPosCommon:_,shaderCoordinateOrigin:S,geospatialOrigin:E}}function x7({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=Wn.DEFAULT,coordinateOrigin:i=x3,autoWrapLongitude:a=!1}){r===Wn.DEFAULT&&(r=t.isGeospatial?Wn.LNGLAT:Wn.CARTESIAN);const h=_7({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return h.project_uWrapLongitude=a,h.project_uModelMatrix=n||v3,h}function b7({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:i,viewProjectionMatrix:a,originCommon:h,cameraPosCommon:l,shaderCoordinateOrigin:m,geospatialOrigin:_}=v7(t,n,r),E=t.getDistanceScales(),S=[t.width*e,t.height*e],I=Im([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,L={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:m,project_uCommonOrigin:h.slice(0,3),project_uCenter:i,project_uPseudoMeters:!!t._pseudoMeters,project_uViewportSize:S,project_uDevicePixelRatio:e,project_uFocalDistance:I,project_uCommonUnitsPerMeter:E.unitsPerMeter,project_uCommonUnitsPerWorldUnit:E.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:y7,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:a,project_uModelMatrix:v3,project_uCameraPosition:l};if(_){const O=t.getDistanceScales(_);switch(n){case Wn.METER_OFFSETS:L.project_uCommonUnitsPerWorldUnit=O.unitsPerMeter,L.project_uCommonUnitsPerWorldUnit2=O.unitsPerMeter2;break;case Wn.LNGLAT:case Wn.LNGLAT_OFFSETS:t._pseudoMeters||(L.project_uCommonUnitsPerMeter=O.unitsPerMeter),L.project_uCommonUnitsPerWorldUnit=O.unitsPerDegree,L.project_uCommonUnitsPerWorldUnit2=O.unitsPerDegree2;break;case Wn.CARTESIAN:L.project_uCommonUnitsPerWorldUnit=[1,1,O.unitsPerMeter[2]],L.project_uCommonUnitsPerWorldUnit2=[0,0,O.unitsPerMeter2[2]];break}}return L}const w7={};function E7(t=w7){return"viewport"in t?x7(t):{}}const aE={name:"project",dependencies:[gj,u7],vs:p7,getUniforms:E7};function T7(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Jh(t,e){const n=Im([],e,t);return s$(n,n,1/n[3]),n}function _A(t,e){const n=t%e;return n<0?e+n:n}function S7(t,e,n){return n*e+(1-n)*t}function lw(t,e,n){return t<e?e:t>n?n:t}function P7(t){return Math.log(t)*Math.LOG2E}const lE=Math.log2||P7;function dl(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const Qo=Math.PI,w3=Qo/4,Io=Qo/180,cw=180/Qo,yd=512,G0=4003e4,yy=85.051129,C7=1.5;function vA(t){return Math.pow(2,t)}function E3(t){return lE(t)}function _d(t){const[e,n]=t;dl(Number.isFinite(e)),dl(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=e*Io,i=n*Io,a=yd*(r+Qo)/(2*Qo),h=yd*(Qo+Math.log(Math.tan(w3+i*.5)))/(2*Qo);return[a,h]}function _u(t){const[e,n]=t,r=e/yd*(2*Qo)-Qo,i=2*(Math.atan(Math.exp(n/yd*(2*Qo)-Qo))-w3);return[r*cw,i*cw]}function A7(t){const{latitude:e}=t;dl(Number.isFinite(e));const n=Math.cos(e*Io);return E3(G0*n)-9}function Tx(t){const e=Math.cos(t*Io);return yd/G0/e}function uw(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;dl(Number.isFinite(e)&&Number.isFinite(n));const i=yd,a=Math.cos(e*Io),h=i/360,l=h/a,m=i/G0/a,_={unitsPerMeter:[m,m,m],metersPerUnit:[1/m,1/m,1/m],unitsPerDegree:[h,l,m],degreesPerUnit:[1/h,1/l,1/m]};if(r){const E=Io*Math.tan(e*Io)/a,S=h*E/2,I=i/G0*E,L=I/l*m;_.unitsPerDegree2=[0,S,I],_.unitsPerMeter2=[L,0,L]}return _}function T3(t,e){const[n,r,i]=t,[a,h,l]=e,{unitsPerMeter:m,unitsPerMeter2:_}=uw({longitude:n,latitude:r,highPrecision:!0}),E=_d(t);E[0]+=a*(m[0]+_[0]*h),E[1]+=h*(m[1]+_[1]*h);const S=_u(E),I=(i||0)+(l||0);return Number.isFinite(i)||Number.isFinite(l)?[S[0],S[1],I]:S}function I7(t){const{height:e,pitch:n,bearing:r,altitude:i,scale:a,center:h}=t,l=T7();j0(l,l,[0,0,-i]),f3(l,l,-n*Io),p3(l,l,r*Io);const m=a/e;return rE(l,l,[m,m,m]),h&&j0(l,l,Dj([],h)),l}function M7(t){const{width:e,height:n,altitude:r,pitch:i=0,offset:a,center:h,scale:l,nearZMultiplier:m=1,farZMultiplier:_=1}=t;let{fovy:E=H0(C7)}=t;r!==void 0&&(E=H0(r));const S=E*Io,I=i*Io,L=S3(E);let O=L;h&&(O+=h[2]*l/Math.cos(I)/n);const D=S*(.5+(a?a[1]:0)/n),H=Math.sin(D)*O/Math.sin(lw(Math.PI/2-I-D,.01,Math.PI-.01)),z=Math.sin(I)*H+O,N=O*10,F=Math.min(z*_,N);return{fov:S,aspect:e/n,focalDistance:L,near:m,far:F}}function H0(t){return 2*Math.atan(.5/t)*cw}function S3(t){return .5/Math.tan(.5*t*Io)}function P3(t,e){const[n,r,i=0]=t;return dl(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),Jh(e,[n,r,i,1])}function cE(t,e,n=0){const[r,i,a]=t;if(dl(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(a))return Jh(e,[r,i,a,1]);const h=Jh(e,[r,i,0,1]),l=Jh(e,[r,i,1,1]),m=h[2],_=l[2],E=m===_?0:((n||0)-m)/(_-m);return u3([],h,l,E)}function k7(t){const{width:e,height:n,bounds:r,minExtent:i=0,maxZoom:a=24,offset:h=[0,0]}=t,[[l,m],[_,E]]=r,S=L7(t.padding),I=_d([l,lw(E,-yy,yy)]),L=_d([_,lw(m,-yy,yy)]),O=[Math.max(Math.abs(L[0]-I[0]),i),Math.max(Math.abs(L[1]-I[1]),i)],D=[e-S.left-S.right-Math.abs(h[0])*2,n-S.top-S.bottom-Math.abs(h[1])*2];dl(D[0]>0&&D[1]>0);const H=D[0]/O[0],z=D[1]/O[1],N=(S.right-S.left)/2/H,F=(S.top-S.bottom)/2/z,$=[(L[0]+I[0])/2+N,(L[1]+I[1])/2+F],Q=_u($),te=Math.min(a,lE(Math.abs(Math.min(H,z))));return dl(Number.isFinite(te)),{longitude:Q[0],latitude:Q[1],zoom:te}}function L7(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(dl(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const xA=Math.PI/180;function R7(t,e=0){const{width:n,height:r,unproject:i}=t,a={targetZ:e},h=i([0,r],a),l=i([n,r],a);let m,_;const E=t.fovy?.5*t.fovy*xA:Math.atan(.5/t.altitude),S=(90-t.pitch)*xA;return E>S-.01?(m=bA(t,0,e),_=bA(t,n,e)):(m=i([0,0],a),_=i([n,0],a)),[h,l,_,m]}function bA(t,e,n){const{pixelUnprojectionMatrix:r}=t,i=Jh(r,[e,0,1,1]),a=Jh(r,[e,t.height,1,1]),l=(n*t.distanceScales.unitsPerMeter[2]-i[2])/(a[2]-i[2]),m=u3([],i,a,l),_=_u(m);return _.push(n),_}const wA=512;function O7(t){const{width:e,height:n,pitch:r=0}=t;let{longitude:i,latitude:a,zoom:h,bearing:l=0}=t;(i<-180||i>180)&&(i=_A(i+180,360)-180),(l<-180||l>180)&&(l=_A(l+180,360)-180);const m=lE(n/wA);if(h<=m)h=m,a=0;else{const _=n/2/Math.pow(2,h),E=_u([0,_])[1];if(a<E)a=E;else{const S=_u([0,wA-_])[1];a>S&&(a=S)}}return{width:e,height:n,longitude:i,latitude:a,zoom:h,pitch:r,bearing:l}}const C3=.01,D7=["longitude","latitude","zoom"],A3={curve:1.414,speed:1.2};function z7(t,e,n,r){const{startZoom:i,startCenterXY:a,uDelta:h,w0:l,u1:m,S:_,rho:E,rho2:S,r0:I}=I3(t,e,r);if(m<C3){const $={};for(const Q of D7){const te=t[Q],re=e[Q];$[Q]=S7(te,re,n)}return $}const L=n*_,O=Math.cosh(I)/Math.cosh(I+E*L),D=l*((Math.cosh(I)*Math.tanh(I+E*L)-Math.sinh(I))/S)/m,H=1/O,z=i+E3(H),N=Pj([],h,D);sw(N,N,a);const F=_u(N);return{longitude:F[0],latitude:F[1],zoom:z}}function F7(t,e,n){const r={...A3,...n},{screenSpeed:i,speed:a,maxDuration:h}=r,{S:l,rho:m}=I3(t,e,r),_=1e3*l;let E;return Number.isFinite(i)?E=_/(i/m):E=_/a,Number.isFinite(h)&&E>h?0:E}function I3(t,e,n){n=Object.assign({},A3,n);const r=n.curve,i=t.zoom,a=[t.longitude,t.latitude],h=vA(i),l=e.zoom,m=[e.longitude,e.latitude],_=vA(l-i),E=_d(a),S=_d(m),I=Mj([],S,E),L=Math.max(t.width,t.height),O=L/_,D=Cj(I)*h,H=Math.max(D,C3),z=r*r,N=(O*O-L*L+z*z*H*H)/(2*L*z*H),F=(O*O-L*L-z*z*H*H)/(2*O*z*H),$=Math.log(Math.sqrt(N*N+1)-N),Q=Math.log(Math.sqrt(F*F+1)-F),te=(Q-$)/r;return{startZoom:i,startCenterXY:E,uDelta:I,w0:L,u1:D,S:te,rho:r,rho2:z,r0:$,r1:Q}}const N7=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,B7=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,U7=km(H7),V7=km(W7),j7=[0,0,0,1],$7=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function G7(t,e){const[n,r,i]=t,a=cE([n,r,i],e);return Number.isFinite(i)?a:[a[0],a[1],0]}function H7({viewport:t,center:e}){return new Ra(t.viewProjectionMatrix).invert().transform(e)}function W7({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,a=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(h=>G7(h,r));for(const h of e){const l=h.clone().translate(new La(t.center).negate()),m=a.map(E=>l.transform(E)),_=new Ra().ortho({left:Math.min(...m.map(E=>E[0])),right:Math.max(...m.map(E=>E[0])),bottom:Math.min(...m.map(E=>E[1])),top:Math.max(...m.map(E=>E[1])),near:Math.min(...m.map(E=>-E[2])),far:Math.max(...m.map(E=>-E[2]))});n.push(_.multiplyRight(h))}return n}function q7(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const r={shadow_uDrawShadowMap:!!t.drawToShadowMap,shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||j7,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},i=U7({viewport:t.viewport,center:e.project_uCenter}),a=[],h=V7({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let l=0;l<t.shadowMatrices.length;l++){const m=h[l],_=m.clone().translate(new La(t.viewport.center).negate());e.project_uCoordinateSystem===Wn.LNGLAT&&e.project_uProjectionMode===Pa.WEB_MERCATOR?(h[l]=_,a[l]=i):(h[l]=m.clone().multiplyRight($7),a[l]=_.transform(i))}for(let l=0;l<h.length;l++)r["shadow_uViewProjectionMatrices[".concat(l,"]")]=h[l],r["shadow_uProjectCenters[".concat(l,"]")]=a[l],t.shadowMaps&&t.shadowMaps.length>0?r["shadow_uShadowMap".concat(l)]=t.shadowMaps[l]:r["shadow_uShadowMap".concat(l)]=t.dummyShadowMap;return r}const Sx={name:"shadow",dependencies:[aE],vs:N7,fs:B7,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?q7(t,e):{}},Z7={color:[255,255,255],intensity:1},EA=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],X7=[0,0,0,200/255];class M3{constructor(e={}){K(this,"id","lighting-effect"),K(this,"props",void 0),K(this,"shadowColor",X7),K(this,"shadow",void 0),K(this,"ambientLight",void 0),K(this,"directionalLights",void 0),K(this,"pointLights",void 0),K(this,"shadowPasses",[]),K(this,"shadowMaps",[]),K(this,"dummyShadowMap",null),K(this,"programManager",void 0),K(this,"shadowMatrices",void 0),this.setProps(e)}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const n in e){const r=e[n];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow),this.props=e}preRender(e,{layers:n,layerFilter:r,viewports:i,onViewportActive:a,views:h}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(e),this.programManager||(this.programManager=Mm.getDefaultProgramManager(e),Sx&&this.programManager.addDefaultModule(Sx)),this.dummyShadowMap||(this.dummyShadowMap=new oa(e,{width:1,height:1}));for(let l=0;l<this.shadowPasses.length;l++)this.shadowPasses[l].render({layers:n,layerFilter:r,viewports:i,onViewportActive:a,views:h,moduleParameters:{shadowLightId:l,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(r=>r.getProjectedLight({layer:e})),pointLights:this.pointLights.map(r=>r.getProjectedLight({layer:e}))},n}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(Sx),this.programManager=null)}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const r=new Ra().lookAt({eye:new La(n.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const r=new a7(e);this.shadowPasses[n]=r,this.shadowMaps[n]=r.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:r}=this;!e&&n.length===0&&r.length===0&&(this.ambientLight=new Q$(Z7),this.directionalLights.push(new gA(EA[0]),new gA(EA[1])))}}class Y7{constructor(e={}){K(this,"_pool",[]),K(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:r=1,type:i,padding:a=0,copy:h=!1,initialize:l=!1,maxCount:m}){const _=i||e&&e.constructor||Float32Array,E=n*r+a;if(ArrayBuffer.isView(e)){if(E<=e.length)return e;if(E*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new _(e.buffer,0,E)}let S=1/0;m&&(S=m*r+a);const I=this._allocate(_,E,l,S);return e&&h?I.set(e):l||I.fill(0,0,4),this._release(e),I}release(e){this._release(e)}_allocate(e,n,r,i){let a=Math.max(Math.ceil(n*this.opts.overAlloc),1);a>i&&(a=i);const h=this._pool,l=e.BYTES_PER_ELEMENT*a,m=h.findIndex(_=>_.byteLength>=l);if(m>=0){const _=new e(h.splice(m,1)[0],0,a);return r&&_.fill(0),_}return new e(a)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:r}=e,{byteLength:i}=r,a=n.findIndex(h=>h.byteLength>=i);a<0?n.push(r):(a>0||n.length<this.opts.poolSize)&&n.splice(a,0,r),n.length>this.opts.poolSize&&n.shift()}}const vd=new Y7;function fp(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function K7(t){return[t[12],t[13],t[14]]}function J7(t){return{left:xh(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:xh(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:xh(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:xh(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:xh(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:xh(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const TA=new La;function xh(t,e,n,r){TA.set(t,e,n);const i=TA.len();return{distance:r/i,normal:new La(-t/i,-e/i,-n/i)}}function Q7(t){return t-Math.fround(t)}let Kf;function Px(t,e){const{size:n=1,startIndex:r=0}=e,i=e.endIndex!==void 0?e.endIndex:t.length,a=(i-r)/n;Kf=vd.allocate(Kf,a,{type:Float32Array,size:n*2});let h=r,l=0;for(;h<i;){for(let m=0;m<n;m++){const _=t[h++];Kf[l+m]=_,Kf[l+m+n]=Q7(_)}l+=n*2}return Kf.subarray(0,a*n*2)}function e9(t){let e=null,n=!1;for(const r of t)r&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],r[0][0]),e[0][1]=Math.min(e[0][1],r[0][1]),e[1][0]=Math.max(e[1][0],r[1][0]),e[1][1]=Math.max(e[1][1],r[1][1])):e=r);return e}const t9=Math.PI/180,n9=fp(),SA=[0,0,0],r9={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function i9({width:t,height:e,orthographic:n,fovyRadians:r,focalDistance:i,padding:a,near:h,far:l}){const m=t/e,_=n?new Ra().orthographic({fovy:r,aspect:m,focalDistance:i,near:h,far:l}):new Ra().perspective({fovy:r,aspect:m,near:h,far:l});if(a){const{left:E=0,right:S=0,top:I=0,bottom:L=0}=a,O=ec((E+t-S)/2,0,t)-t/2,D=ec((I+e-L)/2,0,e)-e/2;_[8]-=O*2/t,_[9]+=D*2/e}return _}class Od{constructor(e={}){K(this,"id",void 0),K(this,"x",void 0),K(this,"y",void 0),K(this,"width",void 0),K(this,"height",void 0),K(this,"padding",void 0),K(this,"isGeospatial",void 0),K(this,"zoom",void 0),K(this,"focalDistance",void 0),K(this,"position",void 0),K(this,"modelMatrix",void 0),K(this,"distanceScales",void 0),K(this,"scale",void 0),K(this,"center",void 0),K(this,"cameraPosition",void 0),K(this,"projectionMatrix",void 0),K(this,"viewMatrix",void 0),K(this,"viewMatrixUncentered",void 0),K(this,"viewMatrixInverse",void 0),K(this,"viewProjectionMatrix",void 0),K(this,"pixelProjectionMatrix",void 0),K(this,"pixelUnprojectionMatrix",void 0),K(this,"resolution",void 0),K(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||r9,this.focalDistance=e.focalDistance||1,this.position=e.position||SA,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?Pa.WEB_MERCATOR:Pa.WEB_MERCATOR_AUTO_OFFSET:Pa.IDENTITY}equals(e){return e instanceof Od?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&im(e.projectionMatrix,this.projectionMatrix)&&im(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const r=this.projectPosition(e),i=P3(r,this.pixelProjectionMatrix),[a,h]=i,l=n?h:this.height-h;return e.length===2?[a,l]:[a,l,i[2]]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,a,h]=e,l=n?a:this.height-a,m=r&&r*this.distanceScales.unitsPerMeter[2],_=cE([i,l,h],this.pixelUnprojectionMatrix,m),[E,S,I]=this.unprojectPosition(_);return Number.isFinite(h)?[E,S,I]:Number.isFinite(r)?[E,S,r]:[E,S]}projectPosition(e){const[n,r]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,r,i]}unprojectPosition(e){const[n,r]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,r,i]}projectFlat(e){if(this.isGeospatial){const n=_d(e);return n[1]=ec(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?_u(e):e}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,0],n),i=this.unproject([this.width,0],n),a=this.unproject([0,this.height],n),h=this.unproject([this.width,this.height],n);return[Math.min(r[0],i[0],a[0],h[0]),Math.min(r[1],i[1],a[1],h[1]),Math.max(r[0],i[0],a[0],h[0]),Math.max(r[1],i[1],a[1],h[1])]}getDistanceScales(e){return e?uw({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:r=1,height:i=1}){return e<this.x+this.width&&this.x<e+r&&n<this.y+this.height&&this.y<n+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,J7(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=A7({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||uw({latitude:r,longitude:n}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:a,modelMatrix:h}=e;let l=SA;if(a&&(l=h?new Ra(h).transformAsVector(a,[]):a),this.isGeospatial){const m=this.projectPosition([n,r,0]);this.center=new La(l).scale(this.distanceScales.unitsPerMeter).add(m)}else this.center=this.projectPosition(l)}_initMatrices(e){const{viewMatrix:n=n9,projectionMatrix:r=null,orthographic:i=!1,fovyRadians:a,fovy:h=75,near:l=.1,far:m=1e3,padding:_=null,focalDistance:E=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new Ra().multiplyRight(n).translate(new La(this.center).negate()),this.projectionMatrix=r||i9({width:this.width,height:this.height,orthographic:i,fovyRadians:a||h*t9,focalDistance:E,padding:_,near:l,far:m});const S=fp();uu(S,S,this.projectionMatrix),uu(S,S,this.viewMatrix),this.viewProjectionMatrix=S,this.viewMatrixInverse=ow([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=K7(this.viewMatrixInverse);const I=fp(),L=fp();rE(I,I,[this.width/2,-this.height/2,1]),j0(I,I,[1,-1,0]),uu(L,I,this.viewProjectionMatrix),this.pixelProjectionMatrix=L,this.pixelUnprojectionMatrix=ow(fp(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||hr.warn("Pixel project matrix not invertible")()}}K(Od,"displayName","Viewport");class xd extends Od{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,pitch:a=0,bearing:h=0,nearZMultiplier:l=.1,farZMultiplier:m=1.01,nearZ:_,farZ:E,orthographic:S=!1,projectionMatrix:I,repeat:L=!1,worldOffset:O=0,position:D,padding:H,legacyMeterSizes:z=!1}=e;let{width:N,height:F,altitude:$=1.5}=e;const Q=Math.pow(2,i);N=N||1,F=F||1;let te,re=null;if(I)$=I[5]/2,te=H0($);else{e.fovy?(te=e.fovy,$=S3(te)):te=H0($);let Ee;if(H){const{top:de=0,bottom:Le=0}=H;Ee=[0,ec((de+F-Le)/2,0,F)-F/2]}re=M7({width:N,height:F,scale:Q,center:D&&[0,0,D[2]*Tx(n)],offset:Ee,pitch:a,fovy:te,nearZMultiplier:l,farZMultiplier:m}),Number.isFinite(_)&&(re.near=_),Number.isFinite(E)&&(re.far=E)}let we=I7({height:F,pitch:a,bearing:h,scale:Q,altitude:$});O&&(we=new Ra().translate([512*O,0,0]).multiplyLeft(we)),super({...e,width:N,height:F,viewMatrix:we,longitude:r,latitude:n,zoom:i,...re,fovy:te,focalDistance:$}),K(this,"longitude",void 0),K(this,"latitude",void 0),K(this,"pitch",void 0),K(this,"bearing",void 0),K(this,"altitude",void 0),K(this,"fovy",void 0),K(this,"orthographic",void 0),K(this,"_subViewports",void 0),K(this,"_pseudoMeters",void 0),this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=a,this.bearing=h,this.altitude=$,this.fovy=te,this.orthographic=S,this._subViewports=L?[]:null,this._pseudoMeters=z,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let i=n;i<=r;i++){const a=i?new xd({...this,worldOffset:i}):this;this._subViewports.push(a)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,r]=this.projectFlat(e),i=(e[2]||0)*Tx(e[1]);return[n,r,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,r]=this.unprojectFlat(e),i=(e[2]||0)/Tx(r);return[n,r,i]}addMetersToLngLat(e,n){return T3(e,n)}panByPosition(e,n){const r=cE(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),a=sw([],i,Aj([],r)),h=sw([],this.center,a),[l,m]=this.unprojectFlat(h);return{longitude:l,latitude:m}}getBounds(e={}){const n=R7(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:r,height:i}=this,{longitude:a,latitude:h,zoom:l}=k7({width:r,height:i,bounds:e,...n});return new xd({width:r,height:i,longitude:a,latitude:h,zoom:l})}}K(xd,"displayName","WebMercatorViewport");const PA=[0,0,0];function Cx(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof xd){const[i,a,h=0]=t,l=e.getDistanceScales([i,a]);r[2]=h*l.unitsPerMeter[2]}return r}function s9(t){const{viewport:e,modelMatrix:n,coordinateOrigin:r}=t;let{coordinateSystem:i,fromCoordinateSystem:a,fromCoordinateOrigin:h}=t;return i===Wn.DEFAULT&&(i=e.isGeospatial?Wn.LNGLAT:Wn.CARTESIAN),a===void 0&&(a=i),h===void 0&&(h=r),{viewport:e,coordinateSystem:i,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:a,fromCoordinateOrigin:h}}function k3(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:i,offsetMode:a}){let[h,l,m=0]=t;switch(n&&([h,l,m]=Im([],[h,l,m,1],n)),r){case Wn.LNGLAT:return Cx([h,l,m],e,a);case Wn.LNGLAT_OFFSETS:return Cx([h+i[0],l+i[1],m+(i[2]||0)],e,a);case Wn.METER_OFFSETS:return Cx(T3(i,[h,l,m]),e,a);case Wn.CARTESIAN:default:return e.isGeospatial?[h+i[0],l+i[1],m+i[2]]:e.projectPosition([h,l,m])}}function o9(t,e){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:a,fromCoordinateSystem:h,fromCoordinateOrigin:l}=s9(e),{autoOffset:m=!0}=e,{geospatialOrigin:_=PA,shaderCoordinateOrigin:E=PA,offsetMode:S=!1}=m?b3(n,r,i):{},I=k3(t,{viewport:n,modelMatrix:a,coordinateSystem:h,coordinateOrigin:l,offsetMode:S});if(S){const L=n.projectPosition(_||E);Gj(I,I,L)}return I}const CA={blendFunc:[1,0,32771,0],blendEquation:32774};class L3 extends oE{constructor(...e){super(...e),K(this,"pickZ",void 0),K(this,"_colorEncoderState",null)}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:a,pickingFBO:h,deviceRect:{x:l,y:m,width:_,height:E},cullRect:S,effects:I,pass:L="picking",pickZ:O,moduleParameters:D}){const H=this.gl;this.pickZ=O;const z=this._resetColorEncoder(O),N=ia(H,{scissorTest:!0,scissor:[l,m,_,E],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...CA,blend:!O},()=>super.render({target:h,layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:a,cullRect:S,effects:I==null?void 0:I.filter($=>$.useInPicking),pass:L,isPicking:!0,moduleParameters:D}));return this._colorEncoderState=null,{decodePickingColor:z&&l9.bind(null,z),stats:N}}shouldDrawLayer(e){const{pickable:n,operation:r}=e.props;return n&&r.includes("draw")||r.includes("terrain")||r.includes("mask")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,n,r){const i={...e.props.parameters},{pickable:a,operation:h}=e.props;return this._colorEncoderState?a&&h.includes("draw")&&(Object.assign(i,CA),i.blend=!0,i.blendColor=a9(this._colorEncoderState,e,r)):i.blend=!1,h.includes("terrain")&&(i.blend=!1),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function a9(t,e,n){const{byLayer:r,byAlpha:i}=t;let a,h=r.get(e);return h?(h.viewports.push(n),a=h.a):(a=r.size+1,a<=255?(h={a,layer:e,viewports:[n]},r.set(e,h),i[a]=h):(hr.warn("Too many pickable layers, only picking the first 255")(),a=0)),[0,0,0,a/255]}function l9(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const Ah={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},W0=Symbol.for("component"),pc=Symbol.for("propTypes"),Ax=Symbol.for("deprecatedProps"),Qh=Symbol.for("asyncPropDefaults"),vu=Symbol.for("asyncPropOriginal"),tc=Symbol.for("asyncPropResolved");function uE(t,e=()=>!0){return Array.isArray(t)?R3(t,e,[]):e(t)?[t]:[]}function R3(t,e,n){let r=-1;for(;++r<t.length;){const i=t[r];Array.isArray(i)?R3(i,e,n):e(i)&&n.push(i)}return n}function c9({target:t,source:e,start:n=0,count:r=1}){const i=e.length,a=r*i;let h=0;for(let l=n;h<i;h++)t[l++]=e[h];for(;h<a;)h<a-h?(t.copyWithin(n+h,n,n+h),h*=2):(t.copyWithin(n+h,n,n+a-h),h=a);return t}class u9{constructor(e,n,r){K(this,"id",void 0),K(this,"context",void 0),K(this,"isLoaded",void 0),K(this,"persistent",void 0),K(this,"_loadCount",0),K(this,"_subscribers",new Set),K(this,"_data",void 0),K(this,"_loader",void 0),K(this,"_error",void 0),K(this,"_content",void 0),this.id=e,this.context=r,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const r=++this._loadCount;let i=e;typeof e=="string"&&(i=qb(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(a=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=a)}).catch(a=>{this._loadCount===r&&(this.isLoaded=!0,this._error=a||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const a of this._subscribers)a.onChange(this.getData())}}class h9{constructor({gl:e,protocol:n}){K(this,"protocol",void 0),K(this,"_context",void 0),K(this,"_resources",void 0),K(this,"_consumers",void 0),K(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:r=!1,persistent:i=!0}){let a=this._resources[e];a?a.setData(n,r):(a=new u9(e,n,this._context),this._resources[e]=a),a.persistent=i}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const r in n){const i=n[r],a=this._resources[i.resourceId];a&&a.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:r,requestId:i="default"}){const{_resources:a,protocol:h}=this;e.startsWith(h)&&(e=e.replace(h,""),a[e]||this.add({resourceId:e,data:null,persistent:!1}));const l=a[e];if(this._track(r,i,l,n),l)return l.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,r,i){const a=this._consumers,h=a[e]=a[e]||{},l=h[n]||{},m=l.resourceId&&this._resources[l.resourceId];m&&(m.unsubscribe(l),this.prune()),r&&(h[n]=l,l.onChange=i,l.resourceId=r.id,r.subscribe(l))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const d9=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,hE={name:"project32",dependencies:[aE],vs:d9},dE={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:#decl":`
uniform bool picking_uAttribute;
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...x$},f9=[aE],p9=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function m9(t){const e=Mm.getDefaultProgramManager(t);for(const n of f9)e.addDefaultModule(n);for(const n of p9)e.addShaderHook(n);return e}const g9="layerManager.setLayers",y9="layerManager.activateViewport";class _9{constructor(e,{deck:n,stats:r,viewport:i,timeline:a}={}){K(this,"layers",void 0),K(this,"context",void 0),K(this,"resourceManager",void 0),K(this,"_lastRenderedLayers",[]),K(this,"_needsRedraw",!1),K(this,"_needsUpdate",!1),K(this,"_nextLayers",null),K(this,"_debug",!1),K(this,"activateViewport",h=>{ss(y9,this,h),h&&(this.context.viewport=h)}),this.layers=[],this.resourceManager=new h9({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:n,programManager:e&&m9(e),stats:r||new Y2({id:"deck.gl"}),viewport:i||new Od({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:a||new g3,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const i=r.getNeedsRedraw(e);n=n||i}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(r=>n.id.indexOf(r)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){ss(g9,this,n,e),this._lastRenderedLayers=e;const r=uE(e,Boolean);for(const i of r)i.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,n,r){r.raiseError(n,"".concat(e," of ").concat(r))}_updateLayers(e,n){const r={};for(const h of e)r[h.id]?hr.warn("Multiple old layers with same id ".concat(h.id))():r[h.id]=h;const i=[];this._updateSublayersRecursively(n,r,i),this._finalizeOldLayers(r);let a=!1;for(const h of i)if(h.hasUniformTransition()){a="Uniform transition in ".concat(h);break}this._needsUpdate=a,this.layers=i}_updateSublayersRecursively(e,n,r){for(const i of e){i.context=this.context;const a=n[i.id];a===null&&hr.warn("Multiple new layers with same id ".concat(i.id))(),n[i.id]=null;let h=null;try{this._debug&&a!==i&&i.validateProps(),a?(this._transferLayerState(a,i),this._updateLayer(i)):this._initializeLayer(i),r.push(i),h=i.isComposite?i.getSubLayers():null}catch(l){this._handleError("matching",l,i)}h&&this._updateSublayersRecursively(h,n,r)}}_finalizeOldLayers(e){for(const n in e){const r=e[n];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=Ah.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=Ah.MATCHED,n!==e&&(e.lifecycle=Ah.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=Ah.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=Ah.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function Ca(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!Ca(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const a of r)if(!e.hasOwnProperty(a)||!Ca(t[a],e[a],n-1))return!1;return!0}return!1}class v9{constructor(e){K(this,"width",void 0),K(this,"height",void 0),K(this,"views",void 0),K(this,"viewState",void 0),K(this,"controllers",void 0),K(this,"timeline",void 0),K(this,"_viewports",void 0),K(this,"_viewportMap",void 0),K(this,"_isUpdating",void 0),K(this,"_needsRedraw",void 0),K(this,"_needsUpdate",void 0),K(this,"_eventManager",void 0),K(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,r=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,n){const r=this.getViewports(),i={x:e[0],y:e[1]};for(let a=r.length-1;a>=0;--a){const h=r[a];if(h.containsPixel(i)){const l=e.slice();return l[0]-=h.x,l[1]-=h.y,h.unproject(l,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=uE(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!Ca(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):hr.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,n){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...n,viewId:e})}_createController(e,n){const r=n.type;return new r({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,n.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:a=>{var h;return(h=this.getView(e.id))===null||h===void 0?void 0:h.makeViewport({viewState:a,width:this.width,height:this.height})}})}_updateController(e,n,r,i){const a=e.controller;if(a&&r){const h={...n,...a,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return(!i||i.constructor!==a.type)&&(i=this._createController(e,h)),i&&i.setProps(h),i}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let i=e.length;i--;){const a=e[i],h=this.getViewState(a),l=a.makeViewport({viewState:h,width:this.width,height:this.height});let m=n[a.id];const _=!!a.controller;_&&!m&&(r=!0),(r||!_)&&m&&(m.finalize(),m=null),this.controllers[a.id]=this._updateController(a,h,l,m),l&&this._viewports.unshift(l)}for(const i in n){const a=n[i];a&&!this.controllers[i]&&a.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((r,i)=>!e[i].equals(n[i]))}}const x9=/([0-9]+\.?[0-9]*)(%|px)/;function $l(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=x9.exec(t);if(e&&e.length>=3){const n=e[2]==="%",r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function Gl(t,e){return t.relative?Math.round(t.position*e):t.position}function Ci(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class bd{constructor(e){K(this,"id",void 0),K(this,"viewportInstance",void 0),K(this,"_x",void 0),K(this,"_y",void 0),K(this,"_width",void 0),K(this,"_height",void 0),K(this,"_padding",void 0),K(this,"props",void 0);const{id:n,x:r=0,y:i=0,width:a="100%",height:h="100%",padding:l=null,viewportInstance:m}=e||{};Ci(!m||m instanceof Od),this.viewportInstance=m,this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=$l(r),this._y=$l(i),this._width=$l(a),this._height=$l(h),this._padding=l&&{left:$l(l.left||0),right:$l(l.right||0),top:$l(l.top||0),bottom:$l(l.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.viewportInstance?e.viewportInstance?this.viewportInstance.equals(e.viewportInstance):!1:this.ViewportType===e.ViewportType&&Ca(this.props,e.props,2)}makeViewport({width:e,height:n,viewState:r}){if(this.viewportInstance)return this.viewportInstance;r=this.filterViewState(r);const i=this.getDimensions({width:e,height:n});return!i.height||!i.width?null:new this.ViewportType({...r,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:(e==null?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const r in this.props.viewState)r!=="id"&&(n[r]=this.props.viewState[r]);return n}return e}getDimensions({width:e,height:n}){const r={x:Gl(this._x,e),y:Gl(this._y,n),width:Gl(this._width,e),height:Gl(this._height,n)};return this._padding&&(r.padding={left:Gl(this._padding.left,e),top:Gl(this._padding.top,n),right:Gl(this._padding.right,e),bottom:Gl(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}let Lm=class{constructor(e){K(this,"_inProgress",void 0),K(this,"_handle",void 0),K(this,"_timeline",void 0),K(this,"time",void 0),K(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var n,r;this.cancel(),this.settings=e,this._inProgress=!0,(n=(r=this.settings).onStart)===null||n===void 0||n.call(r,this)}end(){if(this._inProgress){var e,n;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(e=(n=this.settings).onEnd)===null||e===void 0||e.call(n,this)}}cancel(){if(this._inProgress){var e,n;(e=(n=this.settings).onInterrupt)===null||e===void 0||e.call(n,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:r,settings:i}=this;this._handle=r.addChannel({delay:r.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(e=(n=this.settings).onUpdate)===null||e===void 0||e.call(n,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}};const AA=()=>{},hw={BREAK:1,SNAP_TO_END:2,IGNORE:3},b9=t=>t,w9=hw.BREAK;class E9{constructor(e){K(this,"getControllerState",void 0),K(this,"props",void 0),K(this,"propsInTransition",void 0),K(this,"transition",void 0),K(this,"onViewStateChange",void 0),K(this,"onStateChange",void 0),K(this,"_onTransitionUpdate",n=>{const{time:r,settings:{interpolator:i,startProps:a,endProps:h,duration:l,easing:m}}=n,_=m(r/l),E=i.interpolateProps(a,h,_);this.propsInTransition=this.getControllerState({...this.props,...E}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new Lm(e.timeline),this.onViewStateChange=e.onViewStateChange||AA,this.onStateChange=e.onStateChange||AA}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let i=r;if(this.transition.inProgress){const{interruption:a,endProps:h}=this.transition.settings;i={...r,...a===hw.SNAP_TO_END?h:this.propsInTransition||r}}this._triggerTransition(i,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:r}=e;return(n>0||n==="auto")&&!!r}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===hw.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const r=this.getControllerState(e),i=this.getControllerState(n).shortestPathFrom(r),a=n.transitionInterpolator,h=a.getDuration?a.getDuration(e,n):n.transitionDuration;if(h===0)return;const l=a.initializeProps(e,i);this.propsInTransition={};const m={duration:h,easing:n.transitionEasing||b9,interpolator:a,interruption:n.transitionInterruption||w9,startProps:l.start,endProps:l.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(m),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e==null||e(n)}}}class O3{constructor(e){K(this,"_propsToCompare",void 0),K(this,"_propsToExtract",void 0),K(this,"_requiredProps",void 0);const{compare:n,extract:r,required:i}=e;this._propsToCompare=n,this._propsToExtract=r||n,this._requiredProps=i}arePropsEqual(e,n){for(const r of this._propsToCompare)if(!(r in e)||!(r in n)||!im(e[r],n[r]))return!1;return!0}initializeProps(e,n){const r={},i={};for(const a of this._propsToExtract)(a in e||a in n)&&(r[a]=e[a],i[a]=n[a]);return this._checkRequiredProps(r),this._checkRequiredProps(i),{start:r,end:i}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const r=e[n];Ci(Number.isFinite(r)||Array.isArray(r),"".concat(n," is required for transition"))})}}const T9=["longitude","latitude","zoom","bearing","pitch"],S9=["longitude","latitude","zoom"];class D3 extends O3{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:T9,required:S9},super(r.transitionProps),K(this,"opts",void 0),this.opts=r}initializeProps(e,n){const r=super.initializeProps(e,n),{makeViewport:i,around:a}=this.opts;if(i&&a){const h=i(e),l=i(n),m=h.unproject(a);r.start.around=a,Object.assign(r.end,{around:l.project(m),aroundPosition:m,width:n.width,height:n.height})}return r}interpolateProps(e,n,r){const i={};for(const a of this._propsToExtract)i[a]=rm(e[a]||0,n[a]||0,r);if(n.aroundPosition&&this.opts.makeViewport){const a=this.opts.makeViewport({...n,...i});Object.assign(i,a.panByPosition(n.aroundPosition,rm(e.around,n.around,r)))}return i}}const Hl={transitionDuration:0},P9=300,_y=t=>1-(1-t)*(1-t),bh={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},Zc={};class C9{constructor(e){K(this,"props",void 0),K(this,"state",{}),K(this,"transitionManager",void 0),K(this,"eventManager",void 0),K(this,"onViewStateChange",void 0),K(this,"onStateChange",void 0),K(this,"makeViewport",void 0),K(this,"_controllerState",void 0),K(this,"_events",{}),K(this,"_interactionState",{isDragging:!1}),K(this,"_customEvents",[]),K(this,"_eventStartBlocked",null),K(this,"_panMove",!1),K(this,"invertPan",!1),K(this,"dragMode","rotate"),K(this,"inertia",0),K(this,"scrollZoom",!0),K(this,"dragPan",!0),K(this,"dragRotate",!0),K(this,"doubleClickZoom",!0),K(this,"touchZoom",!0),K(this,"touchRotate",!1),K(this,"keyboard",!0),this.transitionManager=new E9({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const n in this._events)if(this._events[n]){var e;(e=this.eventManager)===null||e===void 0||e.off(n,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:r}=this.props,{offsetCenter:i}=e;return[i.x-n,i.y-r]}isPointInBounds(e,n){const{width:r,height:i}=this.props;if(n&&n.handled)return!1;const a=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=i;return a&&n&&n.stopPropagation(),a}isFunctionKeyPressed(e){const{srcEvent:n}=e;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?P9:0;const{scrollZoom:r=!0,dragPan:i=!0,dragRotate:a=!0,doubleClickZoom:h=!0,touchZoom:l=!0,touchRotate:m=!1,keyboard:_=!0}=e,E=!!this.onViewStateChange;this.toggleEvents(bh.WHEEL,E&&r),this.toggleEvents(bh.PAN,E),this.toggleEvents(bh.PINCH,E&&(l||m)),this.toggleEvents(bh.TRIPLE_PAN,E&&m),this.toggleEvents(bh.DOUBLE_TAP,E&&h),this.toggleEvents(bh.KEYBOARD,E&&_),this.scrollZoom=r,this.dragPan=i,this.dragRotate=a,this.doubleClickZoom=h,this.touchZoom=l,this.touchRotate=m,this.keyboard=_}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(r=>{this._events[r]!==n&&(this._events[r]=n,n?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,n=null,r={}){const i={...e.getViewportProps(),...n},a=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),a){const h=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:h})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(r=!r);const i=this.controllerState[r?"panStart":"rotateStart"]({pos:n});return this._panMove=r,this.updateViewport(i,Hl,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),r=this.controllerState.pan({pos:n});return this.updateViewport(r,Hl,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],a=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(a,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:_y},{isDragging:!1,isPanning:!0})}else{const r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),r=this.controllerState.rotate({pos:n});return this.updateViewport(r,Hl,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],a=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(a,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:_y},{isDragging:!1,isRotating:!0})}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;e.srcEvent.preventDefault();const{speed:r=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:a}=e;let h=2/(1+Math.exp(-Math.abs(a*r)));a<0&&h!==0&&(h=1/h);const l=this.controllerState.zoom({pos:n,scale:h});return this.updateViewport(l,{...this._getTransitionProps({around:n}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.rotateStart({pos:n});return this.updateViewport(r,Hl,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const r=this.controllerState.rotate({pos:n});return this.updateViewport(r,Hl,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const r=this.getCenter(e),i=[r[0],r[1]+=e.velocityY*n/2],a=this.controllerState.rotate({pos:i});this.updateViewport(a,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:_y},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return Zc._startPinchRotation=e.rotation,Zc._lastPinchEvent=e,this.updateViewport(r,Hl,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:r}=e,i=this.getCenter(e);n=n.zoom({pos:i,scale:r})}if(this.touchRotate){const{rotation:r}=e;n=n.rotate({deltaAngleX:Zc._startPinchRotation-r})}return this.updateViewport(n,Hl,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Zc._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:r}=Zc;if(this.touchZoom&&n&&r&&e.scale!==r.scale){const i=this.getCenter(e);let a=this.controllerState.rotateEnd();const h=Math.log2(e.scale),l=(h-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),m=Math.pow(2,h+l*n/2);a=a.zoom({pos:i,scale:m}).zoomEnd(),this.updateViewport(a,{...this._getTransitionProps({around:i}),transitionDuration:n,transitionEasing:_y},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Zc._startPinchRotation=null,Zc._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:n,scale:r?.5:2});return this.updateViewport(i,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:i,rotateSpeedX:a,rotateSpeedY:h}=this.keyboard===!0?{}:this.keyboard,{controllerState:l}=this;let m;const _={};switch(e.srcEvent.code){case"Minus":m=n?l.zoomOut(r).zoomOut(r):l.zoomOut(r),_.isZooming=!0;break;case"Equal":m=n?l.zoomIn(r).zoomIn(r):l.zoomIn(r),_.isZooming=!0;break;case"ArrowLeft":n?(m=l.rotateLeft(a),_.isRotating=!0):(m=l.moveLeft(i),_.isPanning=!0);break;case"ArrowRight":n?(m=l.rotateRight(a),_.isRotating=!0):(m=l.moveRight(i),_.isPanning=!0);break;case"ArrowUp":n?(m=l.rotateUp(h),_.isRotating=!0):(m=l.moveUp(i),_.isPanning=!0);break;case"ArrowDown":n?(m=l.rotateDown(h),_.isRotating=!0):(m=l.moveDown(i),_.isPanning=!0);break;default:return!1}return this.updateViewport(m,this._getTransitionProps(),_),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?Hl:e?{...n,transitionInterpolator:new D3({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class A9{constructor(e,n){K(this,"_viewportProps",void 0),K(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const IA=5,I9=1.2;class M9 extends A9{constructor(e){const{width:n,height:r,latitude:i,longitude:a,zoom:h,bearing:l=0,pitch:m=0,altitude:_=1.5,position:E=[0,0,0],maxZoom:S=20,minZoom:I=0,maxPitch:L=60,minPitch:O=0,startPanLngLat:D,startZoomLngLat:H,startRotatePos:z,startBearing:N,startPitch:F,startZoom:$,normalize:Q=!0}=e;Ci(Number.isFinite(a)),Ci(Number.isFinite(i)),Ci(Number.isFinite(h)),super({width:n,height:r,latitude:i,longitude:a,zoom:h,bearing:l,pitch:m,altitude:_,maxZoom:S,minZoom:I,maxPitch:L,minPitch:O,normalize:Q,position:E},{startPanLngLat:D,startZoomLngLat:H,startRotatePos:z,startBearing:N,startPitch:F,startZoom:$}),K(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const a=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(a)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:i,startBearing:a,startPitch:h}=this.getState();if(!i||a===void 0||h===void 0)return this;let l;return e?l=this._getNewRotation(e,i,h,a):l={bearing:a+n,pitch:h+r},this._getUpdatedState(l)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:i,startZoomLngLat:a}=this.getState();if(a||(i=this.getViewportProps().zoom,a=this._unproject(n)||this._unproject(e)),!a)return this;const{maxZoom:h,minZoom:l}=this.getViewportProps();let m=i+Math.log2(r);m=ec(m,l,h);const _=this.makeViewport({...this.getViewportProps(),zoom:m});return this._getUpdatedState({zoom:m,..._.panByPosition(a,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{bearing:i,longitude:a}=r;return Math.abs(i-n.bearing)>180&&(r.bearing=i<0?i+360:i-360),Math.abs(a-n.longitude)>180&&(r.longitude=a<0?a+360:a-360),r}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:i}=e;e.zoom=ec(i,r,n);const{maxPitch:a,minPitch:h,pitch:l}=e;e.pitch=ec(l,h,a);const{normalize:m=!0}=e;return m&&Object.assign(e,O7(e)),e}_zoomFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.zoom({pos:[n/2,r/2],scale:e})}_panFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.pan({startPos:[n/2,r/2],pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,r,i){const a=e[0]-n[0],h=e[1]-n[1],l=e[1],m=n[1],{width:_,height:E}=this.getViewportProps(),S=a/_;let I=0;h>0?Math.abs(E-m)>IA&&(I=h/(m-E)*I9):h<0&&m>IA&&(I=1-l/m),I=ec(I,-1,1);const{minPitch:L,maxPitch:O}=this.getViewportProps(),D=i+180*S;let H=r;return I>0?H=r+I*(O-r):I<0&&(H=r-I*(L-r)),{pitch:H,bearing:D}}}class k9 extends C9{constructor(...e){super(...e),K(this,"ControllerState",M9),K(this,"transition",{transitionDuration:300,transitionInterpolator:new D3({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),K(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class z3 extends bd{get ViewportType(){return xd}get ControllerType(){return k9}}K(z3,"displayName","MapView");const L9=new M3;function R9(t,e){var n,r;const i=(n=t.order)!==null&&n!==void 0?n:1/0,a=(r=e.order)!==null&&r!==void 0?r:1/0;return i-a}class O9{constructor(){K(this,"effects",void 0),K(this,"_resolvedEffects",[]),K(this,"_defaultEffects",[]),K(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const n=this._defaultEffects;if(!n.find(r=>r.id===e.id)){const r=n.findIndex(i=>R9(i,e)>0);r<0?n.push(e):n.splice(r,0,e),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(Ca(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._resolvedEffects}_setEffects(e){const n={};for(const i of this.effects)n[i.id]=i;const r=[];for(const i of e){const a=n[i.id];a&&a!==i?a.setProps?(a.setProps(i.props),r.push(a)):(a.cleanup(),r.push(i)):r.push(i),delete n[i.id]}for(const i in n)n[i].cleanup();this.effects=r,this._resolvedEffects=r.concat(this._defaultEffects),e.some(i=>i instanceof M3)||this._resolvedEffects.push(L9),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class D9 extends oE{shouldDrawLayer(e){const{operation:n}=e.props;return n.includes("draw")||n.includes("terrain")}}const z9="deckRenderer.renderLayers";class F9{constructor(e){K(this,"gl",void 0),K(this,"layerFilter",void 0),K(this,"drawPickingColors",void 0),K(this,"drawLayersPass",void 0),K(this,"pickLayersPass",void 0),K(this,"renderCount",void 0),K(this,"_needsRedraw",void 0),K(this,"renderBuffers",void 0),K(this,"lastPostProcessEffect",void 0),this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new D9(e),this.pickLayersPass=new L3(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,r={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e,target:e.target||vi.getDefaultFramebuffer(this.gl)};r.effects&&this._preRender(r.effects,r);const i=this.lastPostProcessEffect?this.renderBuffers[0]:r.target,a=n.render({...r,target:i});r.effects&&this._postRender(r.effects,r),this.renderCount++,ss(z9,this,a,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){this.lastPostProcessEffect=null,n.preRenderStats=n.preRenderStats||{};for(const r of e)n.preRenderStats[r.id]=r.preRender(this.gl,n),r.postRender&&(this.lastPostProcessEffect=r.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this;e.length===0&&e.push(new vi(this.gl),new vi(this.gl));for(const n of e)n.resize()}_postRender(e,n){const{renderBuffers:r}=this,i={...n,inputBuffer:r[0],swapBuffer:r[1],target:null};for(const a of e)if(a.postRender){if(a.id===this.lastPostProcessEffect){i.target=n.target,a.postRender(this.gl,i);break}const h=a.postRender(this.gl,i);i.inputBuffer=h,i.swapBuffer=h===r[0]?r[1]:r[0]}}}const N9={pickedColor:null,pickedObjectIndex:-1};function B9({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:a}){const{x:h,y:l,width:m,height:_}=a;let E=i*i,S=-1,I=0;for(let L=0;L<_;L++){const O=L+l-r,D=O*O;if(D>E)I+=4*m;else for(let H=0;H<m;H++){if(t[I+3]-1>=0){const N=H+h-n,F=N*N+D;F<=E&&(E=F,S=I)}I+=4}}if(S>=0){const L=t.slice(S,S+4),O=e(L);if(O){const D=Math.floor(S/4/m),H=S/4-D*m;return{...O,pickedColor:L,pickedX:h+H,pickedY:l+D}}hr.error("Picked non-existent layer. Is picking buffer corrupt?")()}return N9}function U9({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){const a=t.slice(r,r+4),h=a.join(",");if(!n.has(h)){const l=e(a);l?n.set(h,{...l,color:a}):hr.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function F3({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:i,z:a}){let h=e[0];e.length>1&&(h=j9((t==null?void 0:t.pickedViewports)||e,{x:r,y:i}));let l;if(h){const m=[r-h.x,i-h.y];a!==void 0&&(m[2]=a),l=h.unproject(m)}return{color:null,layer:null,viewport:h,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:l,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function V9(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:a,pickedLayer:h,pickedObjectIndex:l}=e,m=h?[h]:[];if(r==="hover"){const S=n.index,I=n.layerId,L=h?h.props.id:null;if(L!==I||l!==S){if(L!==I){const O=i.find(D=>D.props.id===I);O&&m.unshift(O)}n.layerId=L,n.index=l,n.info=null}}const _=F3(t),E=new Map;return E.set(null,_),m.forEach(S=>{let I={..._};S===h&&(I.color=a,I.index=l,I.picked=!0),I=N3({layer:S,info:I,mode:r});const L=I.layer;S===h&&r==="hover"&&(n.info=I),E.set(L.id,I),r==="hover"&&L.updateAutoHighlight(I)}),E}function N3({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}function j9(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.containsPixel(e))return r}return t[0]}class $9{constructor(e){K(this,"gl",void 0),K(this,"pickingFBO",void 0),K(this,"depthFBO",void 0),K(this,"pickLayersPass",void 0),K(this,"layerFilter",void 0),K(this,"lastPickedInfo",void 0),K(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new L3(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:r,viewports:i},a=this.lastPickedInfo.info){const h=a&&a.layer&&a.layer.id,l=a&&a.viewport&&a.viewport.id,m=h?r.find(I=>I.id===h):null,_=l&&i.find(I=>I.id===l)||i[0],E=_&&_.unproject([e-_.x,n-_.y]);return{...a,...{x:e,y:n,viewport:_,coordinate:E,layer:m}}}_resizeBuffer(){var e,n;const{gl:r}=this;if(!this.pickingFBO&&(this.pickingFBO=new vi(r),vi.isSupported(r,{colorBufferFloat:!0}))){const i=new vi(r);i.attach({36064:new oa(r,{format:Fn(r)?34836:6408,type:5126})}),this.depthFBO=i}(e=this.pickingFBO)===null||e===void 0||e.resize({width:r.canvas.width,height:r.canvas.height}),(n=this.depthFBO)===null||n===void 0||n.resize({width:r.canvas.width,height:r.canvas.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(r=>this.pickLayersPass.shouldDrawLayer(r)&&!r.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:r,x:i,y:a,radius:h=0,depth:l=1,mode:m="query",unproject3D:_,onViewportActive:E,effects:S}){const I=this._getPickable(e),L=hd(this.gl);if(!I)return{result:[],emptyInfo:F3({viewports:r,x:i,y:a,pixelRatio:L})};this._resizeBuffer();const O=ux(this.gl,[i,a],!0),D=[O.x+Math.floor(O.width/2),O.y+Math.floor(O.height/2)],H=Math.round(h*L),{width:z,height:N}=this.pickingFBO,F=this._getPickingRect({deviceX:D[0],deviceY:D[1],deviceRadius:H,deviceWidth:z,deviceHeight:N}),$={x:i-h,y:a-h,width:h*2+1,height:h*2+1};let Q;const te=[],re=new Set;for(let we=0;we<l;we++){let Ee;if(F){const Le=this._drawAndSample({layers:I,views:n,viewports:r,onViewportActive:E,deviceRect:F,cullRect:$,effects:S,pass:"picking:".concat(m)});Ee=B9({...Le,deviceX:D[0],deviceY:D[1],deviceRadius:H,deviceRect:F})}else Ee={pickedColor:null,pickedObjectIndex:-1};let de;if(Ee.pickedLayer&&_&&this.depthFBO){const{pickedColors:Le}=this._drawAndSample({layers:[Ee.pickedLayer],views:n,viewports:r,onViewportActive:E,deviceRect:{x:Ee.pickedX,y:Ee.pickedY,width:1,height:1},cullRect:$,effects:S,pass:"picking:".concat(m,":z")},!0);Le[3]&&(de=Le[0])}Ee.pickedLayer&&we+1<l&&(re.add(Ee.pickedLayer),Ee.pickedLayer.disablePickingIndex(Ee.pickedObjectIndex)),Q=V9({pickInfo:Ee,lastPickedInfo:this.lastPickedInfo,mode:m,layers:I,viewports:r,x:i,y:a,z:de,pixelRatio:L});for(const Le of Q.values())Le.layer&&te.push(Le);if(!Ee.pickedColor)break}for(const we of re)we.restorePickingColors();return{result:te,emptyInfo:Q.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:r,x:i,y:a,width:h=1,height:l=1,mode:m="query",maxObjects:_=null,onViewportActive:E,effects:S}){const I=this._getPickable(e);if(!I)return[];this._resizeBuffer();const L=hd(this.gl),O=ux(this.gl,[i,a],!0),D=O.x,H=O.y+O.height,z=ux(this.gl,[i+h,a+l],!0),N=z.x+z.width,F=z.y,$={x:D,y:F,width:N-D,height:H-F},Q=this._drawAndSample({layers:I,views:n,viewports:r,onViewportActive:E,deviceRect:$,cullRect:{x:i,y:a,width:h,height:l},effects:S,pass:"picking:".concat(m)}),te=U9(Q),re=new Map,we=Number.isFinite(_);for(let Ee=0;Ee<te.length&&!(we&&_&&re.size>=_);Ee++){const de=te[Ee];let Le={color:de.pickedColor,layer:null,index:de.pickedObjectIndex,picked:!0,x:i,y:a,pixelRatio:L};Le=N3({layer:de.pickedLayer,info:Le,mode:m}),re.has(Le.object)||re.set(Le.object,Le)}return Array.from(re.values())}_drawAndSample({layers:e,views:n,viewports:r,onViewportActive:i,deviceRect:a,cullRect:h,effects:l,pass:m},_=!1){const E=_?this.depthFBO:this.pickingFBO,S={layers:e,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:E,deviceRect:a,cullRect:h,effects:l,pass:m,pickZ:_,preRenderStats:{}};for(const N of l)N.useInPicking&&(S.preRenderStats[N.id]=N.preRender(this.gl,S));const{decodePickingColor:I}=this.pickLayersPass.render(S),{x:L,y:O,width:D,height:H}=a,z=new(_?Float32Array:Uint8Array)(D*H*4);return C_(E,{sourceX:L,sourceY:O,sourceWidth:D,sourceHeight:H,target:z}),{pickedColors:z,decodePickingColor:I}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:r,deviceWidth:i,deviceHeight:a}){const h=Math.max(0,e-r),l=Math.max(0,n-r),m=Math.min(i,e+r+1)-h,_=Math.min(a,n+r+1)-l;return m<=0||_<=0?null:{x:h,y:l,width:m,height:_}}}const G9={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};let H9=class{constructor(e){K(this,"el",null),K(this,"isVisible",!1);const n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,G9),n.appendChild(this.el))}setTooltip(e,n,r){const i=this.el;if(i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(n,"px, ").concat(r,"px)"),e&&typeof e=="object"&&"style"in e&&Object.assign(i.style,e.style)}}remove(){this.el&&(this.el.remove(),this.el=null)}};var B3={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,r,i){var a=["","webkit","Moz","MS","ms","o"],h=n.createElement("div"),l="function",m=Math.round,_=Math.abs,E=Date.now;function S(ee,ie,xe){return setTimeout(F(ee,xe),ie)}function I(ee,ie,xe){return Array.isArray(ee)?(L(ee,xe[ie],xe),!0):!1}function L(ee,ie,xe){var Ve;if(ee)if(ee.forEach)ee.forEach(ie,xe);else if(ee.length!==i)for(Ve=0;Ve<ee.length;)ie.call(xe,ee[Ve],Ve,ee),Ve++;else for(Ve in ee)ee.hasOwnProperty(Ve)&&ie.call(xe,ee[Ve],Ve,ee)}function O(ee,ie,xe){var Ve="DEPRECATED METHOD: "+ie+`
`+xe+` AT 
`;return function(){var lt=new Error("get-stack-trace"),Nt=lt&&lt.stack?lt.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Sn=e.console&&(e.console.warn||e.console.log);return Sn&&Sn.call(e.console,Ve,Nt),ee.apply(this,arguments)}}var D;typeof Object.assign!="function"?D=function(ie){if(ie===i||ie===null)throw new TypeError("Cannot convert undefined or null to object");for(var xe=Object(ie),Ve=1;Ve<arguments.length;Ve++){var lt=arguments[Ve];if(lt!==i&&lt!==null)for(var Nt in lt)lt.hasOwnProperty(Nt)&&(xe[Nt]=lt[Nt])}return xe}:D=Object.assign;var H=O(function(ie,xe,Ve){for(var lt=Object.keys(xe),Nt=0;Nt<lt.length;)(!Ve||Ve&&ie[lt[Nt]]===i)&&(ie[lt[Nt]]=xe[lt[Nt]]),Nt++;return ie},"extend","Use `assign`."),z=O(function(ie,xe){return H(ie,xe,!0)},"merge","Use `assign`.");function N(ee,ie,xe){var Ve=ie.prototype,lt;lt=ee.prototype=Object.create(Ve),lt.constructor=ee,lt._super=Ve,xe&&D(lt,xe)}function F(ee,ie){return function(){return ee.apply(ie,arguments)}}function $(ee,ie){return typeof ee==l?ee.apply(ie&&ie[0]||i,ie):ee}function Q(ee,ie){return ee===i?ie:ee}function te(ee,ie,xe){L(de(ie),function(Ve){ee.addEventListener(Ve,xe,!1)})}function re(ee,ie,xe){L(de(ie),function(Ve){ee.removeEventListener(Ve,xe,!1)})}function we(ee,ie){for(;ee;){if(ee==ie)return!0;ee=ee.parentNode}return!1}function Ee(ee,ie){return ee.indexOf(ie)>-1}function de(ee){return ee.trim().split(/\s+/g)}function Le(ee,ie,xe){if(ee.indexOf&&!xe)return ee.indexOf(ie);for(var Ve=0;Ve<ee.length;){if(xe&&ee[Ve][xe]==ie||!xe&&ee[Ve]===ie)return Ve;Ve++}return-1}function Ge(ee){return Array.prototype.slice.call(ee,0)}function Be(ee,ie,xe){for(var Ve=[],lt=[],Nt=0;Nt<ee.length;){var Sn=ie?ee[Nt][ie]:ee[Nt];Le(lt,Sn)<0&&Ve.push(ee[Nt]),lt[Nt]=Sn,Nt++}return xe&&(ie?Ve=Ve.sort(function(jr,di){return jr[ie]>di[ie]}):Ve=Ve.sort()),Ve}function Oe(ee,ie){for(var xe,Ve,lt=ie[0].toUpperCase()+ie.slice(1),Nt=0;Nt<a.length;){if(xe=a[Nt],Ve=xe?xe+lt:ie,Ve in ee)return Ve;Nt++}return i}var Ke=1;function je(){return Ke++}function it(ee){var ie=ee.ownerDocument||ee;return ie.defaultView||ie.parentWindow||e}var Me=/mobile|tablet|ip(ad|hone|od)|android/i,qe="ontouchstart"in e,ut=Oe(e,"PointerEvent")!==i,zt=qe&&Me.test(navigator.userAgent),vt="touch",yt="pen",at="mouse",bt="kinect",xt=25,$t=1,Kt=2,Ct=4,sn=8,Qt=1,pn=2,Wt=4,Ot=8,Dt=16,wn=pn|Wt,mn=Ot|Dt,En=wn|mn,zn=["x","y"],Re=["clientX","clientY"];function Bt(ee,ie){var xe=this;this.manager=ee,this.callback=ie,this.element=ee.element,this.target=ee.options.inputTarget,this.domHandler=function(Ve){$(ee.options.enable,[ee])&&xe.handler(Ve)},this.init()}Bt.prototype={handler:function(){},init:function(){this.evEl&&te(this.element,this.evEl,this.domHandler),this.evTarget&&te(this.target,this.evTarget,this.domHandler),this.evWin&&te(it(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&re(this.element,this.evEl,this.domHandler),this.evTarget&&re(this.target,this.evTarget,this.domHandler),this.evWin&&re(it(this.element),this.evWin,this.domHandler)}};function Rn(ee){var ie,xe=ee.options.inputClass;return xe?ie=xe:ut?ie=Kr:zt?ie=Se:qe?ie=He:ie=on,new ie(ee,an)}function an(ee,ie,xe){var Ve=xe.pointers.length,lt=xe.changedPointers.length,Nt=ie&$t&&Ve-lt===0,Sn=ie&(Ct|sn)&&Ve-lt===0;xe.isFirst=!!Nt,xe.isFinal=!!Sn,Nt&&(ee.session={}),xe.eventType=ie,It(ee,xe),ee.emit("hammer.input",xe),ee.recognize(xe),ee.session.prevInput=xe}function It(ee,ie){var xe=ee.session,Ve=ie.pointers,lt=Ve.length;xe.firstInput||(xe.firstInput=Fe(ie)),lt>1&&!xe.firstMultiple?xe.firstMultiple=Fe(ie):lt===1&&(xe.firstMultiple=!1);var Nt=xe.firstInput,Sn=xe.firstMultiple,Ir=Sn?Sn.center:Nt.center,jr=ie.center=et(Ve);ie.timeStamp=E(),ie.deltaTime=ie.timeStamp-Nt.timeStamp,ie.angle=Ne(Ir,jr),ie.distance=Mt(Ir,jr),st(xe,ie),ie.offsetDirection=Zt(ie.deltaX,ie.deltaY);var di=ot(ie.deltaTime,ie.deltaX,ie.deltaY);ie.overallVelocityX=di.x,ie.overallVelocityY=di.y,ie.overallVelocity=_(di.x)>_(di.y)?di.x:di.y,ie.scale=Sn?St(Sn.pointers,Ve):1,ie.rotation=Sn?Ye(Sn.pointers,Ve):0,ie.maxPointers=xe.prevInput?ie.pointers.length>xe.prevInput.maxPointers?ie.pointers.length:xe.prevInput.maxPointers:ie.pointers.length,_t(xe,ie);var cs=ee.element;we(ie.srcEvent.target,cs)&&(cs=ie.srcEvent.target),ie.target=cs}function st(ee,ie){var xe=ie.center,Ve=ee.offsetDelta||{},lt=ee.prevDelta||{},Nt=ee.prevInput||{};(ie.eventType===$t||Nt.eventType===Ct)&&(lt=ee.prevDelta={x:Nt.deltaX||0,y:Nt.deltaY||0},Ve=ee.offsetDelta={x:xe.x,y:xe.y}),ie.deltaX=lt.x+(xe.x-Ve.x),ie.deltaY=lt.y+(xe.y-Ve.y)}function _t(ee,ie){var xe=ee.lastInterval||ie,Ve=ie.timeStamp-xe.timeStamp,lt,Nt,Sn,Ir;if(ie.eventType!=sn&&(Ve>xt||xe.velocity===i)){var jr=ie.deltaX-xe.deltaX,di=ie.deltaY-xe.deltaY,cs=ot(Ve,jr,di);Nt=cs.x,Sn=cs.y,lt=_(cs.x)>_(cs.y)?cs.x:cs.y,Ir=Zt(jr,di),ee.lastInterval=ie}else lt=xe.velocity,Nt=xe.velocityX,Sn=xe.velocityY,Ir=xe.direction;ie.velocity=lt,ie.velocityX=Nt,ie.velocityY=Sn,ie.direction=Ir}function Fe(ee){for(var ie=[],xe=0;xe<ee.pointers.length;)ie[xe]={clientX:m(ee.pointers[xe].clientX),clientY:m(ee.pointers[xe].clientY)},xe++;return{timeStamp:E(),pointers:ie,center:et(ie),deltaX:ee.deltaX,deltaY:ee.deltaY}}function et(ee){var ie=ee.length;if(ie===1)return{x:m(ee[0].clientX),y:m(ee[0].clientY)};for(var xe=0,Ve=0,lt=0;lt<ie;)xe+=ee[lt].clientX,Ve+=ee[lt].clientY,lt++;return{x:m(xe/ie),y:m(Ve/ie)}}function ot(ee,ie,xe){return{x:ie/ee||0,y:xe/ee||0}}function Zt(ee,ie){return ee===ie?Qt:_(ee)>=_(ie)?ee<0?pn:Wt:ie<0?Ot:Dt}function Mt(ee,ie,xe){xe||(xe=zn);var Ve=ie[xe[0]]-ee[xe[0]],lt=ie[xe[1]]-ee[xe[1]];return Math.sqrt(Ve*Ve+lt*lt)}function Ne(ee,ie,xe){xe||(xe=zn);var Ve=ie[xe[0]]-ee[xe[0]],lt=ie[xe[1]]-ee[xe[1]];return Math.atan2(lt,Ve)*180/Math.PI}function Ye(ee,ie){return Ne(ie[1],ie[0],Re)+Ne(ee[1],ee[0],Re)}function St(ee,ie){return Mt(ie[0],ie[1],Re)/Mt(ee[0],ee[1],Re)}var gn={mousedown:$t,mousemove:Kt,mouseup:Ct},yn="mousedown",nt="mousemove mouseup";function on(){this.evEl=yn,this.evWin=nt,this.pressed=!1,Bt.apply(this,arguments)}N(on,Bt,{handler:function(ie){var xe=gn[ie.type];xe&$t&&ie.button===0&&(this.pressed=!0),xe&Kt&&ie.which!==1&&(xe=Ct),this.pressed&&(xe&Ct&&(this.pressed=!1),this.callback(this.manager,xe,{pointers:[ie],changedPointers:[ie],pointerType:at,srcEvent:ie}))}});var rn={pointerdown:$t,pointermove:Kt,pointerup:Ct,pointercancel:sn,pointerout:sn},Cr={2:vt,3:yt,4:at,5:bt},li="pointerdown",un="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(li="MSPointerDown",un="MSPointerMove MSPointerUp MSPointerCancel");function Kr(){this.evEl=li,this.evWin=un,Bt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}N(Kr,Bt,{handler:function(ie){var xe=this.store,Ve=!1,lt=ie.type.toLowerCase().replace("ms",""),Nt=rn[lt],Sn=Cr[ie.pointerType]||ie.pointerType,Ir=Sn==vt,jr=Le(xe,ie.pointerId,"pointerId");Nt&$t&&(ie.button===0||Ir)?jr<0&&(xe.push(ie),jr=xe.length-1):Nt&(Ct|sn)&&(Ve=!0),!(jr<0)&&(xe[jr]=ie,this.callback(this.manager,Nt,{pointers:xe,changedPointers:[ie],pointerType:Sn,srcEvent:ie}),Ve&&xe.splice(jr,1))}});var xi={touchstart:$t,touchmove:Kt,touchend:Ct,touchcancel:sn},he="touchstart",G="touchstart touchmove touchend touchcancel";function q(){this.evTarget=he,this.evWin=G,this.started=!1,Bt.apply(this,arguments)}N(q,Bt,{handler:function(ie){var xe=xi[ie.type];if(xe===$t&&(this.started=!0),!!this.started){var Ve=ne.call(this,ie,xe);xe&(Ct|sn)&&Ve[0].length-Ve[1].length===0&&(this.started=!1),this.callback(this.manager,xe,{pointers:Ve[0],changedPointers:Ve[1],pointerType:vt,srcEvent:ie})}}});function ne(ee,ie){var xe=Ge(ee.touches),Ve=Ge(ee.changedTouches);return ie&(Ct|sn)&&(xe=Be(xe.concat(Ve),"identifier",!0)),[xe,Ve]}var ce={touchstart:$t,touchmove:Kt,touchend:Ct,touchcancel:sn},_e="touchstart touchmove touchend touchcancel";function Se(){this.evTarget=_e,this.targetIds={},Bt.apply(this,arguments)}N(Se,Bt,{handler:function(ie){var xe=ce[ie.type],Ve=Te.call(this,ie,xe);Ve&&this.callback(this.manager,xe,{pointers:Ve[0],changedPointers:Ve[1],pointerType:vt,srcEvent:ie})}});function Te(ee,ie){var xe=Ge(ee.touches),Ve=this.targetIds;if(ie&($t|Kt)&&xe.length===1)return Ve[xe[0].identifier]=!0,[xe,xe];var lt,Nt,Sn=Ge(ee.changedTouches),Ir=[],jr=this.target;if(Nt=xe.filter(function(di){return we(di.target,jr)}),ie===$t)for(lt=0;lt<Nt.length;)Ve[Nt[lt].identifier]=!0,lt++;for(lt=0;lt<Sn.length;)Ve[Sn[lt].identifier]&&Ir.push(Sn[lt]),ie&(Ct|sn)&&delete Ve[Sn[lt].identifier],lt++;if(Ir.length)return[Be(Nt.concat(Ir),"identifier",!0),Ir]}var ge=2500,Ce=25;function He(){Bt.apply(this,arguments);var ee=F(this.handler,this);this.touch=new Se(this.manager,ee),this.mouse=new on(this.manager,ee),this.primaryTouch=null,this.lastTouches=[]}N(He,Bt,{handler:function(ie,xe,Ve){var lt=Ve.pointerType==vt,Nt=Ve.pointerType==at;if(!(Nt&&Ve.sourceCapabilities&&Ve.sourceCapabilities.firesTouchEvents)){if(lt)We.call(this,xe,Ve);else if(Nt&&Pt.call(this,Ve))return;this.callback(ie,xe,Ve)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function We(ee,ie){ee&$t?(this.primaryTouch=ie.changedPointers[0].identifier,Ze.call(this,ie)):ee&(Ct|sn)&&Ze.call(this,ie)}function Ze(ee){var ie=ee.changedPointers[0];if(ie.identifier===this.primaryTouch){var xe={x:ie.clientX,y:ie.clientY};this.lastTouches.push(xe);var Ve=this.lastTouches,lt=function(){var Nt=Ve.indexOf(xe);Nt>-1&&Ve.splice(Nt,1)};setTimeout(lt,ge)}}function Pt(ee){for(var ie=ee.srcEvent.clientX,xe=ee.srcEvent.clientY,Ve=0;Ve<this.lastTouches.length;Ve++){var lt=this.lastTouches[Ve],Nt=Math.abs(ie-lt.x),Sn=Math.abs(xe-lt.y);if(Nt<=Ce&&Sn<=Ce)return!0}return!1}var tn=Oe(h.style,"touchAction"),Lt=tn!==i,ft="compute",Ft="auto",xn="manipulation",bn="none",dn="pan-x",_n="pan-y",Ar=xr();function Ut(ee,ie){this.manager=ee,this.set(ie)}Ut.prototype={set:function(ee){ee==ft&&(ee=this.compute()),Lt&&this.manager.element.style&&Ar[ee]&&(this.manager.element.style[tn]=ee),this.actions=ee.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var ee=[];return L(this.manager.recognizers,function(ie){$(ie.options.enable,[ie])&&(ee=ee.concat(ie.getTouchAction()))}),On(ee.join(" "))},preventDefaults:function(ee){var ie=ee.srcEvent,xe=ee.offsetDirection;if(this.manager.session.prevented){ie.preventDefault();return}var Ve=this.actions,lt=Ee(Ve,bn)&&!Ar[bn],Nt=Ee(Ve,_n)&&!Ar[_n],Sn=Ee(Ve,dn)&&!Ar[dn];if(lt){var Ir=ee.pointers.length===1,jr=ee.distance<2,di=ee.deltaTime<250;if(Ir&&jr&&di)return}if(!(Sn&&Nt)&&(lt||Nt&&xe&wn||Sn&&xe&mn))return this.preventSrc(ie)},preventSrc:function(ee){this.manager.session.prevented=!0,ee.preventDefault()}};function On(ee){if(Ee(ee,bn))return bn;var ie=Ee(ee,dn),xe=Ee(ee,_n);return ie&&xe?bn:ie||xe?ie?dn:_n:Ee(ee,xn)?xn:Ft}function xr(){if(!Lt)return!1;var ee={},ie=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(xe){ee[xe]=ie?e.CSS.supports("touch-action",xe):!0}),ee}var Us=1,Jr=2,ls=4,ho=8,Cn=ho,zo=16,ki=32;function ir(ee){this.options=D({},this.defaults,ee||{}),this.id=je(),this.manager=null,this.options.enable=Q(this.options.enable,!0),this.state=Us,this.simultaneous={},this.requireFail=[]}ir.prototype={defaults:{},set:function(ee){return D(this.options,ee),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(ee){if(I(ee,"recognizeWith",this))return this;var ie=this.simultaneous;return ee=hi(ee,this),ie[ee.id]||(ie[ee.id]=ee,ee.recognizeWith(this)),this},dropRecognizeWith:function(ee){return I(ee,"dropRecognizeWith",this)?this:(ee=hi(ee,this),delete this.simultaneous[ee.id],this)},requireFailure:function(ee){if(I(ee,"requireFailure",this))return this;var ie=this.requireFail;return ee=hi(ee,this),Le(ie,ee)===-1&&(ie.push(ee),ee.requireFailure(this)),this},dropRequireFailure:function(ee){if(I(ee,"dropRequireFailure",this))return this;ee=hi(ee,this);var ie=Le(this.requireFail,ee);return ie>-1&&this.requireFail.splice(ie,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(ee){return!!this.simultaneous[ee.id]},emit:function(ee){var ie=this,xe=this.state;function Ve(lt){ie.manager.emit(lt,ee)}xe<ho&&Ve(ie.options.event+bi(xe)),Ve(ie.options.event),ee.additionalEvent&&Ve(ee.additionalEvent),xe>=ho&&Ve(ie.options.event+bi(xe))},tryEmit:function(ee){if(this.canEmit())return this.emit(ee);this.state=ki},canEmit:function(){for(var ee=0;ee<this.requireFail.length;){if(!(this.requireFail[ee].state&(ki|Us)))return!1;ee++}return!0},recognize:function(ee){var ie=D({},ee);if(!$(this.options.enable,[this,ie])){this.reset(),this.state=ki;return}this.state&(Cn|zo|ki)&&(this.state=Us),this.state=this.process(ie),this.state&(Jr|ls|ho|zo)&&this.tryEmit(ie)},process:function(ee){},getTouchAction:function(){},reset:function(){}};function bi(ee){return ee&zo?"cancel":ee&ho?"end":ee&ls?"move":ee&Jr?"start":""}function Lu(ee){return ee==Dt?"down":ee==Ot?"up":ee==pn?"left":ee==Wt?"right":""}function hi(ee,ie){var xe=ie.manager;return xe?xe.get(ee):ee}function Zn(){ir.apply(this,arguments)}N(Zn,ir,{defaults:{pointers:1},attrTest:function(ee){var ie=this.options.pointers;return ie===0||ee.pointers.length===ie},process:function(ee){var ie=this.state,xe=ee.eventType,Ve=ie&(Jr|ls),lt=this.attrTest(ee);return Ve&&(xe&sn||!lt)?ie|zo:Ve||lt?xe&Ct?ie|ho:ie&Jr?ie|ls:Jr:ki}});function Fo(){Zn.apply(this,arguments),this.pX=null,this.pY=null}N(Fo,Zn,{defaults:{event:"pan",threshold:10,pointers:1,direction:En},getTouchAction:function(){var ee=this.options.direction,ie=[];return ee&wn&&ie.push(_n),ee&mn&&ie.push(dn),ie},directionTest:function(ee){var ie=this.options,xe=!0,Ve=ee.distance,lt=ee.direction,Nt=ee.deltaX,Sn=ee.deltaY;return lt&ie.direction||(ie.direction&wn?(lt=Nt===0?Qt:Nt<0?pn:Wt,xe=Nt!=this.pX,Ve=Math.abs(ee.deltaX)):(lt=Sn===0?Qt:Sn<0?Ot:Dt,xe=Sn!=this.pY,Ve=Math.abs(ee.deltaY))),ee.direction=lt,xe&&Ve>ie.threshold&&lt&ie.direction},attrTest:function(ee){return Zn.prototype.attrTest.call(this,ee)&&(this.state&Jr||!(this.state&Jr)&&this.directionTest(ee))},emit:function(ee){this.pX=ee.deltaX,this.pY=ee.deltaY;var ie=Lu(ee.direction);ie&&(ee.additionalEvent=this.options.event+ie),this._super.emit.call(this,ee)}});function fo(){Zn.apply(this,arguments)}N(fo,Zn,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[bn]},attrTest:function(ee){return this._super.attrTest.call(this,ee)&&(Math.abs(ee.scale-1)>this.options.threshold||this.state&Jr)},emit:function(ee){if(ee.scale!==1){var ie=ee.scale<1?"in":"out";ee.additionalEvent=this.options.event+ie}this._super.emit.call(this,ee)}});function Jn(){ir.apply(this,arguments),this._timer=null,this._input=null}N(Jn,ir,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Ft]},process:function(ee){var ie=this.options,xe=ee.pointers.length===ie.pointers,Ve=ee.distance<ie.threshold,lt=ee.deltaTime>ie.time;if(this._input=ee,!Ve||!xe||ee.eventType&(Ct|sn)&&!lt)this.reset();else if(ee.eventType&$t)this.reset(),this._timer=S(function(){this.state=Cn,this.tryEmit()},ie.time,this);else if(ee.eventType&Ct)return Cn;return ki},reset:function(){clearTimeout(this._timer)},emit:function(ee){this.state===Cn&&(ee&&ee.eventType&Ct?this.manager.emit(this.options.event+"up",ee):(this._input.timeStamp=E(),this.manager.emit(this.options.event,this._input)))}});function Dn(){Zn.apply(this,arguments)}N(Dn,Zn,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[bn]},attrTest:function(ee){return this._super.attrTest.call(this,ee)&&(Math.abs(ee.rotation)>this.options.threshold||this.state&Jr)}});function Vs(){Zn.apply(this,arguments)}N(Vs,Zn,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:wn|mn,pointers:1},getTouchAction:function(){return Fo.prototype.getTouchAction.call(this)},attrTest:function(ee){var ie=this.options.direction,xe;return ie&(wn|mn)?xe=ee.overallVelocity:ie&wn?xe=ee.overallVelocityX:ie&mn&&(xe=ee.overallVelocityY),this._super.attrTest.call(this,ee)&&ie&ee.offsetDirection&&ee.distance>this.options.threshold&&ee.maxPointers==this.options.pointers&&_(xe)>this.options.velocity&&ee.eventType&Ct},emit:function(ee){var ie=Lu(ee.offsetDirection);ie&&this.manager.emit(this.options.event+ie,ee),this.manager.emit(this.options.event,ee)}});function Qn(){ir.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}N(Qn,ir,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[xn]},process:function(ee){var ie=this.options,xe=ee.pointers.length===ie.pointers,Ve=ee.distance<ie.threshold,lt=ee.deltaTime<ie.time;if(this.reset(),ee.eventType&$t&&this.count===0)return this.failTimeout();if(Ve&&lt&&xe){if(ee.eventType!=Ct)return this.failTimeout();var Nt=this.pTime?ee.timeStamp-this.pTime<ie.interval:!0,Sn=!this.pCenter||Mt(this.pCenter,ee.center)<ie.posThreshold;this.pTime=ee.timeStamp,this.pCenter=ee.center,!Sn||!Nt?this.count=1:this.count+=1,this._input=ee;var Ir=this.count%ie.taps;if(Ir===0)return this.hasRequireFailures()?(this._timer=S(function(){this.state=Cn,this.tryEmit()},ie.interval,this),Jr):Cn}return ki},failTimeout:function(){return this._timer=S(function(){this.state=ki},this.options.interval,this),ki},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Cn&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Gi(ee,ie){return ie=ie||{},ie.recognizers=Q(ie.recognizers,Gi.defaults.preset),new Ss(ee,ie)}Gi.VERSION="2.0.7",Gi.defaults={domEvents:!1,touchAction:ft,enable:!0,inputTarget:null,inputClass:null,preset:[[Dn,{enable:!1}],[fo,{enable:!1},["rotate"]],[Vs,{direction:wn}],[Fo,{direction:wn},["swipe"]],[Qn],[Qn,{event:"doubletap",taps:2},["tap"]],[Jn]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Hi=1,bl=2;function Ss(ee,ie){this.options=D({},Gi.defaults,ie||{}),this.options.inputTarget=this.options.inputTarget||ee,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=ee,this.input=Rn(this),this.touchAction=new Ut(this,this.options.touchAction),Sc(this,!0),L(this.options.recognizers,function(xe){var Ve=this.add(new xe[0](xe[1]));xe[2]&&Ve.recognizeWith(xe[2]),xe[3]&&Ve.requireFailure(xe[3])},this)}Ss.prototype={set:function(ee){return D(this.options,ee),ee.touchAction&&this.touchAction.update(),ee.inputTarget&&(this.input.destroy(),this.input.target=ee.inputTarget,this.input.init()),this},stop:function(ee){this.session.stopped=ee?bl:Hi},recognize:function(ee){var ie=this.session;if(!ie.stopped){this.touchAction.preventDefaults(ee);var xe,Ve=this.recognizers,lt=ie.curRecognizer;(!lt||lt&&lt.state&Cn)&&(lt=ie.curRecognizer=null);for(var Nt=0;Nt<Ve.length;)xe=Ve[Nt],ie.stopped!==bl&&(!lt||xe==lt||xe.canRecognizeWith(lt))?xe.recognize(ee):xe.reset(),!lt&&xe.state&(Jr|ls|ho)&&(lt=ie.curRecognizer=xe),Nt++}},get:function(ee){if(ee instanceof ir)return ee;for(var ie=this.recognizers,xe=0;xe<ie.length;xe++)if(ie[xe].options.event==ee)return ie[xe];return null},add:function(ee){if(I(ee,"add",this))return this;var ie=this.get(ee.options.event);return ie&&this.remove(ie),this.recognizers.push(ee),ee.manager=this,this.touchAction.update(),ee},remove:function(ee){if(I(ee,"remove",this))return this;if(ee=this.get(ee),ee){var ie=this.recognizers,xe=Le(ie,ee);xe!==-1&&(ie.splice(xe,1),this.touchAction.update())}return this},on:function(ee,ie){if(ee!==i&&ie!==i){var xe=this.handlers;return L(de(ee),function(Ve){xe[Ve]=xe[Ve]||[],xe[Ve].push(ie)}),this}},off:function(ee,ie){if(ee!==i){var xe=this.handlers;return L(de(ee),function(Ve){ie?xe[Ve]&&xe[Ve].splice(Le(xe[Ve],ie),1):delete xe[Ve]}),this}},emit:function(ee,ie){this.options.domEvents&&Pc(ee,ie);var xe=this.handlers[ee]&&this.handlers[ee].slice();if(!(!xe||!xe.length)){ie.type=ee,ie.preventDefault=function(){ie.srcEvent.preventDefault()};for(var Ve=0;Ve<xe.length;)xe[Ve](ie),Ve++}},destroy:function(){this.element&&Sc(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Sc(ee,ie){var xe=ee.element;if(xe.style){var Ve;L(ee.options.cssProps,function(lt,Nt){Ve=Oe(xe.style,Nt),ie?(ee.oldCssProps[Ve]=xe.style[Ve],xe.style[Ve]=lt):xe.style[Ve]=ee.oldCssProps[Ve]||""}),ie||(ee.oldCssProps={})}}function Pc(ee,ie){var xe=n.createEvent("Event");xe.initEvent(ee,!0,!0),xe.gesture=ie,ie.target.dispatchEvent(xe)}D(Gi,{INPUT_START:$t,INPUT_MOVE:Kt,INPUT_END:Ct,INPUT_CANCEL:sn,STATE_POSSIBLE:Us,STATE_BEGAN:Jr,STATE_CHANGED:ls,STATE_ENDED:ho,STATE_RECOGNIZED:Cn,STATE_CANCELLED:zo,STATE_FAILED:ki,DIRECTION_NONE:Qt,DIRECTION_LEFT:pn,DIRECTION_RIGHT:Wt,DIRECTION_UP:Ot,DIRECTION_DOWN:Dt,DIRECTION_HORIZONTAL:wn,DIRECTION_VERTICAL:mn,DIRECTION_ALL:En,Manager:Ss,Input:Bt,TouchAction:Ut,TouchInput:Se,MouseInput:on,PointerEventInput:Kr,TouchMouseInput:He,SingleTouchInput:q,Recognizer:ir,AttrRecognizer:Zn,Tap:Qn,Pan:Fo,Swipe:Vs,Pinch:fo,Rotate:Dn,Press:Jn,on:te,off:re,each:L,merge:z,extend:H,assign:D,inherit:N,bindFn:F,prefixed:Oe});var wl=typeof e<"u"?e:typeof self<"u"?self:{};wl.Hammer=Gi,typeof i=="function"&&i.amd?i(function(){return Gi}):t.exports?t.exports=Gi:e[r]=Gi})(window,document,"Hammer")})(B3);var Rm=B3.exports;const W9=_m(Rm),_a=KM({__proto__:null,default:W9},[Rm]),U3=1,V3=2,dw=4,q9={mousedown:U3,mousemove:V3,mouseup:dw};function Z9(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function X9(t){const e=t.prototype.handler;t.prototype.handler=function(r){const i=this.store;r.button>0&&r.type==="pointerdown"&&(Z9(i,a=>a.pointerId===r.pointerId)||i.push(r)),e.call(this,r)}}function Y9(t){t.prototype.handler=function(n){let r=q9[n.type];r&U3&&n.button>=0&&(this.pressed=!0),r&V3&&n.which===0&&(r=dw),this.pressed&&(r&dw&&(this.pressed=!1),this.callback(this.manager,r,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}X9(Rm.PointerEventInput);Y9(Rm.MouseInput);const K9=Rm.Manager;let A_=class{constructor(e,n,r){this.element=e,this.callback=n,this.options={enable:!0,...r}}};const J9=_a?[[_a.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[_a.Rotate,{enable:!1}],[_a.Pinch,{enable:!1}],[_a.Swipe,{enable:!1}],[_a.Pan,{threshold:0,enable:!1}],[_a.Press,{enable:!1}],[_a.Tap,{event:"doubletap",taps:2,enable:!1}],[_a.Tap,{event:"anytap",enable:!1}],[_a.Tap,{enable:!1}]]:null,MA={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},Q9={doubletap:["tap"]},eG={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},fE={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},tG={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},kA={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},nG=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",$h=typeof window<"u"?window:global;let fw=!1;try{const t={get passive(){return fw=!0,!0}};$h.addEventListener("test",null,t),$h.removeEventListener("test",null)}catch{fw=!1}const rG=nG.indexOf("firefox")!==-1,{WHEEL_EVENTS:iG}=fE,LA="wheel",RA=4.000244140625,sG=40,oG=.25;class aG extends A_{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{if(!this.options.enable)return;let a=i.deltaY;$h.WheelEvent&&(rG&&i.deltaMode===$h.WheelEvent.DOM_DELTA_PIXEL&&(a/=$h.devicePixelRatio),i.deltaMode===$h.WheelEvent.DOM_DELTA_LINE&&(a*=sG)),a!==0&&a%RA===0&&(a=Math.floor(a/RA)),i.shiftKey&&a&&(a=a*oG),this.callback({type:LA,center:{x:i.clientX,y:i.clientY},delta:-a,srcEvent:i,pointerType:"mouse",target:i.target})},this.events=(this.options.events||[]).concat(iG),this.events.forEach(i=>e.addEventListener(i,this.handleEvent,fw?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===LA&&(this.options.enable=n)}}const{MOUSE_EVENTS:lG}=fE,OA="pointermove",DA="pointerover",zA="pointerout",FA="pointerenter",NA="pointerleave";class cG extends A_{constructor(e,n,r){super(e,n,r),this.handleEvent=a=>{this.handleOverEvent(a),this.handleOutEvent(a),this.handleEnterEvent(a),this.handleLeaveEvent(a),this.handleMoveEvent(a)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(lG),this.events.forEach(a=>e.addEventListener(a,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===OA&&(this.enableMoveEvent=n),e===DA&&(this.enableOverEvent=n),e===zA&&(this.enableOutEvent=n),e===FA&&(this.enableEnterEvent=n),e===NA&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(DA,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(zA,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(FA,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(NA,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.which===0&&(this.pressed=!1),this.pressed||this._emit(OA,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:uG}=fE,BA="keydown",UA="keyup";class hG extends A_{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{const a=i.target||i.srcElement;a.tagName==="INPUT"&&a.type==="text"||a.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:BA,srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:UA,srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(uG),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===BA&&(this.enableDownEvent=n),e===UA&&(this.enableUpEvent=n)}}const VA="contextmenu";class dG extends A_{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{this.options.enable&&this.callback({type:VA,center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===VA&&(this.options.enable=n)}}const pw=1,q0=2,mw=4,fG={pointerdown:pw,pointermove:q0,pointerup:mw,mousedown:pw,mousemove:q0,mouseup:mw},pG=1,mG=2,gG=3,yG=0,_G=1,vG=2,xG=1,bG=2,wG=4;function EG(t){const e=fG[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r,which:i}=t.srcEvent;let a=!1,h=!1,l=!1;return e===mw||e===q0&&!Number.isFinite(n)?(a=i===pG,h=i===mG,l=i===gG):e===q0?(a=!!(n&xG),h=!!(n&wG),l=!!(n&bG)):e===pw&&(a=r===yG,h=r===_G,l=r===vG),{leftButton:a,middleButton:h,rightButton:l}}function TG(t,e){const n=t.center;if(!n)return null;const r=e.getBoundingClientRect(),i=r.width/e.offsetWidth||1,a=r.height/e.offsetHeight||1,h={x:(n.x-r.left-e.clientLeft)/i,y:(n.y-r.top-e.clientTop)/a};return{center:n,offsetCenter:h}}const Ix={srcElement:"root",priority:0};class SG{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const r=this._normalizeEvent(n);let i=n.srcEvent.target;for(;i&&i!==r.rootElement;){if(this._emit(r,i),r.handled)return;i=i.parentNode}this._emit(r,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,r,i=!1,a=!1){const{handlers:h,handlersByElement:l}=this;let m=Ix;typeof r=="string"||r&&r.addEventListener?m={...Ix,srcElement:r}:r&&(m={...Ix,...r});let _=l.get(m.srcElement);_||(_=[],l.set(m.srcElement,_));const E={type:e,handler:n,srcElement:m.srcElement,priority:m.priority};i&&(E.once=!0),a&&(E.passive=!0),h.push(E),this._active=this._active||!E.passive;let S=_.length-1;for(;S>=0&&!(_[S].priority>=E.priority);)S--;_.splice(S+1,0,E)}remove(e,n){const{handlers:r,handlersByElement:i}=this;for(let a=r.length-1;a>=0;a--){const h=r[a];if(h.type===e&&h.handler===n){r.splice(a,1);const l=i.get(h.srcElement);l.splice(l.indexOf(h),1),l.length===0&&i.delete(h.srcElement)}}this._active=r.some(a=>!a.passive)}_emit(e,n){const r=this.handlersByElement.get(n);if(r){let i=!1;const a=()=>{e.handled=!0},h=()=>{e.handled=!0,i=!0},l=[];for(let m=0;m<r.length;m++){const{type:_,handler:E,once:S}=r[m];if(E({...e,type:_,stopPropagation:a,stopImmediatePropagation:h}),S&&l.push(r[m]),i)break}for(let m=0;m<l.length;m++){const{type:_,handler:E}=l[m];this.remove(_,E)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...EG(e),...TG(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const PG={events:null,recognizers:null,recognizerOptions:{},Manager:K9,touchAction:"none",tabIndex:0};class CG{constructor(e=null,n){this._onBasicInput=i=>{const{srcEvent:a}=i,h=eG[a.type];h&&this.manager.emit(h,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={...PG,...n},this.events=new Map,this.setElement(e);const{events:r}=this.options;r&&this.on(r)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,r=n.Manager;this.manager=new r(e,{touchAction:n.touchAction,recognizers:n.recognizers||J9}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(MA).forEach(i=>{const a=this.manager.get(i);a&&MA[i].forEach(h=>{a.recognizeWith(h)})});for(const i in n.recognizerOptions){const a=this.manager.get(i);if(a){const h=n.recognizerOptions[i];delete h.enable,a.set(h)}}this.wheelInput=new aG(e,this._onOtherEvent,{enable:!1}),this.moveInput=new cG(e,this._onOtherEvent,{enable:!1}),this.keyInput=new hG(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new dG(e,this._onOtherEvent,{enable:!1});for(const[i,a]of this.events)a.isEmpty()||(this._toggleRecognizer(a.recognizerName,!0),this.manager.on(i,a.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,r){this._addEventHandler(e,n,r,!1)}once(e,n,r){this._addEventHandler(e,n,r,!0)}watch(e,n,r){this._addEventHandler(e,n,r,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:r}=this;if(!r)return;const i=r.get(e);if(i&&i.options.enable!==n){i.set({enable:n});const a=Q9[e];a&&!this.options.recognizers&&a.forEach(h=>{const l=r.get(h);n?(l.requireFailure(e),i.dropRequireFailure(h)):l.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,r,i,a){if(typeof e!="string"){r=n;for(const E in e)this._addEventHandler(E,e[E],r,i,a);return}const{manager:h,events:l}=this,m=kA[e]||e;let _=l.get(m);_||(_=new SG(this),l.set(m,_),_.recognizerName=tG[m]||m,h&&h.on(m,_.handleEvent)),_.add(e,n,r,i,a),_.isEmpty()||this._toggleRecognizer(_.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const h in e)this._removeEventHandler(h,e[h]);return}const{events:r}=this,i=kA[e]||e,a=r.get(i);if(a&&(a.remove(e,n),a.isEmpty())){const{recognizerName:h}=a;let l=!1;for(const m of r.values())if(m.recognizerName===h&&!m.isEmpty()){l=!0;break}l||this._toggleRecognizer(h,!1)}}}function Xc(){}const AG=({isDragging:t})=>t?"grabbing":"grab",j3={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:Xc,onResize:Xc,onViewStateChange:Xc,onInteractionStateChange:Xc,onBeforeRender:Xc,onAfterRender:Xc,onLoad:Xc,onError:t=>hr.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:AG,getTooltip:null,debug:!1,drawPickingColors:!1};class I_{constructor(e){K(this,"props",void 0),K(this,"width",0),K(this,"height",0),K(this,"userData",{}),K(this,"canvas",null),K(this,"viewManager",null),K(this,"layerManager",null),K(this,"effectManager",null),K(this,"deckRenderer",null),K(this,"deckPicker",null),K(this,"eventManager",null),K(this,"tooltip",null),K(this,"metrics",void 0),K(this,"animationLoop",void 0),K(this,"stats",void 0),K(this,"viewState",void 0),K(this,"cursorState",void 0),K(this,"_needsRedraw",void 0),K(this,"_pickRequest",void 0),K(this,"_lastPointerDownInfo",null),K(this,"_metricsCounter",void 0),K(this,"_onPointerMove",n=>{const{_pickRequest:r}=this;if(n.type==="pointerleave")r.x=-1,r.y=-1,r.radius=0;else{if(n.leftButton||n.rightButton)return;{const i=n.offsetCenter;if(!i)return;r.x=i.x,r.y=i.y,r.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:r.x,y:r.y}),r.event=n}),K(this,"_onEvent",n=>{const r=TC[n.type],i=n.offsetCenter;if(!r||!i||!this.layerManager)return;const a=this.layerManager.getLayers(),h=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:a,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:l}=h,m=l&&(l[r.handler]||l.props[r.handler]),_=this.props[r.handler];let E=!1;m&&(E=m.call(l,h,n)),!E&&_&&_(h,n)}),K(this,"_onPointerDown",n=>{const r=n.offsetCenter,i=this._pick("pickObject","pickObject Time",{x:r.x,y:r.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=i.result[0]||i.emptyInfo}),this.props={...j3,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&hr.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),OR()==="IE"&&hr.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new Y2({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&vd.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,r,i,a,h,l,m;if((e=this.animationLoop)===null||e===void 0||e.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(n=this.layerManager)===null||n===void 0||n.finalize(),this.layerManager=null,(r=this.viewManager)===null||r===void 0||r.finalize(),this.viewManager=null,(i=this.effectManager)===null||i===void 0||i.finalize(),this.effectManager=null,(a=this.deckRenderer)===null||a===void 0||a.finalize(),this.deckRenderer=null,(h=this.deckPicker)===null||h===void 0||h.finalize(),this.deckPicker=null,(l=this.eventManager)===null||l===void 0||l.destroy(),this.eventManager=null,(m=this.tooltip)===null||m===void 0||m.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var _;(_=this.canvas.parentElement)===null||_===void 0||_.removeChild(this.canvas),this.canvas=null}}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&hr.removed("onLayerHover","onHover")(),"onLayerClick"in e&&hr.removed("onLayerClick","onClick")(),e.initialViewState&&!Ca(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),a=this.effectManager.needsRedraw(e),h=this.deckRenderer.needsRedraw(e);return n=n||r||i||a||h,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return Ci(this.viewManager),this.viewManager.views}getViewports(e){return Ci(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_pick(e,n,r){Ci(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(n).timeStart();const a=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return i.get(n).timeEnd(),a}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),Ci(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:r}=e;if(n||n===0){const a=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.width=a}if(r||r===0){var i;const a=Number.isFinite(r)?"".concat(r,"px"):r;this.canvas.style.position=((i=e.style)===null||i===void 0?void 0:i.position)||"absolute",this.canvas.style.height=a}}_updateCanvasSize(){var e,n;const{canvas:r}=this;if(!r)return;const i=(e=r.clientWidth)!==null&&e!==void 0?e:r.width,a=(n=r.clientHeight)!==null&&n!==void 0?n:r.height;if(i!==this.width||a!==this.height){var h,l;this.width=i,this.height=a,(h=this.viewManager)===null||h===void 0||h.setProps({width:i,height:a}),(l=this.layerManager)===null||l===void 0||l.activateViewport(this.getViewports()[0]),this.props.onResize({width:i,height:a})}}_createAnimationLoop(e){const{width:n,height:r,gl:i,glOptions:a,debug:h,onError:l,onBeforeRender:m,onAfterRender:_,useDevicePixels:E}=e;return new SV({width:n,height:r,useDevicePixels:E,autoResizeDrawingBuffer:!i,autoResizeViewport:!1,gl:i,onCreateContext:S=>VR({...a,...S,canvas:this.canvas,debug:h,onContextLost:()=>this._onContextLost()}),onInitialize:S=>this._setGLContext(S.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:m,onAfterRender:_,onError:l})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new z3({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:r,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=r.length>0;let a=i,h=!1;for(const l of r){var n;a=l,h=((n=l.layer)===null||n===void 0?void 0:n.onHover(l,e.event))||h}if(!h&&this.props.onHover&&this.props.onHover(a,e.event),this.props.getTooltip&&this.tooltip){const l=this.props.getTooltip(a);this.tooltip.setTooltip(l,a.x,a.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,X2(e,{enable:!0,copyState:!0})),this.tooltip=new H9(this.canvas),hl(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const n=new g3;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new CG(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in TC)this.eventManager.on(i,this._onEvent);this.viewManager=new v9({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new _9(e,{deck:this,stats:this.stats,viewport:r,timeline:n}),this.effectManager=new O9,this.deckRenderer=new F9(e),this.deckPicker=new $9(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{gl:r}=this.layerManager.context;hl(r,this.props.parameters),this.props.onBeforeRender({gl:r}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...n}),this.props.onAfterRender({gl:r})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),hr.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const r=su.get("Memory Usage");e.bufferMemory=r.get("Buffer Memory").count,e.textureMemory=r.get("Texture Memory").count,e.renderbufferMemory=r.get("Renderbuffer Memory").count,e.gpuMemory=r.get("GPU Memory").count}}K(I_,"defaultProps",j3);K(I_,"VERSION",MB);class Mx{constructor(e,n){K(this,"opts",void 0),K(this,"source",void 0),this.opts=n,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),n=this.getAccessor();if(e)return[e,n];const{value:r}=this.source,{size:i}=n;let a=r;if(r&&r.length!==i){a=new Float32Array(i);const h=n.elementOffset||0;for(let l=0;l<i;++l)a[l]=r[h+l]}return a}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function IG(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function t0(t){return t.stride||t.size*t.bytesPerElement}function $3(t,e){e.offset&&hr.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=t0(t),r=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,a=r*n+i*t.bytesPerElement+(t.offset||0);return{...e,offset:a,stride:n}}function MG(t,e){const n=$3(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class kG{constructor(e,n,r){K(this,"gl",void 0),K(this,"id",void 0),K(this,"size",void 0),K(this,"settings",void 0),K(this,"value",void 0),K(this,"doublePrecision",void 0),K(this,"_buffer",void 0),K(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;const i=n.logicalType||n.type,a=i===5130;let{defaultValue:h}=n;h=Number.isFinite(h)?[h]:h||new Array(this.size).fill(0);let l;a?l=5126:!i&&n.isIndexed?l=e&&t8(e,Sr.ELEMENT_INDEX_UINT32)?5125:5123:l=i||5126;let m=IG(i||l||5126);this.doublePrecision=a,a&&n.fp64===!1&&(m=Float32Array),this.value=null,this.settings={...n,defaultType:m,defaultValue:h,logicalType:i,type:l,size:this.size,bytesPerElement:m.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:n}=this.settings;this._buffer=new ur(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*t0(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),vd.release(this.state.allocatedValue)}getShaderAttributes(e,n){if(this.doublePrecision){const r={},i=this.value instanceof Float64Array,a=MG(this.getAccessor(),n||{});return r[e]=new Mx(this,a.high),r["".concat(e,"64Low")]=i?new Mx(this,a.low):new Float32Array(this.size),r}if(n){const r=$3(this.getAccessor(),n);return{[e]:new Mx(this,r)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:r,size:i}=this,a=r*i;if(n&&a&&n.length>=a){const h=new Array(i).fill(1/0),l=new Array(i).fill(-1/0);for(let m=0;m<a;)for(let _=0;_<i;_++){const E=n[m++];E<h[_]&&(h[_]=E),E>l[_]&&(l[_]=E)}e=[h,l]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let r;ArrayBuffer.isView(e)?r={value:e}:e instanceof ur?r={buffer:e}:r=e;const i={...this.settings,...r};if(n.bufferAccessor=i,n.bounds=null,r.constant){let a=r.value;if(a=this._normalizeValue(a,[],0),this.settings.normalized&&(a=this.normalizeConstant(a)),!(!n.constant||!this._areValuesEqual(a,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=a}else if(r.buffer){const a=r.buffer;n.externalBuffer=a,n.constant=!1,this.value=r.value||null;const h=r.value instanceof Float64Array;i.type=r.type||a.accessor.type,i.bytesPerElement=a.accessor.BYTES_PER_ELEMENT*(h?2:1),i.stride=t0(i)}else if(r.value){this._checkExternalBuffer(r);let a=r.value;n.externalBuffer=null,n.constant=!1,this.value=a,i.bytesPerElement=a.BYTES_PER_ELEMENT,i.stride=t0(i);const{buffer:h,byteOffset:l}=this;this.doublePrecision&&a instanceof Float64Array&&(a=Px(a,i));const m=a.byteLength+l+i.stride*2;h.byteLength<m&&h.reallocate(m),h.setAccessor(null),h.subData({data:a,offset:l}),i.type=r.type||h.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:r=0,endOffset:i}=e;this.buffer.subData({data:this.doublePrecision&&n instanceof Float64Array?Px(n,{size:this.size,startIndex:r,endIndex:i}):n.subarray(r,i),offset:r*n.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,n=!1){const{state:r}=this,i=r.allocatedValue,a=vd.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=a;const{buffer:h,byteOffset:l}=this;return h.byteLength<a.byteLength+l&&(h.reallocate(a.byteLength+l),n&&i&&h.subData({data:i instanceof Float64Array?Px(i,this):i,offset:l})),r.allocatedValue=a,r.constant=!1,r.externalBuffer=null,r.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const r=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=n.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(n.constructor.name));!(n instanceof r)&&this.settings.normalized&&!("normalized"in e)&&hr.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(n=>(n+128)/255*2-1);case 5122:return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case 5121:return new Float32Array(e).map(n=>n/255);case 5123:return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,r){const{defaultValue:i,size:a}=this.settings;if(Number.isFinite(e))return n[r]=e,n;if(!e){let h=a;for(;--h>=0;)n[r+h]=i[h];return n}switch(a){case 4:n[r+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:n[r+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:n[r+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:n[r+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let h=a;for(;--h>=0;)n[r+h]=Number.isFinite(e[h])?e[h]:i[h]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:r}=this;for(let i=0;i<r;i++)if(e[i]!==n[i])return!1;return!0}}const jA=[],$A=[];function pE(t,e=0,n=1/0){let r=jA;const i={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?r=t:t.length>0&&($A.length=t.length,r=$A):r=jA,(e>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,n),i.index=e-1),{iterable:r,objectInfo:i}}function G3(t){return t&&t[Symbol.asyncIterator]}function H3(t,e){const{size:n,stride:r,offset:i,startIndices:a,nested:h}=e,l=t.BYTES_PER_ELEMENT,m=r?r/l:n,_=i?i/l:0,E=Math.floor((t.length-_)/m);return(S,{index:I,target:L})=>{if(!a){const z=I*m+_;for(let N=0;N<n;N++)L[N]=t[z+N];return L}const O=a[I],D=a[I+1]||E;let H;if(h){H=new Array(D-O);for(let z=O;z<D;z++){const N=z*m+_;L=new Array(n);for(let F=0;F<n;F++)L[F]=t[N+F];H[z-O]=L}}else if(m===n)H=t.subarray(O*n+_,D*n+_);else{H=new t.constructor((D-O)*n);let z=0;for(let N=O;N<D;N++){const F=N*m+_;for(let $=0;$<n;$++)H[z++]=t[F+$]}}return H}}const LG=[],n0=[[0,1/0]];function RG(t,e){if(t===n0||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],r=t.length;let i=0;for(let a=0;a<r;a++){const h=t[a];h[1]<e[0]?(n.push(h),i=a+1):h[0]>e[1]?n.push(h):e=[Math.min(h[0],e[0]),Math.max(h[1],e[1])]}return n.splice(i,0,e),n}function kx(t){const{source:e,target:n,start:r=0,size:i,getData:a}=t,h=t.end||n.length,l=e.length,m=h-r;if(l>m){n.set(e.subarray(0,m),r);return}if(n.set(e,r),!a)return;let _=l;for(;_<m;){const E=a(_,e);for(let S=0;S<i;S++)n[r+_]=E[S]||0,_++}}function OG({source:t,target:e,size:n,getData:r,sourceStartIndices:i,targetStartIndices:a}){if(!Array.isArray(a))return kx({source:t,target:e,size:n,getData:r}),e;let h=0,l=0;const m=r&&((E,S)=>r(E+l,S)),_=Math.min(i.length,a.length);for(let E=1;E<_;E++){const S=i[E]*n,I=a[E]*n;kx({source:t.subarray(h,S),target:e,start:l,end:I,size:n,getData:m}),h=S,l=I}return l<e.length&&kx({source:[],target:e,start:l,size:n,getData:m}),e}const DG={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function W3(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...DG[n],...e,...t,type:n}}function q3(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function Z3(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function X3(t){t.push(t.shift())}function mE(t,e){const{doublePrecision:n,settings:r,value:i,size:a}=t,h=n&&i instanceof Float64Array?2:1;return(r.noAlloc?i.length:e*a)*h}function Y3({buffer:t,numInstances:e,attribute:n,fromLength:r,fromStartIndices:i,getData:a=h=>h}){const h=n.doublePrecision&&n.value instanceof Float64Array?2:1,l=n.size*h,m=n.byteOffset,_=n.startIndices,E=i&&_,S=mE(n,e),I=n.isConstant;if(!E&&r>=S)return;const L=I?n.value:n.getBuffer().getData({srcByteOffset:m});if(n.settings.normalized&&!I){const z=a;a=(N,F)=>n.normalizeConstant(z(N,F))}const O=I?(z,N)=>a(L,N):(z,N)=>a(L.subarray(z,z+l),N),D=t.getData({length:r}),H=new Float32Array(S);OG({source:D,target:H,sourceStartIndices:i,targetStartIndices:_,size:l,getData:O}),t.byteLength<H.byteLength+m&&t.reallocate(H.byteLength+m),t.subData({data:H,offset:m})}class gE extends kG{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:n0}),K(this,"constant",!1),this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,r=this.settings.transition,i=Array.isArray(n)?e[n.find(a=>e[a])]:e[n];return W3(i,r)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:r=0,endRow:i=1/0}=n;this.state.updateRanges=RG(this.state.updateRanges,[r,i])}else this.state.updateRanges=n0}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=LG}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:r}=this;return r.noAlloc?!1:r.update?(super.allocate(e,n.updateRanges!==n0),!0):!1}updateBuffer({numInstances:e,data:n,props:r,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:a},settings:{update:h,noAlloc:l}}=this;let m=!0;if(h){for(const[_,E]of a)h.call(i,this,{data:n,startRow:_,endRow:E,props:r,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[_,E]of a){const S=Number.isFinite(_)?this.getVertexOffset(_):0,I=Number.isFinite(E)?this.getVertexOffset(E):l||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:S,endOffset:I})}this._checkAttributeArray()}else m=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),m}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:r,settings:i}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),i.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const h=e;Ci(ArrayBuffer.isView(h.value),"invalid ".concat(i.accessor));const l=!!h.size&&h.size!==this.size;return r.binaryAccessor=H3(h.value,{size:h.size||this.size,stride:h.stride,offset:h.offset,startIndices:n,nested:l}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},n={};for(const r in e)Object.assign(n,super.getShaderAttributes(r,e[r]));return n}_autoUpdater(e,{data:n,startRow:r,endRow:i,props:a,numInstances:h}){if(e.constant)return;const{settings:l,state:m,value:_,size:E,startIndices:S}=e,{accessor:I,transform:L}=l,O=m.binaryAccessor||(typeof I=="function"?I:a[I]);Ci(typeof O=="function",'accessor "'.concat(I,'" is not a function'));let D=e.getVertexOffset(r);const{iterable:H,objectInfo:z}=pE(n,r,i);for(const N of H){z.index++;let F=O(N,z);if(L&&(F=L.call(this,F)),S){const $=(z.index<S.length-1?S[z.index+1]:h)-S[z.index];if(F&&Array.isArray(F[0])){let Q=D;for(const te of F)e._normalizeValue(te,_,Q),Q+=E}else F&&F.length>E?_.set(F,D):(e._normalizeValue(F,z.target,0),c9({target:_,source:z.target,start:D,count:$}));D+=$*E}else e._normalizeValue(F,_,D),D+=E}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let r=!0;switch(n){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class zG{constructor({gl:e,attribute:n,timeline:r}){K(this,"gl",void 0),K(this,"type","interpolation"),K(this,"attributeInTransition",void 0),K(this,"settings",void 0),K(this,"attribute",void 0),K(this,"transition",void 0),K(this,"currentStartIndices",void 0),K(this,"currentLength",void 0),K(this,"transform",void 0),K(this,"buffers",void 0),this.gl=e,this.transition=new Lm(r),this.attribute=n,this.attributeInTransition=new gE(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=NG(e,n);const i={byteLength:0,usage:35050};this.buffers=[new ur(e,i),new ur(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){if(e.duration<=0){this.transition.cancel();return}this.settings=e;const{gl:r,buffers:i,attribute:a}=this;X3(i);const h={numInstances:n,attribute:a,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const l of i)Y3({buffer:l,...h});this.currentStartIndices=a.startIndices,this.currentLength=mE(a,n),this.attributeInTransition.setData({buffer:i[1],value:a.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/a.size),sourceBuffers:{aFrom:i[0],aTo:q3(r,a)},feedbackBuffers:{vCurrent:i[1]}})}update(){const e=this.transition.update();if(e){const{duration:n,easing:r}=this.settings,{time:i}=this.transition;let a=i/n;r&&(a=r(a)),this.transform.run({uniforms:{time:a}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}}const FG=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function NG(t,e){const n=Z3(e.size);return new iE(t,{vs:FG,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}class BG{constructor({gl:e,attribute:n,timeline:r}){K(this,"gl",void 0),K(this,"type","spring"),K(this,"attributeInTransition",void 0),K(this,"settings",void 0),K(this,"attribute",void 0),K(this,"transition",void 0),K(this,"currentStartIndices",void 0),K(this,"currentLength",void 0),K(this,"texture",void 0),K(this,"framebuffer",void 0),K(this,"transform",void 0),K(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new Lm(r),this.attribute=n,this.attributeInTransition=new gE(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=VG(e),this.framebuffer=jG(e,this.texture),this.transform=UG(e,n,this.framebuffer);const i={byteLength:0,usage:35050};this.buffers=[new ur(e,i),new ur(e,i),new ur(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){const{gl:r,buffers:i,attribute:a}=this,h={numInstances:n,attribute:a,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const l of i)Y3({buffer:l,...h});this.settings=e,this.currentStartIndices=a.startIndices,this.currentLength=mE(a,n),this.attributeInTransition.setData({buffer:i[1],value:a.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/a.size),sourceBuffers:{aTo:q3(r,a)}})}update(){const{buffers:e,transform:n,framebuffer:r,transition:i}=this;if(!i.update())return!1;const h=this.settings;return n.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),n.run({framebuffer:r,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:h.stiffness,damping:h.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),X3(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),C_(r)[0]>0||i.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function UG(t,e,n){const r=Z3(e.size);return new iE(t,{framebuffer:n,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}function VG(t){return new oa(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function jG(t,e){return new vi(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}const $G={interpolation:zG,spring:BG};class GG{constructor(e,{id:n,timeline:r}){K(this,"id",void 0),K(this,"isSupported",void 0),K(this,"gl",void 0),K(this,"timeline",void 0),K(this,"transitions",void 0),K(this,"needsRedraw",void 0),K(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=iE.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:r}){this.numInstances=r||1;for(const i in e){const a=e[i],h=a.getTransitionSetting(n);h&&this._updateAttribute(i,a,h)}for(const i in this.transitions){const a=e[i];(!a||!a.getTransitionSetting(n))&&this._removeTransition(i)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const r=this.transitions[n];r.inProgress&&(e[n]=r.attributeInTransition)}return e}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,n,r){const i=this.transitions[e];let a=!i||i.type!==r.type;if(a){if(!this.isSupported){hr.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();return}i&&this._removeTransition(e);const h=$G[r.type];h?this.transitions[e]=new h({attribute:n,timeline:this.timeline,gl:this.gl}):(hr.error("unsupported transition type '".concat(r.type,"'"))(),a=!1)}(a||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}}const GA="attributeManager.invalidate",HG="attributeManager.updateStart",WG="attributeManager.updateEnd",qG="attribute.updateStart",ZG="attribute.allocate",XG="attribute.updateEnd";class YG{constructor(e,{id:n="attribute-manager",stats:r,timeline:i}={}){K(this,"id",void 0),K(this,"gl",void 0),K(this,"attributes",void 0),K(this,"updateTriggers",void 0),K(this,"needsRedraw",void 0),K(this,"userData",void 0),K(this,"stats",void 0),K(this,"attributeTransitionManager",void 0),K(this,"mergeBoundsMemoized",km(e9)),this.id=n,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new GG(e,{id:"".concat(n,"-transitions"),timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const r=this._invalidateTrigger(e,n);ss(GA,this,e,r)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);ss(GA,this,"all")}update({data:e,numInstances:n,startIndices:r=null,transitions:i,props:a={},buffers:h={},context:l={}}){let m=!1;ss(HG,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const _ in this.attributes){const E=this.attributes[_],S=E.settings.accessor;E.startIndices=r,E.numInstances=n,a[_]&&hr.removed("props.".concat(_),"data.attributes.".concat(_))(),E.setExternalBuffer(h[_])||E.setBinaryValue(typeof S=="string"?h[S]:void 0,e.startIndices)||typeof S=="string"&&!h[S]&&E.setConstantValue(a[S])||E.needsUpdate()&&(m=!0,this._updateAttribute({attribute:E,numInstances:n,data:e,props:a,context:l})),this.needsRedraw=this.needsRedraw||E.needsRedraw()}m&&ss(WG,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return this.attributes}getBounds(e){const n=e.map(r=>{var i;return(i=this.attributes[r])===null||i===void 0?void 0:i.getBounds()});return this.mergeBoundsMemoized(n)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:r}=this,i={...r.getAttributes()};for(const a in n){const h=n[a];h.needsRedraw(e)&&!r.hasAttribute(a)&&(i[a]=h)}return i}getShaderAttributes(e,n={}){e||(e=this.getAttributes());const r={};for(const i in e)n[i]||Object.assign(r,e[i].getShaderAttributes());return r}_add(e,n={}){for(const r in e){const i=e[r];this.attributes[r]=this._createAttribute(r,i,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,n,r){const i={...n,id:e,size:n.isIndexed&&1||n.size||1,divisor:r.instanced?1:n.divisor||0};return new gE(this.gl,i)}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:r,updateTriggers:i}=this,a=i[e];return a&&a.forEach(h=>{const l=r[h];l&&l.setNeedsUpdate(l.id,n)}),a}_updateAttribute(e){const{attribute:n,numInstances:r}=e;if(ss(qG,n),n.constant){n.setConstantValue(n.value);return}n.allocate(r)&&ss(ZG,n,r),n.updateBuffer(e)&&(this.needsRedraw=!0,ss(XG,n,r))}}class KG extends Lm{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:r,duration:i,easing:a}}=this,h=a(e/i);this._value=rm(n,r,h)}}const HA=1e-5;function WA(t,e,n,r,i){const a=e-t,l=(n-e)*i,m=-a*r;return l+m+a+e}function JG(t,e,n,r,i){if(Array.isArray(n)){const a=[];for(let h=0;h<n.length;h++)a[h]=WA(t[h],e[h],n[h],r,i);return a}return WA(t,e,n,r,i)}function qA(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}class QG extends Lm{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:r,stiffness:i}=this.settings,{_prevValue:a=e,_currValue:h=e}=this;let l=JG(a,h,n,r,i);const m=qA(l,n),_=qA(l,h);m<HA&&_<HA&&(l=n,this.end()),this._prevValue=h,this._currValue=l}}const eH={interpolation:KG,spring:QG};class tH{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,r,i){const{transitions:a}=this;if(a.has(e)){const m=a.get(e),{value:_=m.settings.fromValue}=m;n=_,this.remove(e)}if(i=W3(i),!i)return;const h=eH[i.type];if(!h){hr.error("unsupported transition type '".concat(i.type,"'"))();return}const l=new h(this.timeline);l.start({...i,fromValue:n,toValue:r}),a.set(e,l)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,r]of this.transitions)r.update(),e[n]=r.value,r.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function nH(t){const e=t[pc];for(const n in e){const r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function rH(t,e){const n=K3({newProps:t,oldProps:e,propTypes:t[pc],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=sH(t,e);let i=!1;return r||(i=oH(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:aH(t,e),transitionsChanged:iH(t,e)}}function iH(t,e){if(!t.transitions)return!1;const n={},r=t[pc];let i=!1;for(const a in t.transitions){const h=r[a],l=h&&h.type;(l==="number"||l==="color"||l==="array")&&gw(t[a],e[a],h)&&(n[a]=!0,i=!0)}return i?n:!1}function K3({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i="props"}){if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(i," changed shallowly");for(const a of Object.keys(t))if(!(a in n)){if(!(a in e))return"".concat(i,".").concat(a," added");const h=gw(t[a],e[a],r[a]);if(h)return"".concat(i,".").concat(a," ").concat(h)}for(const a of Object.keys(e))if(!(a in n)){if(!(a in t))return"".concat(i,".").concat(a," dropped");if(!Object.hasOwnProperty.call(t,a)){const h=gw(t[a],e[a],r[a]);if(h)return"".concat(i,".").concat(a," ").concat(h)}}return!1}function gw(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)||!r&&(r=t&&e&&t.equals,r&&!r.call(t,e))?"changed deeply":!r&&e!==t?"changed shallowly":null}function sH(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:i}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&i&&(n=i(t.data,e.data)||n),n}function oH(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&ZA(t,e,"all"))return{all:!0};const n={};let r=!1;for(const i in t.updateTriggers)i!=="all"&&ZA(t,e,i)&&(n[i]=!0,r=!0);return r?n:!1}function aH(t,e){if(e===null)return!0;const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(!n||!r||r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function ZA(t,e,n){let r=t.updateTriggers[n];r=r??{};let i=e.updateTriggers[n];return i=i??{},K3({oldProps:i,newProps:r,triggerName:n})}const lH="count(): argument not an object",cH="count(): argument not a container";function uH(t){if(!dH(t))throw new Error(lH);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(hH(t))return Object.keys(t).length;throw new Error(cH)}function hH(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function dH(t){return t!==null&&typeof t=="object"}function fH(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(r=>r.name==="project64"))){const r=n.modules.findIndex(i=>i.name==="project32");r>=0&&n.modules.splice(r,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const r={...t.inject};for(const i in e.inject)r[i]=(r[i]||"")+e.inject[i];n.inject=r}return n}const pH={10241:9987,10240:9729,10242:33071,10243:33071},yw={};function mH(t,e,n,r){if(n instanceof oa)return n;n.constructor&&n.constructor.name!=="Object"&&(n={data:n});let i=null;n.compressed&&(i={10241:n.data.length>1?9985:9729});const a=new oa(e,{...n,parameters:{...pH,...i,...r}});return yw[a.id]=t,a}function gH(t,e){!e||!(e instanceof oa)||yw[e.id]===t&&(e.delete(),delete yw[e.id])}const yH={boolean:{validate(t,e){return!0},equal(t,e,n){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||_w(t)&&(t.length===3||t.length===4)},equal(t,e,n){return Ca(t,e,1)}},accessor:{validate(t,e){const n=Z0(t);return n==="function"||n===Z0(e.value)},equal(t,e,n){return typeof e=="function"?!0:Ca(t,e,1)}},array:{validate(t,e){return e.optional&&!t||_w(t)},equal(t,e,n){const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?Ca(t,e,i):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?Ca(t,e,i):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare&&n.ignore!==!1||t===e}},data:{transform:(t,e,n)=>{const{dataTransform:r}=n.props;return r&&t?r(t):t}},image:{transform:(t,e,n)=>{const r=n.context;return!r||!r.gl?null:mH(n.id,r.gl,t,{...e.parameters,...n.props.textureParameters})},release:(t,e,n)=>{gH(n.id,t)}}};function _H(t){const e={},n={},r={};for(const[i,a]of Object.entries(t)){const h=a==null?void 0:a.deprecatedFor;if(h)r[i]=Array.isArray(h)?h:[h];else{const l=vH(i,a);e[i]=l,n[i]=l.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}function vH(t,e){switch(Z0(e)){case"object":return Jf(t,e);case"array":return Jf(t,{type:"array",value:e,compare:!1});case"boolean":return Jf(t,{type:"boolean",value:e});case"number":return Jf(t,{type:"number",value:e});case"function":return Jf(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function Jf(t,e){return"type"in e?{name:t,...yH[e.type],...e}:"value"in e?{name:t,type:Z0(e.value),...e}:{name:t,type:"object",value:e}}function _w(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function Z0(t){return _w(t)?"array":t===null?"null":typeof t}function xH(t,e){let n;for(let a=e.length-1;a>=0;a--){const h=e[a];"extensions"in h&&(n=h.extensions)}const r=vw(t.constructor,n),i=Object.create(r);i[W0]=t,i[vu]={},i[tc]={};for(let a=0;a<e.length;++a){const h=e[a];for(const l in h)i[l]=h[l]}return Object.freeze(i),i}const bH="_mergedDefaultProps";function vw(t,e){let n=bH;if(e)for(const i of e){const a=i.constructor;a&&(n+=":".concat(a.extensionName||a.name))}const r=J3(t,n);return r||(t[n]=wH(t,e||[]))}function wH(t,e){if(!t.prototype)return null;const r=Object.getPrototypeOf(t),i=vw(r),a=J3(t,"defaultProps")||{},h=_H(a),l=Object.assign(Object.create(null),i,h.defaultProps),m=Object.assign(Object.create(null),i==null?void 0:i[pc],h.propTypes),_=Object.assign(Object.create(null),i==null?void 0:i[Ax],h.deprecatedProps);for(const E of e){const S=vw(E.constructor);S&&(Object.assign(l,S),Object.assign(m,S[pc]),Object.assign(_,S[Ax]))}return EH(l,t),SH(l,m),TH(l,_),l[pc]=m,l[Ax]=_,e.length===0&&!yE(t,"_propTypes")&&(t._propTypes=m),l}function EH(t,e){const n=CH(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}function TH(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(r){const i="".concat(this.id,": ").concat(n);for(const a of e[n])yE(this,a)||(this[a]=r);hr.deprecated(i,e[n].join("/"))()}})}function SH(t,e){const n={},r={};for(const i in e){const a=e[i],{name:h,value:l}=a;a.async&&(n[h]=l,r[h]=PH(h))}t[Qh]=n,t[vu]={},Object.defineProperties(t,r)}function PH(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||G3(e)?this[vu][t]=e:this[tc][t]=e},get(){if(this[tc]){if(t in this[tc])return this[tc][t]||this[Qh][t];if(t in this[vu]){const e=this[W0]&&this[W0].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[Qh][t]}}return this[Qh][t]}}}function yE(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function J3(t,e){return yE(t,e)&&t[e]}function CH(t){const e=t.componentName;return e||hr.warn("".concat(t.name,".componentName not specified"))(),e||t.name}let AH=0;class _E{constructor(...e){K(this,"id",void 0),K(this,"props",void 0),K(this,"count",void 0),this.props=xH(this,e),this.id=this.props.id,this.count=AH++}clone(e){const{props:n}=this,r={};for(const i in n[Qh])i in n[tc]?r[i]=n[tc][i]:i in n[vu]&&(r[i]=n[vu][i]);return new this.constructor({...n,...r,...e})}}K(_E,"componentName","Component");K(_E,"defaultProps",{});const IH=Object.freeze({});class MH{constructor(e){K(this,"component",void 0),K(this,"onAsyncPropUpdated",void 0),K(this,"asyncProps",void 0),K(this,"oldProps",void 0),K(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||IH}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){this.component=e[W0]||this.component;const n=e[tc]||{},r=e[vu]||e,i=e[Qh]||{};for(const a in n){const h=n[a];this._createAsyncPropData(a,i[a]),this._updateAsyncProp(a,h),n[a]=this.getAsyncProp(a)}for(const a in r){const h=r[a];this._createAsyncPropData(a,i[a]),this._updateAsyncProp(a,h)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(G3(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const r=this.asyncProps[e];return n===r.resolvedValue||n===r.lastValue?!1:(r.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const r=this.asyncProps[e];r&&(n=this._postProcessValue(r,n),r.resolvedValue=n,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,n,r){const i=this.asyncProps[e];i&&r>=i.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=n,i.resolvedLoadCount=r,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const r=this.asyncProps[e];if(r){r.pendingLoadCount++;const i=r.pendingLoadCount;n.then(a=>{this.component&&(a=this._postProcessValue(r,a),this._setAsyncPropValue(e,a,i),this._onResolve(e,a))}).catch(a=>{this._onError(e,a)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const r=this.asyncProps[e];if(!r)return;r.pendingLoadCount++;const i=r.pendingLoadCount;let a=[],h=0;for await(const l of n){if(!this.component)return;const{dataTransform:m}=this.component.props;m?a=m(l,a):a=a.concat(l),Object.defineProperty(a,"__diff",{enumerable:!1,value:[{startRow:h,endRow:a.length}]}),h=a.length,this._setAsyncPropValue(e,a,i)}this._onResolve(e,a)}_postProcessValue(e,n){const r=e.type;return r&&this.component&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(n,r,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const i=this.component&&this.component.props[pc];this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class kH extends MH{constructor({attributeManager:e,layer:n}){super(n),K(this,"attributeManager",void 0),K(this,"needsRedraw",void 0),K(this,"needsUpdate",void 0),K(this,"subLayers",void 0),K(this,"usesPickingColorCache",void 0),K(this,"hasPickingBuffer",void 0),K(this,"changeFlags",void 0),K(this,"viewport",void 0),K(this,"uniformTransitions",void 0),K(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,n){const r=this.layer,i=r==null?void 0:r.props.fetch;return i?i(n,{propName:e,layer:r}):super._fetch(e,n)}_onResolve(e,n){const r=this.layer;if(r){const i=r.props.onDataLoad;e==="data"&&i&&i(n,{propName:e,layer:r})}}_onError(e,n){const r=this.layer;r&&r.raiseError(n,"loading ".concat(e," of ").concat(this.layer))}}const LH="layer.changeFlag",RH="layer.initialize",OH="layer.update",DH="layer.finalize",zH="layer.matched",XA=2**24-1,FH=Object.freeze([]),NH=km(({oldViewport:t,viewport:e})=>t.equals(e));let va=new Uint8ClampedArray(0);const BH={data:{type:"data",value:FH,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:a})=>{const{resourceManager:h}=n.context;if(i=i||n.getLoadOptions(),r=r||n.props.loaders,a){var l;i={...i,fetch:{...(l=i)===null||l===void 0?void 0:l.fetch,signal:a}}}let m=h.contains(t);return!m&&!i&&(h.add({resourceId:t,data:qb(t,r),persistent:!1}),m=!0),m?h.subscribe({resourceId:t,onChange:_=>{var E;return(E=n.internalState)===null||E===void 0?void 0:E.reloadAsyncProp(e,_)},consumerId:n.id,requestId:e}):qb(t,r,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:Wn.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class Iu extends _E{constructor(...e){super(...e),K(this,"internalState",null),K(this,"lifecycle",Ah.NO_STATE),K(this,"context",void 0),K(this,"state",void 0),K(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){Ci(this.internalState);const n=this.internalState.viewport||this.context.viewport,r=k3(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,a,h]=P3(r,n.pixelProjectionMatrix);return e.length===2?[i,a]:[i,a,h]}unproject(e){return Ci(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){Ci(this.internalState);const r=this.internalState.viewport||this.context.viewport;return o9(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===Wn.DEFAULT||e===Wn.LNGLAT||e===Wn.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){Ci(e instanceof Uint8Array);const[n,r,i]=e;return n+r*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:uH(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return(e=this.getAttributeManager())===null||e===void 0?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){for(const n of this.props.extensions)e=fH(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&n)if(Array.isArray(r))for(const i of r)n.invalidateAll(i);else n.invalidateAll();if(n){const{props:i}=e,a=this.internalState.hasPickingBuffer,h=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(l=>l.getNeedsPickingBuffer.call(this,l));if(a!==h){this.internalState.hasPickingBuffer=h;const{pickingColors:l,instancePickingColors:m}=n.attributes,_=l||m;_&&(h&&_.constant&&(_.constant=!1,n.invalidate(_.id)),!_.value&&!h&&(_.constant=!0,_.value=[0,0,0]))}}}finalizeState(e){for(const r of this.getModels())r.delete();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:r}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,n){var r,i;if(n&&(e=new Error("".concat(n,": ").concat(e.message),{cause:e})),!((r=(i=this.props).onError)!==null&&r!==void 0&&r.call(i,e))){var a,h;(a=this.context)===null||a===void 0||(h=a.onError)===null||h===void 0||h.call(a,e,this)}}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)===null||e===void 0?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!NH({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const n of this.getModels())this._setModelAttributes(n,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,r=this.getNumInstances(),i=this.getStartIndices();e.update({data:n.data,numInstances:r,startIndices:i,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const a=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(a)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),r=Object.create(this.props);for(const i in n)Object.defineProperty(r,i,{value:n[i]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const r=Math.floor(va.length/3);if(this.internalState.usesPickingColorCache=!0,r<n){n>XA&&hr.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),va=vd.allocate(va,n,{size:3,copy:!0,maxCount:Math.max(n,XA)});const i=Math.floor(va.length/3),a=[];for(let h=r;h<i;h++)this.encodePickingColor(h,a),va[h*3+0]=a[0],va[h*3+1]=a[1],va[h*3+2]=a[2]}e.value=va.subarray(0,n*3)}_setModelAttributes(e,n){const r=this.getAttributeManager(),i=e.userData.excludeAttributes||{},a=r.getShaderAttributes(n,i);e.setAttributes(a)}disablePickingIndex(e){const n=this.props.data;if(!("attributes"in n)){this._disablePickingIndex(e);return}const{pickingColors:r,instancePickingColors:i}=this.getAttributeManager().attributes,a=r||i,h=a&&n.attributes&&n.attributes[a.id];if(h&&h.value){const l=h.value,m=this.encodePickingColor(e);for(let _=0;_<n.length;_++){const E=a.getVertexOffset(_);l[E]===m[0]&&l[E+1]===m[1]&&l[E+2]===m[2]&&this._disablePickingIndex(_)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,i=n||r;if(!i)return;const a=i.getVertexOffset(e),h=i.getVertexOffset(e+1);i.buffer.subData({data:new Uint8Array(h-a),offset:a})}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n;r&&(this.internalState.usesPickingColorCache&&r.value.buffer!==va.buffer&&(r.value=va.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){Ci(!this.internalState),Ci(Number.isFinite(this.props.coordinateSystem)),ss(RH,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new kH({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(hr.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new tH(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){ss(zH,this,this===e);const{state:n,internalState:r}=e;this!==e&&(this.internalState=r,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(ss(OH,this,e),!e)return;const n=this.props,r=this.context,i=this.internalState,a=r.viewport,h=this._updateUniformTransition();i.propsInTransition=h,r.viewport=i.viewport||a,this.props=h;try{const l=this._getUpdateParams(),m=this.getModels();if(r.gl)this.updateState(l);else try{this.updateState(l)}catch{}for(const E of this.props.extensions)E.updateState.call(this,l,E);const _=this.getModels()[0]!==m[0];this._postUpdate(l,_)}finally{r.viewport=a,this.props=n,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){ss(DH,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({moduleParameters:e=null,uniforms:n={},parameters:r={}}){this._updateAttributeTransition();const i=this.props,a=this.context;this.props=this.internalState.propsInTransition||i;const h=this.props.opacity;n.opacity=Math.pow(h,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:l}=this.props,m=l&&l(n)||[0,0];hl(a.gl,{polygonOffset:m}),ia(a.gl,r,()=>{const _={moduleParameters:e,uniforms:n,parameters:r,context:a};for(const E of this.props.extensions)E.draw.call(this,_,E);this.draw(_)})}finally{this.props=i}}getChangeFlags(){var e;return(e=this.internalState)===null||e===void 0?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const i in e)if(e[i]){let a=!1;switch(i){case"dataChanged":const h=e[i],l=n[i];h&&Array.isArray(l)&&(n.dataChanged=Array.isArray(h)?l.concat(h):h,a=!0);default:n[i]||(n[i]=e[i],a=!0)}a&&ss(LH,this,i,e)}const r=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=r,n.somethingChanged=r||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const r=rH(e,n);if(r.updateTriggersChanged)for(const a in r.updateTriggersChanged)r.updateTriggersChanged[a]&&this.invalidateAttribute(a);if(r.transitionsChanged)for(const a in r.transitionsChanged){var i;this.internalState.uniformTransitions.add(a,n[a],e[a],(i=e.transitions)===null||i===void 0?void 0:i[a])}return this.setChangeFlags(r)}validateProps(){nH(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={pickingSelectedColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&typeof r=="function"&&(n.pickingHighlightColor=r(e)),this.setModuleParameters(n),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new YG(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:r,oldProps:i}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:a}=this.state;a==null||a.setInstanceCount(this.getNumInstances());const{autoHighlight:h,highlightedObjectIndex:l,highlightColor:m}=r;if(n||i.autoHighlight!==h||i.highlightedObjectIndex!==l||i.highlightColor!==m){const _={};h||(_.pickingSelectedColor=null),Array.isArray(m)&&(_.pickingHighlightColor=m),(n||l!==i.highlightedObjectIndex)&&(_.pickingSelectedColor=Number.isFinite(l)&&l>=0?this.encodePickingColor(l):null),this.setModuleParameters(_)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id;const r=this.getAttributeManager(),i=r?r.getNeedsRedraw(e):!1;if(n=n||i,n)for(const a of this.props.extensions)a.onNeedsRedraw.call(this,a);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}K(Iu,"defaultProps",BH);K(Iu,"layerName","Layer");const UH="compositeLayer.renderLayers";class Q3 extends Iu{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:r}=this.props;return r&&r[e]&&r[e].type||n}getSubLayerRow(e,n,r){return e.__source={parent:this,object:n,index:r},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(r,i)=>r&&r.__source?(n.index=r.__source.index,e(r.__source.object,n)):e(r,i)}return e}getSubLayerProps(e={}){var n;const{opacity:r,pickable:i,visible:a,parameters:h,getPolygonOffset:l,highlightedObjectIndex:m,autoHighlight:_,highlightColor:E,coordinateSystem:S,coordinateOrigin:I,wrapLongitude:L,positionFormat:O,modelMatrix:D,extensions:H,fetch:z,operation:N,_subLayerProps:F}=this.props,$={id:"",updateTriggers:{},opacity:r,pickable:i,visible:a,parameters:h,getPolygonOffset:l,highlightedObjectIndex:m,autoHighlight:_,highlightColor:E,coordinateSystem:S,coordinateOrigin:I,wrapLongitude:L,positionFormat:O,modelMatrix:D,extensions:H,fetch:z,operation:N},Q=F&&e.id&&F[e.id],te=Q&&Q.updateTriggers,re=e.id||"sublayer";if(Q){const we=this.props[pc],Ee=e.type?e.type._propTypes:{};for(const de in Q){const Le=Ee[de]||we[de];Le&&Le.type==="accessor"&&(Q[de]=this.getSubLayerAccessor(Q[de]))}}Object.assign($,e,Q),$.id="".concat(this.props.id,"-").concat(re),$.updateTriggers={all:(n=this.props.updateTriggers)===null||n===void 0?void 0:n.all,...e.updateTriggers,...te};for(const we of H){const Ee=we.getSubLayerProps.call(this,we);Ee&&Object.assign($,Ee,{updateTriggers:Object.assign($.updateTriggers,Ee.updateTriggers)})}return $}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let r=this.internalState.subLayers;const i=!r||this.needsUpdate();if(i){const a=this.renderLayers();r=uE(a,Boolean),this.internalState.subLayers=r}ss(UH,this,i,r);for(const a of r)a.parent=this}}K(Q3,"layerName","CompositeLayer");const Lx={bearing:0,pitch:0,position:[0,0,0]},VH={speed:1.2,curve:1.414};class jH extends O3{constructor(e={}){super({compare:["longitude","latitude","zoom","bearing","pitch","position"],extract:["width","height","longitude","latitude","zoom","bearing","pitch","position"],required:["width","height","latitude","longitude","zoom"]}),K(this,"opts",void 0),this.opts={...VH,...e}}interpolateProps(e,n,r){const i=z7(e,n,r,this.opts);for(const a in Lx)i[a]=rm(e[a]||Lx[a],n[a]||Lx[a],r);return i}getDuration(e,n){let{transitionDuration:r}=n;return r==="auto"&&(r=F7(e,n,this.opts)),r}}class eO{constructor(e){K(this,"opts",void 0),K(this,"typedArrayManager",void 0),K(this,"indexStarts",[0]),K(this,"vertexStarts",[0]),K(this,"vertexCount",0),K(this,"instanceCount",0),K(this,"attributes",void 0),K(this,"_attributeDefs",void 0),K(this,"data",void 0),K(this,"getGeometry",void 0),K(this,"geometryBuffer",void 0),K(this,"buffers",void 0),K(this,"positionSize",void 0),K(this,"normalize",void 0);const{attributes:n={}}=e;this.typedArrayManager=vd,this.attributes={},this._attributeDefs=n,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:n,buffers:r={},getGeometry:i,geometryBuffer:a,positionFormat:h,dataChanged:l,normalize:m=!0}=this.opts;if(this.data=n,this.getGeometry=i,this.positionSize=a&&a.size||(h==="XY"?2:3),this.buffers=r,this.normalize=m,a&&(Ci(n.startIndices),this.getGeometry=this.getGeometryFromBuffer(a),m||(r.positions=a)),this.geometryBuffer=r.positions,Array.isArray(l))for(const _ of l)this._rebuildGeometry(_);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:n}){this._rebuildGeometry({startRow:e,endRow:n})}getGeometryFromBuffer(e){const n=e.value||e;return ArrayBuffer.isView(n)?H3(n,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,n){const{attributes:r,buffers:i,_attributeDefs:a,typedArrayManager:h}=this;for(const l in a)if(l in i)h.release(r[l]),r[l]=null;else{const m=a[l];m.copy=n,r[l]=h.allocate(r[l],e,m)}}_forEachGeometry(e,n,r){const{data:i,getGeometry:a}=this,{iterable:h,objectInfo:l}=pE(i,n,r);for(const m of h){l.index++;const _=a?a(m,l):null;e(_,l.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:n,vertexStarts:r,instanceCount:i}=this;const{data:a,geometryBuffer:h}=this,{startRow:l=0,endRow:m=1/0}=e||{},_={};if(e||(n=[0],r=[0]),this.normalize||!h)this._forEachGeometry((S,I)=>{const L=S&&this.normalizeGeometry(S);_[I]=L,r[I+1]=r[I]+(L?this.getGeometrySize(L):0)},l,m),i=r[r.length-1];else if(r=a.startIndices,i=r[a.length]||0,ArrayBuffer.isView(h))i=i||h.length/this.positionSize;else if(h instanceof ur){const S=h.accessor.stride||this.positionSize*4;i=i||h.byteLength/S}else if(h.buffer){const S=h.stride||this.positionSize*4;i=i||h.buffer.byteLength/S}else if(h.value){const S=h.value,I=h.stride/S.BYTES_PER_ELEMENT||this.positionSize;i=i||S.length/I}this._allocate(i,!!e),this.indexStarts=n,this.vertexStarts=r,this.instanceCount=i;const E={};this._forEachGeometry((S,I)=>{const L=_[I]||S;E.vertexStart=r[I],E.indexStart=n[I];const O=I<r.length-1?r[I+1]:i;E.geometrySize=O-r[I],E.geometryIndex=I,this.updateGeometryAttributes(L,E)},l,m),this.vertexCount=n[n.length-1]}}const $H=typeof window<"u"?Z.useLayoutEffect:Z.useEffect,GH=$H;function X0(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}const HH={position:"absolute",zIndex:-1};function tO(t,e){if(typeof t=="function")return t(e);if(Array.isArray(t))return t.map(n=>tO(n,e));if(M_(t)){if(WH(t))return e.style=HH,Z.cloneElement(t,e);if(qH(t))return Z.cloneElement(t,e)}return t}function M_(t){return t&&typeof t=="object"&&"type"in t||!1}function WH(t){var e;return(e=t.props)===null||e===void 0?void 0:e.mapStyle}function qH(t){const e=t.type;return e&&e.deckGLViewProps}function xw(t){if(typeof t=="function")return Z.createElement(bd,{},t);if(Array.isArray(t))return t.map(xw);if(M_(t)){if(t.type===Z.Fragment)return xw(t.props.children);if(X0(t.type,bd))return t}return t}function ZH({children:t,layers:e=[],views:n=null}){const r=[],i=[],a={};return Z.Children.forEach(xw(t),h=>{if(M_(h)){const l=h.type;if(X0(l,Iu)){const m=XH(l,h.props);i.push(m)}else r.push(h);if(X0(l,bd)&&l!==bd&&h.props.id){const m=new l(h.props);a[m.id]=m}}else h&&r.push(h)}),Object.keys(a).length>0&&(Array.isArray(n)?n.forEach(h=>{a[h.id]=h}):n&&(a[n.id]=n),n=Object.values(a)),e=i.length>0?[...i,...e]:e,{layers:e,children:r,views:n}}function XH(t,e){const n={},r=t.defaultProps||{};for(const i in e)r[i]!==e[i]&&(n[i]=e[i]);return new t(n)}function YH({children:t,deck:e,ContextProvider:n}){const{viewManager:r}=e||{};if(!r||!r.views.length)return[];const i={},a=r.views[0].id;for(const h of t){let l=a,m=h;M_(h)&&X0(h.type,bd)&&(l=h.props.id||a,m=h.props.children);const _=r.getViewport(l),E=r.getViewState(l);if(_){E.padding=_.padding;const{x:S,y:I,width:L,height:O}=_;m=tO(m,{x:S,y:I,width:L,height:O,viewport:_,viewState:E}),i[l]||(i[l]={viewport:_,children:[]}),i[l].children.push(m)}}return Object.keys(i).map(h=>{const{viewport:l,children:m}=i[h],{x:_,y:E,width:S,height:I}=l,L={position:"absolute",left:_,top:E,width:S,height:I},O="view-".concat(h),D=Z.createElement("div",{key:O,id:O,style:L},...m);if(n){const H={viewport:l,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:z=>{z.viewId=h,e._onViewStateChange(z)}};return Z.createElement(n,{key:O,value:H},D)}return D})}const KH={mixBlendMode:null};function JH({width:t,height:e,style:n}){const r={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},i={left:0,top:0};if(n)for(const a in n)a in KH?i[a]=n[a]:r[a]=n[a];return{containerStyle:r,canvasStyle:i}}function QH(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}function nO(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}function eW(t,e,n){const r=new e({...n,_customRender:i=>{t.redrawReason=i;const a=r.getViewports();t.lastRenderedViewports!==a?t.forceUpdate():nO(t)}});return r}const rO=Z.forwardRef((t,e)=>{const[n,r]=Z.useState(0),a=Z.useRef({control:null,version:n,forceUpdate:()=>r(Q=>Q+1)}).current,h=Z.useRef(null),l=Z.useRef(null),m=Z.useMemo(()=>ZH(t),[t.layers,t.views,t.children]);let _=!0;const E=Q=>{var te;return _&&t.viewState?(a.viewStateUpdateRequested=Q,null):(a.viewStateUpdateRequested=null,(te=t.onViewStateChange)===null||te===void 0?void 0:te.call(t,Q))},S=Q=>{if(_)a.interactionStateUpdateRequested=Q;else{var te;a.interactionStateUpdateRequested=null,(te=t.onInteractionStateChange)===null||te===void 0||te.call(t,Q)}},I=Z.useMemo(()=>{const Q={...t,style:null,width:"100%",height:"100%",parent:h.current,canvas:l.current,layers:m.layers,views:m.views,onViewStateChange:E,onInteractionStateChange:S};return delete Q._customRender,a.deck&&a.deck.setProps(Q),Q},[t]);Z.useEffect(()=>{const Q=t.Deck||I_;return a.deck=eW(a,Q,{...I,parent:h.current,canvas:l.current}),()=>{var te;return(te=a.deck)===null||te===void 0?void 0:te.finalize()}},[]),GH(()=>{nO(a);const{viewStateUpdateRequested:Q,interactionStateUpdateRequested:te}=a;Q&&E(Q),te&&S(te)}),Z.useImperativeHandle(e,()=>QH(a),[]);const L=a.deck&&a.deck.isInitialized?a.deck.getViewports():void 0,{ContextProvider:O,width:D,height:H,id:z,style:N}=t,{containerStyle:F,canvasStyle:$}=Z.useMemo(()=>JH({width:D,height:H,style:N}),[D,H,N]);if(!a.viewStateUpdateRequested&&a.lastRenderedViewports===L||a.version!==n){a.lastRenderedViewports=L,a.version=n;const Q=YH({children:m.children,deck:a.deck,ContextProvider:O}),te=Z.createElement("canvas",{key:"canvas",id:z||"deckgl-overlay",ref:l,style:$});a.control=Z.createElement("div",{id:"".concat(z||"deckgl","-wrapper"),ref:h,style:F},[te,Q])}return _=!1,a.control});rO.defaultProps=I_.defaultProps;const tW=rO,nW="modulepreload",rW=function(t){return"/rutas-ambulancias-lima.github.io/"+t},YA={},iW=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(a=>{if(a=rW(a),a in YA)return;YA[a]=!0;const h=a.endsWith(".css"),l=h?'[rel="stylesheet"]':"";if(!!r)for(let E=i.length-1;E>=0;E--){const S=i[E];if(S.href===a&&(!h||S.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${l}`))return;const _=document.createElement("link");if(_.rel=h?"stylesheet":nW,h||(_.as="script",_.crossOrigin=""),_.href=a,document.head.appendChild(_),h)return new Promise((E,S)=>{_.addEventListener("load",E),_.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${a}`)))})})).then(()=>e()).catch(a=>{const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=a,window.dispatchEvent(h),!h.defaultPrevented)throw a})},sW=Z.createContext(null);function oW(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0,i=Array.isArray(e)?e[0]:e?e.x:0,a=Array.isArray(e)?e[1]:e?e.y:0;return n===i&&r===a}function tl(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!tl(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const i of n)if(!e.hasOwnProperty(i)||!tl(t[i],e[i]))return!1;return!0}return!1}function aW(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function KA(t,e){if(!t.getProjection)return;const n=t.getProjection(),r=e.getProjection();tl(n,r)||e.setProjection(n)}function JA(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function QA(t,e){const n=e.viewState||e;let r=!1;if("longitude"in n&&"latitude"in n){const i=t.center;t.center=new i.constructor(n.longitude,n.latitude),r=r||i!==t.center}if("zoom"in n){const i=t.zoom;t.zoom=n.zoom,r=r||i!==t.zoom}if("bearing"in n){const i=t.bearing;t.bearing=n.bearing,r=r||i!==t.bearing}if("pitch"in n){const i=t.pitch;t.pitch=n.pitch,r=r||i!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(r=!0,t.padding=n.padding),r}const lW=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function eI(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const r of t.layers)e[r.id]=r;const n=t.layers.map(r=>{let i=null;"interactive"in r&&(i=Object.assign({},r),delete i.interactive);const a=e[r.ref];if(a){i=i||Object.assign({},r),delete i.ref;for(const h of lW)h in a&&(i[h]=a[h])}return i||r});return{...t,layers:n}}const tI={version:8,sources:{},layers:[]},nI={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},Rx={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},rI={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},cW=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],uW=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class wd{constructor(e,n,r){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=i=>{const a=this.props[rI[i.type]];a?a(i):i.type==="error"&&console.error(i.error)},this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const a=this.props[nI[i.type]];a&&(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"&&(i.features=this._hoveredFeatures||this._queryRenderedFeatures(i.point)),a(i),delete i.features)},this._onCameraEvent=i=>{if(!this._internalUpdate){const a=this.props[Rx[i.type]];a&&a(i)}i.type in this._deferredEvents&&(this._deferredEvents[i.type]=!1)},this._MapClass=e,this.props=n,this._initialize(r)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const n=this.props;this.props=e;const r=this._updateSettings(e,n);r&&this._createShadowTransform(this._map);const i=this._updateSize(e),a=this._updateViewState(e,!0);this._updateStyle(e,n),this._updateStyleComponents(e,n),this._updateHandlers(e,n),(r||i||a&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const r=wd.savedMaps.pop();if(!r)return null;const i=r.map,a=i.getContainer();for(n.className=a.className;a.childNodes.length>0;)n.appendChild(a.childNodes[0]);i._container=n;const h=i._resizeObserver;h&&(h.disconnect(),h.observe(n)),r.setProps({...e,styleDiffing:!1}),i.resize();const{initialViewState:l}=e;return l&&(l.bounds?i.fitBounds(l.bounds,{...l.fitBoundsOptions,duration:0}):r._updateViewState(l,!1)),i.isStyleLoaded()?i.fire("load"):i.once("styledata",()=>i.fire("load")),i._update(),r}_initialize(e){const{props:n}=this,{mapStyle:r=tI}=n,i={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||hW()||null,container:e,style:eI(r)},a=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[a.longitude||0,a.latitude||0],zoom:a.zoom||0,pitch:a.pitch||0,bearing:a.bearing||0}),n.gl){const E=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=E,n.gl)}const h=new this._MapClass(i);a.padding&&h.setPadding(a.padding),n.cursor&&(h.getCanvas().style.cursor=n.cursor),this._createShadowTransform(h);const l=h._render;h._render=E=>{this._inRender=!0,l.call(h,E),this._inRender=!1};const m=h._renderTaskQueue.run;h._renderTaskQueue.run=E=>{m.call(h._renderTaskQueue,E),this._onBeforeRepaint()},h.on("render",()=>this._onAfterRepaint());const _=h.fire;h.fire=this._fireEvent.bind(this,_),h.on("resize",()=>{this._renderTransform.resize(h.transform.width,h.transform.height)}),h.on("styledata",()=>{this._updateStyleComponents(this.props,{}),KA(h.transform,this._renderTransform)}),h.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const E in nI)h.on(E,this._onPointerEvent);for(const E in Rx)h.on(E,this._onCameraEvent);for(const E in rI)h.on(E,this._onEvent);this._map=h}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n==null||n.remove(),wd.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const n=aW(e.transform);e.painter.transform=n,this._renderTransform=n}_updateSize(e){const{viewState:n}=e;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(e,n){if(this._internalUpdate)return!1;const r=this._map,i=this._renderTransform,{zoom:a,pitch:h,bearing:l}=i,m=r.isMoving();m&&(i.cameraElevationReference="sea");const _=QA(i,{...JA(r.transform),...e});if(m&&(i.cameraElevationReference="ground"),_&&n){const E=this._deferredEvents;E.move=!0,E.zoom||(E.zoom=a!==i.zoom),E.rotate||(E.rotate=l!==i.bearing),E.pitch||(E.pitch=h!==i.pitch)}return m||QA(r.transform,e),_}_updateSettings(e,n){const r=this._map;let i=!1;for(const a of cW)if(a in e&&!tl(e[a],n[a])){i=!0;const h=r[`set${a[0].toUpperCase()}${a.slice(1)}`];h==null||h.call(r,e[a])}return i}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==n.mapStyle){const{mapStyle:r=tI,styleDiffing:i=!0}=e,a={diff:i};return"localIdeographFontFamily"in e&&(a.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(eI(r),a),!0}return!1}_updateStyleComponents(e,n){const r=this._map;let i=!1;return r.isStyleLoaded()&&("light"in e&&r.setLight&&!tl(e.light,n.light)&&(i=!0,r.setLight(e.light)),"fog"in e&&r.setFog&&!tl(e.fog,n.fog)&&(i=!0,r.setFog(e.fog)),"terrain"in e&&r.setTerrain&&!tl(e.terrain,n.terrain)&&(!e.terrain||r.getSource(e.terrain.source))&&(i=!0,r.setTerrain(e.terrain))),i}_updateHandlers(e,n){var r,i;const a=this._map;let h=!1;for(const l of uW){const m=(r=e[l])!==null&&r!==void 0?r:!0,_=(i=n[l])!==null&&i!==void 0?i:!0;tl(m,_)||(h=!0,m?a[l].enable(m):a[l].disable())}return h}_queryRenderedFeatures(e){const n=this._map,r=n.transform,{interactiveLayerIds:i=[]}=this.props;try{return n.transform=this._renderTransform,n.queryRenderedFeatures(e,{layers:i.filter(n.getLayer.bind(n))})}catch{return[]}finally{n.transform=r}}_updateHover(e){var n;const{props:r}=this;if(r.interactiveLayerIds&&(r.onMouseMove||r.onMouseEnter||r.onMouseLeave)){const a=e.type,h=((n=this._hoveredFeatures)===null||n===void 0?void 0:n.length)>0,l=this._queryRenderedFeatures(e.point),m=l.length>0;!m&&h&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=l,m&&!h&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=a}else this._hoveredFeatures=null}_fireEvent(e,n,r){const i=this._map,a=i.transform,h=typeof n=="string"?n:n.type;return h==="move"&&this._updateViewState(this.props,!1),h in Rx&&(typeof n=="object"&&(n.viewState=JA(a)),this._map.isMoving())?(i.transform=this._renderTransform,e.call(i,n,r),i.transform=a,i):(e.call(i,n,r),i)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const r in this._deferredEvents)this._deferredEvents[r]&&e.fire(r);this._internalUpdate=!1;const n=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{KA(this._renderTransform,n),e.transform=n}}}wd.savedMaps=[];function hW(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||{}.MapboxAccessToken}catch{}try{t=t||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const dW=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function fW(t){if(!t)return null;const e=t.map,n={getMap:()=>e,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:r=>{const i=e.transform;e.transform=t.transform;const a=e.project(r);return e.transform=i,a},unproject:r=>{const i=e.transform;e.transform=t.transform;const a=e.unproject(r);return e.transform=i,a},queryTerrainElevation:(r,i)=>{const a=e.transform;e.transform=t.transform;const h=e.queryTerrainElevation(r,i);return e.transform=a,h},queryRenderedFeatures:(r,i)=>{const a=e.transform;e.transform=t.transform;const h=e.queryRenderedFeatures(r,i);return e.transform=a,h}};for(const r of pW(e))!(r in n)&&!dW.includes(r)&&(n[r]=e[r].bind(e));return n}function pW(t){const e=new Set;let n=t;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof t[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&e.add(r);n=Object.getPrototypeOf(n)}return Array.from(e)}const mW=typeof document<"u"?Z.useLayoutEffect:Z.useEffect,gW=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function yW(t,e){for(const r of gW)r in e&&(t[r]=e[r]);const{RTLTextPlugin:n="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;n&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(n,r=>{r&&console.error(r)},!1)}const k_=Z.createContext(null);function _W(t,e,n){const r=Z.useContext(sW),[i,a]=Z.useState(null),h=Z.useRef(),{current:l}=Z.useRef({mapLib:null,map:null});Z.useEffect(()=>{const E=t.mapLib;let S=!0,I;return Promise.resolve(E||n).then(L=>{if(!S)return;if(!L)throw new Error("Invalid mapLib");const O="Map"in L?L:L.default;if(!O.Map)throw new Error("Invalid mapLib");if(yW(O,t),!O.supported||O.supported(t))t.reuseMaps&&(I=wd.reuse(t,h.current)),I||(I=new wd(O.Map,t,h.current)),l.map=fW(I),l.mapLib=O,a(I),r==null||r.onMapMount(l.map,t.id);else throw new Error("Map is not supported by this browser")}).catch(L=>{const{onError:O}=t;O?O({type:"error",target:null,originalEvent:null,error:L}):console.error(L)}),()=>{S=!1,I&&(r==null||r.onMapUnmount(t.id),t.reuseMaps?I.recycle():I.destroy())}},[]),mW(()=>{i&&i.setProps(t)}),Z.useImperativeHandle(e,()=>l.map,[i]);const m=Z.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),_={height:"100%"};return Z.createElement("div",{id:t.id,ref:h,style:m},i&&Z.createElement(k_.Provider,{value:l},Z.createElement("div",{"mapboxgl-children":"",style:_},t.children)))}const vW=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function Mu(t,e){if(!t||!e)return;const n=t.style;for(const r in e){const i=e[r];Number.isFinite(i)&&!vW.test(r)?n[r]=`${i}px`:n[r]=i}}function xW(t,e){const{map:n,mapLib:r}=Z.useContext(k_),i=Z.useRef({props:t});i.current.props=t;const a=Z.useMemo(()=>{let D=!1;Z.Children.forEach(t.children,N=>{N&&(D=!0)});const H={...t,element:D?document.createElement("div"):null},z=new r.Marker(H);return z.setLngLat([t.longitude,t.latitude]),z.getElement().addEventListener("click",N=>{var F,$;($=(F=i.current.props).onClick)===null||$===void 0||$.call(F,{type:"click",target:z,originalEvent:N})}),z.on("dragstart",N=>{var F,$;const Q=N;Q.lngLat=a.getLngLat(),($=(F=i.current.props).onDragStart)===null||$===void 0||$.call(F,Q)}),z.on("drag",N=>{var F,$;const Q=N;Q.lngLat=a.getLngLat(),($=(F=i.current.props).onDrag)===null||$===void 0||$.call(F,Q)}),z.on("dragend",N=>{var F,$;const Q=N;Q.lngLat=a.getLngLat(),($=(F=i.current.props).onDragEnd)===null||$===void 0||$.call(F,Q)}),z},[]);Z.useEffect(()=>(a.addTo(n.getMap()),()=>{a.remove()}),[]);const{longitude:h,latitude:l,offset:m,style:_,draggable:E=!1,popup:S=null,rotation:I=0,rotationAlignment:L="auto",pitchAlignment:O="auto"}=t;return Z.useEffect(()=>{Mu(a.getElement(),_)},[_]),Z.useImperativeHandle(e,()=>a,[]),(a.getLngLat().lng!==h||a.getLngLat().lat!==l)&&a.setLngLat([h,l]),m&&!oW(a.getOffset(),m)&&a.setOffset(m),a.isDraggable()!==E&&a.setDraggable(E),a.getRotation()!==I&&a.setRotation(I),a.getRotationAlignment()!==L&&a.setRotationAlignment(L),a.getPitchAlignment()!==O&&a.setPitchAlignment(O),a.getPopup()!==S&&a.setPopup(S),Rd.createPortal(t.children,a.getElement())}Z.memo(Z.forwardRef(xW));function iI(t){return new Set(t?t.trim().split(/\s+/):[])}function bW(t,e){const{map:n,mapLib:r}=Z.useContext(k_),i=Z.useMemo(()=>document.createElement("div"),[]),a=Z.useRef({props:t});a.current.props=t;const h=Z.useMemo(()=>{const l={...t},m=new r.Popup(l);return m.setLngLat([t.longitude,t.latitude]),m.once("open",_=>{var E,S;(S=(E=a.current.props).onOpen)===null||S===void 0||S.call(E,_)}),m},[]);if(Z.useEffect(()=>{const l=m=>{var _,E;(E=(_=a.current.props).onClose)===null||E===void 0||E.call(_,m)};return h.on("close",l),h.setDOMContent(i).addTo(n.getMap()),()=>{h.off("close",l),h.isOpen()&&h.remove()}},[]),Z.useEffect(()=>{Mu(h.getElement(),t.style)},[t.style]),Z.useImperativeHandle(e,()=>h,[]),h.isOpen()&&((h.getLngLat().lng!==t.longitude||h.getLngLat().lat!==t.latitude)&&h.setLngLat([t.longitude,t.latitude]),t.offset&&!tl(h.options.offset,t.offset)&&h.setOffset(t.offset),(h.options.anchor!==t.anchor||h.options.maxWidth!==t.maxWidth)&&(h.options.anchor=t.anchor,h.setMaxWidth(t.maxWidth)),h.options.className!==t.className)){const l=iI(h.options.className),m=iI(t.className);for(const _ of l)m.has(_)||h.removeClassName(_);for(const _ of m)l.has(_)||h.addClassName(_);h.options.className=t.className}return Rd.createPortal(t.children,i)}Z.memo(Z.forwardRef(bW));function Om(t,e,n,r){const i=Z.useContext(k_),a=Z.useMemo(()=>t(i),[]);return Z.useEffect(()=>{const h=r||n||e,l=typeof e=="function"&&typeof n=="function"?e:null,m=typeof n=="function"?n:typeof e=="function"?e:null,{map:_}=i;return _.hasControl(a)||(_.addControl(a,h==null?void 0:h.position),l&&l(i)),()=>{m&&m(i),_.hasControl(a)&&_.removeControl(a)}},[]),a}function wW(t){const e=Om(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return Z.useEffect(()=>{Mu(e._container,t.style)},[t.style]),null}Z.memo(wW);function EW(t){const e=Om(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return Z.useEffect(()=>{Mu(e._controlContainer,t.style)},[t.style]),null}Z.memo(EW);function TW(t,e){const n=Z.useRef({props:t}),r=Om(({mapLib:i})=>{const a=new i.GeolocateControl(t),h=a._setupUI;return a._setupUI=l=>{a._container.hasChildNodes()||h(l)},a.on("geolocate",l=>{var m,_;(_=(m=n.current.props).onGeolocate)===null||_===void 0||_.call(m,l)}),a.on("error",l=>{var m,_;(_=(m=n.current.props).onError)===null||_===void 0||_.call(m,l)}),a.on("outofmaxbounds",l=>{var m,_;(_=(m=n.current.props).onOutOfMaxBounds)===null||_===void 0||_.call(m,l)}),a.on("trackuserlocationstart",l=>{var m,_;(_=(m=n.current.props).onTrackUserLocationStart)===null||_===void 0||_.call(m,l)}),a.on("trackuserlocationend",l=>{var m,_;(_=(m=n.current.props).onTrackUserLocationEnd)===null||_===void 0||_.call(m,l)}),a},{position:t.position});return n.current.props=t,Z.useImperativeHandle(e,()=>r,[]),Z.useEffect(()=>{Mu(r._container,t.style)},[t.style]),null}Z.memo(Z.forwardRef(TW));function SW(t){const e=Om(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return Z.useEffect(()=>{Mu(e._container,t.style)},[t.style]),null}Z.memo(SW);function PW(t){const e=Om(({mapLib:a})=>new a.ScaleControl(t),{position:t.position}),n=Z.useRef(t),r=n.current;n.current=t;const{style:i}=t;return t.maxWidth!==void 0&&t.maxWidth!==r.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==r.unit&&e.setUnit(t.unit),Z.useEffect(()=>{Mu(e._container,i)},[i]),null}Z.memo(PW);const CW=iW(()=>import("./mapbox-gl-a48d0b34.js").then(t=>t.m),[]),AW=(()=>Z.forwardRef(function(e,n){return _W(e,n,CW)}))();var iO={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(R4,function(){var n,r,i;function a(l,m){if(!n)n=m;else if(!r)r=m;else{var _="var sharedChunk = {}; ("+n+")(sharedChunk); ("+r+")(sharedChunk);",E={};n(E),i=m(E),typeof window<"u"&&(i.workerUrl=window.URL.createObjectURL(new Blob([_],{type:"text/javascript"})))}}a(["exports"],function(l){function m(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var _=E;function E(c,s){this.x=c,this.y=s}E.prototype={clone:function(){return new E(this.x,this.y)},add:function(c){return this.clone()._add(c)},sub:function(c){return this.clone()._sub(c)},multByPoint:function(c){return this.clone()._multByPoint(c)},divByPoint:function(c){return this.clone()._divByPoint(c)},mult:function(c){return this.clone()._mult(c)},div:function(c){return this.clone()._div(c)},rotate:function(c){return this.clone()._rotate(c)},rotateAround:function(c,s){return this.clone()._rotateAround(c,s)},matMult:function(c){return this.clone()._matMult(c)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(c){return this.x===c.x&&this.y===c.y},dist:function(c){return Math.sqrt(this.distSqr(c))},distSqr:function(c){var s=c.x-this.x,u=c.y-this.y;return s*s+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith:function(c){return this.angleWithSep(c.x,c.y)},angleWithSep:function(c,s){return Math.atan2(this.x*s-this.y*c,this.x*c+this.y*s)},_matMult:function(c){var s=c[2]*this.x+c[3]*this.y;return this.x=c[0]*this.x+c[1]*this.y,this.y=s,this},_add:function(c){return this.x+=c.x,this.y+=c.y,this},_sub:function(c){return this.x-=c.x,this.y-=c.y,this},_mult:function(c){return this.x*=c,this.y*=c,this},_div:function(c){return this.x/=c,this.y/=c,this},_multByPoint:function(c){return this.x*=c.x,this.y*=c.y,this},_divByPoint:function(c){return this.x/=c.x,this.y/=c.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var c=this.y;return this.y=this.x,this.x=-c,this},_rotate:function(c){var s=Math.cos(c),u=Math.sin(c),f=u*this.x+s*this.y;return this.x=s*this.x-u*this.y,this.y=f,this},_rotateAround:function(c,s){var u=Math.cos(c),f=Math.sin(c),g=s.y+f*(this.x-s.x)+u*(this.y-s.y);return this.x=s.x+u*(this.x-s.x)-f*(this.y-s.y),this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},E.convert=function(c){return c instanceof E?c:Array.isArray(c)?new E(c[0],c[1]):c};var S=m(_),I=L;function L(c,s,u,f){this.cx=3*c,this.bx=3*(u-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(f-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=s,this.p2x=u,this.p2y=f}L.prototype={sampleCurveX:function(c){return((this.ax*c+this.bx)*c+this.cx)*c},sampleCurveY:function(c){return((this.ay*c+this.by)*c+this.cy)*c},sampleCurveDerivativeX:function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},solveCurveX:function(c,s){if(s===void 0&&(s=1e-6),c<0)return 0;if(c>1)return 1;for(var u=c,f=0;f<8;f++){var g=this.sampleCurveX(u)-c;if(Math.abs(g)<s)return u;var x=this.sampleCurveDerivativeX(u);if(Math.abs(x)<1e-6)break;u-=g/x}var w=0,T=1;for(u=c,f=0;f<20&&(g=this.sampleCurveX(u),!(Math.abs(g-c)<s));f++)c>g?w=u:T=u,u=.5*(T-w)+w;return u},solve:function(c,s){return this.sampleCurveY(this.solveCurveX(c,s))}};var O=m(I);let D,H;function z(){return D==null&&(D=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),D}function N(){if(H==null&&(H=!1,z())){const s=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(s){for(let f=0;f<5*5;f++){const g=4*f;s.fillStyle=`rgb(${g},${g+1},${g+2})`,s.fillRect(f%5,Math.floor(f/5),1,1)}const u=s.getImageData(0,0,5,5).data;for(let f=0;f<5*5*4;f++)if(f%4!=3&&u[f]!==f){H=!0;break}}}return H||!1}function F(c,s,u,f){const g=new O(c,s,u,f);return function(x){return g.solve(x)}}const $=F(.25,.1,.25,1);function Q(c,s,u){return Math.min(u,Math.max(s,c))}function te(c,s,u){const f=u-s,g=((c-s)%f+f)%f+s;return g===s?u:g}function re(c,...s){for(const u of s)for(const f in u)c[f]=u[f];return c}let we=1;function Ee(c,s,u){const f={};for(const g in c)f[g]=s.call(u||this,c[g],g,c);return f}function de(c,s,u){const f={};for(const g in c)s.call(u||this,c[g],g,c)&&(f[g]=c[g]);return f}function Le(c){return Array.isArray(c)?c.map(Le):typeof c=="object"&&c?Ee(c,Le):c}const Ge={};function Be(c){Ge[c]||(typeof console<"u"&&console.warn(c),Ge[c]=!0)}function Oe(c,s,u){return(u.y-c.y)*(s.x-c.x)>(s.y-c.y)*(u.x-c.x)}function Ke(c){let s=0;for(let u,f,g=0,x=c.length,w=x-1;g<x;w=g++)u=c[g],f=c[w],s+=(f.x-u.x)*(u.y+f.y);return s}function je(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let it=null;function Me(c){if(it==null){const s=c.navigator?c.navigator.userAgent:null;it=!!c.safari||!(!s||!(/\b(iPad|iPhone|iPod)\b/.test(s)||s.match("Safari")&&!s.match("Chrome")))}return it}function qe(c){return typeof ImageBitmap<"u"&&c instanceof ImageBitmap}const ut="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";async function zt(c,s,u,f,g){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const x=new VideoFrame(c,{timestamp:0});try{const w=x==null?void 0:x.format;if(!w||!w.startsWith("BGR")&&!w.startsWith("RGB"))throw new Error(`Unrecognized format ${w}`);const T=w.startsWith("BGR"),A=new Uint8ClampedArray(f*g*4);if(await x.copyTo(A,function(k,B,j,W,Y){const J=4*Math.max(-B,0),ae=(Math.max(0,j)-j)*W*4+J,pe=4*W,ye=Math.max(0,B),Ie=Math.max(0,j);return{rect:{x:ye,y:Ie,width:Math.min(k.width,B+W)-ye,height:Math.min(k.height,j+Y)-Ie},layout:[{offset:ae,stride:pe}]}}(c,s,u,f,g)),T)for(let k=0;k<A.length;k+=4){const B=A[k];A[k]=A[k+2],A[k+2]=B}return A}finally{x.close()}}let vt,yt,at,bt;const xt={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(c){const s=requestAnimationFrame(c);return{cancel:()=>cancelAnimationFrame(s)}},getImageData(c,s=0){return this.getImageCanvasContext(c).getImageData(-s,-s,c.width+2*s,c.height+2*s)},getImageCanvasContext(c){const s=window.document.createElement("canvas"),u=s.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return s.width=c.width,s.height=c.height,u.drawImage(c,0,0,c.width,c.height),u},resolveURL:c=>(at||(at=document.createElement("a")),at.href=c,at.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(bt==null&&(bt=matchMedia("(prefers-reduced-motion: reduce)")),bt.matches)}},$t={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class Kt extends Error{constructor(s,u,f,g){super(`AJAXError: ${u} (${s}): ${f}`),this.status=s,this.statusText=u,this.url=f,this.body=g}}const Ct=je()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,sn=c=>$t.REGISTERED_PROTOCOLS[c.substring(0,c.indexOf("://"))];function Qt(c,s){const u=new AbortController,f=new Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,cache:c.cache,referrer:Ct(),signal:u.signal});let g=!1,x=!1;return c.type==="json"&&f.headers.set("Accept","application/json"),x||fetch(f).then(w=>w.ok?(T=>{(c.type==="arrayBuffer"||c.type==="image"?T.arrayBuffer():c.type==="json"?T.json():T.text()).then(A=>{x||(g=!0,s(null,A,T.headers.get("Cache-Control"),T.headers.get("Expires")))}).catch(A=>{x||s(new Error(A.message))})})(w):w.blob().then(T=>s(new Kt(w.status,w.statusText,c.url,T)))).catch(w=>{w.code!==20&&s(new Error(w.message))}),{cancel:()=>{x=!0,g||u.abort()}}}const pn=function(c,s){if(/:\/\//.test(c.url)&&!/^https?:|^file:/.test(c.url)){if(je()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,s);if(!je())return(sn(c.url)||Qt)(c,s)}if(!(/^file:/.test(u=c.url)||/^file:/.test(Ct())&&!/^\w+:/.test(u))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return Qt(c,s);if(je()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,s,void 0,!0)}var u;return function(f,g){const x=new XMLHttpRequest;x.open(f.method||"GET",f.url,!0),f.type!=="arrayBuffer"&&f.type!=="image"||(x.responseType="arraybuffer");for(const w in f.headers)x.setRequestHeader(w,f.headers[w]);return f.type==="json"&&(x.responseType="text",x.setRequestHeader("Accept","application/json")),x.withCredentials=f.credentials==="include",x.onerror=()=>{g(new Error(x.statusText))},x.onload=()=>{if((x.status>=200&&x.status<300||x.status===0)&&x.response!==null){let w=x.response;if(f.type==="json")try{w=JSON.parse(x.response)}catch(T){return g(T)}g(null,w,x.getResponseHeader("Cache-Control"),x.getResponseHeader("Expires"))}else{const w=new Blob([x.response],{type:x.getResponseHeader("Content-Type")});g(new Kt(x.status,x.statusText,f.url,w))}},x.send(f.body),{cancel:()=>x.abort()}}(c,s)},Wt=function(c,s){return pn(re(c,{type:"arrayBuffer"}),s)};function Ot(c){if(!c||c.indexOf("://")<=0||c.indexOf("data:image/")===0||c.indexOf("blob:")===0)return!0;const s=new URL(c),u=window.location;return s.protocol===u.protocol&&s.host===u.host}function Dt(c,s,u){u[c]&&u[c].indexOf(s)!==-1||(u[c]=u[c]||[],u[c].push(s))}function wn(c,s,u){if(u&&u[c]){const f=u[c].indexOf(s);f!==-1&&u[c].splice(f,1)}}class mn{constructor(s,u={}){re(this,u),this.type=s}}class En extends mn{constructor(s,u={}){super("error",re({error:s},u))}}class zn{on(s,u){return this._listeners=this._listeners||{},Dt(s,u,this._listeners),this}off(s,u){return wn(s,u,this._listeners),wn(s,u,this._oneTimeListeners),this}once(s,u){return u?(this._oneTimeListeners=this._oneTimeListeners||{},Dt(s,u,this._oneTimeListeners),this):new Promise(f=>this.once(s,f))}fire(s,u){typeof s=="string"&&(s=new mn(s,u||{}));const f=s.type;if(this.listens(f)){s.target=this;const g=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const T of g)T.call(this,s);const x=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const T of x)wn(f,T,this._oneTimeListeners),T.call(this,s);const w=this._eventedParent;w&&(re(s,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),w.fire(s))}else s instanceof En&&console.error(s.error);return this}listens(s){return this._listeners&&this._listeners[s]&&this._listeners[s].length>0||this._oneTimeListeners&&this._oneTimeListeners[s]&&this._oneTimeListeners[s].length>0||this._eventedParent&&this._eventedParent.listens(s)}setEventedParent(s,u){return this._eventedParent=s,this._eventedParentData=u,this}}var Re={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Bt=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Rn(c,s){const u={};for(const f in c)f!=="ref"&&(u[f]=c[f]);return Bt.forEach(f=>{f in s&&(u[f]=s[f])}),u}function an(c,s){if(Array.isArray(c)){if(!Array.isArray(s)||c.length!==s.length)return!1;for(let u=0;u<c.length;u++)if(!an(c[u],s[u]))return!1;return!0}if(typeof c=="object"&&c!==null&&s!==null){if(typeof s!="object"||Object.keys(c).length!==Object.keys(s).length)return!1;for(const u in c)if(!an(c[u],s[u]))return!1;return!0}return c===s}const It={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function st(c,s,u){u.push({command:It.addSource,args:[c,s[c]]})}function _t(c,s,u){s.push({command:It.removeSource,args:[c]}),u[c]=!0}function Fe(c,s,u,f){_t(c,u,f),st(c,s,u)}function et(c,s,u){let f;for(f in c[u])if(Object.prototype.hasOwnProperty.call(c[u],f)&&f!=="data"&&!an(c[u][f],s[u][f]))return!1;for(f in s[u])if(Object.prototype.hasOwnProperty.call(s[u],f)&&f!=="data"&&!an(c[u][f],s[u][f]))return!1;return!0}function ot(c,s,u,f,g,x){let w;for(w in s=s||{},c=c||{})Object.prototype.hasOwnProperty.call(c,w)&&(an(c[w],s[w])||u.push({command:x,args:[f,w,s[w],g]}));for(w in s)Object.prototype.hasOwnProperty.call(s,w)&&!Object.prototype.hasOwnProperty.call(c,w)&&(an(c[w],s[w])||u.push({command:x,args:[f,w,s[w],g]}))}function Zt(c){return c.id}function Mt(c,s){return c[s.id]=s,c}class Ne{constructor(s,u,f,g){this.message=(s?`${s}: `:"")+f,g&&(this.identifier=g),u!=null&&u.__line__&&(this.line=u.__line__)}}function Ye(c,...s){for(const u of s)for(const f in u)c[f]=u[f];return c}class St extends Error{constructor(s,u){super(u),this.message=u,this.key=s}}class gn{constructor(s,u=[]){this.parent=s,this.bindings={};for(const[f,g]of u)this.bindings[f]=g}concat(s){return new gn(this,s)}get(s){if(this.bindings[s])return this.bindings[s];if(this.parent)return this.parent.get(s);throw new Error(`${s} not found in scope.`)}has(s){return!!this.bindings[s]||!!this.parent&&this.parent.has(s)}}const yn={kind:"null"},nt={kind:"number"},on={kind:"string"},rn={kind:"boolean"},Cr={kind:"color"},li={kind:"object"},un={kind:"value"},Kr={kind:"collator"},xi={kind:"formatted"},he={kind:"padding"},G={kind:"resolvedImage"},q={kind:"variableAnchorOffsetCollection"};function ne(c,s){return{kind:"array",itemType:c,N:s}}function ce(c){if(c.kind==="array"){const s=ce(c.itemType);return typeof c.N=="number"?`array<${s}, ${c.N}>`:c.itemType.kind==="value"?"array":`array<${s}>`}return c.kind}const _e=[yn,nt,on,rn,Cr,xi,li,ne(un),he,G,q];function Se(c,s){if(s.kind==="error")return null;if(c.kind==="array"){if(s.kind==="array"&&(s.N===0&&s.itemType.kind==="value"||!Se(c.itemType,s.itemType))&&(typeof c.N!="number"||c.N===s.N))return null}else{if(c.kind===s.kind)return null;if(c.kind==="value"){for(const u of _e)if(!Se(u,s))return null}}return`Expected ${ce(c)} but found ${ce(s)} instead.`}function Te(c,s){return s.some(u=>u.kind===c.kind)}function ge(c,s){return s.some(u=>u==="null"?c===null:u==="array"?Array.isArray(c):u==="object"?c&&!Array.isArray(c)&&typeof c=="object":u===typeof c)}function Ce(c,s){return c.kind==="array"&&s.kind==="array"?c.itemType.kind===s.itemType.kind&&typeof c.N=="number":c.kind===s.kind}const He=.96422,We=.82521,Ze=4/29,Pt=6/29,tn=3*Pt*Pt,Lt=Pt*Pt*Pt,ft=Math.PI/180,Ft=180/Math.PI;function xn(c){return(c%=360)<0&&(c+=360),c}function bn([c,s,u,f]){let g,x;const w=_n((.2225045*(c=dn(c))+.7168786*(s=dn(s))+.0606169*(u=dn(u)))/1);c===s&&s===u?g=x=w:(g=_n((.4360747*c+.3850649*s+.1430804*u)/He),x=_n((.0139322*c+.0971045*s+.7141733*u)/We));const T=116*w-16;return[T<0?0:T,500*(g-w),200*(w-x),f]}function dn(c){return c<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function _n(c){return c>Lt?Math.pow(c,1/3):c/tn+Ze}function Ar([c,s,u,f]){let g=(c+16)/116,x=isNaN(s)?g:g+s/500,w=isNaN(u)?g:g-u/200;return g=1*On(g),x=He*On(x),w=We*On(w),[Ut(3.1338561*x-1.6168667*g-.4906146*w),Ut(-.9787684*x+1.9161415*g+.033454*w),Ut(.0719453*x-.2289914*g+1.4052427*w),f]}function Ut(c){return(c=c<=.00304?12.92*c:1.055*Math.pow(c,1/2.4)-.055)<0?0:c>1?1:c}function On(c){return c>Pt?c*c*c:tn*(c-Ze)}function xr(c){return parseInt(c.padEnd(2,c),16)/255}function Us(c,s){return Jr(s?c/100:c,0,1)}function Jr(c,s,u){return Math.min(Math.max(s,c),u)}function ls(c){return!c.some(Number.isNaN)}const ho={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Cn{constructor(s,u,f,g=1,x=!0){this.r=s,this.g=u,this.b=f,this.a=g,x||(this.r*=g,this.g*=g,this.b*=g,g||this.overwriteGetter("rgb",[s,u,f,g]))}static parse(s){if(s instanceof Cn)return s;if(typeof s!="string")return;const u=function(f){if((f=f.toLowerCase().trim())==="transparent")return[0,0,0,0];const g=ho[f];if(g){const[w,T,A]=g;return[w/255,T/255,A/255,1]}if(f.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(f)){const w=f.length<6?1:2;let T=1;return[xr(f.slice(T,T+=w)),xr(f.slice(T,T+=w)),xr(f.slice(T,T+=w)),xr(f.slice(T,T+w)||"ff")]}if(f.startsWith("rgb")){const w=f.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(w){const[T,A,k,B,j,W,Y,J,ae,pe,ye,Ie]=w,be=[B||" ",Y||" ",pe].join("");if(be==="  "||be==="  /"||be===",,"||be===",,,"){const ke=[k,W,ae].join(""),ze=ke==="%%%"?100:ke===""?255:0;if(ze){const Je=[Jr(+A/ze,0,1),Jr(+j/ze,0,1),Jr(+J/ze,0,1),ye?Us(+ye,Ie):1];if(ls(Je))return Je}}return}}const x=f.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[w,T,A,k,B,j,W,Y,J]=x,ae=[A||" ",B||" ",W].join("");if(ae==="  "||ae==="  /"||ae===",,"||ae===",,,"){const pe=[+T,Jr(+k,0,100),Jr(+j,0,100),Y?Us(+Y,J):1];if(ls(pe))return function([ye,Ie,be,ke]){function ze(Je){const Tt=(Je+ye/30)%12,jt=Ie*Math.min(be,1-be);return be-jt*Math.max(-1,Math.min(Tt-3,9-Tt,1))}return ye=xn(ye),Ie/=100,be/=100,[ze(0),ze(8),ze(4),ke]}(pe)}}}(s);return u?new Cn(...u,!1):void 0}get rgb(){const{r:s,g:u,b:f,a:g}=this,x=g||1/0;return this.overwriteGetter("rgb",[s/x,u/x,f/x,g])}get hcl(){return this.overwriteGetter("hcl",function(s){const[u,f,g,x]=bn(s),w=Math.sqrt(f*f+g*g);return[Math.round(1e4*w)?xn(Math.atan2(g,f)*Ft):NaN,w,u,x]}(this.rgb))}get lab(){return this.overwriteGetter("lab",bn(this.rgb))}overwriteGetter(s,u){return Object.defineProperty(this,s,{value:u}),u}toString(){const[s,u,f,g]=this.rgb;return`rgba(${[s,u,f].map(x=>Math.round(255*x)).join(",")},${g})`}}Cn.black=new Cn(0,0,0,1),Cn.white=new Cn(1,1,1,1),Cn.transparent=new Cn(0,0,0,0),Cn.red=new Cn(1,0,0,1);class zo{constructor(s,u,f){this.sensitivity=s?u?"variant":"case":u?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(s,u){return this.collator.compare(s,u)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ki{constructor(s,u,f,g,x){this.text=s,this.image=u,this.scale=f,this.fontStack=g,this.textColor=x}}class ir{constructor(s){this.sections=s}static fromString(s){return new ir([new ki(s,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(s=>s.text.length!==0||s.image&&s.image.name.length!==0)}static factory(s){return s instanceof ir?s:ir.fromString(s)}toString(){return this.sections.length===0?"":this.sections.map(s=>s.text).join("")}}class bi{constructor(s){this.values=s.slice()}static parse(s){if(s instanceof bi)return s;if(typeof s=="number")return new bi([s,s,s,s]);if(Array.isArray(s)&&!(s.length<1||s.length>4)){for(const u of s)if(typeof u!="number")return;switch(s.length){case 1:s=[s[0],s[0],s[0],s[0]];break;case 2:s=[s[0],s[1],s[0],s[1]];break;case 3:s=[s[0],s[1],s[2],s[1]]}return new bi(s)}}toString(){return JSON.stringify(this.values)}}const Lu=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class hi{constructor(s){this.values=s.slice()}static parse(s){if(s instanceof hi)return s;if(Array.isArray(s)&&!(s.length<1)&&s.length%2==0){for(let u=0;u<s.length;u+=2){const f=s[u],g=s[u+1];if(typeof f!="string"||!Lu.has(f)||!Array.isArray(g)||g.length!==2||typeof g[0]!="number"||typeof g[1]!="number")return}return new hi(s)}}toString(){return JSON.stringify(this.values)}}class Zn{constructor(s){this.name=s.name,this.available=s.available}toString(){return this.name}static fromString(s){return s?new Zn({name:s,available:!1}):null}}function Fo(c,s,u,f){return typeof c=="number"&&c>=0&&c<=255&&typeof s=="number"&&s>=0&&s<=255&&typeof u=="number"&&u>=0&&u<=255?f===void 0||typeof f=="number"&&f>=0&&f<=1?null:`Invalid rgba value [${[c,s,u,f].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof f=="number"?[c,s,u,f]:[c,s,u]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function fo(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof Cn||c instanceof zo||c instanceof ir||c instanceof bi||c instanceof hi||c instanceof Zn)return!0;if(Array.isArray(c)){for(const s of c)if(!fo(s))return!1;return!0}if(typeof c=="object"){for(const s in c)if(!fo(c[s]))return!1;return!0}return!1}function Jn(c){if(c===null)return yn;if(typeof c=="string")return on;if(typeof c=="boolean")return rn;if(typeof c=="number")return nt;if(c instanceof Cn)return Cr;if(c instanceof zo)return Kr;if(c instanceof ir)return xi;if(c instanceof bi)return he;if(c instanceof hi)return q;if(c instanceof Zn)return G;if(Array.isArray(c)){const s=c.length;let u;for(const f of c){const g=Jn(f);if(u){if(u===g)continue;u=un;break}u=g}return ne(u||un,s)}return li}function Dn(c){const s=typeof c;return c===null?"":s==="string"||s==="number"||s==="boolean"?String(c):c instanceof Cn||c instanceof ir||c instanceof bi||c instanceof hi||c instanceof Zn?c.toString():JSON.stringify(c)}class Vs{constructor(s,u){this.type=s,this.value=u}static parse(s,u){if(s.length!==2)return u.error(`'literal' expression requires exactly one argument, but found ${s.length-1} instead.`);if(!fo(s[1]))return u.error("invalid value");const f=s[1];let g=Jn(f);const x=u.expectedType;return g.kind!=="array"||g.N!==0||!x||x.kind!=="array"||typeof x.N=="number"&&x.N!==0||(g=x),new Vs(g,f)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Qn{constructor(s){this.name="ExpressionEvaluationError",this.message=s}toJSON(){return this.message}}const Gi={string:on,number:nt,boolean:rn,object:li};class Hi{constructor(s,u){this.type=s,this.args=u}static parse(s,u){if(s.length<2)return u.error("Expected at least one argument.");let f,g=1;const x=s[0];if(x==="array"){let T,A;if(s.length>2){const k=s[1];if(typeof k!="string"||!(k in Gi)||k==="object")return u.error('The item type argument of "array" must be one of string, number, boolean',1);T=Gi[k],g++}else T=un;if(s.length>3){if(s[2]!==null&&(typeof s[2]!="number"||s[2]<0||s[2]!==Math.floor(s[2])))return u.error('The length argument to "array" must be a positive integer literal',2);A=s[2],g++}f=ne(T,A)}else{if(!Gi[x])throw new Error(`Types doesn't contain name = ${x}`);f=Gi[x]}const w=[];for(;g<s.length;g++){const T=u.parse(s[g],g,un);if(!T)return null;w.push(T)}return new Hi(f,w)}evaluate(s){for(let u=0;u<this.args.length;u++){const f=this.args[u].evaluate(s);if(!Se(this.type,Jn(f)))return f;if(u===this.args.length-1)throw new Qn(`Expected value to be of type ${ce(this.type)}, but found ${ce(Jn(f))} instead.`)}throw new Error}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}const bl={"to-boolean":rn,"to-color":Cr,"to-number":nt,"to-string":on};class Ss{constructor(s,u){this.type=s,this.args=u}static parse(s,u){if(s.length<2)return u.error("Expected at least one argument.");const f=s[0];if(!bl[f])throw new Error(`Can't parse ${f} as it is not part of the known types`);if((f==="to-boolean"||f==="to-string")&&s.length!==2)return u.error("Expected one argument.");const g=bl[f],x=[];for(let w=1;w<s.length;w++){const T=u.parse(s[w],w,un);if(!T)return null;x.push(T)}return new Ss(g,x)}evaluate(s){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(s);case"color":{let u,f;for(const g of this.args){if(u=g.evaluate(s),f=null,u instanceof Cn)return u;if(typeof u=="string"){const x=s.parseColor(u);if(x)return x}else if(Array.isArray(u)&&(f=u.length<3||u.length>4?`Invalid rbga value ${JSON.stringify(u)}: expected an array containing either three or four numeric values.`:Fo(u[0],u[1],u[2],u[3]),!f))return new Cn(u[0]/255,u[1]/255,u[2]/255,u[3])}throw new Qn(f||`Could not parse color from value '${typeof u=="string"?u:JSON.stringify(u)}'`)}case"padding":{let u;for(const f of this.args){u=f.evaluate(s);const g=bi.parse(u);if(g)return g}throw new Qn(`Could not parse padding from value '${typeof u=="string"?u:JSON.stringify(u)}'`)}case"variableAnchorOffsetCollection":{let u;for(const f of this.args){u=f.evaluate(s);const g=hi.parse(u);if(g)return g}throw new Qn(`Could not parse variableAnchorOffsetCollection from value '${typeof u=="string"?u:JSON.stringify(u)}'`)}case"number":{let u=null;for(const f of this.args){if(u=f.evaluate(s),u===null)return 0;const g=Number(u);if(!isNaN(g))return g}throw new Qn(`Could not convert ${JSON.stringify(u)} to number.`)}case"formatted":return ir.fromString(Dn(this.args[0].evaluate(s)));case"resolvedImage":return Zn.fromString(Dn(this.args[0].evaluate(s)));default:return Dn(this.args[0].evaluate(s))}}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}const Sc=["Unknown","Point","LineString","Polygon"];class Pc{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Sc[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(s){let u=this._parseColorCache[s];return u||(u=this._parseColorCache[s]=Cn.parse(s)),u}}class wl{constructor(s,u,f=[],g,x=new gn,w=[]){this.registry=s,this.path=f,this.key=f.map(T=>`[${T}]`).join(""),this.scope=x,this.errors=w,this.expectedType=g,this._isConstant=u}parse(s,u,f,g,x={}){return u?this.concat(u,f,g)._parse(s,x):this._parse(s,x)}_parse(s,u){function f(g,x,w){return w==="assert"?new Hi(x,[g]):w==="coerce"?new Ss(x,[g]):g}if(s!==null&&typeof s!="string"&&typeof s!="boolean"&&typeof s!="number"||(s=["literal",s]),Array.isArray(s)){if(s.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=s[0];if(typeof g!="string")return this.error(`Expression name must be a string, but found ${typeof g} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const x=this.registry[g];if(x){let w=x.parse(s,this);if(!w)return null;if(this.expectedType){const T=this.expectedType,A=w.type;if(T.kind!=="string"&&T.kind!=="number"&&T.kind!=="boolean"&&T.kind!=="object"&&T.kind!=="array"||A.kind!=="value")if(T.kind!=="color"&&T.kind!=="formatted"&&T.kind!=="resolvedImage"||A.kind!=="value"&&A.kind!=="string")if(T.kind!=="padding"||A.kind!=="value"&&A.kind!=="number"&&A.kind!=="array")if(T.kind!=="variableAnchorOffsetCollection"||A.kind!=="value"&&A.kind!=="array"){if(this.checkSubtype(T,A))return null}else w=f(w,T,u.typeAnnotation||"coerce");else w=f(w,T,u.typeAnnotation||"coerce");else w=f(w,T,u.typeAnnotation||"coerce");else w=f(w,T,u.typeAnnotation||"assert")}if(!(w instanceof Vs)&&w.type.kind!=="resolvedImage"&&this._isConstant(w)){const T=new Pc;try{w=new Vs(w.type,w.evaluate(T))}catch(A){return this.error(A.message),null}}return w}return this.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(s===void 0?"'undefined' value invalid. Use null instead.":typeof s=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof s} instead.`)}concat(s,u,f){const g=typeof s=="number"?this.path.concat(s):this.path,x=f?this.scope.concat(f):this.scope;return new wl(this.registry,this._isConstant,g,u||null,x,this.errors)}error(s,...u){const f=`${this.key}${u.map(g=>`[${g}]`).join("")}`;this.errors.push(new St(f,s))}checkSubtype(s,u){const f=Se(s,u);return f&&this.error(f),f}}class ee{constructor(s,u,f){this.type=Kr,this.locale=f,this.caseSensitive=s,this.diacriticSensitive=u}static parse(s,u){if(s.length!==2)return u.error("Expected one argument.");const f=s[1];if(typeof f!="object"||Array.isArray(f))return u.error("Collator options argument must be an object.");const g=u.parse(f["case-sensitive"]!==void 0&&f["case-sensitive"],1,rn);if(!g)return null;const x=u.parse(f["diacritic-sensitive"]!==void 0&&f["diacritic-sensitive"],1,rn);if(!x)return null;let w=null;return f.locale&&(w=u.parse(f.locale,1,on),!w)?null:new ee(g,x,w)}evaluate(s){return new zo(this.caseSensitive.evaluate(s),this.diacriticSensitive.evaluate(s),this.locale?this.locale.evaluate(s):null)}eachChild(s){s(this.caseSensitive),s(this.diacriticSensitive),this.locale&&s(this.locale)}outputDefined(){return!1}}const ie=8192;function xe(c,s){c[0]=Math.min(c[0],s[0]),c[1]=Math.min(c[1],s[1]),c[2]=Math.max(c[2],s[0]),c[3]=Math.max(c[3],s[1])}function Ve(c,s){return!(c[0]<=s[0]||c[2]>=s[2]||c[1]<=s[1]||c[3]>=s[3])}function lt(c,s){const u=(180+c[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,g=Math.pow(2,s.z);return[Math.round(u*g*ie),Math.round(f*g*ie)]}function Nt(c,s,u){const f=c[0]-s[0],g=c[1]-s[1],x=c[0]-u[0],w=c[1]-u[1];return f*w-x*g==0&&f*x<=0&&g*w<=0}function Sn(c,s){let u=!1;for(let w=0,T=s.length;w<T;w++){const A=s[w];for(let k=0,B=A.length;k<B-1;k++){if(Nt(c,A[k],A[k+1]))return!1;(g=A[k])[1]>(f=c)[1]!=(x=A[k+1])[1]>f[1]&&f[0]<(x[0]-g[0])*(f[1]-g[1])/(x[1]-g[1])+g[0]&&(u=!u)}}var f,g,x;return u}function Ir(c,s){for(let u=0;u<s.length;u++)if(Sn(c,s[u]))return!0;return!1}function jr(c,s,u,f){const g=f[0]-u[0],x=f[1]-u[1],w=(c[0]-u[0])*x-g*(c[1]-u[1]),T=(s[0]-u[0])*x-g*(s[1]-u[1]);return w>0&&T<0||w<0&&T>0}function di(c,s,u){for(const k of u)for(let B=0;B<k.length-1;++B)if((T=[(w=k[B+1])[0]-(x=k[B])[0],w[1]-x[1]])[0]*(A=[(g=s)[0]-(f=c)[0],g[1]-f[1]])[1]-T[1]*A[0]!=0&&jr(f,g,x,w)&&jr(x,w,f,g))return!0;var f,g,x,w,T,A;return!1}function cs(c,s){for(let u=0;u<c.length;++u)if(!Sn(c[u],s))return!1;for(let u=0;u<c.length-1;++u)if(di(c[u],c[u+1],s))return!1;return!0}function Vm(c,s){for(let u=0;u<s.length;u++)if(cs(c,s[u]))return!0;return!1}function Ru(c,s,u){const f=[];for(let g=0;g<c.length;g++){const x=[];for(let w=0;w<c[g].length;w++){const T=lt(c[g][w],u);xe(s,T),x.push(T)}f.push(x)}return f}function jm(c,s,u){const f=[];for(let g=0;g<c.length;g++){const x=Ru(c[g],s,u);f.push(x)}return f}function $m(c,s,u,f){if(c[0]<u[0]||c[0]>u[2]){const g=.5*f;let x=c[0]-u[0]>g?-f:u[0]-c[0]>g?f:0;x===0&&(x=c[0]-u[2]>g?-f:u[2]-c[0]>g?f:0),c[0]+=x}xe(s,c)}function Fd(c,s,u,f){const g=Math.pow(2,f.z)*ie,x=[f.x*ie,f.y*ie],w=[];for(const T of c)for(const A of T){const k=[A.x+x[0],A.y+x[1]];$m(k,s,u,g),w.push(k)}return w}function Nd(c,s,u,f){const g=Math.pow(2,f.z)*ie,x=[f.x*ie,f.y*ie],w=[];for(const A of c){const k=[];for(const B of A){const j=[B.x+x[0],B.y+x[1]];xe(s,j),k.push(j)}w.push(k)}if(s[2]-s[0]<=g/2){(T=s)[0]=T[1]=1/0,T[2]=T[3]=-1/0;for(const A of w)for(const k of A)$m(k,s,u,g)}var T;return w}class Da{constructor(s,u){this.type=rn,this.geojson=s,this.geometries=u}static parse(s,u){if(s.length!==2)return u.error(`'within' expression requires exactly one argument, but found ${s.length-1} instead.`);if(fo(s[1])){const f=s[1];if(f.type==="FeatureCollection")for(let g=0;g<f.features.length;++g){const x=f.features[g].geometry.type;if(x==="Polygon"||x==="MultiPolygon")return new Da(f,f.features[g].geometry)}else if(f.type==="Feature"){const g=f.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new Da(f,f.geometry)}else if(f.type==="Polygon"||f.type==="MultiPolygon")return new Da(f,f)}return u.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(s){if(s.geometry()!=null&&s.canonicalID()!=null){if(s.geometryType()==="Point")return function(u,f){const g=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],w=u.canonicalID();if(f.type==="Polygon"){const T=Ru(f.coordinates,x,w),A=Fd(u.geometry(),g,x,w);if(!Ve(g,x))return!1;for(const k of A)if(!Sn(k,T))return!1}if(f.type==="MultiPolygon"){const T=jm(f.coordinates,x,w),A=Fd(u.geometry(),g,x,w);if(!Ve(g,x))return!1;for(const k of A)if(!Ir(k,T))return!1}return!0}(s,this.geometries);if(s.geometryType()==="LineString")return function(u,f){const g=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],w=u.canonicalID();if(f.type==="Polygon"){const T=Ru(f.coordinates,x,w),A=Nd(u.geometry(),g,x,w);if(!Ve(g,x))return!1;for(const k of A)if(!cs(k,T))return!1}if(f.type==="MultiPolygon"){const T=jm(f.coordinates,x,w),A=Nd(u.geometry(),g,x,w);if(!Ve(g,x))return!1;for(const k of A)if(!Vm(k,T))return!1}return!0}(s,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class Ou{constructor(s,u){this.type=u.type,this.name=s,this.boundExpression=u}static parse(s,u){if(s.length!==2||typeof s[1]!="string")return u.error("'var' expression requires exactly one string literal argument.");const f=s[1];return u.scope.has(f)?new Ou(f,u.scope.get(f)):u.error(`Unknown variable "${f}". Make sure "${f}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(s){return this.boundExpression.evaluate(s)}eachChild(){}outputDefined(){return!1}}class Ps{constructor(s,u,f,g){this.name=s,this.type=u,this._evaluate=f,this.args=g}evaluate(s){return this._evaluate(s,this.args)}eachChild(s){this.args.forEach(s)}outputDefined(){return!1}static parse(s,u){const f=s[0],g=Ps.definitions[f];if(!g)return u.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0);const x=Array.isArray(g)?g[0]:g.type,w=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,T=w.filter(([k])=>!Array.isArray(k)||k.length===s.length-1);let A=null;for(const[k,B]of T){A=new wl(u.registry,Du,u.path,null,u.scope);const j=[];let W=!1;for(let Y=1;Y<s.length;Y++){const J=s[Y],ae=Array.isArray(k)?k[Y-1]:k.type,pe=A.parse(J,1+j.length,ae);if(!pe){W=!0;break}j.push(pe)}if(!W)if(Array.isArray(k)&&k.length!==j.length)A.error(`Expected ${k.length} arguments, but found ${j.length} instead.`);else{for(let Y=0;Y<j.length;Y++){const J=Array.isArray(k)?k[Y]:k.type,ae=j[Y];A.concat(Y+1).checkSubtype(J,ae.type)}if(A.errors.length===0)return new Ps(f,x,B,j)}}if(T.length===1)u.errors.push(...A.errors);else{const k=(T.length?T:w).map(([j])=>{return W=j,Array.isArray(W)?`(${W.map(ce).join(", ")})`:`(${ce(W.type)}...)`;var W}).join(" | "),B=[];for(let j=1;j<s.length;j++){const W=u.parse(s[j],1+B.length);if(!W)return null;B.push(ce(W.type))}u.error(`Expected arguments of type ${k}, but found (${B.join(", ")}) instead.`)}return null}static register(s,u){Ps.definitions=u;for(const f in u)s[f]=Ps}}function Du(c){if(c instanceof Ou)return Du(c.boundExpression);if(c instanceof Ps&&c.name==="error"||c instanceof ee||c instanceof Da)return!1;const s=c instanceof Ss||c instanceof Hi;let u=!0;return c.eachChild(f=>{u=s?u&&Du(f):u&&f instanceof Vs}),!!u&&zu(c)&&Fu(c,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function zu(c){if(c instanceof Ps&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof Da)return!1;let s=!0;return c.eachChild(u=>{s&&!zu(u)&&(s=!1)}),s}function Cc(c){if(c instanceof Ps&&c.name==="feature-state")return!1;let s=!0;return c.eachChild(u=>{s&&!Cc(u)&&(s=!1)}),s}function Fu(c,s){if(c instanceof Ps&&s.indexOf(c.name)>=0)return!1;let u=!0;return c.eachChild(f=>{u&&!Fu(f,s)&&(u=!1)}),u}function El(c,s){const u=c.length-1;let f,g,x=0,w=u,T=0;for(;x<=w;)if(T=Math.floor((x+w)/2),f=c[T],g=c[T+1],f<=s){if(T===u||s<g)return T;x=T+1}else{if(!(f>s))throw new Qn("Input is not a number.");w=T-1}return 0}class ca{constructor(s,u,f){this.type=s,this.input=u,this.labels=[],this.outputs=[];for(const[g,x]of f)this.labels.push(g),this.outputs.push(x)}static parse(s,u){if(s.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return u.error("Expected an even number of arguments.");const f=u.parse(s[1],1,nt);if(!f)return null;const g=[];let x=null;u.expectedType&&u.expectedType.kind!=="value"&&(x=u.expectedType);for(let w=1;w<s.length;w+=2){const T=w===1?-1/0:s[w],A=s[w+1],k=w,B=w+1;if(typeof T!="number")return u.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(g.length&&g[g.length-1][0]>=T)return u.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);const j=u.parse(A,B,x);if(!j)return null;x=x||j.type,g.push([T,j])}return new ca(x,f,g)}evaluate(s){const u=this.labels,f=this.outputs;if(u.length===1)return f[0].evaluate(s);const g=this.input.evaluate(s);if(g<=u[0])return f[0].evaluate(s);const x=u.length;return g>=u[x-1]?f[x-1].evaluate(s):f[El(u,g)].evaluate(s)}eachChild(s){s(this.input);for(const u of this.outputs)s(u)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}}function kn(c,s,u){return c+u*(s-c)}function Nu(c,s,u){return c.map((f,g)=>kn(f,s[g],u))}const us={number:kn,color:function(c,s,u,f="rgb"){switch(f){case"rgb":{const[g,x,w,T]=Nu(c.rgb,s.rgb,u);return new Cn(g,x,w,T,!1)}case"hcl":{const[g,x,w,T]=c.hcl,[A,k,B,j]=s.hcl;let W,Y;if(isNaN(g)||isNaN(A))isNaN(g)?isNaN(A)?W=NaN:(W=A,w!==1&&w!==0||(Y=k)):(W=g,B!==1&&B!==0||(Y=x));else{let Ie=A-g;A>g&&Ie>180?Ie-=360:A<g&&g-A>180&&(Ie+=360),W=g+u*Ie}const[J,ae,pe,ye]=function([Ie,be,ke,ze]){return Ie=isNaN(Ie)?0:Ie*ft,Ar([ke,Math.cos(Ie)*be,Math.sin(Ie)*be,ze])}([W,Y??kn(x,k,u),kn(w,B,u),kn(T,j,u)]);return new Cn(J,ae,pe,ye,!1)}case"lab":{const[g,x,w,T]=Ar(Nu(c.lab,s.lab,u));return new Cn(g,x,w,T,!1)}}},array:Nu,padding:function(c,s,u){return new bi(Nu(c.values,s.values,u))},variableAnchorOffsetCollection:function(c,s,u){const f=c.values,g=s.values;if(f.length!==g.length)throw new Qn(`Cannot interpolate values of different length. from: ${c.toString()}, to: ${s.toString()}`);const x=[];for(let w=0;w<f.length;w+=2){if(f[w]!==g[w])throw new Qn(`Cannot interpolate values containing mismatched anchors. from[${w}]: ${f[w]}, to[${w}]: ${g[w]}`);x.push(f[w]);const[T,A]=f[w+1],[k,B]=g[w+1];x.push([kn(T,k,u),kn(A,B,u)])}return new hi(x)}};class hs{constructor(s,u,f,g,x){this.type=s,this.operator=u,this.interpolation=f,this.input=g,this.labels=[],this.outputs=[];for(const[w,T]of x)this.labels.push(w),this.outputs.push(T)}static interpolationFactor(s,u,f,g){let x=0;if(s.name==="exponential")x=Bd(u,s.base,f,g);else if(s.name==="linear")x=Bd(u,1,f,g);else if(s.name==="cubic-bezier"){const w=s.controlPoints;x=new O(w[0],w[1],w[2],w[3]).solve(Bd(u,1,f,g))}return x}static parse(s,u){let[f,g,x,...w]=s;if(!Array.isArray(g)||g.length===0)return u.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const k=g[1];if(typeof k!="number")return u.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:k}}else{if(g[0]!=="cubic-bezier")return u.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const k=g.slice(1);if(k.length!==4||k.some(B=>typeof B!="number"||B<0||B>1))return u.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:k}}}if(s.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return u.error("Expected an even number of arguments.");if(x=u.parse(x,2,nt),!x)return null;const T=[];let A=null;f==="interpolate-hcl"||f==="interpolate-lab"?A=Cr:u.expectedType&&u.expectedType.kind!=="value"&&(A=u.expectedType);for(let k=0;k<w.length;k+=2){const B=w[k],j=w[k+1],W=k+3,Y=k+4;if(typeof B!="number")return u.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',W);if(T.length&&T[T.length-1][0]>=B)return u.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',W);const J=u.parse(j,Y,A);if(!J)return null;A=A||J.type,T.push([B,J])}return Ce(A,nt)||Ce(A,Cr)||Ce(A,he)||Ce(A,q)||Ce(A,ne(nt))?new hs(A,f,g,x,T):u.error(`Type ${ce(A)} is not interpolatable.`)}evaluate(s){const u=this.labels,f=this.outputs;if(u.length===1)return f[0].evaluate(s);const g=this.input.evaluate(s);if(g<=u[0])return f[0].evaluate(s);const x=u.length;if(g>=u[x-1])return f[x-1].evaluate(s);const w=El(u,g),T=hs.interpolationFactor(this.interpolation,g,u[w],u[w+1]),A=f[w].evaluate(s),k=f[w+1].evaluate(s);switch(this.operator){case"interpolate":return us[this.type.kind](A,k,T);case"interpolate-hcl":return us.color(A,k,T,"hcl");case"interpolate-lab":return us.color(A,k,T,"lab")}}eachChild(s){s(this.input);for(const u of this.outputs)s(u)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}}function Bd(c,s,u,f){const g=f-u,x=c-u;return g===0?0:s===1?x/g:(Math.pow(s,x)-1)/(Math.pow(s,g)-1)}class Bu{constructor(s,u){this.type=s,this.args=u}static parse(s,u){if(s.length<2)return u.error("Expectected at least one argument.");let f=null;const g=u.expectedType;g&&g.kind!=="value"&&(f=g);const x=[];for(const T of s.slice(1)){const A=u.parse(T,1+x.length,f,void 0,{typeAnnotation:"omit"});if(!A)return null;f=f||A.type,x.push(A)}if(!f)throw new Error("No output type");const w=g&&x.some(T=>Se(g,T.type));return new Bu(w?un:f,x)}evaluate(s){let u,f=null,g=0;for(const x of this.args)if(g++,f=x.evaluate(s),f&&f instanceof Zn&&!f.available&&(u||(u=f.name),f=null,g===this.args.length&&(f=u)),f!==null)break;return f}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}class Uu{constructor(s,u){this.type=u.type,this.bindings=[].concat(s),this.result=u}evaluate(s){return this.result.evaluate(s)}eachChild(s){for(const u of this.bindings)s(u[1]);s(this.result)}static parse(s,u){if(s.length<4)return u.error(`Expected at least 3 arguments, but found ${s.length-1} instead.`);const f=[];for(let x=1;x<s.length-1;x+=2){const w=s[x];if(typeof w!="string")return u.error(`Expected string, but found ${typeof w} instead.`,x);if(/[^a-zA-Z0-9_]/.test(w))return u.error("Variable names must contain only alphanumeric characters or '_'.",x);const T=u.parse(s[x+1],x+1);if(!T)return null;f.push([w,T])}const g=u.parse(s[s.length-1],s.length-1,u.expectedType,f);return g?new Uu(f,g):null}outputDefined(){return this.result.outputDefined()}}class Ud{constructor(s,u,f){this.type=s,this.index=u,this.input=f}static parse(s,u){if(s.length!==3)return u.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const f=u.parse(s[1],1,nt),g=u.parse(s[2],2,ne(u.expectedType||un));return f&&g?new Ud(g.type.itemType,f,g):null}evaluate(s){const u=this.index.evaluate(s),f=this.input.evaluate(s);if(u<0)throw new Qn(`Array index out of bounds: ${u} < 0.`);if(u>=f.length)throw new Qn(`Array index out of bounds: ${u} > ${f.length-1}.`);if(u!==Math.floor(u))throw new Qn(`Array index must be an integer, but found ${u} instead.`);return f[u]}eachChild(s){s(this.index),s(this.input)}outputDefined(){return!1}}class Vd{constructor(s,u){this.type=rn,this.needle=s,this.haystack=u}static parse(s,u){if(s.length!==3)return u.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const f=u.parse(s[1],1,un),g=u.parse(s[2],2,un);return f&&g?Te(f.type,[rn,on,nt,yn,un])?new Vd(f,g):u.error(`Expected first argument to be of type boolean, string, number or null, but found ${ce(f.type)} instead`):null}evaluate(s){const u=this.needle.evaluate(s),f=this.haystack.evaluate(s);if(!f)return!1;if(!ge(u,["boolean","string","number","null"]))throw new Qn(`Expected first argument to be of type boolean, string, number or null, but found ${ce(Jn(u))} instead.`);if(!ge(f,["string","array"]))throw new Qn(`Expected second argument to be of type array or string, but found ${ce(Jn(f))} instead.`);return f.indexOf(u)>=0}eachChild(s){s(this.needle),s(this.haystack)}outputDefined(){return!0}}class Vu{constructor(s,u,f){this.type=nt,this.needle=s,this.haystack=u,this.fromIndex=f}static parse(s,u){if(s.length<=2||s.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const f=u.parse(s[1],1,un),g=u.parse(s[2],2,un);if(!f||!g)return null;if(!Te(f.type,[rn,on,nt,yn,un]))return u.error(`Expected first argument to be of type boolean, string, number or null, but found ${ce(f.type)} instead`);if(s.length===4){const x=u.parse(s[3],3,nt);return x?new Vu(f,g,x):null}return new Vu(f,g)}evaluate(s){const u=this.needle.evaluate(s),f=this.haystack.evaluate(s);if(!ge(u,["boolean","string","number","null"]))throw new Qn(`Expected first argument to be of type boolean, string, number or null, but found ${ce(Jn(u))} instead.`);if(!ge(f,["string","array"]))throw new Qn(`Expected second argument to be of type array or string, but found ${ce(Jn(f))} instead.`);if(this.fromIndex){const g=this.fromIndex.evaluate(s);return f.indexOf(u,g)}return f.indexOf(u)}eachChild(s){s(this.needle),s(this.haystack),this.fromIndex&&s(this.fromIndex)}outputDefined(){return!1}}class jd{constructor(s,u,f,g,x,w){this.inputType=s,this.type=u,this.input=f,this.cases=g,this.outputs=x,this.otherwise=w}static parse(s,u){if(s.length<5)return u.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if(s.length%2!=1)return u.error("Expected an even number of arguments.");let f,g;u.expectedType&&u.expectedType.kind!=="value"&&(g=u.expectedType);const x={},w=[];for(let k=2;k<s.length-1;k+=2){let B=s[k];const j=s[k+1];Array.isArray(B)||(B=[B]);const W=u.concat(k);if(B.length===0)return W.error("Expected at least one branch label.");for(const J of B){if(typeof J!="number"&&typeof J!="string")return W.error("Branch labels must be numbers or strings.");if(typeof J=="number"&&Math.abs(J)>Number.MAX_SAFE_INTEGER)return W.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof J=="number"&&Math.floor(J)!==J)return W.error("Numeric branch labels must be integer values.");if(f){if(W.checkSubtype(f,Jn(J)))return null}else f=Jn(J);if(x[String(J)]!==void 0)return W.error("Branch labels must be unique.");x[String(J)]=w.length}const Y=u.parse(j,k,g);if(!Y)return null;g=g||Y.type,w.push(Y)}const T=u.parse(s[1],1,un);if(!T)return null;const A=u.parse(s[s.length-1],s.length-1,g);return A?T.type.kind!=="value"&&u.concat(1).checkSubtype(f,T.type)?null:new jd(f,g,T,x,w,A):null}evaluate(s){const u=this.input.evaluate(s);return(Jn(u)===this.inputType&&this.outputs[this.cases[u]]||this.otherwise).evaluate(s)}eachChild(s){s(this.input),this.outputs.forEach(s),s(this.otherwise)}outputDefined(){return this.outputs.every(s=>s.outputDefined())&&this.otherwise.outputDefined()}}class $d{constructor(s,u,f){this.type=s,this.branches=u,this.otherwise=f}static parse(s,u){if(s.length<4)return u.error(`Expected at least 3 arguments, but found only ${s.length-1}.`);if(s.length%2!=0)return u.error("Expected an odd number of arguments.");let f;u.expectedType&&u.expectedType.kind!=="value"&&(f=u.expectedType);const g=[];for(let w=1;w<s.length-1;w+=2){const T=u.parse(s[w],w,rn);if(!T)return null;const A=u.parse(s[w+1],w+1,f);if(!A)return null;g.push([T,A]),f=f||A.type}const x=u.parse(s[s.length-1],s.length-1,f);if(!x)return null;if(!f)throw new Error("Can't infer output type");return new $d(f,g,x)}evaluate(s){for(const[u,f]of this.branches)if(u.evaluate(s))return f.evaluate(s);return this.otherwise.evaluate(s)}eachChild(s){for(const[u,f]of this.branches)s(u),s(f);s(this.otherwise)}outputDefined(){return this.branches.every(([s,u])=>u.outputDefined())&&this.otherwise.outputDefined()}}class ju{constructor(s,u,f,g){this.type=s,this.input=u,this.beginIndex=f,this.endIndex=g}static parse(s,u){if(s.length<=2||s.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const f=u.parse(s[1],1,un),g=u.parse(s[2],2,nt);if(!f||!g)return null;if(!Te(f.type,[ne(un),on,un]))return u.error(`Expected first argument to be of type array or string, but found ${ce(f.type)} instead`);if(s.length===4){const x=u.parse(s[3],3,nt);return x?new ju(f.type,f,g,x):null}return new ju(f.type,f,g)}evaluate(s){const u=this.input.evaluate(s),f=this.beginIndex.evaluate(s);if(!ge(u,["string","array"]))throw new Qn(`Expected first argument to be of type array or string, but found ${ce(Jn(u))} instead.`);if(this.endIndex){const g=this.endIndex.evaluate(s);return u.slice(f,g)}return u.slice(f)}eachChild(s){s(this.input),s(this.beginIndex),this.endIndex&&s(this.endIndex)}outputDefined(){return!1}}function Gm(c,s){return c==="=="||c==="!="?s.kind==="boolean"||s.kind==="string"||s.kind==="number"||s.kind==="null"||s.kind==="value":s.kind==="string"||s.kind==="number"||s.kind==="value"}function Hm(c,s,u,f){return f.compare(s,u)===0}function Tl(c,s,u){const f=c!=="=="&&c!=="!=";return class sO{constructor(x,w,T){this.type=rn,this.lhs=x,this.rhs=w,this.collator=T,this.hasUntypedArgument=x.type.kind==="value"||w.type.kind==="value"}static parse(x,w){if(x.length!==3&&x.length!==4)return w.error("Expected two or three arguments.");const T=x[0];let A=w.parse(x[1],1,un);if(!A)return null;if(!Gm(T,A.type))return w.concat(1).error(`"${T}" comparisons are not supported for type '${ce(A.type)}'.`);let k=w.parse(x[2],2,un);if(!k)return null;if(!Gm(T,k.type))return w.concat(2).error(`"${T}" comparisons are not supported for type '${ce(k.type)}'.`);if(A.type.kind!==k.type.kind&&A.type.kind!=="value"&&k.type.kind!=="value")return w.error(`Cannot compare types '${ce(A.type)}' and '${ce(k.type)}'.`);f&&(A.type.kind==="value"&&k.type.kind!=="value"?A=new Hi(k.type,[A]):A.type.kind!=="value"&&k.type.kind==="value"&&(k=new Hi(A.type,[k])));let B=null;if(x.length===4){if(A.type.kind!=="string"&&k.type.kind!=="string"&&A.type.kind!=="value"&&k.type.kind!=="value")return w.error("Cannot use collator to compare non-string types.");if(B=w.parse(x[3],3,Kr),!B)return null}return new sO(A,k,B)}evaluate(x){const w=this.lhs.evaluate(x),T=this.rhs.evaluate(x);if(f&&this.hasUntypedArgument){const A=Jn(w),k=Jn(T);if(A.kind!==k.kind||A.kind!=="string"&&A.kind!=="number")throw new Qn(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${A.kind}, ${k.kind}) instead.`)}if(this.collator&&!f&&this.hasUntypedArgument){const A=Jn(w),k=Jn(T);if(A.kind!=="string"||k.kind!=="string")return s(x,w,T)}return this.collator?u(x,w,T,this.collator.evaluate(x)):s(x,w,T)}eachChild(x){x(this.lhs),x(this.rhs),this.collator&&x(this.collator)}outputDefined(){return!0}}}const Pv=Tl("==",function(c,s,u){return s===u},Hm),Cv=Tl("!=",function(c,s,u){return s!==u},function(c,s,u,f){return!Hm(0,s,u,f)}),Av=Tl("<",function(c,s,u){return s<u},function(c,s,u,f){return f.compare(s,u)<0}),Iv=Tl(">",function(c,s,u){return s>u},function(c,s,u,f){return f.compare(s,u)>0}),Mv=Tl("<=",function(c,s,u){return s<=u},function(c,s,u,f){return f.compare(s,u)<=0}),kv=Tl(">=",function(c,s,u){return s>=u},function(c,s,u,f){return f.compare(s,u)>=0});class Gd{constructor(s,u,f,g,x){this.type=on,this.number=s,this.locale=u,this.currency=f,this.minFractionDigits=g,this.maxFractionDigits=x}static parse(s,u){if(s.length!==3)return u.error("Expected two arguments.");const f=u.parse(s[1],1,nt);if(!f)return null;const g=s[2];if(typeof g!="object"||Array.isArray(g))return u.error("NumberFormat options argument must be an object.");let x=null;if(g.locale&&(x=u.parse(g.locale,1,on),!x))return null;let w=null;if(g.currency&&(w=u.parse(g.currency,1,on),!w))return null;let T=null;if(g["min-fraction-digits"]&&(T=u.parse(g["min-fraction-digits"],1,nt),!T))return null;let A=null;return g["max-fraction-digits"]&&(A=u.parse(g["max-fraction-digits"],1,nt),!A)?null:new Gd(f,x,w,T,A)}evaluate(s){return new Intl.NumberFormat(this.locale?this.locale.evaluate(s):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(s):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(s):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(s):void 0}).format(this.number.evaluate(s))}eachChild(s){s(this.number),this.locale&&s(this.locale),this.currency&&s(this.currency),this.minFractionDigits&&s(this.minFractionDigits),this.maxFractionDigits&&s(this.maxFractionDigits)}outputDefined(){return!1}}class $u{constructor(s){this.type=xi,this.sections=s}static parse(s,u){if(s.length<2)return u.error("Expected at least one argument.");const f=s[1];if(!Array.isArray(f)&&typeof f=="object")return u.error("First argument must be an image or text section.");const g=[];let x=!1;for(let w=1;w<=s.length-1;++w){const T=s[w];if(x&&typeof T=="object"&&!Array.isArray(T)){x=!1;let A=null;if(T["font-scale"]&&(A=u.parse(T["font-scale"],1,nt),!A))return null;let k=null;if(T["text-font"]&&(k=u.parse(T["text-font"],1,ne(on)),!k))return null;let B=null;if(T["text-color"]&&(B=u.parse(T["text-color"],1,Cr),!B))return null;const j=g[g.length-1];j.scale=A,j.font=k,j.textColor=B}else{const A=u.parse(s[w],1,un);if(!A)return null;const k=A.type.kind;if(k!=="string"&&k!=="value"&&k!=="null"&&k!=="resolvedImage")return u.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");x=!0,g.push({content:A,scale:null,font:null,textColor:null})}}return new $u(g)}evaluate(s){return new ir(this.sections.map(u=>{const f=u.content.evaluate(s);return Jn(f)===G?new ki("",f,null,null,null):new ki(Dn(f),null,u.scale?u.scale.evaluate(s):null,u.font?u.font.evaluate(s).join(","):null,u.textColor?u.textColor.evaluate(s):null)}))}eachChild(s){for(const u of this.sections)s(u.content),u.scale&&s(u.scale),u.font&&s(u.font),u.textColor&&s(u.textColor)}outputDefined(){return!1}}class Hd{constructor(s){this.type=G,this.input=s}static parse(s,u){if(s.length!==2)return u.error("Expected two arguments.");const f=u.parse(s[1],1,on);return f?new Hd(f):u.error("No image name provided.")}evaluate(s){const u=this.input.evaluate(s),f=Zn.fromString(u);return f&&s.availableImages&&(f.available=s.availableImages.indexOf(u)>-1),f}eachChild(s){s(this.input)}outputDefined(){return!1}}class Wd{constructor(s){this.type=nt,this.input=s}static parse(s,u){if(s.length!==2)return u.error(`Expected 1 argument, but found ${s.length-1} instead.`);const f=u.parse(s[1],1);return f?f.type.kind!=="array"&&f.type.kind!=="string"&&f.type.kind!=="value"?u.error(`Expected argument of type string or array, but found ${ce(f.type)} instead.`):new Wd(f):null}evaluate(s){const u=this.input.evaluate(s);if(typeof u=="string"||Array.isArray(u))return u.length;throw new Qn(`Expected value to be of type string or array, but found ${ce(Jn(u))} instead.`)}eachChild(s){s(this.input)}outputDefined(){return!1}}const Sl={"==":Pv,"!=":Cv,">":Iv,"<":Av,">=":kv,"<=":Mv,array:Hi,at:Ud,boolean:Hi,case:$d,coalesce:Bu,collator:ee,format:$u,image:Hd,in:Vd,"index-of":Vu,interpolate:hs,"interpolate-hcl":hs,"interpolate-lab":hs,length:Wd,let:Uu,literal:Vs,match:jd,number:Hi,"number-format":Gd,object:Hi,slice:ju,step:ca,string:Hi,"to-boolean":Ss,"to-color":Ss,"to-number":Ss,"to-string":Ss,var:Ou,within:Da};function Wm(c,[s,u,f,g]){s=s.evaluate(c),u=u.evaluate(c),f=f.evaluate(c);const x=g?g.evaluate(c):1,w=Fo(s,u,f,x);if(w)throw new Qn(w);return new Cn(s/255,u/255,f/255,x,!1)}function qm(c,s){return c in s}function qd(c,s){const u=s[c];return u===void 0?null:u}function za(c){return{type:c}}function Zm(c){return{result:"success",value:c}}function ua(c){return{result:"error",value:c}}function Pl(c){return c["property-type"]==="data-driven"||c["property-type"]==="cross-faded-data-driven"}function Xm(c){return!!c.expression&&c.expression.parameters.indexOf("zoom")>-1}function Zd(c){return!!c.expression&&c.expression.interpolated}function Un(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}function mr(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)}function Lv(c){return c}function Ln(c,s){const u=s.type==="color",f=c.stops&&typeof c.stops[0][0]=="object",g=f||!(f||c.property!==void 0),x=c.type||(Zd(s)?"exponential":"interval");if(u||s.type==="padding"){const B=u?Cn.parse:bi.parse;(c=Ye({},c)).stops&&(c.stops=c.stops.map(j=>[j[0],B(j[1])])),c.default=B(c.default?c.default:s.default)}if(c.colorSpace&&(w=c.colorSpace)!=="rgb"&&w!=="hcl"&&w!=="lab")throw new Error(`Unknown color space: "${c.colorSpace}"`);var w;let T,A,k;if(x==="exponential")T=Ac;else if(x==="interval")T=fr;else if(x==="categorical"){T=gr,A=Object.create(null);for(const B of c.stops)A[B[0]]=B[1];k=typeof c.stops[0][0]}else{if(x!=="identity")throw new Error(`Unknown function type "${x}"`);T=Ym}if(f){const B={},j=[];for(let J=0;J<c.stops.length;J++){const ae=c.stops[J],pe=ae[0].zoom;B[pe]===void 0&&(B[pe]={zoom:pe,type:c.type,property:c.property,default:c.default,stops:[]},j.push(pe)),B[pe].stops.push([ae[0].value,ae[1]])}const W=[];for(const J of j)W.push([B[J].zoom,Ln(B[J],s)]);const Y={name:"linear"};return{kind:"composite",interpolationType:Y,interpolationFactor:hs.interpolationFactor.bind(void 0,Y),zoomStops:W.map(J=>J[0]),evaluate:({zoom:J},ae)=>Ac({stops:W,base:c.base},s,J).evaluate(J,ae)}}if(g){const B=x==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:B,interpolationFactor:hs.interpolationFactor.bind(void 0,B),zoomStops:c.stops.map(j=>j[0]),evaluate:({zoom:j})=>T(c,s,j,A,k)}}return{kind:"source",evaluate(B,j){const W=j&&j.properties?j.properties[c.property]:void 0;return W===void 0?Fa(c.default,s.default):T(c,s,W,A,k)}}}function Fa(c,s,u){return c!==void 0?c:s!==void 0?s:u!==void 0?u:void 0}function gr(c,s,u,f,g){return Fa(typeof u===g?f[u]:void 0,c.default,s.default)}function fr(c,s,u){if(Un(u)!=="number")return Fa(c.default,s.default);const f=c.stops.length;if(f===1||u<=c.stops[0][0])return c.stops[0][1];if(u>=c.stops[f-1][0])return c.stops[f-1][1];const g=El(c.stops.map(x=>x[0]),u);return c.stops[g][1]}function Ac(c,s,u){const f=c.base!==void 0?c.base:1;if(Un(u)!=="number")return Fa(c.default,s.default);const g=c.stops.length;if(g===1||u<=c.stops[0][0])return c.stops[0][1];if(u>=c.stops[g-1][0])return c.stops[g-1][1];const x=El(c.stops.map(B=>B[0]),u),w=function(B,j,W,Y){const J=Y-W,ae=B-W;return J===0?0:j===1?ae/J:(Math.pow(j,ae)-1)/(Math.pow(j,J)-1)}(u,f,c.stops[x][0],c.stops[x+1][0]),T=c.stops[x][1],A=c.stops[x+1][1],k=us[s.type]||Lv;return typeof T.evaluate=="function"?{evaluate(...B){const j=T.evaluate.apply(void 0,B),W=A.evaluate.apply(void 0,B);if(j!==void 0&&W!==void 0)return k(j,W,w,c.colorSpace)}}:k(T,A,w,c.colorSpace)}function Ym(c,s,u){switch(s.type){case"color":u=Cn.parse(u);break;case"formatted":u=ir.fromString(u.toString());break;case"resolvedImage":u=Zn.fromString(u.toString());break;case"padding":u=bi.parse(u);break;default:Un(u)===s.type||s.type==="enum"&&s.values[u]||(u=void 0)}return Fa(u,c.default,s.default)}Ps.register(Sl,{error:[{kind:"error"},[on],(c,[s])=>{throw new Qn(s.evaluate(c))}],typeof:[on,[un],(c,[s])=>ce(Jn(s.evaluate(c)))],"to-rgba":[ne(nt,4),[Cr],(c,[s])=>{const[u,f,g,x]=s.evaluate(c).rgb;return[255*u,255*f,255*g,x]}],rgb:[Cr,[nt,nt,nt],Wm],rgba:[Cr,[nt,nt,nt,nt],Wm],has:{type:rn,overloads:[[[on],(c,[s])=>qm(s.evaluate(c),c.properties())],[[on,li],(c,[s,u])=>qm(s.evaluate(c),u.evaluate(c))]]},get:{type:un,overloads:[[[on],(c,[s])=>qd(s.evaluate(c),c.properties())],[[on,li],(c,[s,u])=>qd(s.evaluate(c),u.evaluate(c))]]},"feature-state":[un,[on],(c,[s])=>qd(s.evaluate(c),c.featureState||{})],properties:[li,[],c=>c.properties()],"geometry-type":[on,[],c=>c.geometryType()],id:[un,[],c=>c.id()],zoom:[nt,[],c=>c.globals.zoom],"heatmap-density":[nt,[],c=>c.globals.heatmapDensity||0],"line-progress":[nt,[],c=>c.globals.lineProgress||0],accumulated:[un,[],c=>c.globals.accumulated===void 0?null:c.globals.accumulated],"+":[nt,za(nt),(c,s)=>{let u=0;for(const f of s)u+=f.evaluate(c);return u}],"*":[nt,za(nt),(c,s)=>{let u=1;for(const f of s)u*=f.evaluate(c);return u}],"-":{type:nt,overloads:[[[nt,nt],(c,[s,u])=>s.evaluate(c)-u.evaluate(c)],[[nt],(c,[s])=>-s.evaluate(c)]]},"/":[nt,[nt,nt],(c,[s,u])=>s.evaluate(c)/u.evaluate(c)],"%":[nt,[nt,nt],(c,[s,u])=>s.evaluate(c)%u.evaluate(c)],ln2:[nt,[],()=>Math.LN2],pi:[nt,[],()=>Math.PI],e:[nt,[],()=>Math.E],"^":[nt,[nt,nt],(c,[s,u])=>Math.pow(s.evaluate(c),u.evaluate(c))],sqrt:[nt,[nt],(c,[s])=>Math.sqrt(s.evaluate(c))],log10:[nt,[nt],(c,[s])=>Math.log(s.evaluate(c))/Math.LN10],ln:[nt,[nt],(c,[s])=>Math.log(s.evaluate(c))],log2:[nt,[nt],(c,[s])=>Math.log(s.evaluate(c))/Math.LN2],sin:[nt,[nt],(c,[s])=>Math.sin(s.evaluate(c))],cos:[nt,[nt],(c,[s])=>Math.cos(s.evaluate(c))],tan:[nt,[nt],(c,[s])=>Math.tan(s.evaluate(c))],asin:[nt,[nt],(c,[s])=>Math.asin(s.evaluate(c))],acos:[nt,[nt],(c,[s])=>Math.acos(s.evaluate(c))],atan:[nt,[nt],(c,[s])=>Math.atan(s.evaluate(c))],min:[nt,za(nt),(c,s)=>Math.min(...s.map(u=>u.evaluate(c)))],max:[nt,za(nt),(c,s)=>Math.max(...s.map(u=>u.evaluate(c)))],abs:[nt,[nt],(c,[s])=>Math.abs(s.evaluate(c))],round:[nt,[nt],(c,[s])=>{const u=s.evaluate(c);return u<0?-Math.round(-u):Math.round(u)}],floor:[nt,[nt],(c,[s])=>Math.floor(s.evaluate(c))],ceil:[nt,[nt],(c,[s])=>Math.ceil(s.evaluate(c))],"filter-==":[rn,[on,un],(c,[s,u])=>c.properties()[s.value]===u.value],"filter-id-==":[rn,[un],(c,[s])=>c.id()===s.value],"filter-type-==":[rn,[on],(c,[s])=>c.geometryType()===s.value],"filter-<":[rn,[on,un],(c,[s,u])=>{const f=c.properties()[s.value],g=u.value;return typeof f==typeof g&&f<g}],"filter-id-<":[rn,[un],(c,[s])=>{const u=c.id(),f=s.value;return typeof u==typeof f&&u<f}],"filter->":[rn,[on,un],(c,[s,u])=>{const f=c.properties()[s.value],g=u.value;return typeof f==typeof g&&f>g}],"filter-id->":[rn,[un],(c,[s])=>{const u=c.id(),f=s.value;return typeof u==typeof f&&u>f}],"filter-<=":[rn,[on,un],(c,[s,u])=>{const f=c.properties()[s.value],g=u.value;return typeof f==typeof g&&f<=g}],"filter-id-<=":[rn,[un],(c,[s])=>{const u=c.id(),f=s.value;return typeof u==typeof f&&u<=f}],"filter->=":[rn,[on,un],(c,[s,u])=>{const f=c.properties()[s.value],g=u.value;return typeof f==typeof g&&f>=g}],"filter-id->=":[rn,[un],(c,[s])=>{const u=c.id(),f=s.value;return typeof u==typeof f&&u>=f}],"filter-has":[rn,[un],(c,[s])=>s.value in c.properties()],"filter-has-id":[rn,[],c=>c.id()!==null&&c.id()!==void 0],"filter-type-in":[rn,[ne(on)],(c,[s])=>s.value.indexOf(c.geometryType())>=0],"filter-id-in":[rn,[ne(un)],(c,[s])=>s.value.indexOf(c.id())>=0],"filter-in-small":[rn,[on,ne(un)],(c,[s,u])=>u.value.indexOf(c.properties()[s.value])>=0],"filter-in-large":[rn,[on,ne(un)],(c,[s,u])=>function(f,g,x,w){for(;x<=w;){const T=x+w>>1;if(g[T]===f)return!0;g[T]>f?w=T-1:x=T+1}return!1}(c.properties()[s.value],u.value,0,u.value.length-1)],all:{type:rn,overloads:[[[rn,rn],(c,[s,u])=>s.evaluate(c)&&u.evaluate(c)],[za(rn),(c,s)=>{for(const u of s)if(!u.evaluate(c))return!1;return!0}]]},any:{type:rn,overloads:[[[rn,rn],(c,[s,u])=>s.evaluate(c)||u.evaluate(c)],[za(rn),(c,s)=>{for(const u of s)if(u.evaluate(c))return!0;return!1}]]},"!":[rn,[rn],(c,[s])=>!s.evaluate(c)],"is-supported-script":[rn,[on],(c,[s])=>{const u=c.globals&&c.globals.isSupportedScript;return!u||u(s.evaluate(c))}],upcase:[on,[on],(c,[s])=>s.evaluate(c).toUpperCase()],downcase:[on,[on],(c,[s])=>s.evaluate(c).toLowerCase()],concat:[on,za(un),(c,s)=>s.map(u=>Dn(u.evaluate(c))).join("")],"resolved-locale":[on,[Kr],(c,[s])=>s.evaluate(c).resolvedLocale()]});class Xd{constructor(s,u){var f;this.expression=s,this._warningHistory={},this._evaluator=new Pc,this._defaultValue=u?(f=u).type==="color"&&mr(f.default)?new Cn(0,0,0,0):f.type==="color"?Cn.parse(f.default)||null:f.type==="padding"?bi.parse(f.default)||null:f.type==="variableAnchorOffsetCollection"?hi.parse(f.default)||null:f.default===void 0?null:f.default:null,this._enumValues=u&&u.type==="enum"?u.values:null}evaluateWithoutErrorHandling(s,u,f,g,x,w){return this._evaluator.globals=s,this._evaluator.feature=u,this._evaluator.featureState=f,this._evaluator.canonical=g,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=w,this.expression.evaluate(this._evaluator)}evaluate(s,u,f,g,x,w){this._evaluator.globals=s,this._evaluator.feature=u||null,this._evaluator.featureState=f||null,this._evaluator.canonical=g,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=w||null;try{const T=this.expression.evaluate(this._evaluator);if(T==null||typeof T=="number"&&T!=T)return this._defaultValue;if(this._enumValues&&!(T in this._enumValues))throw new Qn(`Expected value to be one of ${Object.keys(this._enumValues).map(A=>JSON.stringify(A)).join(", ")}, but found ${JSON.stringify(T)} instead.`);return T}catch(T){return this._warningHistory[T.message]||(this._warningHistory[T.message]=!0,typeof console<"u"&&console.warn(T.message)),this._defaultValue}}}function Gu(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in Sl}function Hu(c,s){const u=new wl(Sl,Du,[],s?function(g){const x={color:Cr,string:on,number:nt,enum:on,boolean:rn,formatted:xi,padding:he,resolvedImage:G,variableAnchorOffsetCollection:q};return g.type==="array"?ne(x[g.value]||un,g.length):x[g.type]}(s):void 0),f=u.parse(c,void 0,void 0,void 0,s&&s.type==="string"?{typeAnnotation:"coerce"}:void 0);return f?Zm(new Xd(f,s)):ua(u.errors)}class Yd{constructor(s,u){this.kind=s,this._styleExpression=u,this.isStateDependent=s!=="constant"&&!Cc(u.expression)}evaluateWithoutErrorHandling(s,u,f,g,x,w){return this._styleExpression.evaluateWithoutErrorHandling(s,u,f,g,x,w)}evaluate(s,u,f,g,x,w){return this._styleExpression.evaluate(s,u,f,g,x,w)}}class Wu{constructor(s,u,f,g){this.kind=s,this.zoomStops=f,this._styleExpression=u,this.isStateDependent=s!=="camera"&&!Cc(u.expression),this.interpolationType=g}evaluateWithoutErrorHandling(s,u,f,g,x,w){return this._styleExpression.evaluateWithoutErrorHandling(s,u,f,g,x,w)}evaluate(s,u,f,g,x,w){return this._styleExpression.evaluate(s,u,f,g,x,w)}interpolationFactor(s,u,f){return this.interpolationType?hs.interpolationFactor(this.interpolationType,s,u,f):0}}function Kd(c,s){const u=Hu(c,s);if(u.result==="error")return u;const f=u.value.expression,g=zu(f);if(!g&&!Pl(s))return ua([new St("","data expressions not supported")]);const x=Fu(f,["zoom"]);if(!x&&!Xm(s))return ua([new St("","zoom expressions not supported")]);const w=Mc(f);return w||x?w instanceof St?ua([w]):w instanceof hs&&!Zd(s)?ua([new St("",'"interpolate" expressions cannot be used with this property')]):Zm(w?new Wu(g?"camera":"composite",u.value,w.labels,w instanceof hs?w.interpolation:void 0):new Yd(g?"constant":"source",u.value)):ua([new St("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ic{constructor(s,u){this._parameters=s,this._specification=u,Ye(this,Ln(this._parameters,this._specification))}static deserialize(s){return new Ic(s._parameters,s._specification)}static serialize(s){return{_parameters:s._parameters,_specification:s._specification}}}function Mc(c){let s=null;if(c instanceof Uu)s=Mc(c.result);else if(c instanceof Bu){for(const u of c.args)if(s=Mc(u),s)break}else(c instanceof ca||c instanceof hs)&&c.input instanceof Ps&&c.input.name==="zoom"&&(s=c);return s instanceof St||c.eachChild(u=>{const f=Mc(u);f instanceof St?s=f:!s&&f?s=new St("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):s&&f&&s!==f&&(s=new St("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),s}function kc(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const s of c.slice(1))if(!kc(s)&&typeof s!="boolean")return!1;return!0;default:return!0}}const Rv={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Jd(c){if(c==null)return{filter:()=>!0,needGeometry:!1};kc(c)||(c=qu(c));const s=Hu(c,Rv);if(s.result==="error")throw new Error(s.value.map(u=>`${u.key}: ${u.message}`).join(", "));return{filter:(u,f,g)=>s.value.evaluate(u,f,{},g),needGeometry:Km(c)}}function Ov(c,s){return c<s?-1:c>s?1:0}function Km(c){if(!Array.isArray(c))return!1;if(c[0]==="within")return!0;for(let s=1;s<c.length;s++)if(Km(c[s]))return!0;return!1}function qu(c){if(!c)return!0;const s=c[0];return c.length<=1?s!=="any":s==="=="?Qd(c[1],c[2],"=="):s==="!="?Lc(Qd(c[1],c[2],"==")):s==="<"||s===">"||s==="<="||s===">="?Qd(c[1],c[2],s):s==="any"?(u=c.slice(1),["any"].concat(u.map(qu))):s==="all"?["all"].concat(c.slice(1).map(qu)):s==="none"?["all"].concat(c.slice(1).map(qu).map(Lc)):s==="in"?Jm(c[1],c.slice(2)):s==="!in"?Lc(Jm(c[1],c.slice(2))):s==="has"?Qm(c[1]):s==="!has"?Lc(Qm(c[1])):s!=="within"||c;var u}function Qd(c,s,u){switch(c){case"$type":return[`filter-type-${u}`,s];case"$id":return[`filter-id-${u}`,s];default:return[`filter-${u}`,c,s]}}function Jm(c,s){if(s.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",s]];case"$id":return["filter-id-in",["literal",s]];default:return s.length>200&&!s.some(u=>typeof u!=typeof s[0])?["filter-in-large",c,["literal",s.sort(Ov)]]:["filter-in-small",c,["literal",s]]}}function Qm(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function Lc(c){return["!",c]}function Zu(c){const s=typeof c;if(s==="number"||s==="boolean"||s==="string"||c==null)return JSON.stringify(c);if(Array.isArray(c)){let g="[";for(const x of c)g+=`${Zu(x)},`;return`${g}]`}const u=Object.keys(c).sort();let f="{";for(let g=0;g<u.length;g++)f+=`${JSON.stringify(u[g])}:${Zu(c[u[g]])},`;return`${f}}`}function Xu(c){let s="";for(const u of Bt)s+=`/${Zu(c[u])}`;return s}function eg(c){const s=c.value;return s?[new Ne(c.key,s,"constants have been deprecated as of v8")]:[]}function br(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function Na(c){if(Array.isArray(c))return c.map(Na);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const s={};for(const u in c)s[u]=Na(c[u]);return s}return br(c)}function Wi(c){const s=c.key,u=c.value,f=c.valueSpec||{},g=c.objectElementValidators||{},x=c.style,w=c.styleSpec,T=c.validateSpec;let A=[];const k=Un(u);if(k!=="object")return[new Ne(s,u,`object expected, ${k} found`)];for(const B in u){const j=B.split(".")[0],W=f[j]||f["*"];let Y;if(g[j])Y=g[j];else if(f[j])Y=T;else if(g["*"])Y=g["*"];else{if(!f["*"]){A.push(new Ne(s,u[B],`unknown property "${B}"`));continue}Y=T}A=A.concat(Y({key:(s&&`${s}.`)+B,value:u[B],valueSpec:W,style:x,styleSpec:w,object:u,objectKey:B,validateSpec:T},u))}for(const B in f)g[B]||f[B].required&&f[B].default===void 0&&u[B]===void 0&&A.push(new Ne(s,u,`missing required property "${B}"`));return A}function Cl(c){const s=c.value,u=c.valueSpec,f=c.style,g=c.styleSpec,x=c.key,w=c.arrayElementValidator||c.validateSpec;if(Un(s)!=="array")return[new Ne(x,s,`array expected, ${Un(s)} found`)];if(u.length&&s.length!==u.length)return[new Ne(x,s,`array length ${u.length} expected, length ${s.length} found`)];if(u["min-length"]&&s.length<u["min-length"])return[new Ne(x,s,`array length at least ${u["min-length"]} expected, length ${s.length} found`)];let T={type:u.value,values:u.values};g.$version<7&&(T.function=u.function),Un(u.value)==="object"&&(T=u.value);let A=[];for(let k=0;k<s.length;k++)A=A.concat(w({array:s,arrayIndex:k,value:s[k],valueSpec:T,validateSpec:c.validateSpec,style:f,styleSpec:g,key:`${x}[${k}]`}));return A}function Rc(c){const s=c.key,u=c.value,f=c.valueSpec;let g=Un(u);return g==="number"&&u!=u&&(g="NaN"),g!=="number"?[new Ne(s,u,`number expected, ${g} found`)]:"minimum"in f&&u<f.minimum?[new Ne(s,u,`${u} is less than the minimum value ${f.minimum}`)]:"maximum"in f&&u>f.maximum?[new Ne(s,u,`${u} is greater than the maximum value ${f.maximum}`)]:[]}function Yu(c){const s=c.valueSpec,u=br(c.value.type);let f,g,x,w={};const T=u!=="categorical"&&c.value.property===void 0,A=!T,k=Un(c.value.stops)==="array"&&Un(c.value.stops[0])==="array"&&Un(c.value.stops[0][0])==="object",B=Wi({key:c.key,value:c.value,valueSpec:c.styleSpec.function,validateSpec:c.validateSpec,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{stops:function(Y){if(u==="identity")return[new Ne(Y.key,Y.value,'identity function may not have a "stops" property')];let J=[];const ae=Y.value;return J=J.concat(Cl({key:Y.key,value:ae,valueSpec:Y.valueSpec,validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec,arrayElementValidator:j})),Un(ae)==="array"&&ae.length===0&&J.push(new Ne(Y.key,ae,"array must have at least one stop")),J},default:function(Y){return Y.validateSpec({key:Y.key,value:Y.value,valueSpec:s,validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec})}}});return u==="identity"&&T&&B.push(new Ne(c.key,c.value,'missing required property "property"')),u==="identity"||c.value.stops||B.push(new Ne(c.key,c.value,'missing required property "stops"')),u==="exponential"&&c.valueSpec.expression&&!Zd(c.valueSpec)&&B.push(new Ne(c.key,c.value,"exponential functions not supported")),c.styleSpec.$version>=8&&(A&&!Pl(c.valueSpec)?B.push(new Ne(c.key,c.value,"property functions not supported")):T&&!Xm(c.valueSpec)&&B.push(new Ne(c.key,c.value,"zoom functions not supported"))),u!=="categorical"&&!k||c.value.property!==void 0||B.push(new Ne(c.key,c.value,'"property" property is required')),B;function j(Y){let J=[];const ae=Y.value,pe=Y.key;if(Un(ae)!=="array")return[new Ne(pe,ae,`array expected, ${Un(ae)} found`)];if(ae.length!==2)return[new Ne(pe,ae,`array length 2 expected, length ${ae.length} found`)];if(k){if(Un(ae[0])!=="object")return[new Ne(pe,ae,`object expected, ${Un(ae[0])} found`)];if(ae[0].zoom===void 0)return[new Ne(pe,ae,"object stop key must have zoom")];if(ae[0].value===void 0)return[new Ne(pe,ae,"object stop key must have value")];if(x&&x>br(ae[0].zoom))return[new Ne(pe,ae[0].zoom,"stop zoom values must appear in ascending order")];br(ae[0].zoom)!==x&&(x=br(ae[0].zoom),g=void 0,w={}),J=J.concat(Wi({key:`${pe}[0]`,value:ae[0],valueSpec:{zoom:{}},validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec,objectElementValidators:{zoom:Rc,value:W}}))}else J=J.concat(W({key:`${pe}[0]`,value:ae[0],valueSpec:{},validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec},ae));return Gu(Na(ae[1]))?J.concat([new Ne(`${pe}[1]`,ae[1],"expressions are not allowed in function stops.")]):J.concat(Y.validateSpec({key:`${pe}[1]`,value:ae[1],valueSpec:s,validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec}))}function W(Y,J){const ae=Un(Y.value),pe=br(Y.value),ye=Y.value!==null?Y.value:J;if(f){if(ae!==f)return[new Ne(Y.key,ye,`${ae} stop domain type must match previous stop domain type ${f}`)]}else f=ae;if(ae!=="number"&&ae!=="string"&&ae!=="boolean")return[new Ne(Y.key,ye,"stop domain value must be a number, string, or boolean")];if(ae!=="number"&&u!=="categorical"){let Ie=`number expected, ${ae} found`;return Pl(s)&&u===void 0&&(Ie+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ne(Y.key,ye,Ie)]}return u!=="categorical"||ae!=="number"||isFinite(pe)&&Math.floor(pe)===pe?u!=="categorical"&&ae==="number"&&g!==void 0&&pe<g?[new Ne(Y.key,ye,"stop domain values must appear in ascending order")]:(g=pe,u==="categorical"&&pe in w?[new Ne(Y.key,ye,"stop domain values must be unique")]:(w[pe]=!0,[])):[new Ne(Y.key,ye,`integer expected, found ${pe}`)]}}function Ba(c){const s=(c.expressionContext==="property"?Kd:Hu)(Na(c.value),c.valueSpec);if(s.result==="error")return s.value.map(f=>new Ne(`${c.key}${f.key}`,c.value,f.message));const u=s.value.expression||s.value._styleExpression.expression;if(c.expressionContext==="property"&&c.propertyKey==="text-font"&&!u.outputDefined())return[new Ne(c.key,c.value,`Invalid data expression for "${c.propertyKey}". Output values must be contained as literals within the expression.`)];if(c.expressionContext==="property"&&c.propertyType==="layout"&&!Cc(u))return[new Ne(c.key,c.value,'"feature-state" data expressions are not supported with layout properties.')];if(c.expressionContext==="filter"&&!Cc(u))return[new Ne(c.key,c.value,'"feature-state" data expressions are not supported with filters.')];if(c.expressionContext&&c.expressionContext.indexOf("cluster")===0){if(!Fu(u,["zoom","feature-state"]))return[new Ne(c.key,c.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(c.expressionContext==="cluster-initial"&&!zu(u))return[new Ne(c.key,c.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Oc(c){const s=c.key,u=c.value,f=c.valueSpec,g=[];return Array.isArray(f.values)?f.values.indexOf(br(u))===-1&&g.push(new Ne(s,u,`expected one of [${f.values.join(", ")}], ${JSON.stringify(u)} found`)):Object.keys(f.values).indexOf(br(u))===-1&&g.push(new Ne(s,u,`expected one of [${Object.keys(f.values).join(", ")}], ${JSON.stringify(u)} found`)),g}function Al(c){return kc(Na(c.value))?Ba(Ye({},c,{expressionContext:"filter",valueSpec:{value:"boolean"}})):tg(c)}function tg(c){const s=c.value,u=c.key;if(Un(s)!=="array")return[new Ne(u,s,`array expected, ${Un(s)} found`)];const f=c.styleSpec;let g,x=[];if(s.length<1)return[new Ne(u,s,"filter array must have at least 1 element")];switch(x=x.concat(Oc({key:`${u}[0]`,value:s[0],valueSpec:f.filter_operator,style:c.style,styleSpec:c.styleSpec})),br(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&br(s[1])==="$type"&&x.push(new Ne(u,s,`"$type" cannot be use with operator "${s[0]}"`));case"==":case"!=":s.length!==3&&x.push(new Ne(u,s,`filter array for operator "${s[0]}" must have 3 elements`));case"in":case"!in":s.length>=2&&(g=Un(s[1]),g!=="string"&&x.push(new Ne(`${u}[1]`,s[1],`string expected, ${g} found`)));for(let w=2;w<s.length;w++)g=Un(s[w]),br(s[1])==="$type"?x=x.concat(Oc({key:`${u}[${w}]`,value:s[w],valueSpec:f.geometry_type,style:c.style,styleSpec:c.styleSpec})):g!=="string"&&g!=="number"&&g!=="boolean"&&x.push(new Ne(`${u}[${w}]`,s[w],`string, number, or boolean expected, ${g} found`));break;case"any":case"all":case"none":for(let w=1;w<s.length;w++)x=x.concat(tg({key:`${u}[${w}]`,value:s[w],style:c.style,styleSpec:c.styleSpec}));break;case"has":case"!has":g=Un(s[1]),s.length!==2?x.push(new Ne(u,s,`filter array for "${s[0]}" operator must have 2 elements`)):g!=="string"&&x.push(new Ne(`${u}[1]`,s[1],`string expected, ${g} found`));break;case"within":g=Un(s[1]),s.length!==2?x.push(new Ne(u,s,`filter array for "${s[0]}" operator must have 2 elements`)):g!=="object"&&x.push(new Ne(`${u}[1]`,s[1],`object expected, ${g} found`))}return x}function ng(c,s){const u=c.key,f=c.validateSpec,g=c.style,x=c.styleSpec,w=c.value,T=c.objectKey,A=x[`${s}_${c.layerType}`];if(!A)return[];const k=T.match(/^(.*)-transition$/);if(s==="paint"&&k&&A[k[1]]&&A[k[1]].transition)return f({key:u,value:w,valueSpec:x.transition,style:g,styleSpec:x});const B=c.valueSpec||A[T];if(!B)return[new Ne(u,w,`unknown property "${T}"`)];let j;if(Un(w)==="string"&&Pl(B)&&!B.tokens&&(j=/^{([^}]+)}$/.exec(w)))return[new Ne(u,w,`"${T}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(j[1])} }\`.`)];const W=[];return c.layerType==="symbol"&&(T==="text-field"&&g&&!g.glyphs&&W.push(new Ne(u,w,'use of "text-field" requires a style "glyphs" property')),T==="text-font"&&mr(Na(w))&&br(w.type)==="identity"&&W.push(new Ne(u,w,'"text-font" does not support identity functions'))),W.concat(f({key:c.key,value:w,valueSpec:B,style:g,styleSpec:x,expressionContext:"property",propertyType:s,propertyKey:T}))}function rg(c){return ng(c,"paint")}function ig(c){return ng(c,"layout")}function sg(c){let s=[];const u=c.value,f=c.key,g=c.style,x=c.styleSpec;u.type||u.ref||s.push(new Ne(f,u,'either "type" or "ref" is required'));let w=br(u.type);const T=br(u.ref);if(u.id){const A=br(u.id);for(let k=0;k<c.arrayIndex;k++){const B=g.layers[k];br(B.id)===A&&s.push(new Ne(f,u.id,`duplicate layer id "${u.id}", previously used at line ${B.id.__line__}`))}}if("ref"in u){let A;["type","source","source-layer","filter","layout"].forEach(k=>{k in u&&s.push(new Ne(f,u[k],`"${k}" is prohibited for ref layers`))}),g.layers.forEach(k=>{br(k.id)===T&&(A=k)}),A?A.ref?s.push(new Ne(f,u.ref,"ref cannot reference another ref layer")):w=br(A.type):s.push(new Ne(f,u.ref,`ref layer "${T}" not found`))}else if(w!=="background")if(u.source){const A=g.sources&&g.sources[u.source],k=A&&br(A.type);A?k==="vector"&&w==="raster"?s.push(new Ne(f,u.source,`layer "${u.id}" requires a raster source`)):k!=="raster-dem"&&w==="hillshade"?s.push(new Ne(f,u.source,`layer "${u.id}" requires a raster-dem source`)):k==="raster"&&w!=="raster"?s.push(new Ne(f,u.source,`layer "${u.id}" requires a vector source`)):k!=="vector"||u["source-layer"]?k==="raster-dem"&&w!=="hillshade"?s.push(new Ne(f,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):w!=="line"||!u.paint||!u.paint["line-gradient"]||k==="geojson"&&A.lineMetrics||s.push(new Ne(f,u,`layer "${u.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):s.push(new Ne(f,u,`layer "${u.id}" must specify a "source-layer"`)):s.push(new Ne(f,u.source,`source "${u.source}" not found`))}else s.push(new Ne(f,u,'missing required property "source"'));return s=s.concat(Wi({key:f,value:u,valueSpec:x.layer,style:c.style,styleSpec:c.styleSpec,validateSpec:c.validateSpec,objectElementValidators:{"*":()=>[],type:()=>c.validateSpec({key:`${f}.type`,value:u.type,valueSpec:x.layer.type,style:c.style,styleSpec:c.styleSpec,validateSpec:c.validateSpec,object:u,objectKey:"type"}),filter:Al,layout:A=>Wi({layer:u,key:A.key,value:A.value,style:A.style,styleSpec:A.styleSpec,validateSpec:A.validateSpec,objectElementValidators:{"*":k=>ig(Ye({layerType:w},k))}}),paint:A=>Wi({layer:u,key:A.key,value:A.value,style:A.style,styleSpec:A.styleSpec,validateSpec:A.validateSpec,objectElementValidators:{"*":k=>rg(Ye({layerType:w},k))}})}})),s}function po(c){const s=c.value,u=c.key,f=Un(s);return f!=="string"?[new Ne(u,s,`string expected, ${f} found`)]:[]}const Dc={promoteId:function({key:c,value:s}){if(Un(s)==="string")return po({key:c,value:s});{const u=[];for(const f in s)u.push(...po({key:`${c}.${f}`,value:s[f]}));return u}}};function ds(c){const s=c.value,u=c.key,f=c.styleSpec,g=c.style,x=c.validateSpec;if(!s.type)return[new Ne(u,s,'"type" is required')];const w=br(s.type);let T;switch(w){case"vector":case"raster":return T=Wi({key:u,value:s,valueSpec:f[`source_${w.replace("-","_")}`],style:c.style,styleSpec:f,objectElementValidators:Dc,validateSpec:x}),T;case"raster-dem":return T=function(A){var k;const B=(k=A.sourceName)!==null&&k!==void 0?k:"",j=A.value,W=A.styleSpec,Y=W.source_raster_dem,J=A.style;let ae=[];const pe=Un(j);if(j===void 0)return ae;if(pe!=="object")return ae.push(new Ne("source_raster_dem",j,`object expected, ${pe} found`)),ae;const ye=br(j.encoding)==="custom",Ie=["redFactor","greenFactor","blueFactor","baseShift"],be=A.value.encoding?`"${A.value.encoding}"`:"Default";for(const ke in j)!ye&&Ie.includes(ke)?ae.push(new Ne(ke,j[ke],`In "${B}": "${ke}" is only valid when "encoding" is set to "custom". ${be} encoding found`)):Y[ke]?ae=ae.concat(A.validateSpec({key:ke,value:j[ke],valueSpec:Y[ke],validateSpec:A.validateSpec,style:J,styleSpec:W})):ae.push(new Ne(ke,j[ke],`unknown property "${ke}"`));return ae}({sourceName:u,value:s,style:c.style,styleSpec:f,validateSpec:x}),T;case"geojson":if(T=Wi({key:u,value:s,valueSpec:f.source_geojson,style:g,styleSpec:f,validateSpec:x,objectElementValidators:Dc}),s.cluster)for(const A in s.clusterProperties){const[k,B]=s.clusterProperties[A],j=typeof k=="string"?[k,["accumulated"],["get",A]]:k;T.push(...Ba({key:`${u}.${A}.map`,value:B,validateSpec:x,expressionContext:"cluster-map"})),T.push(...Ba({key:`${u}.${A}.reduce`,value:j,validateSpec:x,expressionContext:"cluster-reduce"}))}return T;case"video":return Wi({key:u,value:s,valueSpec:f.source_video,style:g,validateSpec:x,styleSpec:f});case"image":return Wi({key:u,value:s,valueSpec:f.source_image,style:g,validateSpec:x,styleSpec:f});case"canvas":return[new Ne(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Oc({key:`${u}.type`,value:s.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:g,validateSpec:x,styleSpec:f})}}function zc(c){const s=c.value,u=c.styleSpec,f=u.light,g=c.style;let x=[];const w=Un(s);if(s===void 0)return x;if(w!=="object")return x=x.concat([new Ne("light",s,`object expected, ${w} found`)]),x;for(const T in s){const A=T.match(/^(.*)-transition$/);x=x.concat(A&&f[A[1]]&&f[A[1]].transition?c.validateSpec({key:T,value:s[T],valueSpec:u.transition,validateSpec:c.validateSpec,style:g,styleSpec:u}):f[T]?c.validateSpec({key:T,value:s[T],valueSpec:f[T],validateSpec:c.validateSpec,style:g,styleSpec:u}):[new Ne(T,s[T],`unknown property "${T}"`)])}return x}function og(c){const s=c.value,u=c.styleSpec,f=u.terrain,g=c.style;let x=[];const w=Un(s);if(s===void 0)return x;if(w!=="object")return x=x.concat([new Ne("terrain",s,`object expected, ${w} found`)]),x;for(const T in s)x=x.concat(f[T]?c.validateSpec({key:T,value:s[T],valueSpec:f[T],validateSpec:c.validateSpec,style:g,styleSpec:u}):[new Ne(T,s[T],`unknown property "${T}"`)]);return x}function ag(c){let s=[];const u=c.value,f=c.key;if(Array.isArray(u)){const g=[],x=[];for(const w in u)u[w].id&&g.includes(u[w].id)&&s.push(new Ne(f,u,`all the sprites' ids must be unique, but ${u[w].id} is duplicated`)),g.push(u[w].id),u[w].url&&x.includes(u[w].url)&&s.push(new Ne(f,u,`all the sprites' URLs must be unique, but ${u[w].url} is duplicated`)),x.push(u[w].url),s=s.concat(Wi({key:`${f}[${w}]`,value:u[w],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:c.validateSpec}));return s}return po({key:f,value:u})}const lg={"*":()=>[],array:Cl,boolean:function(c){const s=c.value,u=c.key,f=Un(s);return f!=="boolean"?[new Ne(u,s,`boolean expected, ${f} found`)]:[]},number:Rc,color:function(c){const s=c.key,u=c.value,f=Un(u);return f!=="string"?[new Ne(s,u,`color expected, ${f} found`)]:Cn.parse(String(u))?[]:[new Ne(s,u,`color expected, "${u}" found`)]},constants:eg,enum:Oc,filter:Al,function:Yu,layer:sg,object:Wi,source:ds,light:zc,terrain:og,string:po,formatted:function(c){return po(c).length===0?[]:Ba(c)},resolvedImage:function(c){return po(c).length===0?[]:Ba(c)},padding:function(c){const s=c.key,u=c.value;if(Un(u)==="array"){if(u.length<1||u.length>4)return[new Ne(s,u,`padding requires 1 to 4 values; ${u.length} values found`)];const f={type:"number"};let g=[];for(let x=0;x<u.length;x++)g=g.concat(c.validateSpec({key:`${s}[${x}]`,value:u[x],validateSpec:c.validateSpec,valueSpec:f}));return g}return Rc({key:s,value:u,valueSpec:{}})},variableAnchorOffsetCollection:function(c){const s=c.key,u=c.value,f=Un(u),g=c.styleSpec;if(f!=="array"||u.length<1||u.length%2!=0)return[new Ne(s,u,"variableAnchorOffsetCollection requires a non-empty array of even length")];let x=[];for(let w=0;w<u.length;w+=2)x=x.concat(Oc({key:`${s}[${w}]`,value:u[w],valueSpec:g.layout_symbol["text-anchor"]})),x=x.concat(Cl({key:`${s}[${w+1}]`,value:u[w+1],valueSpec:{length:2,value:"number"},validateSpec:c.validateSpec,style:c.style,styleSpec:g}));return x},sprite:ag};function No(c){const s=c.value,u=c.valueSpec,f=c.styleSpec;return c.validateSpec=No,u.expression&&mr(br(s))?Yu(c):u.expression&&Gu(Na(s))?Ba(c):u.type&&lg[u.type]?lg[u.type](c):Wi(Ye({},c,{valueSpec:u.type?f[u.type]:u}))}function cg(c){const s=c.value,u=c.key,f=po(c);return f.length||(s.indexOf("{fontstack}")===-1&&f.push(new Ne(u,s,'"glyphs" url must include a "{fontstack}" token')),s.indexOf("{range}")===-1&&f.push(new Ne(u,s,'"glyphs" url must include a "{range}" token'))),f}function Cs(c,s=Re){let u=[];return u=u.concat(No({key:"",value:c,valueSpec:s.$root,styleSpec:s,style:c,validateSpec:No,objectElementValidators:{glyphs:cg,"*":()=>[]}})),c.constants&&(u=u.concat(eg({key:"constants",value:c.constants,style:c,styleSpec:s,validateSpec:No}))),Ku(u)}function Bo(c){return function(s){return c({...s,validateSpec:No})}}function Ku(c){return[].concat(c).sort((s,u)=>s.line-u.line)}function Uo(c){return function(...s){return Ku(c.apply(this,s))}}Cs.source=Uo(Bo(ds)),Cs.sprite=Uo(Bo(ag)),Cs.glyphs=Uo(Bo(cg)),Cs.light=Uo(Bo(zc)),Cs.terrain=Uo(Bo(og)),Cs.layer=Uo(Bo(sg)),Cs.filter=Uo(Bo(Al)),Cs.paintProperty=Uo(Bo(rg)),Cs.layoutProperty=Uo(Bo(ig));const Vo=Cs,Dv=Vo.light,ef=Vo.paintProperty,ug=Vo.layoutProperty;function Ju(c,s){let u=!1;if(s&&s.length)for(const f of s)c.fire(new En(new Error(f.message))),u=!0;return u}class Il{constructor(s,u,f){const g=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;const w=new Int32Array(this.arrayBuffer);s=w[0],this.d=(u=w[1])+2*(f=w[2]);for(let A=0;A<this.d*this.d;A++){const k=w[3+A],B=w[3+A+1];g.push(k===B?null:w.subarray(k,B))}const T=w[3+g.length+1];this.keys=w.subarray(w[3+g.length],T),this.bboxes=w.subarray(T),this.insert=this._insertReadonly}else{this.d=u+2*f;for(let w=0;w<this.d*this.d;w++)g.push([]);this.keys=[],this.bboxes=[]}this.n=u,this.extent=s,this.padding=f,this.scale=u/s,this.uid=0;const x=f/u*s;this.min=-x,this.max=s+x}insert(s,u,f,g,x){this._forEachCell(u,f,g,x,this._insertCell,this.uid++,void 0,void 0),this.keys.push(s),this.bboxes.push(u),this.bboxes.push(f),this.bboxes.push(g),this.bboxes.push(x)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(s,u,f,g,x,w){this.cells[x].push(w)}query(s,u,f,g,x){const w=this.min,T=this.max;if(s<=w&&u<=w&&T<=f&&T<=g&&!x)return Array.prototype.slice.call(this.keys);{const A=[];return this._forEachCell(s,u,f,g,this._queryCell,A,{},x),A}}_queryCell(s,u,f,g,x,w,T,A){const k=this.cells[x];if(k!==null){const B=this.keys,j=this.bboxes;for(let W=0;W<k.length;W++){const Y=k[W];if(T[Y]===void 0){const J=4*Y;(A?A(j[J+0],j[J+1],j[J+2],j[J+3]):s<=j[J+2]&&u<=j[J+3]&&f>=j[J+0]&&g>=j[J+1])?(T[Y]=!0,w.push(B[Y])):T[Y]=!1}}}}_forEachCell(s,u,f,g,x,w,T,A){const k=this._convertToCellCoord(s),B=this._convertToCellCoord(u),j=this._convertToCellCoord(f),W=this._convertToCellCoord(g);for(let Y=k;Y<=j;Y++)for(let J=B;J<=W;J++){const ae=this.d*J+Y;if((!A||A(this._convertFromCellCoord(Y),this._convertFromCellCoord(J),this._convertFromCellCoord(Y+1),this._convertFromCellCoord(J+1)))&&x.call(this,s,u,f,g,ae,w,T,A))return}}_convertFromCellCoord(s){return(s-this.padding)/this.scale}_convertToCellCoord(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const s=this.cells,u=3+this.cells.length+1+1;let f=0;for(let w=0;w<this.cells.length;w++)f+=this.cells[w].length;const g=new Int32Array(u+f+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;let x=u;for(let w=0;w<s.length;w++){const T=s[w];g[3+w]=x,g.set(T,x),x+=T.length}return g[3+s.length]=x,g.set(this.keys,x),x+=this.keys.length,g[3+s.length+1]=x,g.set(this.bboxes,x),x+=this.bboxes.length,g.buffer}static serialize(s,u){const f=s.toArrayBuffer();return u&&u.push(f),{buffer:f}}static deserialize(s){return new Il(s.buffer)}}const jo={};function kt(c,s,u={}){if(jo[c])throw new Error(`${c} is already registered.`);Object.defineProperty(s,"_classRegistryKey",{value:c,writeable:!1}),jo[c]={klass:s,omit:u.omit||[],shallow:u.shallow||[]}}kt("Object",Object),kt("TransferableGridIndex",Il),kt("Color",Cn),kt("Error",Error),kt("AJAXError",Kt),kt("ResolvedImage",Zn),kt("StylePropertyFunction",Ic),kt("StyleExpression",Xd,{omit:["_evaluator"]}),kt("ZoomDependentExpression",Wu),kt("ZoomConstantExpression",Yd),kt("CompoundExpression",Ps,{omit:["_evaluate"]});for(const c in Sl)Sl[c]._classRegistryKey||kt(`Expression_${c}`,Sl[c]);function Qu(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function ha(c,s){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||c instanceof Blob)return c;if(Qu(c)||qe(c))return s&&s.push(c),c;if(ArrayBuffer.isView(c)){const u=c;return s&&s.push(u.buffer),u}if(c instanceof ImageData)return s&&s.push(c.data.buffer),c;if(Array.isArray(c)){const u=[];for(const f of c)u.push(ha(f,s));return u}if(typeof c=="object"){const u=c.constructor,f=u._classRegistryKey;if(!f)throw new Error("can't serialize object of unregistered class");if(!jo[f])throw new Error(`${f} is not registered.`);const g=u.serialize?u.serialize(c,s):{};if(u.serialize){if(s&&g===s[s.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const x in c){if(!c.hasOwnProperty(x)||jo[f].omit.indexOf(x)>=0)continue;const w=c[x];g[x]=jo[f].shallow.indexOf(x)>=0?w:ha(w,s)}c instanceof Error&&(g.message=c.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return f!=="Object"&&(g.$name=f),g}throw new Error("can't serialize object of type "+typeof c)}function Ml(c){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||c instanceof Blob||Qu(c)||qe(c)||ArrayBuffer.isView(c)||c instanceof ImageData)return c;if(Array.isArray(c))return c.map(Ml);if(typeof c=="object"){const s=c.$name||"Object";if(!jo[s])throw new Error(`can't deserialize unregistered class ${s}`);const{klass:u}=jo[s];if(!u)throw new Error(`can't deserialize unregistered class ${s}`);if(u.deserialize)return u.deserialize(c);const f=Object.create(u.prototype);for(const g of Object.keys(c)){if(g==="$name")continue;const x=c[g];f[g]=jo[s].shallow.indexOf(g)>=0?x:Ml(x)}return f}throw new Error("can't deserialize object of type "+typeof c)}class hg{constructor(){this.first=!0}update(s,u){const f=Math.floor(s);return this.first?(this.first=!1,this.lastIntegerZoom=f,this.lastIntegerZoomTime=0,this.lastZoom=s,this.lastFloorZoom=f,!0):(this.lastFloorZoom>f?(this.lastIntegerZoom=f+1,this.lastIntegerZoomTime=u):this.lastFloorZoom<f&&(this.lastIntegerZoom=f,this.lastIntegerZoomTime=u),s!==this.lastZoom&&(this.lastZoom=s,this.lastFloorZoom=f,!0))}}const Et={"Latin-1 Supplement":c=>c>=128&&c<=255,Arabic:c=>c>=1536&&c<=1791,"Arabic Supplement":c=>c>=1872&&c<=1919,"Arabic Extended-A":c=>c>=2208&&c<=2303,"Hangul Jamo":c=>c>=4352&&c<=4607,"Unified Canadian Aboriginal Syllabics":c=>c>=5120&&c<=5759,Khmer:c=>c>=6016&&c<=6143,"Unified Canadian Aboriginal Syllabics Extended":c=>c>=6320&&c<=6399,"General Punctuation":c=>c>=8192&&c<=8303,"Letterlike Symbols":c=>c>=8448&&c<=8527,"Number Forms":c=>c>=8528&&c<=8591,"Miscellaneous Technical":c=>c>=8960&&c<=9215,"Control Pictures":c=>c>=9216&&c<=9279,"Optical Character Recognition":c=>c>=9280&&c<=9311,"Enclosed Alphanumerics":c=>c>=9312&&c<=9471,"Geometric Shapes":c=>c>=9632&&c<=9727,"Miscellaneous Symbols":c=>c>=9728&&c<=9983,"Miscellaneous Symbols and Arrows":c=>c>=11008&&c<=11263,"CJK Radicals Supplement":c=>c>=11904&&c<=12031,"Kangxi Radicals":c=>c>=12032&&c<=12255,"Ideographic Description Characters":c=>c>=12272&&c<=12287,"CJK Symbols and Punctuation":c=>c>=12288&&c<=12351,Hiragana:c=>c>=12352&&c<=12447,Katakana:c=>c>=12448&&c<=12543,Bopomofo:c=>c>=12544&&c<=12591,"Hangul Compatibility Jamo":c=>c>=12592&&c<=12687,Kanbun:c=>c>=12688&&c<=12703,"Bopomofo Extended":c=>c>=12704&&c<=12735,"CJK Strokes":c=>c>=12736&&c<=12783,"Katakana Phonetic Extensions":c=>c>=12784&&c<=12799,"Enclosed CJK Letters and Months":c=>c>=12800&&c<=13055,"CJK Compatibility":c=>c>=13056&&c<=13311,"CJK Unified Ideographs Extension A":c=>c>=13312&&c<=19903,"Yijing Hexagram Symbols":c=>c>=19904&&c<=19967,"CJK Unified Ideographs":c=>c>=19968&&c<=40959,"Yi Syllables":c=>c>=40960&&c<=42127,"Yi Radicals":c=>c>=42128&&c<=42191,"Hangul Jamo Extended-A":c=>c>=43360&&c<=43391,"Hangul Syllables":c=>c>=44032&&c<=55215,"Hangul Jamo Extended-B":c=>c>=55216&&c<=55295,"Private Use Area":c=>c>=57344&&c<=63743,"CJK Compatibility Ideographs":c=>c>=63744&&c<=64255,"Arabic Presentation Forms-A":c=>c>=64336&&c<=65023,"Vertical Forms":c=>c>=65040&&c<=65055,"CJK Compatibility Forms":c=>c>=65072&&c<=65103,"Small Form Variants":c=>c>=65104&&c<=65135,"Arabic Presentation Forms-B":c=>c>=65136&&c<=65279,"Halfwidth and Fullwidth Forms":c=>c>=65280&&c<=65519};function tf(c){for(const s of c)if(rf(s.charCodeAt(0)))return!0;return!1}function nf(c){for(const s of c)if(!zv(s.charCodeAt(0)))return!1;return!0}function zv(c){return!(Et.Arabic(c)||Et["Arabic Supplement"](c)||Et["Arabic Extended-A"](c)||Et["Arabic Presentation Forms-A"](c)||Et["Arabic Presentation Forms-B"](c))}function rf(c){return!(c!==746&&c!==747&&(c<4352||!(Et["Bopomofo Extended"](c)||Et.Bopomofo(c)||Et["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||Et["CJK Compatibility Ideographs"](c)||Et["CJK Compatibility"](c)||Et["CJK Radicals Supplement"](c)||Et["CJK Strokes"](c)||!(!Et["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||Et["CJK Unified Ideographs Extension A"](c)||Et["CJK Unified Ideographs"](c)||Et["Enclosed CJK Letters and Months"](c)||Et["Hangul Compatibility Jamo"](c)||Et["Hangul Jamo Extended-A"](c)||Et["Hangul Jamo Extended-B"](c)||Et["Hangul Jamo"](c)||Et["Hangul Syllables"](c)||Et.Hiragana(c)||Et["Ideographic Description Characters"](c)||Et.Kanbun(c)||Et["Kangxi Radicals"](c)||Et["Katakana Phonetic Extensions"](c)||Et.Katakana(c)&&c!==12540||!(!Et["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!Et["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||Et["Unified Canadian Aboriginal Syllabics"](c)||Et["Unified Canadian Aboriginal Syllabics Extended"](c)||Et["Vertical Forms"](c)||Et["Yijing Hexagram Symbols"](c)||Et["Yi Syllables"](c)||Et["Yi Radicals"](c))))}function dg(c){return!(rf(c)||function(s){return!!(Et["Latin-1 Supplement"](s)&&(s===167||s===169||s===174||s===177||s===188||s===189||s===190||s===215||s===247)||Et["General Punctuation"](s)&&(s===8214||s===8224||s===8225||s===8240||s===8241||s===8251||s===8252||s===8258||s===8263||s===8264||s===8265||s===8273)||Et["Letterlike Symbols"](s)||Et["Number Forms"](s)||Et["Miscellaneous Technical"](s)&&(s>=8960&&s<=8967||s>=8972&&s<=8991||s>=8996&&s<=9e3||s===9003||s>=9085&&s<=9114||s>=9150&&s<=9165||s===9167||s>=9169&&s<=9179||s>=9186&&s<=9215)||Et["Control Pictures"](s)&&s!==9251||Et["Optical Character Recognition"](s)||Et["Enclosed Alphanumerics"](s)||Et["Geometric Shapes"](s)||Et["Miscellaneous Symbols"](s)&&!(s>=9754&&s<=9759)||Et["Miscellaneous Symbols and Arrows"](s)&&(s>=11026&&s<=11055||s>=11088&&s<=11097||s>=11192&&s<=11243)||Et["CJK Symbols and Punctuation"](s)||Et.Katakana(s)||Et["Private Use Area"](s)||Et["CJK Compatibility Forms"](s)||Et["Small Form Variants"](s)||Et["Halfwidth and Fullwidth Forms"](s)||s===8734||s===8756||s===8757||s>=9984&&s<=10087||s>=10102&&s<=10131||s===65532||s===65533)}(c))}function fg(c){return c>=1424&&c<=2303||Et["Arabic Presentation Forms-A"](c)||Et["Arabic Presentation Forms-B"](c)}function pg(c,s){return!(!s&&fg(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||Et.Khmer(c))}function Fv(c){for(const s of c)if(fg(s.charCodeAt(0)))return!0;return!1}const sf="deferred",of="loading",af="loaded";let lf=null,qi="unavailable",da=null;const Fc=function(c){c&&typeof c=="string"&&c.indexOf("NetworkError")>-1&&(qi="error"),lf&&lf(c)};function cf(){Nc.fire(new mn("pluginStateChange",{pluginStatus:qi,pluginURL:da}))}const Nc=new zn,uf=function(){return qi},mg=function(){if(qi!==sf||!da)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");qi=of,cf(),da&&Wt({url:da},c=>{c?Fc(c):(qi=af,cf())})},fs={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>qi===af||fs.applyArabicShaping!=null,isLoading:()=>qi===of,setState(c){if(!je())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");qi=c.pluginStatus,da=c.pluginURL},isParsed(){if(!je())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return fs.applyArabicShaping!=null&&fs.processBidirectionalText!=null&&fs.processStyledBidirectionalText!=null},getPluginURL(){if(!je())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return da}};class sr{constructor(s,u){this.zoom=s,u?(this.now=u.now,this.fadeDuration=u.fadeDuration,this.zoomHistory=u.zoomHistory,this.transition=u.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new hg,this.transition={})}isSupportedScript(s){return function(u,f){for(const g of u)if(!pg(g.charCodeAt(0),f))return!1;return!0}(s,fs.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const s=this.zoom,u=s-Math.floor(s),f=this.crossFadingFactor();return s>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:u+(1-u)*f}:{fromScale:.5,toScale:1,t:1-(1-f)*u}}}class eh{constructor(s,u){this.property=s,this.value=u,this.expression=function(f,g){if(mr(f))return new Ic(f,g);if(Gu(f)){const x=Kd(f,g);if(x.result==="error")throw new Error(x.value.map(w=>`${w.key}: ${w.message}`).join(", "));return x.value}{let x=f;return g.type==="color"&&typeof f=="string"?x=Cn.parse(f):g.type!=="padding"||typeof f!="number"&&!Array.isArray(f)?g.type==="variableAnchorOffsetCollection"&&Array.isArray(f)&&(x=hi.parse(f)):x=bi.parse(f),{kind:"constant",evaluate:()=>x}}}(u===void 0?s.specification.default:u,s.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(s,u,f){return this.property.possiblyEvaluate(this,s,u,f)}}class hf{constructor(s){this.property=s,this.value=new eh(s,void 0)}transitioned(s,u){return new yg(this.property,this.value,u,re({},s.transition,this.transition),s.now)}untransitioned(){return new yg(this.property,this.value,null,{},0)}}class gg{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitionablePropertyValues)}getValue(s){return Le(this._values[s].value.value)}setValue(s,u){Object.prototype.hasOwnProperty.call(this._values,s)||(this._values[s]=new hf(this._values[s].property)),this._values[s].value=new eh(this._values[s].property,u===null?void 0:Le(u))}getTransition(s){return Le(this._values[s].transition)}setTransition(s,u){Object.prototype.hasOwnProperty.call(this._values,s)||(this._values[s]=new hf(this._values[s].property)),this._values[s].transition=Le(u)||void 0}serialize(){const s={};for(const u of Object.keys(this._values)){const f=this.getValue(u);f!==void 0&&(s[u]=f);const g=this.getTransition(u);g!==void 0&&(s[`${u}-transition`]=g)}return s}transitioned(s,u){const f=new _g(this._properties);for(const g of Object.keys(this._values))f._values[g]=this._values[g].transitioned(s,u._values[g]);return f}untransitioned(){const s=new _g(this._properties);for(const u of Object.keys(this._values))s._values[u]=this._values[u].untransitioned();return s}}class yg{constructor(s,u,f,g,x){this.property=s,this.value=u,this.begin=x+g.delay||0,this.end=this.begin+g.duration||0,s.specification.transition&&(g.delay||g.duration)&&(this.prior=f)}possiblyEvaluate(s,u,f){const g=s.now||0,x=this.value.possiblyEvaluate(s,u,f),w=this.prior;if(w){if(g>this.end)return this.prior=null,x;if(this.value.isDataDriven())return this.prior=null,x;if(g<this.begin)return w.possiblyEvaluate(s,u,f);{const T=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(w.possiblyEvaluate(s,u,f),x,function(A){if(A<=0)return 0;if(A>=1)return 1;const k=A*A,B=k*A;return 4*(A<.5?B:3*(A-k)+B-.75)}(T))}}return x}}class _g{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitioningPropertyValues)}possiblyEvaluate(s,u,f){const g=new th(this._properties);for(const x of Object.keys(this._values))g._values[x]=this._values[x].possiblyEvaluate(s,u,f);return g}hasTransition(){for(const s of Object.keys(this._values))if(this._values[s].prior)return!0;return!1}}class Nv{constructor(s){this._properties=s,this._values=Object.create(s.defaultPropertyValues)}hasValue(s){return this._values[s].value!==void 0}getValue(s){return Le(this._values[s].value)}setValue(s,u){this._values[s]=new eh(this._values[s].property,u===null?void 0:Le(u))}serialize(){const s={};for(const u of Object.keys(this._values)){const f=this.getValue(u);f!==void 0&&(s[u]=f)}return s}possiblyEvaluate(s,u,f){const g=new th(this._properties);for(const x of Object.keys(this._values))g._values[x]=this._values[x].possiblyEvaluate(s,u,f);return g}}class Li{constructor(s,u,f){this.property=s,this.value=u,this.parameters=f}isConstant(){return this.value.kind==="constant"}constantOr(s){return this.value.kind==="constant"?this.value.value:s}evaluate(s,u,f,g){return this.property.evaluate(this.value,this.parameters,s,u,f,g)}}class th{constructor(s){this._properties=s,this._values=Object.create(s.defaultPossiblyEvaluatedValues)}get(s){return this._values[s]}}class Xt{constructor(s){this.specification=s}possiblyEvaluate(s,u){if(s.isDataDriven())throw new Error("Value should not be data driven");return s.expression.evaluate(u)}interpolate(s,u,f){const g=us[this.specification.type];return g?g(s,u,f):s}}class ln{constructor(s,u){this.specification=s,this.overrides=u}possiblyEvaluate(s,u,f,g){return new Li(this,s.expression.kind==="constant"||s.expression.kind==="camera"?{kind:"constant",value:s.expression.evaluate(u,null,{},f,g)}:s.expression,u)}interpolate(s,u,f){if(s.value.kind!=="constant"||u.value.kind!=="constant")return s;if(s.value.value===void 0||u.value.value===void 0)return new Li(this,{kind:"constant",value:void 0},s.parameters);const g=us[this.specification.type];if(g){const x=g(s.value.value,u.value.value,f);return new Li(this,{kind:"constant",value:x},s.parameters)}return s}evaluate(s,u,f,g,x,w){return s.kind==="constant"?s.value:s.evaluate(u,f,g,x,w)}}class Bc extends ln{possiblyEvaluate(s,u,f,g){if(s.value===void 0)return new Li(this,{kind:"constant",value:void 0},u);if(s.expression.kind==="constant"){const x=s.expression.evaluate(u,null,{},f,g),w=s.property.specification.type==="resolvedImage"&&typeof x!="string"?x.name:x,T=this._calculate(w,w,w,u);return new Li(this,{kind:"constant",value:T},u)}if(s.expression.kind==="camera"){const x=this._calculate(s.expression.evaluate({zoom:u.zoom-1}),s.expression.evaluate({zoom:u.zoom}),s.expression.evaluate({zoom:u.zoom+1}),u);return new Li(this,{kind:"constant",value:x},u)}return new Li(this,s.expression,u)}evaluate(s,u,f,g,x,w){if(s.kind==="source"){const T=s.evaluate(u,f,g,x,w);return this._calculate(T,T,T,u)}return s.kind==="composite"?this._calculate(s.evaluate({zoom:Math.floor(u.zoom)-1},f,g),s.evaluate({zoom:Math.floor(u.zoom)},f,g),s.evaluate({zoom:Math.floor(u.zoom)+1},f,g),u):s.value}_calculate(s,u,f,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:s,to:u}:{from:f,to:u}}interpolate(s){return s}}class df{constructor(s){this.specification=s}possiblyEvaluate(s,u,f,g){if(s.value!==void 0){if(s.expression.kind==="constant"){const x=s.expression.evaluate(u,null,{},f,g);return this._calculate(x,x,x,u)}return this._calculate(s.expression.evaluate(new sr(Math.floor(u.zoom-1),u)),s.expression.evaluate(new sr(Math.floor(u.zoom),u)),s.expression.evaluate(new sr(Math.floor(u.zoom+1),u)),u)}}_calculate(s,u,f,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:s,to:u}:{from:f,to:u}}interpolate(s){return s}}class ff{constructor(s){this.specification=s}possiblyEvaluate(s,u,f,g){return!!s.expression.evaluate(u,null,{},f,g)}interpolate(){return!1}}class Dr{constructor(s){this.properties=s,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const u in s){const f=s[u];f.specification.overridable&&this.overridableProperties.push(u);const g=this.defaultPropertyValues[u]=new eh(f,void 0),x=this.defaultTransitionablePropertyValues[u]=new hf(f);this.defaultTransitioningPropertyValues[u]=x.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=g.possiblyEvaluate({})}}}kt("DataDrivenProperty",ln),kt("DataConstantProperty",Xt),kt("CrossFadedDataDrivenProperty",Bc),kt("CrossFadedProperty",df),kt("ColorRampProperty",ff);const pf="-transition";class As extends zn{constructor(s,u){if(super(),this.id=s.id,this.type=s.type,this._featureFilter={filter:()=>!0,needGeometry:!1},s.type!=="custom"&&(this.metadata=s.metadata,this.minzoom=s.minzoom,this.maxzoom=s.maxzoom,s.type!=="background"&&(this.source=s.source,this.sourceLayer=s["source-layer"],this.filter=s.filter),u.layout&&(this._unevaluatedLayout=new Nv(u.layout)),u.paint)){this._transitionablePaint=new gg(u.paint);for(const f in s.paint)this.setPaintProperty(f,s.paint[f],{validate:!1});for(const f in s.layout)this.setLayoutProperty(f,s.layout[f],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new th(u.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(s){return s==="visibility"?this.visibility:this._unevaluatedLayout.getValue(s)}setLayoutProperty(s,u,f={}){u!=null&&this._validate(ug,`layers.${this.id}.layout.${s}`,s,u,f)||(s!=="visibility"?this._unevaluatedLayout.setValue(s,u):this.visibility=u)}getPaintProperty(s){return s.endsWith(pf)?this._transitionablePaint.getTransition(s.slice(0,-11)):this._transitionablePaint.getValue(s)}setPaintProperty(s,u,f={}){if(u!=null&&this._validate(ef,`layers.${this.id}.paint.${s}`,s,u,f))return!1;if(s.endsWith(pf))return this._transitionablePaint.setTransition(s.slice(0,-11),u||void 0),!1;{const g=this._transitionablePaint._values[s],x=g.property.specification["property-type"]==="cross-faded-data-driven",w=g.value.isDataDriven(),T=g.value;this._transitionablePaint.setValue(s,u),this._handleSpecialPaintPropertyUpdate(s);const A=this._transitionablePaint._values[s].value;return A.isDataDriven()||w||x||this._handleOverridablePaintPropertyUpdate(s,T,A)}}_handleSpecialPaintPropertyUpdate(s){}_handleOverridablePaintPropertyUpdate(s,u,f){return!1}isHidden(s){return!!(this.minzoom&&s<this.minzoom)||!!(this.maxzoom&&s>=this.maxzoom)||this.visibility==="none"}updateTransitions(s){this._transitioningPaint=this._transitionablePaint.transitioned(s,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(s,u){s.getCrossfadeParameters&&(this._crossfadeParameters=s.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(s,void 0,u)),this.paint=this._transitioningPaint.possiblyEvaluate(s,void 0,u)}serialize(){const s={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(s.layout=s.layout||{},s.layout.visibility=this.visibility),de(s,(u,f)=>!(u===void 0||f==="layout"&&!Object.keys(u).length||f==="paint"&&!Object.keys(u).length))}_validate(s,u,f,g,x={}){return(!x||x.validate!==!1)&&Ju(this,s.call(Vo,{key:u,layerType:this.type,objectKey:f,value:g,styleSpec:Re,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const s in this.paint._values){const u=this.paint.get(s);if(u instanceof Li&&Pl(u.property.specification)&&(u.value.kind==="source"||u.value.kind==="composite")&&u.value.isStateDependent)return!0}return!1}}const vg={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ua{constructor(s,u){this._structArray=s,this._pos1=u*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class wr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(s,u){return s._trim(),u&&(s.isTransferred=!0,u.push(s.arrayBuffer)),{length:s.length,arrayBuffer:s.arrayBuffer}}static deserialize(s){const u=Object.create(this.prototype);return u.arrayBuffer=s.arrayBuffer,u.length=s.length,u.capacity=s.arrayBuffer.byteLength/u.bytesPerElement,u._refreshViews(),u}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(s){this.reserve(s),this.length=s}reserve(s){if(s>this.capacity){this.capacity=Math.max(s,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const u=this.uint8;this._refreshViews(),u&&this.uint8.set(u)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function yr(c,s=1){let u=0,f=0;return{members:c.map(g=>{const x=vg[g.type].BYTES_PER_ELEMENT,w=u=kl(u,Math.max(s,x)),T=g.components||1;return f=Math.max(f,x),u+=x*T,{name:g.name,type:g.type,components:T,offset:w}}),size:kl(u,Math.max(f,s)),alignment:s}}function kl(c,s){return Math.ceil(c/s)*s}class Uc extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u){const f=this.length;return this.resize(f+1),this.emplace(f,s,u)}emplace(s,u,f){const g=2*s;return this.int16[g+0]=u,this.int16[g+1]=f,s}}Uc.prototype.bytesPerElement=4,kt("StructArrayLayout2i4",Uc);class Vc extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,s,u,f)}emplace(s,u,f,g){const x=3*s;return this.int16[x+0]=u,this.int16[x+1]=f,this.int16[x+2]=g,s}}Vc.prototype.bytesPerElement=6,kt("StructArrayLayout3i6",Vc);class Va extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,f,g){const x=this.length;return this.resize(x+1),this.emplace(x,s,u,f,g)}emplace(s,u,f,g,x){const w=4*s;return this.int16[w+0]=u,this.int16[w+1]=f,this.int16[w+2]=g,this.int16[w+3]=x,s}}Va.prototype.bytesPerElement=8,kt("StructArrayLayout4i8",Va);class mf extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x,w){const T=this.length;return this.resize(T+1),this.emplace(T,s,u,f,g,x,w)}emplace(s,u,f,g,x,w,T){const A=6*s;return this.int16[A+0]=u,this.int16[A+1]=f,this.int16[A+2]=g,this.int16[A+3]=x,this.int16[A+4]=w,this.int16[A+5]=T,s}}mf.prototype.bytesPerElement=12,kt("StructArrayLayout2i4i12",mf);class gf extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x,w){const T=this.length;return this.resize(T+1),this.emplace(T,s,u,f,g,x,w)}emplace(s,u,f,g,x,w,T){const A=4*s,k=8*s;return this.int16[A+0]=u,this.int16[A+1]=f,this.uint8[k+4]=g,this.uint8[k+5]=x,this.uint8[k+6]=w,this.uint8[k+7]=T,s}}gf.prototype.bytesPerElement=8,kt("StructArrayLayout2i4ub8",gf);class Ll extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u){const f=this.length;return this.resize(f+1),this.emplace(f,s,u)}emplace(s,u,f){const g=2*s;return this.float32[g+0]=u,this.float32[g+1]=f,s}}Ll.prototype.bytesPerElement=8,kt("StructArrayLayout2f8",Ll);class yf extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x,w,T,A,k,B){const j=this.length;return this.resize(j+1),this.emplace(j,s,u,f,g,x,w,T,A,k,B)}emplace(s,u,f,g,x,w,T,A,k,B,j){const W=10*s;return this.uint16[W+0]=u,this.uint16[W+1]=f,this.uint16[W+2]=g,this.uint16[W+3]=x,this.uint16[W+4]=w,this.uint16[W+5]=T,this.uint16[W+6]=A,this.uint16[W+7]=k,this.uint16[W+8]=B,this.uint16[W+9]=j,s}}yf.prototype.bytesPerElement=20,kt("StructArrayLayout10ui20",yf);class _f extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x,w,T,A,k,B,j,W){const Y=this.length;return this.resize(Y+1),this.emplace(Y,s,u,f,g,x,w,T,A,k,B,j,W)}emplace(s,u,f,g,x,w,T,A,k,B,j,W,Y){const J=12*s;return this.int16[J+0]=u,this.int16[J+1]=f,this.int16[J+2]=g,this.int16[J+3]=x,this.uint16[J+4]=w,this.uint16[J+5]=T,this.uint16[J+6]=A,this.uint16[J+7]=k,this.int16[J+8]=B,this.int16[J+9]=j,this.int16[J+10]=W,this.int16[J+11]=Y,s}}_f.prototype.bytesPerElement=24,kt("StructArrayLayout4i4ui4i24",_f);class Vn extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,s,u,f)}emplace(s,u,f,g){const x=3*s;return this.float32[x+0]=u,this.float32[x+1]=f,this.float32[x+2]=g,s}}Vn.prototype.bytesPerElement=12,kt("StructArrayLayout3f12",Vn);class v extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s){const u=this.length;return this.resize(u+1),this.emplace(u,s)}emplace(s,u){return this.uint32[1*s+0]=u,s}}v.prototype.bytesPerElement=4,kt("StructArrayLayout1ul4",v);class o extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x,w,T,A,k){const B=this.length;return this.resize(B+1),this.emplace(B,s,u,f,g,x,w,T,A,k)}emplace(s,u,f,g,x,w,T,A,k,B){const j=10*s,W=5*s;return this.int16[j+0]=u,this.int16[j+1]=f,this.int16[j+2]=g,this.int16[j+3]=x,this.int16[j+4]=w,this.int16[j+5]=T,this.uint32[W+3]=A,this.uint16[j+8]=k,this.uint16[j+9]=B,s}}o.prototype.bytesPerElement=20,kt("StructArrayLayout6i1ul2ui20",o);class d extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x,w){const T=this.length;return this.resize(T+1),this.emplace(T,s,u,f,g,x,w)}emplace(s,u,f,g,x,w,T){const A=6*s;return this.int16[A+0]=u,this.int16[A+1]=f,this.int16[A+2]=g,this.int16[A+3]=x,this.int16[A+4]=w,this.int16[A+5]=T,s}}d.prototype.bytesPerElement=12,kt("StructArrayLayout2i2i2i12",d);class p extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x){const w=this.length;return this.resize(w+1),this.emplace(w,s,u,f,g,x)}emplace(s,u,f,g,x,w){const T=4*s,A=8*s;return this.float32[T+0]=u,this.float32[T+1]=f,this.float32[T+2]=g,this.int16[A+6]=x,this.int16[A+7]=w,s}}p.prototype.bytesPerElement=16,kt("StructArrayLayout2f1f2i16",p);class y extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,f,g){const x=this.length;return this.resize(x+1),this.emplace(x,s,u,f,g)}emplace(s,u,f,g,x){const w=12*s,T=3*s;return this.uint8[w+0]=u,this.uint8[w+1]=f,this.float32[T+1]=g,this.float32[T+2]=x,s}}y.prototype.bytesPerElement=12,kt("StructArrayLayout2ub2f12",y);class b extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,s,u,f)}emplace(s,u,f,g){const x=3*s;return this.uint16[x+0]=u,this.uint16[x+1]=f,this.uint16[x+2]=g,s}}b.prototype.bytesPerElement=6,kt("StructArrayLayout3ui6",b);class P extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x,w,T,A,k,B,j,W,Y,J,ae,pe,ye){const Ie=this.length;return this.resize(Ie+1),this.emplace(Ie,s,u,f,g,x,w,T,A,k,B,j,W,Y,J,ae,pe,ye)}emplace(s,u,f,g,x,w,T,A,k,B,j,W,Y,J,ae,pe,ye,Ie){const be=24*s,ke=12*s,ze=48*s;return this.int16[be+0]=u,this.int16[be+1]=f,this.uint16[be+2]=g,this.uint16[be+3]=x,this.uint32[ke+2]=w,this.uint32[ke+3]=T,this.uint32[ke+4]=A,this.uint16[be+10]=k,this.uint16[be+11]=B,this.uint16[be+12]=j,this.float32[ke+7]=W,this.float32[ke+8]=Y,this.uint8[ze+36]=J,this.uint8[ze+37]=ae,this.uint8[ze+38]=pe,this.uint32[ke+10]=ye,this.int16[be+22]=Ie,s}}P.prototype.bytesPerElement=48,kt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",P);class C extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x,w,T,A,k,B,j,W,Y,J,ae,pe,ye,Ie,be,ke,ze,Je,Tt,jt,wt,gt,ht,Rt){const pt=this.length;return this.resize(pt+1),this.emplace(pt,s,u,f,g,x,w,T,A,k,B,j,W,Y,J,ae,pe,ye,Ie,be,ke,ze,Je,Tt,jt,wt,gt,ht,Rt)}emplace(s,u,f,g,x,w,T,A,k,B,j,W,Y,J,ae,pe,ye,Ie,be,ke,ze,Je,Tt,jt,wt,gt,ht,Rt,pt){const rt=32*s,en=16*s;return this.int16[rt+0]=u,this.int16[rt+1]=f,this.int16[rt+2]=g,this.int16[rt+3]=x,this.int16[rt+4]=w,this.int16[rt+5]=T,this.int16[rt+6]=A,this.int16[rt+7]=k,this.uint16[rt+8]=B,this.uint16[rt+9]=j,this.uint16[rt+10]=W,this.uint16[rt+11]=Y,this.uint16[rt+12]=J,this.uint16[rt+13]=ae,this.uint16[rt+14]=pe,this.uint16[rt+15]=ye,this.uint16[rt+16]=Ie,this.uint16[rt+17]=be,this.uint16[rt+18]=ke,this.uint16[rt+19]=ze,this.uint16[rt+20]=Je,this.uint16[rt+21]=Tt,this.uint16[rt+22]=jt,this.uint32[en+12]=wt,this.float32[en+13]=gt,this.float32[en+14]=ht,this.uint16[rt+30]=Rt,this.uint16[rt+31]=pt,s}}C.prototype.bytesPerElement=64,kt("StructArrayLayout8i15ui1ul2f2ui64",C);class M extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s){const u=this.length;return this.resize(u+1),this.emplace(u,s)}emplace(s,u){return this.float32[1*s+0]=u,s}}M.prototype.bytesPerElement=4,kt("StructArrayLayout1f4",M);class R extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,s,u,f)}emplace(s,u,f,g){const x=3*s;return this.uint16[6*s+0]=u,this.float32[x+1]=f,this.float32[x+2]=g,s}}R.prototype.bytesPerElement=12,kt("StructArrayLayout1ui2f12",R);class U extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,s,u,f)}emplace(s,u,f,g){const x=4*s;return this.uint32[2*s+0]=u,this.uint16[x+2]=f,this.uint16[x+3]=g,s}}U.prototype.bytesPerElement=8,kt("StructArrayLayout1ul2ui8",U);class V extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u){const f=this.length;return this.resize(f+1),this.emplace(f,s,u)}emplace(s,u,f){const g=2*s;return this.uint16[g+0]=u,this.uint16[g+1]=f,s}}V.prototype.bytesPerElement=4,kt("StructArrayLayout2ui4",V);class X extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s){const u=this.length;return this.resize(u+1),this.emplace(u,s)}emplace(s,u){return this.uint16[1*s+0]=u,s}}X.prototype.bytesPerElement=2,kt("StructArrayLayout1ui2",X);class ue extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,f,g){const x=this.length;return this.resize(x+1),this.emplace(x,s,u,f,g)}emplace(s,u,f,g,x){const w=4*s;return this.float32[w+0]=u,this.float32[w+1]=f,this.float32[w+2]=g,this.float32[w+3]=x,s}}ue.prototype.bytesPerElement=16,kt("StructArrayLayout4f16",ue);class le extends Ua{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new S(this.anchorPointX,this.anchorPointY)}}le.prototype.size=20;class fe extends o{get(s){return new le(this,s)}}kt("CollisionBoxArray",fe);class oe extends Ua{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(s){this._structArray.uint8[this._pos1+37]=s}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(s){this._structArray.uint8[this._pos1+38]=s}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(s){this._structArray.uint32[this._pos4+10]=s}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}oe.prototype.size=48;class Pe extends P{get(s){return new oe(this,s)}}kt("PlacedSymbolArray",Pe);class De extends Ua{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(s){this._structArray.uint32[this._pos4+12]=s}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}De.prototype.size=64;class me extends C{get(s){return new De(this,s)}}kt("SymbolInstanceArray",me);class Ae extends M{getoffsetX(s){return this.float32[1*s+0]}}kt("GlyphOffsetArray",Ae);class Ue extends Vc{getx(s){return this.int16[3*s+0]}gety(s){return this.int16[3*s+1]}gettileUnitDistanceFromAnchor(s){return this.int16[3*s+2]}}kt("SymbolLineVertexArray",Ue);class $e extends Ua{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}$e.prototype.size=12;class Xe extends R{get(s){return new $e(this,s)}}kt("TextAnchorOffsetArray",Xe);class tt extends Ua{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}tt.prototype.size=8;class Qe extends U{get(s){return new tt(this,s)}}kt("FeatureIndexArray",Qe);class ct extends Uc{}class Vt extends Uc{}class An extends Uc{}class mt extends mf{}class cn extends gf{}class Gt extends Ll{}class Hn extends yf{}class Pn extends _f{}class vn extends Vn{}class In extends v{}class Mr extends d{}class tr extends y{}class fi extends b{}class Qr extends V{}const zr=yr([{name:"a_pos",components:2,type:"Int16"}],4),{members:ps}=zr;class or{constructor(s=[]){this.segments=s}prepareSegment(s,u,f,g){let x=this.segments[this.segments.length-1];return s>or.MAX_VERTEX_ARRAY_LENGTH&&Be(`Max vertices per segment is ${or.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${s}`),(!x||x.vertexLength+s>or.MAX_VERTEX_ARRAY_LENGTH||x.sortKey!==g)&&(x={vertexOffset:u.length,primitiveOffset:f.length,vertexLength:0,primitiveLength:0},g!==void 0&&(x.sortKey=g),this.segments.push(x)),x}get(){return this.segments}destroy(){for(const s of this.segments)for(const u in s.vaos)s.vaos[u].destroy()}static simpleSegment(s,u,f,g){return new or([{vertexOffset:s,primitiveOffset:u,vertexLength:f,primitiveLength:g,vaos:{},sortKey:0}])}}function mo(c,s){return 256*(c=Q(Math.floor(c),0,255))+Q(Math.floor(s),0,255)}or.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,kt("SegmentVector",or);const go=yr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var fa={exports:{}},ja={exports:{}};ja.exports=function(c,s){var u,f,g,x,w,T,A,k;for(f=c.length-(u=3&c.length),g=s,w=3432918353,T=461845907,k=0;k<f;)A=255&c.charCodeAt(k)|(255&c.charCodeAt(++k))<<8|(255&c.charCodeAt(++k))<<16|(255&c.charCodeAt(++k))<<24,++k,g=27492+(65535&(x=5*(65535&(g=(g^=A=(65535&(A=(A=(65535&A)*w+(((A>>>16)*w&65535)<<16)&4294967295)<<15|A>>>17))*T+(((A>>>16)*T&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(x>>>16)&65535)<<16);switch(A=0,u){case 3:A^=(255&c.charCodeAt(k+2))<<16;case 2:A^=(255&c.charCodeAt(k+1))<<8;case 1:g^=A=(65535&(A=(A=(65535&(A^=255&c.charCodeAt(k)))*w+(((A>>>16)*w&65535)<<16)&4294967295)<<15|A>>>17))*T+(((A>>>16)*T&65535)<<16)&4294967295}return g^=c.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0};var Rl=ja.exports,wi={exports:{}};wi.exports=function(c,s){for(var u,f=c.length,g=s^f,x=0;f>=4;)u=1540483477*(65535&(u=255&c.charCodeAt(x)|(255&c.charCodeAt(++x))<<8|(255&c.charCodeAt(++x))<<16|(255&c.charCodeAt(++x))<<24))+((1540483477*(u>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),f-=4,++x;switch(f){case 3:g^=(255&c.charCodeAt(x+2))<<16;case 2:g^=(255&c.charCodeAt(x+1))<<8;case 1:g=1540483477*(65535&(g^=255&c.charCodeAt(x)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0};var pi=Rl,Ri=wi.exports;fa.exports=pi,fa.exports.murmur3=pi,fa.exports.murmur2=Ri;var $a=m(fa.exports);class kr{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(s,u,f,g){this.ids.push(ei(s)),this.positions.push(u,f,g)}getPositions(s){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const u=ei(s);let f=0,g=this.ids.length-1;for(;f<g;){const w=f+g>>1;this.ids[w]>=u?g=w:f=w+1}const x=[];for(;this.ids[f]===u;)x.push({index:this.positions[3*f],start:this.positions[3*f+1],end:this.positions[3*f+2]}),f++;return x}static serialize(s,u){const f=new Float64Array(s.ids),g=new Uint32Array(s.positions);return Zi(f,g,0,f.length-1),u&&u.push(f.buffer,g.buffer),{ids:f,positions:g}}static deserialize(s){const u=new kr;return u.ids=s.ids,u.positions=s.positions,u.indexed=!0,u}}function ei(c){const s=+c;return!isNaN(s)&&s<=Number.MAX_SAFE_INTEGER?s:$a(String(c))}function Zi(c,s,u,f){for(;u<f;){const g=c[u+f>>1];let x=u-1,w=f+1;for(;;){do x++;while(c[x]<g);do w--;while(c[w]>g);if(x>=w)break;Lr(c,x,w),Lr(s,3*x,3*w),Lr(s,3*x+1,3*w+1),Lr(s,3*x+2,3*w+2)}w-u<f-w?(Zi(c,s,u,w),u=w+1):(Zi(c,s,w+1,f),f=w)}}function Lr(c,s,u){const f=c[s];c[s]=c[u],c[u]=f}kt("FeaturePositionMap",kr);class Ga{constructor(s,u){this.gl=s.gl,this.location=u}}class nh extends Ga{constructor(s,u){super(s,u),this.current=0}set(s){this.current!==s&&(this.current=s,this.gl.uniform1f(this.location,s))}}class xg extends Ga{constructor(s,u){super(s,u),this.current=[0,0,0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]&&s[3]===this.current[3]||(this.current=s,this.gl.uniform4f(this.location,s[0],s[1],s[2],s[3]))}}class bg extends Ga{constructor(s,u){super(s,u),this.current=Cn.transparent}set(s){s.r===this.current.r&&s.g===this.current.g&&s.b===this.current.b&&s.a===this.current.a||(this.current=s,this.gl.uniform4f(this.location,s.r,s.g,s.b,s.a))}}const Bv=new Float32Array(16);function vf(c){return[mo(255*c.r,255*c.g),mo(255*c.b,255*c.a)]}class yo{constructor(s,u,f){this.value=s,this.uniformNames=u.map(g=>`u_${g}`),this.type=f}setUniform(s,u,f){s.set(f.constantOr(this.value))}getBinding(s,u,f){return this.type==="color"?new bg(s,u):new nh(s,u)}}class Ha{constructor(s,u){this.uniformNames=u.map(f=>`u_${f}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(s,u){this.pixelRatioFrom=u.pixelRatio,this.pixelRatioTo=s.pixelRatio,this.patternFrom=u.tlbr,this.patternTo=s.tlbr}setUniform(s,u,f,g){const x=g==="u_pattern_to"?this.patternTo:g==="u_pattern_from"?this.patternFrom:g==="u_pixel_ratio_to"?this.pixelRatioTo:g==="u_pixel_ratio_from"?this.pixelRatioFrom:null;x&&s.set(x)}getBinding(s,u,f){return f.substr(0,9)==="u_pattern"?new xg(s,u):new nh(s,u)}}class _o{constructor(s,u,f,g){this.expression=s,this.type=f,this.maxValue=0,this.paintVertexAttributes=u.map(x=>({name:`a_${x}`,type:"Float32",components:f==="color"?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(s,u,f,g,x){const w=this.paintVertexArray.length,T=this.expression.evaluate(new sr(0),u,{},g,[],x);this.paintVertexArray.resize(s),this._setPaintValue(w,s,T)}updatePaintArray(s,u,f,g){const x=this.expression.evaluate({zoom:0},f,g);this._setPaintValue(s,u,x)}_setPaintValue(s,u,f){if(this.type==="color"){const g=vf(f);for(let x=s;x<u;x++)this.paintVertexArray.emplace(x,g[0],g[1])}else{for(let g=s;g<u;g++)this.paintVertexArray.emplace(g,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Is{constructor(s,u,f,g,x,w){this.expression=s,this.uniformNames=u.map(T=>`u_${T}_t`),this.type=f,this.useIntegerZoom=g,this.zoom=x,this.maxValue=0,this.paintVertexAttributes=u.map(T=>({name:`a_${T}`,type:"Float32",components:f==="color"?4:2,offset:0})),this.paintVertexArray=new w}populatePaintArray(s,u,f,g,x){const w=this.expression.evaluate(new sr(this.zoom),u,{},g,[],x),T=this.expression.evaluate(new sr(this.zoom+1),u,{},g,[],x),A=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValue(A,s,w,T)}updatePaintArray(s,u,f,g){const x=this.expression.evaluate({zoom:this.zoom},f,g),w=this.expression.evaluate({zoom:this.zoom+1},f,g);this._setPaintValue(s,u,x,w)}_setPaintValue(s,u,f,g){if(this.type==="color"){const x=vf(f),w=vf(g);for(let T=s;T<u;T++)this.paintVertexArray.emplace(T,x[0],x[1],w[0],w[1])}else{for(let x=s;x<u;x++)this.paintVertexArray.emplace(x,f,g);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(g))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(s,u){const f=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,g=Q(this.expression.interpolationFactor(f,this.zoom,this.zoom+1),0,1);s.set(g)}getBinding(s,u,f){return new nh(s,u)}}class vo{constructor(s,u,f,g,x,w){this.expression=s,this.type=u,this.useIntegerZoom=f,this.zoom=g,this.layerId=w,this.zoomInPaintVertexArray=new x,this.zoomOutPaintVertexArray=new x}populatePaintArray(s,u,f){const g=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(s),this.zoomOutPaintVertexArray.resize(s),this._setPaintValues(g,s,u.patterns&&u.patterns[this.layerId],f)}updatePaintArray(s,u,f,g,x){this._setPaintValues(s,u,f.patterns&&f.patterns[this.layerId],x)}_setPaintValues(s,u,f,g){if(!g||!f)return;const{min:x,mid:w,max:T}=f,A=g[x],k=g[w],B=g[T];if(A&&k&&B)for(let j=s;j<u;j++)this.zoomInPaintVertexArray.emplace(j,k.tl[0],k.tl[1],k.br[0],k.br[1],A.tl[0],A.tl[1],A.br[0],A.br[1],k.pixelRatio,A.pixelRatio),this.zoomOutPaintVertexArray.emplace(j,k.tl[0],k.tl[1],k.br[0],k.br[1],B.tl[0],B.tl[1],B.br[0],B.br[1],k.pixelRatio,B.pixelRatio)}upload(s){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=s.createVertexBuffer(this.zoomInPaintVertexArray,go.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=s.createVertexBuffer(this.zoomOutPaintVertexArray,go.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class xf{constructor(s,u,f){this.binders={},this._buffers=[];const g=[];for(const x in s.paint._values){if(!f(x))continue;const w=s.paint.get(x);if(!(w instanceof Li&&Pl(w.property.specification)))continue;const T=BD(x,s.type),A=w.value,k=w.property.specification.type,B=w.property.useIntegerZoom,j=w.property.specification["property-type"],W=j==="cross-faded"||j==="cross-faded-data-driven";if(A.kind==="constant")this.binders[x]=W?new Ha(A.value,T):new yo(A.value,T,k),g.push(`/u_${x}`);else if(A.kind==="source"||W){const Y=hT(x,k,"source");this.binders[x]=W?new vo(A,k,B,u,Y,s.id):new _o(A,T,k,Y),g.push(`/a_${x}`)}else{const Y=hT(x,k,"composite");this.binders[x]=new Is(A,T,k,B,u,Y),g.push(`/z_${x}`)}}this.cacheKey=g.sort().join("")}getMaxValue(s){const u=this.binders[s];return u instanceof _o||u instanceof Is?u.maxValue:0}populatePaintArrays(s,u,f,g,x){for(const w in this.binders){const T=this.binders[w];(T instanceof _o||T instanceof Is||T instanceof vo)&&T.populatePaintArray(s,u,f,g,x)}}setConstantPatternPositions(s,u){for(const f in this.binders){const g=this.binders[f];g instanceof Ha&&g.setConstantPatternPositions(s,u)}}updatePaintArrays(s,u,f,g,x){let w=!1;for(const T in s){const A=u.getPositions(T);for(const k of A){const B=f.feature(k.index);for(const j in this.binders){const W=this.binders[j];if((W instanceof _o||W instanceof Is||W instanceof vo)&&W.expression.isStateDependent===!0){const Y=g.paint.get(j);W.expression=Y.value,W.updatePaintArray(k.start,k.end,B,s[T],x),w=!0}}}}return w}defines(){const s=[];for(const u in this.binders){const f=this.binders[u];(f instanceof yo||f instanceof Ha)&&s.push(...f.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return s}getBinderAttributes(){const s=[];for(const u in this.binders){const f=this.binders[u];if(f instanceof _o||f instanceof Is)for(let g=0;g<f.paintVertexAttributes.length;g++)s.push(f.paintVertexAttributes[g].name);else if(f instanceof vo)for(let g=0;g<go.members.length;g++)s.push(go.members[g].name)}return s}getBinderUniforms(){const s=[];for(const u in this.binders){const f=this.binders[u];if(f instanceof yo||f instanceof Ha||f instanceof Is)for(const g of f.uniformNames)s.push(g)}return s}getPaintVertexBuffers(){return this._buffers}getUniforms(s,u){const f=[];for(const g in this.binders){const x=this.binders[g];if(x instanceof yo||x instanceof Ha||x instanceof Is){for(const w of x.uniformNames)if(u[w]){const T=x.getBinding(s,u[w],w);f.push({name:w,property:g,binding:T})}}}return f}setUniforms(s,u,f,g){for(const{name:x,property:w,binding:T}of u)this.binders[w].setUniform(T,g,f.get(w),x)}updatePaintBuffers(s){this._buffers=[];for(const u in this.binders){const f=this.binders[u];if(s&&f instanceof vo){const g=s.fromScale===2?f.zoomInPaintVertexBuffer:f.zoomOutPaintVertexBuffer;g&&this._buffers.push(g)}else(f instanceof _o||f instanceof Is)&&f.paintVertexBuffer&&this._buffers.push(f.paintVertexBuffer)}}upload(s){for(const u in this.binders){const f=this.binders[u];(f instanceof _o||f instanceof Is||f instanceof vo)&&f.upload(s)}this.updatePaintBuffers()}destroy(){for(const s in this.binders){const u=this.binders[s];(u instanceof _o||u instanceof Is||u instanceof vo)&&u.destroy()}}}class $o{constructor(s,u,f=()=>!0){this.programConfigurations={};for(const g of s)this.programConfigurations[g.id]=new xf(g,u,f);this.needsUpload=!1,this._featureMap=new kr,this._bufferOffset=0}populatePaintArrays(s,u,f,g,x,w){for(const T in this.programConfigurations)this.programConfigurations[T].populatePaintArrays(s,u,g,x,w);u.id!==void 0&&this._featureMap.add(u.id,f,this._bufferOffset,s),this._bufferOffset=s,this.needsUpload=!0}updatePaintArrays(s,u,f,g){for(const x of f)this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(s,this._featureMap,u,x,g)||this.needsUpload}get(s){return this.programConfigurations[s]}upload(s){if(this.needsUpload){for(const u in this.programConfigurations)this.programConfigurations[u].upload(s);this.needsUpload=!1}}destroy(){for(const s in this.programConfigurations)this.programConfigurations[s].destroy()}}function BD(c,s){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[c]||[c.replace(`${s}-`,"").replace(/-/g,"_")]}function hT(c,s,u){const f={color:{source:Ll,composite:ue},number:{source:M,composite:Ll}},g=function(x){return{"line-pattern":{source:Hn,composite:Hn},"fill-pattern":{source:Hn,composite:Hn},"fill-extrusion-pattern":{source:Hn,composite:Hn}}[x]}(c);return g&&g[u]||f[s][u]}kt("ConstantBinder",yo),kt("CrossFadedConstantBinder",Ha),kt("SourceExpressionBinder",_o),kt("CrossFadedCompositeBinder",vo),kt("CompositeExpressionBinder",Is),kt("ProgramConfiguration",xf,{omit:["_buffers"]}),kt("ProgramConfigurationSet",$o);const $r=8192,Uv=Math.pow(2,14)-1,dT=-Uv-1;function jc(c){const s=$r/c.extent,u=c.loadGeometry();for(let f=0;f<u.length;f++){const g=u[f];for(let x=0;x<g.length;x++){const w=g[x],T=Math.round(w.x*s),A=Math.round(w.y*s);w.x=Q(T,dT,Uv),w.y=Q(A,dT,Uv),(T<w.x||T>w.x+1||A<w.y||A>w.y+1)&&Be("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return u}function $c(c,s){return{type:c.type,id:c.id,properties:c.properties,geometry:s?jc(c):[]}}function wg(c,s,u,f,g){c.emplaceBack(2*s+(f+1)/2,2*u+(g+1)/2)}class Vv{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(u=>u.id),this.index=s.index,this.hasPattern=!1,this.layoutVertexArray=new Vt,this.indexArray=new fi,this.segments=new or,this.programConfigurations=new $o(s.layers,s.zoom),this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(s,u,f){const g=this.layers[0],x=[];let w=null,T=!1;g.type==="circle"&&(w=g.layout.get("circle-sort-key"),T=!w.isConstant());for(const{feature:A,id:k,index:B,sourceLayerIndex:j}of s){const W=this.layers[0]._featureFilter.needGeometry,Y=$c(A,W);if(!this.layers[0]._featureFilter.filter(new sr(this.zoom),Y,f))continue;const J=T?w.evaluate(Y,{},f):void 0,ae={id:k,properties:A.properties,type:A.type,sourceLayerIndex:j,index:B,geometry:W?Y.geometry:jc(A),patterns:{},sortKey:J};x.push(ae)}T&&x.sort((A,k)=>A.sortKey-k.sortKey);for(const A of x){const{geometry:k,index:B,sourceLayerIndex:j}=A,W=s[B].feature;this.addFeature(A,k,B,f),u.featureIndex.insert(W,k,B,j,this.index)}}update(s,u,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,u,this.stateDependentLayers,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,ps),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(s,u,f,g){for(const x of u)for(const w of x){const T=w.x,A=w.y;if(T<0||T>=$r||A<0||A>=$r)continue;const k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,s.sortKey),B=k.vertexLength;wg(this.layoutVertexArray,T,A,-1,-1),wg(this.layoutVertexArray,T,A,1,-1),wg(this.layoutVertexArray,T,A,1,1),wg(this.layoutVertexArray,T,A,-1,1),this.indexArray.emplaceBack(B,B+1,B+2),this.indexArray.emplaceBack(B,B+3,B+2),k.vertexLength+=4,k.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,f,{},g)}}function fT(c,s){for(let u=0;u<c.length;u++)if(rh(s,c[u]))return!0;for(let u=0;u<s.length;u++)if(rh(c,s[u]))return!0;return!!jv(c,s)}function UD(c,s,u){return!!rh(c,s)||!!$v(s,c,u)}function pT(c,s){if(c.length===1)return gT(s,c[0]);for(let u=0;u<s.length;u++){const f=s[u];for(let g=0;g<f.length;g++)if(rh(c,f[g]))return!0}for(let u=0;u<c.length;u++)if(gT(s,c[u]))return!0;for(let u=0;u<s.length;u++)if(jv(c,s[u]))return!0;return!1}function VD(c,s,u){if(c.length>1){if(jv(c,s))return!0;for(let f=0;f<s.length;f++)if($v(s[f],c,u))return!0}for(let f=0;f<c.length;f++)if($v(c[f],s,u))return!0;return!1}function jv(c,s){if(c.length===0||s.length===0)return!1;for(let u=0;u<c.length-1;u++){const f=c[u],g=c[u+1];for(let x=0;x<s.length-1;x++)if(jD(f,g,s[x],s[x+1]))return!0}return!1}function jD(c,s,u,f){return Oe(c,u,f)!==Oe(s,u,f)&&Oe(c,s,u)!==Oe(c,s,f)}function $v(c,s,u){const f=u*u;if(s.length===1)return c.distSqr(s[0])<f;for(let g=1;g<s.length;g++)if(mT(c,s[g-1],s[g])<f)return!0;return!1}function mT(c,s,u){const f=s.distSqr(u);if(f===0)return c.distSqr(s);const g=((c.x-s.x)*(u.x-s.x)+(c.y-s.y)*(u.y-s.y))/f;return c.distSqr(g<0?s:g>1?u:u.sub(s)._mult(g)._add(s))}function gT(c,s){let u,f,g,x=!1;for(let w=0;w<c.length;w++){u=c[w];for(let T=0,A=u.length-1;T<u.length;A=T++)f=u[T],g=u[A],f.y>s.y!=g.y>s.y&&s.x<(g.x-f.x)*(s.y-f.y)/(g.y-f.y)+f.x&&(x=!x)}return x}function rh(c,s){let u=!1;for(let f=0,g=c.length-1;f<c.length;g=f++){const x=c[f],w=c[g];x.y>s.y!=w.y>s.y&&s.x<(w.x-x.x)*(s.y-x.y)/(w.y-x.y)+x.x&&(u=!u)}return u}function $D(c,s,u){const f=u[0],g=u[2];if(c.x<f.x&&s.x<f.x||c.x>g.x&&s.x>g.x||c.y<f.y&&s.y<f.y||c.y>g.y&&s.y>g.y)return!1;const x=Oe(c,s,u[0]);return x!==Oe(c,s,u[1])||x!==Oe(c,s,u[2])||x!==Oe(c,s,u[3])}function bf(c,s,u){const f=s.paint.get(c).value;return f.kind==="constant"?f.value:u.programConfigurations.get(s.id).getMaxValue(c)}function Eg(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function Tg(c,s,u,f,g){if(!s[0]&&!s[1])return c;const x=S.convert(s)._mult(g);u==="viewport"&&x._rotate(-f);const w=[];for(let T=0;T<c.length;T++)w.push(c[T].sub(x));return w}let yT,_T;kt("CircleBucket",Vv,{omit:["layers"]});var GD={get paint(){return _T=_T||new Dr({"circle-radius":new ln(Re.paint_circle["circle-radius"]),"circle-color":new ln(Re.paint_circle["circle-color"]),"circle-blur":new ln(Re.paint_circle["circle-blur"]),"circle-opacity":new ln(Re.paint_circle["circle-opacity"]),"circle-translate":new Xt(Re.paint_circle["circle-translate"]),"circle-translate-anchor":new Xt(Re.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Xt(Re.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Xt(Re.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ln(Re.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ln(Re.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ln(Re.paint_circle["circle-stroke-opacity"])})},get layout(){return yT=yT||new Dr({"circle-sort-key":new ln(Re.layout_circle["circle-sort-key"])})}},Xi=1e-6,ih=typeof Float32Array<"u"?Float32Array:Array;function Gv(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function vT(c,s,u){var f=s[0],g=s[1],x=s[2],w=s[3],T=s[4],A=s[5],k=s[6],B=s[7],j=s[8],W=s[9],Y=s[10],J=s[11],ae=s[12],pe=s[13],ye=s[14],Ie=s[15],be=u[0],ke=u[1],ze=u[2],Je=u[3];return c[0]=be*f+ke*T+ze*j+Je*ae,c[1]=be*g+ke*A+ze*W+Je*pe,c[2]=be*x+ke*k+ze*Y+Je*ye,c[3]=be*w+ke*B+ze*J+Je*Ie,c[4]=(be=u[4])*f+(ke=u[5])*T+(ze=u[6])*j+(Je=u[7])*ae,c[5]=be*g+ke*A+ze*W+Je*pe,c[6]=be*x+ke*k+ze*Y+Je*ye,c[7]=be*w+ke*B+ze*J+Je*Ie,c[8]=(be=u[8])*f+(ke=u[9])*T+(ze=u[10])*j+(Je=u[11])*ae,c[9]=be*g+ke*A+ze*W+Je*pe,c[10]=be*x+ke*k+ze*Y+Je*ye,c[11]=be*w+ke*B+ze*J+Je*Ie,c[12]=(be=u[12])*f+(ke=u[13])*T+(ze=u[14])*j+(Je=u[15])*ae,c[13]=be*g+ke*A+ze*W+Je*pe,c[14]=be*x+ke*k+ze*Y+Je*ye,c[15]=be*w+ke*B+ze*J+Je*Ie,c}Math.hypot||(Math.hypot=function(){for(var c=0,s=arguments.length;s--;)c+=arguments[s]*arguments[s];return Math.sqrt(c)});var wf,HD=vT;function Sg(c,s,u){var f=s[0],g=s[1],x=s[2],w=s[3];return c[0]=u[0]*f+u[4]*g+u[8]*x+u[12]*w,c[1]=u[1]*f+u[5]*g+u[9]*x+u[13]*w,c[2]=u[2]*f+u[6]*g+u[10]*x+u[14]*w,c[3]=u[3]*f+u[7]*g+u[11]*x+u[15]*w,c}wf=new ih(4),ih!=Float32Array&&(wf[0]=0,wf[1]=0,wf[2]=0,wf[3]=0);class WD extends As{constructor(s){super(s,GD)}createBucket(s){return new Vv(s)}queryRadius(s){const u=s;return bf("circle-radius",this,u)+bf("circle-stroke-width",this,u)+Eg(this.paint.get("circle-translate"))}queryIntersectsFeature(s,u,f,g,x,w,T,A){const k=Tg(s,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),w.angle,T),B=this.paint.get("circle-radius").evaluate(u,f)+this.paint.get("circle-stroke-width").evaluate(u,f),j=this.paint.get("circle-pitch-alignment")==="map",W=j?k:function(J,ae){return J.map(pe=>xT(pe,ae))}(k,A),Y=j?B*T:B;for(const J of g)for(const ae of J){const pe=j?ae:xT(ae,A);let ye=Y;const Ie=Sg([],[ae.x,ae.y,0,1],A);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ye*=Ie[3]/w.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ye*=w.cameraToCenterDistance/Ie[3]),UD(W,pe,ye))return!0}return!1}}function xT(c,s){const u=Sg([],[c.x,c.y,0,1],s);return new S(u[0]/u[3],u[1]/u[3])}class bT extends Vv{}let wT;kt("HeatmapBucket",bT,{omit:["layers"]});var qD={get paint(){return wT=wT||new Dr({"heatmap-radius":new ln(Re.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ln(Re.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Xt(Re.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ff(Re.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Xt(Re.paint_heatmap["heatmap-opacity"])})}};function Hv(c,{width:s,height:u},f,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==s*u*f)throw new RangeError(`mismatched image size. expected: ${g.length} but got: ${s*u*f}`)}else g=new Uint8Array(s*u*f);return c.width=s,c.height=u,c.data=g,c}function ET(c,{width:s,height:u},f){if(s===c.width&&u===c.height)return;const g=Hv({},{width:s,height:u},f);Wv(c,g,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,s),height:Math.min(c.height,u)},f),c.width=s,c.height=u,c.data=g.data}function Wv(c,s,u,f,g,x){if(g.width===0||g.height===0)return s;if(g.width>c.width||g.height>c.height||u.x>c.width-g.width||u.y>c.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>s.width||g.height>s.height||f.x>s.width-g.width||f.y>s.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const w=c.data,T=s.data;if(w===T)throw new Error("srcData equals dstData, so image is already copied");for(let A=0;A<g.height;A++){const k=((u.y+A)*c.width+u.x)*x,B=((f.y+A)*s.width+f.x)*x;for(let j=0;j<g.width*x;j++)T[B+j]=w[k+j]}return s}class Ef{constructor(s,u){Hv(this,s,1,u)}resize(s){ET(this,s,1)}clone(){return new Ef({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,u,f,g,x){Wv(s,u,f,g,x,1)}}class js{constructor(s,u){Hv(this,s,4,u)}resize(s){ET(this,s,4)}replace(s,u){u?this.data.set(s):this.data=s instanceof Uint8ClampedArray?new Uint8Array(s.buffer):s}clone(){return new js({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,u,f,g,x){Wv(s,u,f,g,x,4)}}function TT(c){const s={},u=c.resolution||256,f=c.clips?c.clips.length:1,g=c.image||new js({width:u,height:f});if(Math.log(u)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${u}`);const x=(w,T,A)=>{s[c.evaluationKey]=A;const k=c.expression.evaluate(s);g.data[w+T+0]=Math.floor(255*k.r/k.a),g.data[w+T+1]=Math.floor(255*k.g/k.a),g.data[w+T+2]=Math.floor(255*k.b/k.a),g.data[w+T+3]=Math.floor(255*k.a)};if(c.clips)for(let w=0,T=0;w<f;++w,T+=4*u)for(let A=0,k=0;A<u;A++,k+=4){const B=A/(u-1),{start:j,end:W}=c.clips[w];x(T,k,j*(1-B)+W*B)}else for(let w=0,T=0;w<u;w++,T+=4)x(0,T,w/(u-1));return g}kt("AlphaImage",Ef),kt("RGBAImage",js);class ZD extends As{createBucket(s){return new bT(s)}constructor(s){super(s,qD),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(s){s==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=TT({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let ST;var XD={get paint(){return ST=ST||new Dr({"hillshade-illumination-direction":new Xt(Re.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Xt(Re.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Xt(Re.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Xt(Re.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Xt(Re.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Xt(Re.paint_hillshade["hillshade-accent-color"])})}};class YD extends As{constructor(s){super(s,XD)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const KD=yr([{name:"a_pos",components:2,type:"Int16"}],4),{members:JD}=KD;var qv={exports:{}};function Pg(c,s,u){u=u||2;var f,g,x,w,T,A,k,B=s&&s.length,j=B?s[0]*u:c.length,W=PT(c,0,j,u,!0),Y=[];if(!W||W.next===W.prev)return Y;if(B&&(W=function(ae,pe,ye,Ie){var be,ke,ze,Je=[];for(be=0,ke=pe.length;be<ke;be++)(ze=PT(ae,pe[be]*Ie,be<ke-1?pe[be+1]*Ie:ae.length,Ie,!1))===ze.next&&(ze.steiner=!0),Je.push(oz(ze));for(Je.sort(rz),be=0;be<Je.length;be++)ye=iz(Je[be],ye);return ye}(c,s,W,u)),c.length>80*u){f=x=c[0],g=w=c[1];for(var J=u;J<j;J+=u)(T=c[J])<f&&(f=T),(A=c[J+1])<g&&(g=A),T>x&&(x=T),A>w&&(w=A);k=(k=Math.max(x-f,w-g))!==0?32767/k:0}return Tf(W,Y,u,f,g,k,0),Y}function PT(c,s,u,f,g){var x,w;if(g===Yv(c,s,u,f)>0)for(x=s;x<u;x+=f)w=IT(x,c[x],c[x+1],w);else for(x=u-f;x>=s;x-=f)w=IT(x,c[x],c[x+1],w);return w&&Cg(w,w.next)&&(Pf(w),w=w.next),w}function Gc(c,s){if(!c)return c;s||(s=c);var u,f=c;do if(u=!1,f.steiner||!Cg(f,f.next)&&Fr(f.prev,f,f.next)!==0)f=f.next;else{if(Pf(f),(f=s=f.prev)===f.next)break;u=!0}while(u||f!==s);return s}function Tf(c,s,u,f,g,x,w){if(c){!w&&x&&function(B,j,W,Y){var J=B;do J.z===0&&(J.z=Zv(J.x,J.y,j,W,Y)),J.prevZ=J.prev,J.nextZ=J.next,J=J.next;while(J!==B);J.prevZ.nextZ=null,J.prevZ=null,function(ae){var pe,ye,Ie,be,ke,ze,Je,Tt,jt=1;do{for(ye=ae,ae=null,ke=null,ze=0;ye;){for(ze++,Ie=ye,Je=0,pe=0;pe<jt&&(Je++,Ie=Ie.nextZ);pe++);for(Tt=jt;Je>0||Tt>0&&Ie;)Je!==0&&(Tt===0||!Ie||ye.z<=Ie.z)?(be=ye,ye=ye.nextZ,Je--):(be=Ie,Ie=Ie.nextZ,Tt--),ke?ke.nextZ=be:ae=be,be.prevZ=ke,ke=be;ye=Ie}ke.nextZ=null,jt*=2}while(ze>1)}(J)}(c,f,g,x);for(var T,A,k=c;c.prev!==c.next;)if(T=c.prev,A=c.next,x?ez(c,f,g,x):QD(c))s.push(T.i/u|0),s.push(c.i/u|0),s.push(A.i/u|0),Pf(c),c=A.next,k=A.next;else if((c=A)===k){w?w===1?Tf(c=tz(Gc(c),s,u),s,u,f,g,x,2):w===2&&nz(c,s,u,f,g,x):Tf(Gc(c),s,u,f,g,x,1);break}}}function QD(c){var s=c.prev,u=c,f=c.next;if(Fr(s,u,f)>=0)return!1;for(var g=s.x,x=u.x,w=f.x,T=s.y,A=u.y,k=f.y,B=g<x?g<w?g:w:x<w?x:w,j=T<A?T<k?T:k:A<k?A:k,W=g>x?g>w?g:w:x>w?x:w,Y=T>A?T>k?T:k:A>k?A:k,J=f.next;J!==s;){if(J.x>=B&&J.x<=W&&J.y>=j&&J.y<=Y&&sh(g,T,x,A,w,k,J.x,J.y)&&Fr(J.prev,J,J.next)>=0)return!1;J=J.next}return!0}function ez(c,s,u,f){var g=c.prev,x=c,w=c.next;if(Fr(g,x,w)>=0)return!1;for(var T=g.x,A=x.x,k=w.x,B=g.y,j=x.y,W=w.y,Y=T<A?T<k?T:k:A<k?A:k,J=B<j?B<W?B:W:j<W?j:W,ae=T>A?T>k?T:k:A>k?A:k,pe=B>j?B>W?B:W:j>W?j:W,ye=Zv(Y,J,s,u,f),Ie=Zv(ae,pe,s,u,f),be=c.prevZ,ke=c.nextZ;be&&be.z>=ye&&ke&&ke.z<=Ie;){if(be.x>=Y&&be.x<=ae&&be.y>=J&&be.y<=pe&&be!==g&&be!==w&&sh(T,B,A,j,k,W,be.x,be.y)&&Fr(be.prev,be,be.next)>=0||(be=be.prevZ,ke.x>=Y&&ke.x<=ae&&ke.y>=J&&ke.y<=pe&&ke!==g&&ke!==w&&sh(T,B,A,j,k,W,ke.x,ke.y)&&Fr(ke.prev,ke,ke.next)>=0))return!1;ke=ke.nextZ}for(;be&&be.z>=ye;){if(be.x>=Y&&be.x<=ae&&be.y>=J&&be.y<=pe&&be!==g&&be!==w&&sh(T,B,A,j,k,W,be.x,be.y)&&Fr(be.prev,be,be.next)>=0)return!1;be=be.prevZ}for(;ke&&ke.z<=Ie;){if(ke.x>=Y&&ke.x<=ae&&ke.y>=J&&ke.y<=pe&&ke!==g&&ke!==w&&sh(T,B,A,j,k,W,ke.x,ke.y)&&Fr(ke.prev,ke,ke.next)>=0)return!1;ke=ke.nextZ}return!0}function tz(c,s,u){var f=c;do{var g=f.prev,x=f.next.next;!Cg(g,x)&&CT(g,f,f.next,x)&&Sf(g,x)&&Sf(x,g)&&(s.push(g.i/u|0),s.push(f.i/u|0),s.push(x.i/u|0),Pf(f),Pf(f.next),f=c=x),f=f.next}while(f!==c);return Gc(f)}function nz(c,s,u,f,g,x){var w=c;do{for(var T=w.next.next;T!==w.prev;){if(w.i!==T.i&&az(w,T)){var A=AT(w,T);return w=Gc(w,w.next),A=Gc(A,A.next),Tf(w,s,u,f,g,x,0),void Tf(A,s,u,f,g,x,0)}T=T.next}w=w.next}while(w!==c)}function rz(c,s){return c.x-s.x}function iz(c,s){var u=function(g,x){var w,T=x,A=g.x,k=g.y,B=-1/0;do{if(k<=T.y&&k>=T.next.y&&T.next.y!==T.y){var j=T.x+(k-T.y)*(T.next.x-T.x)/(T.next.y-T.y);if(j<=A&&j>B&&(B=j,w=T.x<T.next.x?T:T.next,j===A))return w}T=T.next}while(T!==x);if(!w)return null;var W,Y=w,J=w.x,ae=w.y,pe=1/0;T=w;do A>=T.x&&T.x>=J&&A!==T.x&&sh(k<ae?A:B,k,J,ae,k<ae?B:A,k,T.x,T.y)&&(W=Math.abs(k-T.y)/(A-T.x),Sf(T,g)&&(W<pe||W===pe&&(T.x>w.x||T.x===w.x&&sz(w,T)))&&(w=T,pe=W)),T=T.next;while(T!==Y);return w}(c,s);if(!u)return s;var f=AT(u,c);return Gc(f,f.next),Gc(u,u.next)}function sz(c,s){return Fr(c.prev,c,s.prev)<0&&Fr(s.next,c,c.next)<0}function Zv(c,s,u,f,g){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-u)*g|0)|c<<8))|c<<4))|c<<2))|c<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-f)*g|0)|s<<8))|s<<4))|s<<2))|s<<1))<<1}function oz(c){var s=c,u=c;do(s.x<u.x||s.x===u.x&&s.y<u.y)&&(u=s),s=s.next;while(s!==c);return u}function sh(c,s,u,f,g,x,w,T){return(g-w)*(s-T)>=(c-w)*(x-T)&&(c-w)*(f-T)>=(u-w)*(s-T)&&(u-w)*(x-T)>=(g-w)*(f-T)}function az(c,s){return c.next.i!==s.i&&c.prev.i!==s.i&&!function(u,f){var g=u;do{if(g.i!==u.i&&g.next.i!==u.i&&g.i!==f.i&&g.next.i!==f.i&&CT(g,g.next,u,f))return!0;g=g.next}while(g!==u);return!1}(c,s)&&(Sf(c,s)&&Sf(s,c)&&function(u,f){var g=u,x=!1,w=(u.x+f.x)/2,T=(u.y+f.y)/2;do g.y>T!=g.next.y>T&&g.next.y!==g.y&&w<(g.next.x-g.x)*(T-g.y)/(g.next.y-g.y)+g.x&&(x=!x),g=g.next;while(g!==u);return x}(c,s)&&(Fr(c.prev,c,s.prev)||Fr(c,s.prev,s))||Cg(c,s)&&Fr(c.prev,c,c.next)>0&&Fr(s.prev,s,s.next)>0)}function Fr(c,s,u){return(s.y-c.y)*(u.x-s.x)-(s.x-c.x)*(u.y-s.y)}function Cg(c,s){return c.x===s.x&&c.y===s.y}function CT(c,s,u,f){var g=Ig(Fr(c,s,u)),x=Ig(Fr(c,s,f)),w=Ig(Fr(u,f,c)),T=Ig(Fr(u,f,s));return g!==x&&w!==T||!(g!==0||!Ag(c,u,s))||!(x!==0||!Ag(c,f,s))||!(w!==0||!Ag(u,c,f))||!(T!==0||!Ag(u,s,f))}function Ag(c,s,u){return s.x<=Math.max(c.x,u.x)&&s.x>=Math.min(c.x,u.x)&&s.y<=Math.max(c.y,u.y)&&s.y>=Math.min(c.y,u.y)}function Ig(c){return c>0?1:c<0?-1:0}function Sf(c,s){return Fr(c.prev,c,c.next)<0?Fr(c,s,c.next)>=0&&Fr(c,c.prev,s)>=0:Fr(c,s,c.prev)<0||Fr(c,c.next,s)<0}function AT(c,s){var u=new Xv(c.i,c.x,c.y),f=new Xv(s.i,s.x,s.y),g=c.next,x=s.prev;return c.next=s,s.prev=c,u.next=g,g.prev=u,f.next=u,u.prev=f,x.next=f,f.prev=x,f}function IT(c,s,u,f){var g=new Xv(c,s,u);return f?(g.next=f.next,g.prev=f,f.next.prev=g,f.next=g):(g.prev=g,g.next=g),g}function Pf(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function Xv(c,s,u){this.i=c,this.x=s,this.y=u,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Yv(c,s,u,f){for(var g=0,x=s,w=u-f;x<u;x+=f)g+=(c[w]-c[x])*(c[x+1]+c[w+1]),w=x;return g}qv.exports=Pg,qv.exports.default=Pg,Pg.deviation=function(c,s,u,f){var g=s&&s.length,x=Math.abs(Yv(c,0,g?s[0]*u:c.length,u));if(g)for(var w=0,T=s.length;w<T;w++)x-=Math.abs(Yv(c,s[w]*u,w<T-1?s[w+1]*u:c.length,u));var A=0;for(w=0;w<f.length;w+=3){var k=f[w]*u,B=f[w+1]*u,j=f[w+2]*u;A+=Math.abs((c[k]-c[j])*(c[B+1]-c[k+1])-(c[k]-c[B])*(c[j+1]-c[k+1]))}return x===0&&A===0?0:Math.abs((A-x)/x)},Pg.flatten=function(c){for(var s=c[0][0].length,u={vertices:[],holes:[],dimensions:s},f=0,g=0;g<c.length;g++){for(var x=0;x<c[g].length;x++)for(var w=0;w<s;w++)u.vertices.push(c[g][x][w]);g>0&&u.holes.push(f+=c[g-1].length)}return u};var MT=m(qv.exports);function lz(c,s,u,f,g){kT(c,s,u||0,f||c.length-1,g||cz)}function kT(c,s,u,f,g){for(;f>u;){if(f-u>600){var x=f-u+1,w=s-u+1,T=Math.log(x),A=.5*Math.exp(2*T/3),k=.5*Math.sqrt(T*A*(x-A)/x)*(w-x/2<0?-1:1);kT(c,s,Math.max(u,Math.floor(s-w*A/x+k)),Math.min(f,Math.floor(s+(x-w)*A/x+k)),g)}var B=c[s],j=u,W=f;for(Cf(c,u,s),g(c[f],B)>0&&Cf(c,u,f);j<W;){for(Cf(c,j,W),j++,W--;g(c[j],B)<0;)j++;for(;g(c[W],B)>0;)W--}g(c[u],B)===0?Cf(c,u,W):Cf(c,++W,f),W<=s&&(u=W+1),s<=W&&(f=W-1)}}function Cf(c,s,u){var f=c[s];c[s]=c[u],c[u]=f}function cz(c,s){return c<s?-1:c>s?1:0}function Kv(c,s){const u=c.length;if(u<=1)return[c];const f=[];let g,x;for(let w=0;w<u;w++){const T=Ke(c[w]);T!==0&&(c[w].area=Math.abs(T),x===void 0&&(x=T<0),x===T<0?(g&&f.push(g),g=[c[w]]):g.push(c[w]))}if(g&&f.push(g),s>1)for(let w=0;w<f.length;w++)f[w].length<=s||(lz(f[w],s,1,f[w].length-1,uz),f[w]=f[w].slice(0,s));return f}function uz(c,s){return s.area-c.area}function Jv(c,s,u){const f=u.patternDependencies;let g=!1;for(const x of s){const w=x.paint.get(`${c}-pattern`);w.isConstant()||(g=!0);const T=w.constantOr(null);T&&(g=!0,f[T.to]=!0,f[T.from]=!0)}return g}function Qv(c,s,u,f,g){const x=g.patternDependencies;for(const w of s){const T=w.paint.get(`${c}-pattern`).value;if(T.kind!=="constant"){let A=T.evaluate({zoom:f-1},u,{},g.availableImages),k=T.evaluate({zoom:f},u,{},g.availableImages),B=T.evaluate({zoom:f+1},u,{},g.availableImages);A=A&&A.name?A.name:A,k=k&&k.name?k.name:k,B=B&&B.name?B.name:B,x[A]=!0,x[k]=!0,x[B]=!0,u.patterns[w.id]={min:A,mid:k,max:B}}}return u}class e1{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(u=>u.id),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new An,this.indexArray=new fi,this.indexArray2=new Qr,this.programConfigurations=new $o(s.layers,s.zoom),this.segments=new or,this.segments2=new or,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(s,u,f){this.hasPattern=Jv("fill",this.layers,u);const g=this.layers[0].layout.get("fill-sort-key"),x=!g.isConstant(),w=[];for(const{feature:T,id:A,index:k,sourceLayerIndex:B}of s){const j=this.layers[0]._featureFilter.needGeometry,W=$c(T,j);if(!this.layers[0]._featureFilter.filter(new sr(this.zoom),W,f))continue;const Y=x?g.evaluate(W,{},f,u.availableImages):void 0,J={id:A,properties:T.properties,type:T.type,sourceLayerIndex:B,index:k,geometry:j?W.geometry:jc(T),patterns:{},sortKey:Y};w.push(J)}x&&w.sort((T,A)=>T.sortKey-A.sortKey);for(const T of w){const{geometry:A,index:k,sourceLayerIndex:B}=T;if(this.hasPattern){const j=Qv("fill",this.layers,T,this.zoom,u);this.patternFeatures.push(j)}else this.addFeature(T,A,k,f,{});u.featureIndex.insert(s[k].feature,A,k,B,this.index)}}update(s,u,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,u,this.stateDependentLayers,f)}addFeatures(s,u,f){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,u,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,JD),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.indexBuffer2=s.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(s,u,f,g,x){for(const w of Kv(u,500)){let T=0;for(const Y of w)T+=Y.length;const A=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray),k=A.vertexLength,B=[],j=[];for(const Y of w){if(Y.length===0)continue;Y!==w[0]&&j.push(B.length/2);const J=this.segments2.prepareSegment(Y.length,this.layoutVertexArray,this.indexArray2),ae=J.vertexLength;this.layoutVertexArray.emplaceBack(Y[0].x,Y[0].y),this.indexArray2.emplaceBack(ae+Y.length-1,ae),B.push(Y[0].x),B.push(Y[0].y);for(let pe=1;pe<Y.length;pe++)this.layoutVertexArray.emplaceBack(Y[pe].x,Y[pe].y),this.indexArray2.emplaceBack(ae+pe-1,ae+pe),B.push(Y[pe].x),B.push(Y[pe].y);J.vertexLength+=Y.length,J.primitiveLength+=Y.length}const W=MT(B,j);for(let Y=0;Y<W.length;Y+=3)this.indexArray.emplaceBack(k+W[Y],k+W[Y+1],k+W[Y+2]);A.vertexLength+=T,A.primitiveLength+=W.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,f,x,g)}}let LT,RT;kt("FillBucket",e1,{omit:["layers","patternFeatures"]});var hz={get paint(){return RT=RT||new Dr({"fill-antialias":new Xt(Re.paint_fill["fill-antialias"]),"fill-opacity":new ln(Re.paint_fill["fill-opacity"]),"fill-color":new ln(Re.paint_fill["fill-color"]),"fill-outline-color":new ln(Re.paint_fill["fill-outline-color"]),"fill-translate":new Xt(Re.paint_fill["fill-translate"]),"fill-translate-anchor":new Xt(Re.paint_fill["fill-translate-anchor"]),"fill-pattern":new Bc(Re.paint_fill["fill-pattern"])})},get layout(){return LT=LT||new Dr({"fill-sort-key":new ln(Re.layout_fill["fill-sort-key"])})}};class dz extends As{constructor(s){super(s,hz)}recalculate(s,u){super.recalculate(s,u);const f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(s){return new e1(s)}queryRadius(){return Eg(this.paint.get("fill-translate"))}queryIntersectsFeature(s,u,f,g,x,w,T){return pT(Tg(s,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),w.angle,T),g)}isTileClipped(){return!0}}const fz=yr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),pz=yr([{name:"a_centroid",components:2,type:"Int16"}],4),{members:mz}=fz;var Ol={},gz=_,OT=oh;function oh(c,s,u,f,g){this.properties={},this.extent=u,this.type=0,this._pbf=c,this._geometry=-1,this._keys=f,this._values=g,c.readFields(yz,this,s)}function yz(c,s,u){c==1?s.id=u.readVarint():c==2?function(f,g){for(var x=f.readVarint()+f.pos;f.pos<x;){var w=g._keys[f.readVarint()],T=g._values[f.readVarint()];g.properties[w]=T}}(u,s):c==3?s.type=u.readVarint():c==4&&(s._geometry=u.pos)}function _z(c){for(var s,u,f=0,g=0,x=c.length,w=x-1;g<x;w=g++)f+=((u=c[w]).x-(s=c[g]).x)*(s.y+u.y);return f}oh.types=["Unknown","Point","LineString","Polygon"],oh.prototype.loadGeometry=function(){var c=this._pbf;c.pos=this._geometry;for(var s,u=c.readVarint()+c.pos,f=1,g=0,x=0,w=0,T=[];c.pos<u;){if(g<=0){var A=c.readVarint();f=7&A,g=A>>3}if(g--,f===1||f===2)x+=c.readSVarint(),w+=c.readSVarint(),f===1&&(s&&T.push(s),s=[]),s.push(new gz(x,w));else{if(f!==7)throw new Error("unknown command "+f);s&&s.push(s[0].clone())}}return s&&T.push(s),T},oh.prototype.bbox=function(){var c=this._pbf;c.pos=this._geometry;for(var s=c.readVarint()+c.pos,u=1,f=0,g=0,x=0,w=1/0,T=-1/0,A=1/0,k=-1/0;c.pos<s;){if(f<=0){var B=c.readVarint();u=7&B,f=B>>3}if(f--,u===1||u===2)(g+=c.readSVarint())<w&&(w=g),g>T&&(T=g),(x+=c.readSVarint())<A&&(A=x),x>k&&(k=x);else if(u!==7)throw new Error("unknown command "+u)}return[w,A,T,k]},oh.prototype.toGeoJSON=function(c,s,u){var f,g,x=this.extent*Math.pow(2,u),w=this.extent*c,T=this.extent*s,A=this.loadGeometry(),k=oh.types[this.type];function B(Y){for(var J=0;J<Y.length;J++){var ae=Y[J];Y[J]=[360*(ae.x+w)/x-180,360/Math.PI*Math.atan(Math.exp((180-360*(ae.y+T)/x)*Math.PI/180))-90]}}switch(this.type){case 1:var j=[];for(f=0;f<A.length;f++)j[f]=A[f][0];B(A=j);break;case 2:for(f=0;f<A.length;f++)B(A[f]);break;case 3:for(A=function(Y){var J=Y.length;if(J<=1)return[Y];for(var ae,pe,ye=[],Ie=0;Ie<J;Ie++){var be=_z(Y[Ie]);be!==0&&(pe===void 0&&(pe=be<0),pe===be<0?(ae&&ye.push(ae),ae=[Y[Ie]]):ae.push(Y[Ie]))}return ae&&ye.push(ae),ye}(A),f=0;f<A.length;f++)for(g=0;g<A[f].length;g++)B(A[f][g])}A.length===1?A=A[0]:k="Multi"+k;var W={type:"Feature",geometry:{type:k,coordinates:A},properties:this.properties};return"id"in this&&(W.id=this.id),W};var vz=OT,DT=zT;function zT(c,s){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(xz,this,s),this.length=this._features.length}function xz(c,s,u){c===15?s.version=u.readVarint():c===1?s.name=u.readString():c===5?s.extent=u.readVarint():c===2?s._features.push(u.pos):c===3?s._keys.push(u.readString()):c===4&&s._values.push(function(f){for(var g=null,x=f.readVarint()+f.pos;f.pos<x;){var w=f.readVarint()>>3;g=w===1?f.readString():w===2?f.readFloat():w===3?f.readDouble():w===4?f.readVarint64():w===5?f.readVarint():w===6?f.readSVarint():w===7?f.readBoolean():null}return g}(u))}zT.prototype.feature=function(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];var s=this._pbf.readVarint()+this._pbf.pos;return new vz(this._pbf,s,this.extent,this._keys,this._values)};var bz=DT;function wz(c,s,u){if(c===3){var f=new bz(u,u.readVarint()+u.pos);f.length&&(s[f.name]=f)}}Ol.VectorTile=function(c,s){this.layers=c.readFields(wz,{},s)},Ol.VectorTileFeature=OT,Ol.VectorTileLayer=DT;const Ez=Ol.VectorTileFeature.types,t1=Math.pow(2,13);function Af(c,s,u,f,g,x,w,T){c.emplaceBack(s,u,2*Math.floor(f*t1)+w,g*t1*2,x*t1*2,Math.round(T))}class n1{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(u=>u.id),this.index=s.index,this.hasPattern=!1,this.layoutVertexArray=new mt,this.centroidVertexArray=new ct,this.indexArray=new fi,this.programConfigurations=new $o(s.layers,s.zoom),this.segments=new or,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(s,u,f){this.features=[],this.hasPattern=Jv("fill-extrusion",this.layers,u);for(const{feature:g,id:x,index:w,sourceLayerIndex:T}of s){const A=this.layers[0]._featureFilter.needGeometry,k=$c(g,A);if(!this.layers[0]._featureFilter.filter(new sr(this.zoom),k,f))continue;const B={id:x,sourceLayerIndex:T,index:w,geometry:A?k.geometry:jc(g),properties:g.properties,type:g.type,patterns:{}};this.hasPattern?this.features.push(Qv("fill-extrusion",this.layers,B,this.zoom,u)):this.addFeature(B,B.geometry,w,f,{}),u.featureIndex.insert(g,B.geometry,w,T,this.index,!0)}}addFeatures(s,u,f){for(const g of this.features){const{geometry:x}=g;this.addFeature(g,x,g.index,u,f)}}update(s,u,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,u,this.stateDependentLayers,f)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,mz),this.centroidVertexBuffer=s.createVertexBuffer(this.centroidVertexArray,pz.members,!0),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(s,u,f,g,x){const w={x:0,y:0,vertexCount:0};for(const T of Kv(u,500)){let A=0;for(const J of T)A+=J.length;let k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const J of T){if(J.length===0||Sz(J))continue;let ae=0;for(let pe=0;pe<J.length;pe++){const ye=J[pe];if(pe>=1){const Ie=J[pe-1];if(!Tz(ye,Ie)){k.vertexLength+4>or.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const be=ye.sub(Ie)._perp()._unit(),ke=Ie.dist(ye);ae+ke>32768&&(ae=0),Af(this.layoutVertexArray,ye.x,ye.y,be.x,be.y,0,0,ae),Af(this.layoutVertexArray,ye.x,ye.y,be.x,be.y,0,1,ae),w.x+=2*ye.x,w.y+=2*ye.y,w.vertexCount+=2,ae+=ke,Af(this.layoutVertexArray,Ie.x,Ie.y,be.x,be.y,0,0,ae),Af(this.layoutVertexArray,Ie.x,Ie.y,be.x,be.y,0,1,ae),w.x+=2*Ie.x,w.y+=2*Ie.y,w.vertexCount+=2;const ze=k.vertexLength;this.indexArray.emplaceBack(ze,ze+2,ze+1),this.indexArray.emplaceBack(ze+1,ze+2,ze+3),k.vertexLength+=4,k.primitiveLength+=2}}}}if(k.vertexLength+A>or.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(A,this.layoutVertexArray,this.indexArray)),Ez[s.type]!=="Polygon")continue;const B=[],j=[],W=k.vertexLength;for(const J of T)if(J.length!==0){J!==T[0]&&j.push(B.length/2);for(let ae=0;ae<J.length;ae++){const pe=J[ae];Af(this.layoutVertexArray,pe.x,pe.y,0,0,1,1,0),w.x+=pe.x,w.y+=pe.y,w.vertexCount+=1,B.push(pe.x),B.push(pe.y)}}const Y=MT(B,j);for(let J=0;J<Y.length;J+=3)this.indexArray.emplaceBack(W+Y[J],W+Y[J+2],W+Y[J+1]);k.primitiveLength+=Y.length/3,k.vertexLength+=A}for(let T=0;T<w.vertexCount;T++)this.centroidVertexArray.emplaceBack(Math.floor(w.x/w.vertexCount),Math.floor(w.y/w.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,f,x,g)}}function Tz(c,s){return c.x===s.x&&(c.x<0||c.x>$r)||c.y===s.y&&(c.y<0||c.y>$r)}function Sz(c){return c.every(s=>s.x<0)||c.every(s=>s.x>$r)||c.every(s=>s.y<0)||c.every(s=>s.y>$r)}let FT;kt("FillExtrusionBucket",n1,{omit:["layers","features"]});var Pz={get paint(){return FT=FT||new Dr({"fill-extrusion-opacity":new Xt(Re["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ln(Re["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Xt(Re["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Xt(Re["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Bc(Re["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ln(Re["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ln(Re["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Xt(Re["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Cz extends As{constructor(s){super(s,Pz)}createBucket(s){return new n1(s)}queryRadius(){return Eg(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(s,u,f,g,x,w,T,A){const k=Tg(s,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),w.angle,T),B=this.paint.get("fill-extrusion-height").evaluate(u,f),j=this.paint.get("fill-extrusion-base").evaluate(u,f),W=function(J,ae,pe,ye){const Ie=[];for(const be of J){const ke=[be.x,be.y,0,1];Sg(ke,ke,ae),Ie.push(new S(ke[0]/ke[3],ke[1]/ke[3]))}return Ie}(k,A),Y=function(J,ae,pe,ye){const Ie=[],be=[],ke=ye[8]*ae,ze=ye[9]*ae,Je=ye[10]*ae,Tt=ye[11]*ae,jt=ye[8]*pe,wt=ye[9]*pe,gt=ye[10]*pe,ht=ye[11]*pe;for(const Rt of J){const pt=[],rt=[];for(const en of Rt){const qt=en.x,Tn=en.y,ar=ye[0]*qt+ye[4]*Tn+ye[12],pr=ye[1]*qt+ye[5]*Tn+ye[13],ni=ye[2]*qt+ye[6]*Tn+ye[14],Ms=ye[3]*qt+ye[7]*Tn+ye[15],Yi=ni+Je,Gr=Ms+Tt,mi=ar+jt,Ti=pr+wt,Ki=ni+gt,Ji=Ms+ht,ri=new S((ar+ke)/Gr,(pr+ze)/Gr);ri.z=Yi/Gr,pt.push(ri);const ii=new S(mi/Ji,Ti/Ji);ii.z=Ki/Ji,rt.push(ii)}Ie.push(pt),be.push(rt)}return[Ie,be]}(g,j,B,A);return function(J,ae,pe){let ye=1/0;pT(pe,ae)&&(ye=NT(pe,ae[0]));for(let Ie=0;Ie<ae.length;Ie++){const be=ae[Ie],ke=J[Ie];for(let ze=0;ze<be.length-1;ze++){const Je=be[ze],Tt=[Je,be[ze+1],ke[ze+1],ke[ze],Je];fT(pe,Tt)&&(ye=Math.min(ye,NT(pe,Tt)))}}return ye!==1/0&&ye}(Y[0],Y[1],W)}}function If(c,s){return c.x*s.x+c.y*s.y}function NT(c,s){if(c.length===1){let u=0;const f=s[u++];let g;for(;!g||f.equals(g);)if(g=s[u++],!g)return 1/0;for(;u<s.length;u++){const x=s[u],w=c[0],T=g.sub(f),A=x.sub(f),k=w.sub(f),B=If(T,T),j=If(T,A),W=If(A,A),Y=If(k,T),J=If(k,A),ae=B*W-j*j,pe=(W*Y-j*J)/ae,ye=(B*J-j*Y)/ae,Ie=f.z*(1-pe-ye)+g.z*pe+x.z*ye;if(isFinite(Ie))return Ie}return 1/0}{let u=1/0;for(const f of s)u=Math.min(u,f.z);return u}}const Az=yr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Iz}=Az,Mz=yr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:kz}=Mz,Lz=Ol.VectorTileFeature.types,Rz=Math.cos(Math.PI/180*37.5),BT=Math.pow(2,14)/.5;class r1{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(u=>u.id),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(u=>{this.gradients[u.id]={}}),this.layoutVertexArray=new cn,this.layoutVertexArray2=new Gt,this.indexArray=new fi,this.programConfigurations=new $o(s.layers,s.zoom),this.segments=new or,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(s,u,f){this.hasPattern=Jv("line",this.layers,u);const g=this.layers[0].layout.get("line-sort-key"),x=!g.isConstant(),w=[];for(const{feature:T,id:A,index:k,sourceLayerIndex:B}of s){const j=this.layers[0]._featureFilter.needGeometry,W=$c(T,j);if(!this.layers[0]._featureFilter.filter(new sr(this.zoom),W,f))continue;const Y=x?g.evaluate(W,{},f):void 0,J={id:A,properties:T.properties,type:T.type,sourceLayerIndex:B,index:k,geometry:j?W.geometry:jc(T),patterns:{},sortKey:Y};w.push(J)}x&&w.sort((T,A)=>T.sortKey-A.sortKey);for(const T of w){const{geometry:A,index:k,sourceLayerIndex:B}=T;if(this.hasPattern){const j=Qv("line",this.layers,T,this.zoom,u);this.patternFeatures.push(j)}else this.addFeature(T,A,k,f,{});u.featureIndex.insert(s[k].feature,A,k,B,this.index)}}update(s,u,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,u,this.stateDependentLayers,f)}addFeatures(s,u,f){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,u,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=s.createVertexBuffer(this.layoutVertexArray2,kz)),this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Iz),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(s){if(s.properties&&Object.prototype.hasOwnProperty.call(s.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(s.properties,"mapbox_clip_end"))return{start:+s.properties.mapbox_clip_start,end:+s.properties.mapbox_clip_end}}addFeature(s,u,f,g,x){const w=this.layers[0].layout,T=w.get("line-join").evaluate(s,{}),A=w.get("line-cap"),k=w.get("line-miter-limit"),B=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(s);for(const j of u)this.addLine(j,s,T,A,k,B);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,f,x,g)}addLine(s,u,f,g,x,w){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ye=0;ye<s.length-1;ye++)this.totalDistance+=s[ye].dist(s[ye+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const T=Lz[u.type]==="Polygon";let A=s.length;for(;A>=2&&s[A-1].equals(s[A-2]);)A--;let k=0;for(;k<A-1&&s[k].equals(s[k+1]);)k++;if(A<(T?3:2))return;f==="bevel"&&(x=1.05);const B=this.overscaling<=16?15*$r/(512*this.overscaling):0,j=this.segments.prepareSegment(10*A,this.layoutVertexArray,this.indexArray);let W,Y,J,ae,pe;this.e1=this.e2=-1,T&&(W=s[A-2],pe=s[k].sub(W)._unit()._perp());for(let ye=k;ye<A;ye++){if(J=ye===A-1?T?s[k+1]:void 0:s[ye+1],J&&s[ye].equals(J))continue;pe&&(ae=pe),W&&(Y=W),W=s[ye],pe=J?J.sub(W)._unit()._perp():ae,ae=ae||pe;let Ie=ae.add(pe);Ie.x===0&&Ie.y===0||Ie._unit();const be=ae.x*pe.x+ae.y*pe.y,ke=Ie.x*pe.x+Ie.y*pe.y,ze=ke!==0?1/ke:1/0,Je=2*Math.sqrt(2-2*ke),Tt=ke<Rz&&Y&&J,jt=ae.x*pe.y-ae.y*pe.x>0;if(Tt&&ye>k){const ht=W.dist(Y);if(ht>2*B){const Rt=W.sub(W.sub(Y)._mult(B/ht)._round());this.updateDistance(Y,Rt),this.addCurrentVertex(Rt,ae,0,0,j),Y=Rt}}const wt=Y&&J;let gt=wt?f:T?"butt":g;if(wt&&gt==="round"&&(ze<w?gt="miter":ze<=2&&(gt="fakeround")),gt==="miter"&&ze>x&&(gt="bevel"),gt==="bevel"&&(ze>2&&(gt="flipbevel"),ze<x&&(gt="miter")),Y&&this.updateDistance(Y,W),gt==="miter")Ie._mult(ze),this.addCurrentVertex(W,Ie,0,0,j);else if(gt==="flipbevel"){if(ze>100)Ie=pe.mult(-1);else{const ht=ze*ae.add(pe).mag()/ae.sub(pe).mag();Ie._perp()._mult(ht*(jt?-1:1))}this.addCurrentVertex(W,Ie,0,0,j),this.addCurrentVertex(W,Ie.mult(-1),0,0,j)}else if(gt==="bevel"||gt==="fakeround"){const ht=-Math.sqrt(ze*ze-1),Rt=jt?ht:0,pt=jt?0:ht;if(Y&&this.addCurrentVertex(W,ae,Rt,pt,j),gt==="fakeround"){const rt=Math.round(180*Je/Math.PI/20);for(let en=1;en<rt;en++){let qt=en/rt;if(qt!==.5){const ar=qt-.5;qt+=qt*ar*(qt-1)*((1.0904+be*(be*(3.55645-1.43519*be)-3.2452))*ar*ar+(.848013+be*(.215638*be-1.06021)))}const Tn=pe.sub(ae)._mult(qt)._add(ae)._unit()._mult(jt?-1:1);this.addHalfVertex(W,Tn.x,Tn.y,!1,jt,0,j)}}J&&this.addCurrentVertex(W,pe,-Rt,-pt,j)}else if(gt==="butt")this.addCurrentVertex(W,Ie,0,0,j);else if(gt==="square"){const ht=Y?1:-1;this.addCurrentVertex(W,Ie,ht,ht,j)}else gt==="round"&&(Y&&(this.addCurrentVertex(W,ae,0,0,j),this.addCurrentVertex(W,ae,1,1,j,!0)),J&&(this.addCurrentVertex(W,pe,-1,-1,j,!0),this.addCurrentVertex(W,pe,0,0,j)));if(Tt&&ye<A-1){const ht=W.dist(J);if(ht>2*B){const Rt=W.add(J.sub(W)._mult(B/ht)._round());this.updateDistance(W,Rt),this.addCurrentVertex(Rt,pe,0,0,j),W=Rt}}}}addCurrentVertex(s,u,f,g,x,w=!1){const T=u.y*g-u.x,A=-u.y-u.x*g;this.addHalfVertex(s,u.x+u.y*f,u.y-u.x*f,w,!1,f,x),this.addHalfVertex(s,T,A,w,!0,-g,x),this.distance>BT/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(s,u,f,g,x,w))}addHalfVertex({x:s,y:u},f,g,x,w,T,A){const k=.5*(this.lineClips?this.scaledDistance*(BT-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((s<<1)+(x?1:0),(u<<1)+(w?1:0),Math.round(63*f)+128,Math.round(63*g)+128,1+(T===0?0:T<0?-1:1)|(63&k)<<2,k>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const B=A.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,B),A.primitiveLength++),w?this.e2=B:this.e1=B}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(s,u){this.distance+=s.dist(u),this.updateScaledDistance()}}let UT,VT;kt("LineBucket",r1,{omit:["layers","patternFeatures"]});var jT={get paint(){return VT=VT||new Dr({"line-opacity":new ln(Re.paint_line["line-opacity"]),"line-color":new ln(Re.paint_line["line-color"]),"line-translate":new Xt(Re.paint_line["line-translate"]),"line-translate-anchor":new Xt(Re.paint_line["line-translate-anchor"]),"line-width":new ln(Re.paint_line["line-width"]),"line-gap-width":new ln(Re.paint_line["line-gap-width"]),"line-offset":new ln(Re.paint_line["line-offset"]),"line-blur":new ln(Re.paint_line["line-blur"]),"line-dasharray":new df(Re.paint_line["line-dasharray"]),"line-pattern":new Bc(Re.paint_line["line-pattern"]),"line-gradient":new ff(Re.paint_line["line-gradient"])})},get layout(){return UT=UT||new Dr({"line-cap":new Xt(Re.layout_line["line-cap"]),"line-join":new ln(Re.layout_line["line-join"]),"line-miter-limit":new Xt(Re.layout_line["line-miter-limit"]),"line-round-limit":new Xt(Re.layout_line["line-round-limit"]),"line-sort-key":new ln(Re.layout_line["line-sort-key"])})}};class Oz extends ln{possiblyEvaluate(s,u){return u=new sr(Math.floor(u.zoom),{now:u.now,fadeDuration:u.fadeDuration,zoomHistory:u.zoomHistory,transition:u.transition}),super.possiblyEvaluate(s,u)}evaluate(s,u,f,g){return u=re({},u,{zoom:Math.floor(u.zoom)}),super.evaluate(s,u,f,g)}}let Mg;class Dz extends As{constructor(s){super(s,jT),this.gradientVersion=0,Mg||(Mg=new Oz(jT.paint.properties["line-width"].specification),Mg.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(s){if(s==="line-gradient"){const u=this.gradientExpression();this.stepInterpolant=!!function(f){return f._styleExpression!==void 0}(u)&&u._styleExpression.expression instanceof ca,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(s,u){super.recalculate(s,u),this.paint._values["line-floorwidth"]=Mg.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,s)}createBucket(s){return new r1(s)}queryRadius(s){const u=s,f=$T(bf("line-width",this,u),bf("line-gap-width",this,u)),g=bf("line-offset",this,u);return f/2+Math.abs(g)+Eg(this.paint.get("line-translate"))}queryIntersectsFeature(s,u,f,g,x,w,T){const A=Tg(s,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),w.angle,T),k=T/2*$T(this.paint.get("line-width").evaluate(u,f),this.paint.get("line-gap-width").evaluate(u,f)),B=this.paint.get("line-offset").evaluate(u,f);return B&&(g=function(j,W){const Y=[];for(let J=0;J<j.length;J++){const ae=j[J],pe=[];for(let ye=0;ye<ae.length;ye++){const Ie=ae[ye-1],be=ae[ye],ke=ae[ye+1],ze=ye===0?new S(0,0):be.sub(Ie)._unit()._perp(),Je=ye===ae.length-1?new S(0,0):ke.sub(be)._unit()._perp(),Tt=ze._add(Je)._unit(),jt=Tt.x*Je.x+Tt.y*Je.y;jt!==0&&Tt._mult(1/jt),pe.push(Tt._mult(W)._add(be))}Y.push(pe)}return Y}(g,B*T)),function(j,W,Y){for(let J=0;J<W.length;J++){const ae=W[J];if(j.length>=3){for(let pe=0;pe<ae.length;pe++)if(rh(j,ae[pe]))return!0}if(VD(j,ae,Y))return!0}return!1}(A,g,k)}isTileClipped(){return!0}}function $T(c,s){return s>0?s+2*c:c}const zz=yr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Fz=yr([{name:"a_projected_pos",components:3,type:"Float32"}],4);yr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Nz=yr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);yr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const GT=yr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Bz=yr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Uz(c,s,u){return c.sections.forEach(f=>{f.text=function(g,x,w){const T=x.layout.get("text-transform").evaluate(w,{});return T==="uppercase"?g=g.toLocaleUpperCase():T==="lowercase"&&(g=g.toLocaleLowerCase()),fs.applyArabicShaping&&(g=fs.applyArabicShaping(g)),g}(f.text,s,u)}),c}yr([{name:"triangle",components:3,type:"Uint16"}]),yr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),yr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),yr([{type:"Float32",name:"offsetX"}]),yr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),yr([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Mf={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var ti=24,HT=Xn,WT=function(c,s,u,f,g){var x,w,T=8*g-f-1,A=(1<<T)-1,k=A>>1,B=-7,j=u?g-1:0,W=u?-1:1,Y=c[s+j];for(j+=W,x=Y&(1<<-B)-1,Y>>=-B,B+=T;B>0;x=256*x+c[s+j],j+=W,B-=8);for(w=x&(1<<-B)-1,x>>=-B,B+=f;B>0;w=256*w+c[s+j],j+=W,B-=8);if(x===0)x=1-k;else{if(x===A)return w?NaN:1/0*(Y?-1:1);w+=Math.pow(2,f),x-=k}return(Y?-1:1)*w*Math.pow(2,x-f)},qT=function(c,s,u,f,g,x){var w,T,A,k=8*x-g-1,B=(1<<k)-1,j=B>>1,W=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,Y=f?0:x-1,J=f?1:-1,ae=s<0||s===0&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(T=isNaN(s)?1:0,w=B):(w=Math.floor(Math.log(s)/Math.LN2),s*(A=Math.pow(2,-w))<1&&(w--,A*=2),(s+=w+j>=1?W/A:W*Math.pow(2,1-j))*A>=2&&(w++,A/=2),w+j>=B?(T=0,w=B):w+j>=1?(T=(s*A-1)*Math.pow(2,g),w+=j):(T=s*Math.pow(2,j-1)*Math.pow(2,g),w=0));g>=8;c[u+Y]=255&T,Y+=J,T/=256,g-=8);for(w=w<<g|T,k+=g;k>0;c[u+Y]=255&w,Y+=J,w/=256,k-=8);c[u+Y-J]|=128*ae};function Xn(c){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(c)?c:new Uint8Array(c||0),this.pos=0,this.type=0,this.length=this.buf.length}Xn.Varint=0,Xn.Fixed64=1,Xn.Bytes=2,Xn.Fixed32=5;var i1=4294967296,ZT=1/i1,XT=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Wa(c){return c.type===Xn.Bytes?c.readVarint()+c.pos:c.pos+1}function ah(c,s,u){return u?4294967296*s+(c>>>0):4294967296*(s>>>0)+(c>>>0)}function YT(c,s,u){var f=s<=16383?1:s<=2097151?2:s<=268435455?3:Math.floor(Math.log(s)/(7*Math.LN2));u.realloc(f);for(var g=u.pos-1;g>=c;g--)u.buf[g+f]=u.buf[g]}function Vz(c,s){for(var u=0;u<c.length;u++)s.writeVarint(c[u])}function jz(c,s){for(var u=0;u<c.length;u++)s.writeSVarint(c[u])}function $z(c,s){for(var u=0;u<c.length;u++)s.writeFloat(c[u])}function Gz(c,s){for(var u=0;u<c.length;u++)s.writeDouble(c[u])}function Hz(c,s){for(var u=0;u<c.length;u++)s.writeBoolean(c[u])}function Wz(c,s){for(var u=0;u<c.length;u++)s.writeFixed32(c[u])}function qz(c,s){for(var u=0;u<c.length;u++)s.writeSFixed32(c[u])}function Zz(c,s){for(var u=0;u<c.length;u++)s.writeFixed64(c[u])}function Xz(c,s){for(var u=0;u<c.length;u++)s.writeSFixed64(c[u])}function kg(c,s){return(c[s]|c[s+1]<<8|c[s+2]<<16)+16777216*c[s+3]}function lh(c,s,u){c[u]=s,c[u+1]=s>>>8,c[u+2]=s>>>16,c[u+3]=s>>>24}function KT(c,s){return(c[s]|c[s+1]<<8|c[s+2]<<16)+(c[s+3]<<24)}Xn.prototype={destroy:function(){this.buf=null},readFields:function(c,s,u){for(u=u||this.length;this.pos<u;){var f=this.readVarint(),g=f>>3,x=this.pos;this.type=7&f,c(g,s,this),this.pos===x&&this.skip(f)}return s},readMessage:function(c,s){return this.readFields(c,s,this.readVarint()+this.pos)},readFixed32:function(){var c=kg(this.buf,this.pos);return this.pos+=4,c},readSFixed32:function(){var c=KT(this.buf,this.pos);return this.pos+=4,c},readFixed64:function(){var c=kg(this.buf,this.pos)+kg(this.buf,this.pos+4)*i1;return this.pos+=8,c},readSFixed64:function(){var c=kg(this.buf,this.pos)+KT(this.buf,this.pos+4)*i1;return this.pos+=8,c},readFloat:function(){var c=WT(this.buf,this.pos,!0,23,4);return this.pos+=4,c},readDouble:function(){var c=WT(this.buf,this.pos,!0,52,8);return this.pos+=8,c},readVarint:function(c){var s,u,f=this.buf;return s=127&(u=f[this.pos++]),u<128?s:(s|=(127&(u=f[this.pos++]))<<7,u<128?s:(s|=(127&(u=f[this.pos++]))<<14,u<128?s:(s|=(127&(u=f[this.pos++]))<<21,u<128?s:function(g,x,w){var T,A,k=w.buf;if(T=(112&(A=k[w.pos++]))>>4,A<128||(T|=(127&(A=k[w.pos++]))<<3,A<128)||(T|=(127&(A=k[w.pos++]))<<10,A<128)||(T|=(127&(A=k[w.pos++]))<<17,A<128)||(T|=(127&(A=k[w.pos++]))<<24,A<128)||(T|=(1&(A=k[w.pos++]))<<31,A<128))return ah(g,T,x);throw new Error("Expected varint not more than 10 bytes")}(s|=(15&(u=f[this.pos]))<<28,c,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var c=this.readVarint();return c%2==1?(c+1)/-2:c/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var c=this.readVarint()+this.pos,s=this.pos;return this.pos=c,c-s>=12&&XT?function(u,f,g){return XT.decode(u.subarray(f,g))}(this.buf,s,c):function(u,f,g){for(var x="",w=f;w<g;){var T,A,k,B=u[w],j=null,W=B>239?4:B>223?3:B>191?2:1;if(w+W>g)break;W===1?B<128&&(j=B):W===2?(192&(T=u[w+1]))==128&&(j=(31&B)<<6|63&T)<=127&&(j=null):W===3?(A=u[w+2],(192&(T=u[w+1]))==128&&(192&A)==128&&((j=(15&B)<<12|(63&T)<<6|63&A)<=2047||j>=55296&&j<=57343)&&(j=null)):W===4&&(A=u[w+2],k=u[w+3],(192&(T=u[w+1]))==128&&(192&A)==128&&(192&k)==128&&((j=(15&B)<<18|(63&T)<<12|(63&A)<<6|63&k)<=65535||j>=1114112)&&(j=null)),j===null?(j=65533,W=1):j>65535&&(j-=65536,x+=String.fromCharCode(j>>>10&1023|55296),j=56320|1023&j),x+=String.fromCharCode(j),w+=W}return x}(this.buf,s,c)},readBytes:function(){var c=this.readVarint()+this.pos,s=this.buf.subarray(this.pos,c);return this.pos=c,s},readPackedVarint:function(c,s){if(this.type!==Xn.Bytes)return c.push(this.readVarint(s));var u=Wa(this);for(c=c||[];this.pos<u;)c.push(this.readVarint(s));return c},readPackedSVarint:function(c){if(this.type!==Xn.Bytes)return c.push(this.readSVarint());var s=Wa(this);for(c=c||[];this.pos<s;)c.push(this.readSVarint());return c},readPackedBoolean:function(c){if(this.type!==Xn.Bytes)return c.push(this.readBoolean());var s=Wa(this);for(c=c||[];this.pos<s;)c.push(this.readBoolean());return c},readPackedFloat:function(c){if(this.type!==Xn.Bytes)return c.push(this.readFloat());var s=Wa(this);for(c=c||[];this.pos<s;)c.push(this.readFloat());return c},readPackedDouble:function(c){if(this.type!==Xn.Bytes)return c.push(this.readDouble());var s=Wa(this);for(c=c||[];this.pos<s;)c.push(this.readDouble());return c},readPackedFixed32:function(c){if(this.type!==Xn.Bytes)return c.push(this.readFixed32());var s=Wa(this);for(c=c||[];this.pos<s;)c.push(this.readFixed32());return c},readPackedSFixed32:function(c){if(this.type!==Xn.Bytes)return c.push(this.readSFixed32());var s=Wa(this);for(c=c||[];this.pos<s;)c.push(this.readSFixed32());return c},readPackedFixed64:function(c){if(this.type!==Xn.Bytes)return c.push(this.readFixed64());var s=Wa(this);for(c=c||[];this.pos<s;)c.push(this.readFixed64());return c},readPackedSFixed64:function(c){if(this.type!==Xn.Bytes)return c.push(this.readSFixed64());var s=Wa(this);for(c=c||[];this.pos<s;)c.push(this.readSFixed64());return c},skip:function(c){var s=7&c;if(s===Xn.Varint)for(;this.buf[this.pos++]>127;);else if(s===Xn.Bytes)this.pos=this.readVarint()+this.pos;else if(s===Xn.Fixed32)this.pos+=4;else{if(s!==Xn.Fixed64)throw new Error("Unimplemented type: "+s);this.pos+=8}},writeTag:function(c,s){this.writeVarint(c<<3|s)},realloc:function(c){for(var s=this.length||16;s<this.pos+c;)s*=2;if(s!==this.length){var u=new Uint8Array(s);u.set(this.buf),this.buf=u,this.length=s}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(c){this.realloc(4),lh(this.buf,c,this.pos),this.pos+=4},writeSFixed32:function(c){this.realloc(4),lh(this.buf,c,this.pos),this.pos+=4},writeFixed64:function(c){this.realloc(8),lh(this.buf,-1&c,this.pos),lh(this.buf,Math.floor(c*ZT),this.pos+4),this.pos+=8},writeSFixed64:function(c){this.realloc(8),lh(this.buf,-1&c,this.pos),lh(this.buf,Math.floor(c*ZT),this.pos+4),this.pos+=8},writeVarint:function(c){(c=+c||0)>268435455||c<0?function(s,u){var f,g;if(s>=0?(f=s%4294967296|0,g=s/4294967296|0):(g=~(-s/4294967296),4294967295^(f=~(-s%4294967296))?f=f+1|0:(f=0,g=g+1|0)),s>=18446744073709552e3||s<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),function(x,w,T){T.buf[T.pos++]=127&x|128,x>>>=7,T.buf[T.pos++]=127&x|128,x>>>=7,T.buf[T.pos++]=127&x|128,x>>>=7,T.buf[T.pos++]=127&x|128,T.buf[T.pos]=127&(x>>>=7)}(f,0,u),function(x,w){var T=(7&x)<<4;w.buf[w.pos++]|=T|((x>>>=3)?128:0),x&&(w.buf[w.pos++]=127&x|((x>>>=7)?128:0),x&&(w.buf[w.pos++]=127&x|((x>>>=7)?128:0),x&&(w.buf[w.pos++]=127&x|((x>>>=7)?128:0),x&&(w.buf[w.pos++]=127&x|((x>>>=7)?128:0),x&&(w.buf[w.pos++]=127&x)))))}(g,u)}(c,this):(this.realloc(4),this.buf[this.pos++]=127&c|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=c>>>7&127))))},writeSVarint:function(c){this.writeVarint(c<0?2*-c-1:2*c)},writeBoolean:function(c){this.writeVarint(!!c)},writeString:function(c){c=String(c),this.realloc(4*c.length),this.pos++;var s=this.pos;this.pos=function(f,g,x){for(var w,T,A=0;A<g.length;A++){if((w=g.charCodeAt(A))>55295&&w<57344){if(!T){w>56319||A+1===g.length?(f[x++]=239,f[x++]=191,f[x++]=189):T=w;continue}if(w<56320){f[x++]=239,f[x++]=191,f[x++]=189,T=w;continue}w=T-55296<<10|w-56320|65536,T=null}else T&&(f[x++]=239,f[x++]=191,f[x++]=189,T=null);w<128?f[x++]=w:(w<2048?f[x++]=w>>6|192:(w<65536?f[x++]=w>>12|224:(f[x++]=w>>18|240,f[x++]=w>>12&63|128),f[x++]=w>>6&63|128),f[x++]=63&w|128)}return x}(this.buf,c,this.pos);var u=this.pos-s;u>=128&&YT(s,u,this),this.pos=s-1,this.writeVarint(u),this.pos+=u},writeFloat:function(c){this.realloc(4),qT(this.buf,c,this.pos,!0,23,4),this.pos+=4},writeDouble:function(c){this.realloc(8),qT(this.buf,c,this.pos,!0,52,8),this.pos+=8},writeBytes:function(c){var s=c.length;this.writeVarint(s),this.realloc(s);for(var u=0;u<s;u++)this.buf[this.pos++]=c[u]},writeRawMessage:function(c,s){this.pos++;var u=this.pos;c(s,this);var f=this.pos-u;f>=128&&YT(u,f,this),this.pos=u-1,this.writeVarint(f),this.pos+=f},writeMessage:function(c,s,u){this.writeTag(c,Xn.Bytes),this.writeRawMessage(s,u)},writePackedVarint:function(c,s){s.length&&this.writeMessage(c,Vz,s)},writePackedSVarint:function(c,s){s.length&&this.writeMessage(c,jz,s)},writePackedBoolean:function(c,s){s.length&&this.writeMessage(c,Hz,s)},writePackedFloat:function(c,s){s.length&&this.writeMessage(c,$z,s)},writePackedDouble:function(c,s){s.length&&this.writeMessage(c,Gz,s)},writePackedFixed32:function(c,s){s.length&&this.writeMessage(c,Wz,s)},writePackedSFixed32:function(c,s){s.length&&this.writeMessage(c,qz,s)},writePackedFixed64:function(c,s){s.length&&this.writeMessage(c,Zz,s)},writePackedSFixed64:function(c,s){s.length&&this.writeMessage(c,Xz,s)},writeBytesField:function(c,s){this.writeTag(c,Xn.Bytes),this.writeBytes(s)},writeFixed32Field:function(c,s){this.writeTag(c,Xn.Fixed32),this.writeFixed32(s)},writeSFixed32Field:function(c,s){this.writeTag(c,Xn.Fixed32),this.writeSFixed32(s)},writeFixed64Field:function(c,s){this.writeTag(c,Xn.Fixed64),this.writeFixed64(s)},writeSFixed64Field:function(c,s){this.writeTag(c,Xn.Fixed64),this.writeSFixed64(s)},writeVarintField:function(c,s){this.writeTag(c,Xn.Varint),this.writeVarint(s)},writeSVarintField:function(c,s){this.writeTag(c,Xn.Varint),this.writeSVarint(s)},writeStringField:function(c,s){this.writeTag(c,Xn.Bytes),this.writeString(s)},writeFloatField:function(c,s){this.writeTag(c,Xn.Fixed32),this.writeFloat(s)},writeDoubleField:function(c,s){this.writeTag(c,Xn.Fixed64),this.writeDouble(s)},writeBooleanField:function(c,s){this.writeVarintField(c,!!s)}};var s1=m(HT);const o1=3;function Yz(c,s,u){c===1&&u.readMessage(Kz,s)}function Kz(c,s,u){if(c===3){const{id:f,bitmap:g,width:x,height:w,left:T,top:A,advance:k}=u.readMessage(Jz,{});s.push({id:f,bitmap:new Ef({width:x+2*o1,height:w+2*o1},g),metrics:{width:x,height:w,left:T,top:A,advance:k}})}}function Jz(c,s,u){c===1?s.id=u.readVarint():c===2?s.bitmap=u.readBytes():c===3?s.width=u.readVarint():c===4?s.height=u.readVarint():c===5?s.left=u.readSVarint():c===6?s.top=u.readSVarint():c===7&&(s.advance=u.readVarint())}const JT=o1;function QT(c){let s=0,u=0;for(const w of c)s+=w.w*w.h,u=Math.max(u,w.w);c.sort((w,T)=>T.h-w.h);const f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(s/.95)),u),h:1/0}];let g=0,x=0;for(const w of c)for(let T=f.length-1;T>=0;T--){const A=f[T];if(!(w.w>A.w||w.h>A.h)){if(w.x=A.x,w.y=A.y,x=Math.max(x,w.y+w.h),g=Math.max(g,w.x+w.w),w.w===A.w&&w.h===A.h){const k=f.pop();T<f.length&&(f[T]=k)}else w.h===A.h?(A.x+=w.w,A.w-=w.w):w.w===A.w?(A.y+=w.h,A.h-=w.h):(f.push({x:A.x+w.w,y:A.y,w:A.w-w.w,h:w.h}),A.y+=w.h,A.h-=w.h);break}}return{w:g,h:x,fill:s/(g*x)||0}}const ms=1;class a1{constructor(s,{pixelRatio:u,version:f,stretchX:g,stretchY:x,content:w}){this.paddedRect=s,this.pixelRatio=u,this.stretchX=g,this.stretchY=x,this.content=w,this.version=f}get tl(){return[this.paddedRect.x+ms,this.paddedRect.y+ms]}get br(){return[this.paddedRect.x+this.paddedRect.w-ms,this.paddedRect.y+this.paddedRect.h-ms]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*ms)/this.pixelRatio,(this.paddedRect.h-2*ms)/this.pixelRatio]}}class eS{constructor(s,u){const f={},g={};this.haveRenderCallbacks=[];const x=[];this.addImages(s,f,x),this.addImages(u,g,x);const{w,h:T}=QT(x),A=new js({width:w||1,height:T||1});for(const k in s){const B=s[k],j=f[k].paddedRect;js.copy(B.data,A,{x:0,y:0},{x:j.x+ms,y:j.y+ms},B.data)}for(const k in u){const B=u[k],j=g[k].paddedRect,W=j.x+ms,Y=j.y+ms,J=B.data.width,ae=B.data.height;js.copy(B.data,A,{x:0,y:0},{x:W,y:Y},B.data),js.copy(B.data,A,{x:0,y:ae-1},{x:W,y:Y-1},{width:J,height:1}),js.copy(B.data,A,{x:0,y:0},{x:W,y:Y+ae},{width:J,height:1}),js.copy(B.data,A,{x:J-1,y:0},{x:W-1,y:Y},{width:1,height:ae}),js.copy(B.data,A,{x:0,y:0},{x:W+J,y:Y},{width:1,height:ae})}this.image=A,this.iconPositions=f,this.patternPositions=g}addImages(s,u,f){for(const g in s){const x=s[g],w={x:0,y:0,w:x.data.width+2*ms,h:x.data.height+2*ms};f.push(w),u[g]=new a1(w,x),x.hasRenderCallback&&this.haveRenderCallbacks.push(g)}}patchUpdatedImages(s,u){s.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const f in s.updatedImages)this.patchUpdatedImage(this.iconPositions[f],s.getImage(f),u),this.patchUpdatedImage(this.patternPositions[f],s.getImage(f),u)}patchUpdatedImage(s,u,f){if(!s||!u||s.version===u.version)return;s.version=u.version;const[g,x]=s.tl;f.update(u.data,void 0,{x:g,y:x})}}var Dl;kt("ImagePosition",a1),kt("ImageAtlas",eS),l.WritingMode=void 0,(Dl=l.WritingMode||(l.WritingMode={}))[Dl.none=0]="none",Dl[Dl.horizontal=1]="horizontal",Dl[Dl.vertical=2]="vertical",Dl[Dl.horizontalOnly=3]="horizontalOnly";const kf=-17;class Lf{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(s,u){const f=new Lf;return f.scale=s||1,f.fontStack=u,f}static forImage(s){const u=new Lf;return u.imageName=s,u}}class ch{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(s,u){const f=new ch;for(let g=0;g<s.sections.length;g++){const x=s.sections[g];x.image?f.addImageSection(x):f.addTextSection(x,u)}return f}length(){return this.text.length}getSection(s){return this.sections[this.sectionIndex[s]]}getSectionIndex(s){return this.sectionIndex[s]}getCharCode(s){return this.text.charCodeAt(s)}verticalizePunctuation(){this.text=function(s){let u="";for(let f=0;f<s.length;f++){const g=s.charCodeAt(f+1)||null,x=s.charCodeAt(f-1)||null;u+=g&&dg(g)&&!Mf[s[f+1]]||x&&dg(x)&&!Mf[s[f-1]]||!Mf[s[f]]?s[f]:Mf[s[f]]}return u}(this.text)}trim(){let s=0;for(let f=0;f<this.text.length&&Rg[this.text.charCodeAt(f)];f++)s++;let u=this.text.length;for(let f=this.text.length-1;f>=0&&f>=s&&Rg[this.text.charCodeAt(f)];f--)u--;this.text=this.text.substring(s,u),this.sectionIndex=this.sectionIndex.slice(s,u)}substring(s,u){const f=new ch;return f.text=this.text.substring(s,u),f.sectionIndex=this.sectionIndex.slice(s,u),f.sections=this.sections,f}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((s,u)=>Math.max(s,this.sections[u].scale),0)}addTextSection(s,u){this.text+=s.text,this.sections.push(Lf.forText(s.scale,s.fontStack||u));const f=this.sections.length-1;for(let g=0;g<s.text.length;++g)this.sectionIndex.push(f)}addImageSection(s){const u=s.image?s.image.name:"";if(u.length===0)return void Be("Can't add FormattedSection with an empty image.");const f=this.getNextImageSectionCharCode();f?(this.text+=String.fromCharCode(f),this.sections.push(Lf.forImage(u)),this.sectionIndex.push(this.sections.length-1)):Be("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Lg(c,s,u,f,g,x,w,T,A,k,B,j,W,Y,J,ae){const pe=ch.fromFeature(c,g);let ye;j===l.WritingMode.vertical&&pe.verticalizePunctuation();const{processBidirectionalText:Ie,processStyledBidirectionalText:be}=fs;if(Ie&&pe.sections.length===1){ye=[];const Je=Ie(pe.toString(),l1(pe,k,x,s,f,Y,J));for(const Tt of Je){const jt=new ch;jt.text=Tt,jt.sections=pe.sections;for(let wt=0;wt<Tt.length;wt++)jt.sectionIndex.push(0);ye.push(jt)}}else if(be){ye=[];const Je=be(pe.text,pe.sectionIndex,l1(pe,k,x,s,f,Y,J));for(const Tt of Je){const jt=new ch;jt.text=Tt[0],jt.sectionIndex=Tt[1],jt.sections=pe.sections,ye.push(jt)}}else ye=function(Je,Tt){const jt=[],wt=Je.text;let gt=0;for(const ht of Tt)jt.push(Je.substring(gt,ht)),gt=ht;return gt<wt.length&&jt.push(Je.substring(gt,wt.length)),jt}(pe,l1(pe,k,x,s,f,Y,J));const ke=[],ze={positionedLines:ke,text:pe.toString(),top:B[1],bottom:B[1],left:B[0],right:B[0],writingMode:j,iconsInText:!1,verticalizable:!1};return function(Je,Tt,jt,wt,gt,ht,Rt,pt,rt,en,qt,Tn){let ar=0,pr=kf,ni=0,Ms=0;const Yi=pt==="right"?1:pt==="left"?0:.5;let Gr=0;for(const ri of gt){ri.trim();const ii=ri.getMaxScale(),Oi=(ii-1)*ti,Qi={positionedGlyphs:[],lineOffset:0};Je.positionedLines[Gr]=Qi;const Di=Qi.positionedGlyphs;let gs=0;if(!ri.length()){pr+=ht,++Gr;continue}for(let si=0;si<ri.length();si++){const Mn=ri.getSection(si),zi=ri.getSectionIndex(si),Si=ri.getCharCode(si);let oi=0,xo=null,Go=null,Ho=null,qa=ti;const bo=!(rt===l.WritingMode.horizontal||!qt&&!rf(Si)||qt&&(Rg[Si]||(mi=Si,Et.Arabic(mi)||Et["Arabic Supplement"](mi)||Et["Arabic Extended-A"](mi)||Et["Arabic Presentation Forms-A"](mi)||Et["Arabic Presentation Forms-B"](mi))));if(Mn.imageName){const Gs=wt[Mn.imageName];if(!Gs)continue;Ho=Mn.imageName,Je.iconsInText=Je.iconsInText||!0,Go=Gs.paddedRect;const _s=Gs.displaySize;Mn.scale=Mn.scale*ti/Tn,xo={width:_s[0],height:_s[1],left:ms,top:-JT,advance:bo?_s[1]:_s[0]},oi=Oi+(ti-_s[1]*Mn.scale),qa=xo.advance;const Za=bo?_s[0]*Mn.scale-ti*ii:_s[1]*Mn.scale-ti*ii;Za>0&&Za>gs&&(gs=Za)}else{const Gs=jt[Mn.fontStack],_s=Gs&&Gs[Si];if(_s&&_s.rect)Go=_s.rect,xo=_s.metrics;else{const Za=Tt[Mn.fontStack],Ff=Za&&Za[Si];if(!Ff)continue;xo=Ff.metrics}oi=(ii-Mn.scale)*ti}bo?(Je.verticalizable=!0,Di.push({glyph:Si,imageName:Ho,x:ar,y:pr+oi,vertical:bo,scale:Mn.scale,fontStack:Mn.fontStack,sectionIndex:zi,metrics:xo,rect:Go}),ar+=qa*Mn.scale+en):(Di.push({glyph:Si,imageName:Ho,x:ar,y:pr+oi,vertical:bo,scale:Mn.scale,fontStack:Mn.fontStack,sectionIndex:zi,metrics:xo,rect:Go}),ar+=xo.advance*Mn.scale+en)}Di.length!==0&&(ni=Math.max(ar-en,ni),t4(Di,0,Di.length-1,Yi,gs)),ar=0;const ys=ht*ii+gs;Qi.lineOffset=Math.max(gs,Oi),pr+=ys,Ms=Math.max(ys,Ms),++Gr}var mi;const Ti=pr-kf,{horizontalAlign:Ki,verticalAlign:Ji}=c1(Rt);(function(ri,ii,Oi,Qi,Di,gs,ys,si,Mn){const zi=(ii-Oi)*Di;let Si=0;Si=gs!==ys?-si*Qi-kf:(-Qi*Mn+.5)*ys;for(const oi of ri)for(const xo of oi.positionedGlyphs)xo.x+=zi,xo.y+=Si})(Je.positionedLines,Yi,Ki,Ji,ni,Ms,ht,Ti,gt.length),Je.top+=-Ji*Ti,Je.bottom=Je.top+Ti,Je.left+=-Ki*ni,Je.right=Je.left+ni}(ze,s,u,f,ye,w,T,A,j,k,W,ae),!function(Je){for(const Tt of Je)if(Tt.positionedGlyphs.length!==0)return!1;return!0}(ke)&&ze}const Rg={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Qz={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function tS(c,s,u,f,g,x){if(s.imageName){const w=f[s.imageName];return w?w.displaySize[0]*s.scale*ti/x+g:0}{const w=u[s.fontStack],T=w&&w[c];return T?T.metrics.advance*s.scale+g:0}}function nS(c,s,u,f){const g=Math.pow(c-s,2);return f?c<s?g/2:2*g:g+Math.abs(u)*u}function e4(c,s,u){let f=0;return c===10&&(f-=1e4),u&&(f+=150),c!==40&&c!==65288||(f+=50),s!==41&&s!==65289||(f+=50),f}function rS(c,s,u,f,g,x){let w=null,T=nS(s,u,g,x);for(const A of f){const k=nS(s-A.x,u,g,x)+A.badness;k<=T&&(w=A,T=k)}return{index:c,x:s,priorBreak:w,badness:T}}function iS(c){return c?iS(c.priorBreak).concat(c.index):[]}function l1(c,s,u,f,g,x,w){if(x!=="point")return[];if(!c)return[];const T=[],A=function(W,Y,J,ae,pe,ye){let Ie=0;for(let be=0;be<W.length();be++){const ke=W.getSection(be);Ie+=tS(W.getCharCode(be),ke,ae,pe,Y,ye)}return Ie/Math.max(1,Math.ceil(Ie/J))}(c,s,u,f,g,w),k=c.text.indexOf("​")>=0;let B=0;for(let W=0;W<c.length();W++){const Y=c.getSection(W),J=c.getCharCode(W);if(Rg[J]||(B+=tS(J,Y,f,g,s,w)),W<c.length()-1){const ae=!((j=J)<11904||!(Et["Bopomofo Extended"](j)||Et.Bopomofo(j)||Et["CJK Compatibility Forms"](j)||Et["CJK Compatibility Ideographs"](j)||Et["CJK Compatibility"](j)||Et["CJK Radicals Supplement"](j)||Et["CJK Strokes"](j)||Et["CJK Symbols and Punctuation"](j)||Et["CJK Unified Ideographs Extension A"](j)||Et["CJK Unified Ideographs"](j)||Et["Enclosed CJK Letters and Months"](j)||Et["Halfwidth and Fullwidth Forms"](j)||Et.Hiragana(j)||Et["Ideographic Description Characters"](j)||Et["Kangxi Radicals"](j)||Et["Katakana Phonetic Extensions"](j)||Et.Katakana(j)||Et["Vertical Forms"](j)||Et["Yi Radicals"](j)||Et["Yi Syllables"](j)));(Qz[J]||ae||Y.imageName)&&T.push(rS(W+1,B,A,T,e4(J,c.getCharCode(W+1),ae&&k),!1))}}var j;return iS(rS(c.length(),B,A,T,0,!0))}function c1(c){let s=.5,u=.5;switch(c){case"right":case"top-right":case"bottom-right":s=1;break;case"left":case"top-left":case"bottom-left":s=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:s,verticalAlign:u}}function t4(c,s,u,f,g){if(!f&&!g)return;const x=c[u],w=(c[u].x+x.metrics.advance*x.scale)*f;for(let T=s;T<=u;T++)c[T].x-=w,c[T].y+=g}function n4(c,s,u){const{horizontalAlign:f,verticalAlign:g}=c1(u),x=s[0]-c.displaySize[0]*f,w=s[1]-c.displaySize[1]*g;return{image:c,top:w,bottom:w+c.displaySize[1],left:x,right:x+c.displaySize[0]}}function sS(c,s,u,f,g,x){const w=c.image;let T;if(w.content){const pe=w.content,ye=w.pixelRatio||1;T=[pe[0]/ye,pe[1]/ye,w.displaySize[0]-pe[2]/ye,w.displaySize[1]-pe[3]/ye]}const A=s.left*x,k=s.right*x;let B,j,W,Y;u==="width"||u==="both"?(Y=g[0]+A-f[3],j=g[0]+k+f[1]):(Y=g[0]+(A+k-w.displaySize[0])/2,j=Y+w.displaySize[0]);const J=s.top*x,ae=s.bottom*x;return u==="height"||u==="both"?(B=g[1]+J-f[0],W=g[1]+ae+f[2]):(B=g[1]+(J+ae-w.displaySize[1])/2,W=B+w.displaySize[1]),{image:w,top:B,right:j,bottom:W,left:Y,collisionPadding:T}}const Rf=255,pa=128,zl=Rf*pa;function oS(c,s){const{expression:u}=s;if(u.kind==="constant")return{kind:"constant",layoutSize:u.evaluate(new sr(c+1))};if(u.kind==="source")return{kind:"source"};{const{zoomStops:f,interpolationType:g}=u;let x=0;for(;x<f.length&&f[x]<=c;)x++;x=Math.max(0,x-1);let w=x;for(;w<f.length&&f[w]<c+1;)w++;w=Math.min(f.length-1,w);const T=f[x],A=f[w];return u.kind==="composite"?{kind:"composite",minZoom:T,maxZoom:A,interpolationType:g}:{kind:"camera",minZoom:T,maxZoom:A,minSize:u.evaluate(new sr(T)),maxSize:u.evaluate(new sr(A)),interpolationType:g}}}function u1(c,s,u){let f="never";const g=c.get(s);return g?f=g:c.get(u)&&(f="always"),f}const r4=Ol.VectorTileFeature.types,i4=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Og(c,s,u,f,g,x,w,T,A,k,B,j,W){const Y=T?Math.min(zl,Math.round(T[0])):0,J=T?Math.min(zl,Math.round(T[1])):0;c.emplaceBack(s,u,Math.round(32*f),Math.round(32*g),x,w,(Y<<1)+(A?1:0),J,16*k,16*B,256*j,256*W)}function h1(c,s,u){c.emplaceBack(s.x,s.y,u),c.emplaceBack(s.x,s.y,u),c.emplaceBack(s.x,s.y,u),c.emplaceBack(s.x,s.y,u)}function s4(c){for(const s of c.sections)if(Fv(s.text))return!0;return!1}class d1{constructor(s){this.layoutVertexArray=new Pn,this.indexArray=new fi,this.programConfigurations=s,this.segments=new or,this.dynamicLayoutVertexArray=new vn,this.opacityVertexArray=new In,this.hasVisibleVertices=!1,this.placedSymbolArray=new Pe}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(s,u,f,g){this.isEmpty()||(f&&(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,zz.members),this.indexBuffer=s.createIndexBuffer(this.indexArray,u),this.dynamicLayoutVertexBuffer=s.createVertexBuffer(this.dynamicLayoutVertexArray,Fz.members,!0),this.opacityVertexBuffer=s.createVertexBuffer(this.opacityVertexArray,i4,!0),this.opacityVertexBuffer.itemSize=1),(f||g)&&this.programConfigurations.upload(s))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}kt("SymbolBuffers",d1);class f1{constructor(s,u,f){this.layoutVertexArray=new s,this.layoutAttributes=u,this.indexArray=new f,this.segments=new or,this.collisionVertexArray=new tr}upload(s){this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=s.createVertexBuffer(this.collisionVertexArray,Nz.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}kt("CollisionBuffers",f1);class uh{constructor(s){this.collisionBoxArray=s.collisionBoxArray,this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(w=>w.id),this.index=s.index,this.pixelRatio=s.pixelRatio,this.sourceLayerIndex=s.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Gv([]),this.placementViewportMatrix=Gv([]);const u=this.layers[0]._unevaluatedLayout._values;this.textSizeData=oS(this.zoom,u["text-size"]),this.iconSizeData=oS(this.zoom,u["icon-size"]);const f=this.layers[0].layout,g=f.get("symbol-sort-key"),x=f.get("symbol-z-order");this.canOverlap=u1(f,"text-overlap","text-allow-overlap")!=="never"||u1(f,"icon-overlap","icon-allow-overlap")!=="never"||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey=x!=="viewport-y"&&!g.isConstant(),this.sortFeaturesByY=(x==="viewport-y"||x==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,f.get("symbol-placement")==="point"&&(this.writingModes=f.get("text-writing-mode").map(w=>l.WritingMode[w])),this.stateDependentLayerIds=this.layers.filter(w=>w.isStateDependent()).map(w=>w.id),this.sourceID=s.sourceID}createArrays(){this.text=new d1(new $o(this.layers,this.zoom,s=>/^text/.test(s))),this.icon=new d1(new $o(this.layers,this.zoom,s=>/^icon/.test(s))),this.glyphOffsetArray=new Ae,this.lineVertexArray=new Ue,this.symbolInstances=new me,this.textAnchorOffsets=new Xe}calculateGlyphDependencies(s,u,f,g,x){for(let w=0;w<s.length;w++)if(u[s.charCodeAt(w)]=!0,(f||g)&&x){const T=Mf[s.charAt(w)];T&&(u[T.charCodeAt(0)]=!0)}}populate(s,u,f){const g=this.layers[0],x=g.layout,w=x.get("text-font"),T=x.get("text-field"),A=x.get("icon-image"),k=(T.value.kind!=="constant"||T.value.value instanceof ir&&!T.value.value.isEmpty()||T.value.value.toString().length>0)&&(w.value.kind!=="constant"||w.value.value.length>0),B=A.value.kind!=="constant"||!!A.value.value||Object.keys(A.parameters).length>0,j=x.get("symbol-sort-key");if(this.features=[],!k&&!B)return;const W=u.iconDependencies,Y=u.glyphDependencies,J=u.availableImages,ae=new sr(this.zoom);for(const{feature:pe,id:ye,index:Ie,sourceLayerIndex:be}of s){const ke=g._featureFilter.needGeometry,ze=$c(pe,ke);if(!g._featureFilter.filter(ae,ze,f))continue;let Je,Tt;if(ke||(ze.geometry=jc(pe)),k){const wt=g.getValueAndResolveTokens("text-field",ze,f,J),gt=ir.factory(wt);s4(gt)&&(this.hasRTLText=!0),(!this.hasRTLText||uf()==="unavailable"||this.hasRTLText&&fs.isParsed())&&(Je=Uz(gt,g,ze))}if(B){const wt=g.getValueAndResolveTokens("icon-image",ze,f,J);Tt=wt instanceof Zn?wt:Zn.fromString(wt)}if(!Je&&!Tt)continue;const jt=this.sortFeaturesByKey?j.evaluate(ze,{},f):void 0;if(this.features.push({id:ye,text:Je,icon:Tt,index:Ie,sourceLayerIndex:be,geometry:ze.geometry,properties:pe.properties,type:r4[pe.type],sortKey:jt}),Tt&&(W[Tt.name]=!0),Je){const wt=w.evaluate(ze,{},f).join(","),gt=x.get("text-rotation-alignment")!=="viewport"&&x.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(l.WritingMode.vertical)>=0;for(const ht of Je.sections)if(ht.image)W[ht.image.name]=!0;else{const Rt=tf(Je.toString()),pt=ht.fontStack||wt,rt=Y[pt]=Y[pt]||{};this.calculateGlyphDependencies(ht.text,rt,gt,this.allowVerticalPlacement,Rt)}}}x.get("symbol-placement")==="line"&&(this.features=function(pe){const ye={},Ie={},be=[];let ke=0;function ze(wt){be.push(pe[wt]),ke++}function Je(wt,gt,ht){const Rt=Ie[wt];return delete Ie[wt],Ie[gt]=Rt,be[Rt].geometry[0].pop(),be[Rt].geometry[0]=be[Rt].geometry[0].concat(ht[0]),Rt}function Tt(wt,gt,ht){const Rt=ye[gt];return delete ye[gt],ye[wt]=Rt,be[Rt].geometry[0].shift(),be[Rt].geometry[0]=ht[0].concat(be[Rt].geometry[0]),Rt}function jt(wt,gt,ht){const Rt=ht?gt[0][gt[0].length-1]:gt[0][0];return`${wt}:${Rt.x}:${Rt.y}`}for(let wt=0;wt<pe.length;wt++){const gt=pe[wt],ht=gt.geometry,Rt=gt.text?gt.text.toString():null;if(!Rt){ze(wt);continue}const pt=jt(Rt,ht),rt=jt(Rt,ht,!0);if(pt in Ie&&rt in ye&&Ie[pt]!==ye[rt]){const en=Tt(pt,rt,ht),qt=Je(pt,rt,be[en].geometry);delete ye[pt],delete Ie[rt],Ie[jt(Rt,be[qt].geometry,!0)]=qt,be[en].geometry=null}else pt in Ie?Je(pt,rt,ht):rt in ye?Tt(pt,rt,ht):(ze(wt),ye[pt]=ke-1,Ie[rt]=ke-1)}return be.filter(wt=>wt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((pe,ye)=>pe.sortKey-ye.sortKey)}update(s,u,f){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(s,u,this.layers,f),this.icon.programConfigurations.updatePaintArrays(s,u,this.layers,f))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(s){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(s),this.iconCollisionBox.upload(s)),this.text.upload(s,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(s,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(s,u){const f=this.lineVertexArray.length;if(s.segment!==void 0){let g=s.dist(u[s.segment+1]),x=s.dist(u[s.segment]);const w={};for(let T=s.segment+1;T<u.length;T++)w[T]={x:u[T].x,y:u[T].y,tileUnitDistanceFromAnchor:g},T<u.length-1&&(g+=u[T+1].dist(u[T]));for(let T=s.segment||0;T>=0;T--)w[T]={x:u[T].x,y:u[T].y,tileUnitDistanceFromAnchor:x},T>0&&(x+=u[T-1].dist(u[T]));for(let T=0;T<u.length;T++){const A=w[T];this.lineVertexArray.emplaceBack(A.x,A.y,A.tileUnitDistanceFromAnchor)}}return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}}addSymbols(s,u,f,g,x,w,T,A,k,B,j,W){const Y=s.indexArray,J=s.layoutVertexArray,ae=s.segments.prepareSegment(4*u.length,J,Y,this.canOverlap?w.sortKey:void 0),pe=this.glyphOffsetArray.length,ye=ae.vertexLength,Ie=this.allowVerticalPlacement&&T===l.WritingMode.vertical?Math.PI/2:0,be=w.text&&w.text.sections;for(let ke=0;ke<u.length;ke++){const{tl:ze,tr:Je,bl:Tt,br:jt,tex:wt,pixelOffsetTL:gt,pixelOffsetBR:ht,minFontScaleX:Rt,minFontScaleY:pt,glyphOffset:rt,isSDF:en,sectionIndex:qt}=u[ke],Tn=ae.vertexLength,ar=rt[1];Og(J,A.x,A.y,ze.x,ar+ze.y,wt.x,wt.y,f,en,gt.x,gt.y,Rt,pt),Og(J,A.x,A.y,Je.x,ar+Je.y,wt.x+wt.w,wt.y,f,en,ht.x,gt.y,Rt,pt),Og(J,A.x,A.y,Tt.x,ar+Tt.y,wt.x,wt.y+wt.h,f,en,gt.x,ht.y,Rt,pt),Og(J,A.x,A.y,jt.x,ar+jt.y,wt.x+wt.w,wt.y+wt.h,f,en,ht.x,ht.y,Rt,pt),h1(s.dynamicLayoutVertexArray,A,Ie),Y.emplaceBack(Tn,Tn+1,Tn+2),Y.emplaceBack(Tn+1,Tn+2,Tn+3),ae.vertexLength+=4,ae.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(rt[0]),ke!==u.length-1&&qt===u[ke+1].sectionIndex||s.programConfigurations.populatePaintArrays(J.length,w,w.index,{},W,be&&be[qt])}s.placedSymbolArray.emplaceBack(A.x,A.y,pe,this.glyphOffsetArray.length-pe,ye,k,B,A.segment,f?f[0]:0,f?f[1]:0,g[0],g[1],T,0,!1,0,j)}_addCollisionDebugVertex(s,u,f,g,x,w){return u.emplaceBack(0,0),s.emplaceBack(f.x,f.y,g,x,Math.round(w.x),Math.round(w.y))}addCollisionDebugVertices(s,u,f,g,x,w,T){const A=x.segments.prepareSegment(4,x.layoutVertexArray,x.indexArray),k=A.vertexLength,B=x.layoutVertexArray,j=x.collisionVertexArray,W=T.anchorX,Y=T.anchorY;this._addCollisionDebugVertex(B,j,w,W,Y,new S(s,u)),this._addCollisionDebugVertex(B,j,w,W,Y,new S(f,u)),this._addCollisionDebugVertex(B,j,w,W,Y,new S(f,g)),this._addCollisionDebugVertex(B,j,w,W,Y,new S(s,g)),A.vertexLength+=4;const J=x.indexArray;J.emplaceBack(k,k+1),J.emplaceBack(k+1,k+2),J.emplaceBack(k+2,k+3),J.emplaceBack(k+3,k),A.primitiveLength+=4}addDebugCollisionBoxes(s,u,f,g){for(let x=s;x<u;x++){const w=this.collisionBoxArray.get(x);this.addCollisionDebugVertices(w.x1,w.y1,w.x2,w.y2,g?this.textCollisionBox:this.iconCollisionBox,w.anchorPoint,f)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new f1(Mr,GT.members,Qr),this.iconCollisionBox=new f1(Mr,GT.members,Qr);for(let s=0;s<this.symbolInstances.length;s++){const u=this.symbolInstances.get(s);this.addDebugCollisionBoxes(u.textBoxStartIndex,u.textBoxEndIndex,u,!0),this.addDebugCollisionBoxes(u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u,!0),this.addDebugCollisionBoxes(u.iconBoxStartIndex,u.iconBoxEndIndex,u,!1),this.addDebugCollisionBoxes(u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex,u,!1)}}_deserializeCollisionBoxesForSymbol(s,u,f,g,x,w,T,A,k){const B={};for(let j=u;j<f;j++){const W=s.get(j);B.textBox={x1:W.x1,y1:W.y1,x2:W.x2,y2:W.y2,anchorPointX:W.anchorPointX,anchorPointY:W.anchorPointY},B.textFeatureIndex=W.featureIndex;break}for(let j=g;j<x;j++){const W=s.get(j);B.verticalTextBox={x1:W.x1,y1:W.y1,x2:W.x2,y2:W.y2,anchorPointX:W.anchorPointX,anchorPointY:W.anchorPointY},B.verticalTextFeatureIndex=W.featureIndex;break}for(let j=w;j<T;j++){const W=s.get(j);B.iconBox={x1:W.x1,y1:W.y1,x2:W.x2,y2:W.y2,anchorPointX:W.anchorPointX,anchorPointY:W.anchorPointY},B.iconFeatureIndex=W.featureIndex;break}for(let j=A;j<k;j++){const W=s.get(j);B.verticalIconBox={x1:W.x1,y1:W.y1,x2:W.x2,y2:W.y2,anchorPointX:W.anchorPointX,anchorPointY:W.anchorPointY},B.verticalIconFeatureIndex=W.featureIndex;break}return B}deserializeCollisionBoxes(s){this.collisionArrays=[];for(let u=0;u<this.symbolInstances.length;u++){const f=this.symbolInstances.get(u);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(s,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(s,u){const f=s.placedSymbolArray.get(u),g=f.vertexStartIndex+4*f.numGlyphs;for(let x=f.vertexStartIndex;x<g;x+=4)s.indexArray.emplaceBack(x,x+1,x+2),s.indexArray.emplaceBack(x+1,x+2,x+3)}getSortedSymbolIndexes(s){if(this.sortedAngle===s&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const u=Math.sin(s),f=Math.cos(s),g=[],x=[],w=[];for(let T=0;T<this.symbolInstances.length;++T){w.push(T);const A=this.symbolInstances.get(T);g.push(0|Math.round(u*A.anchorX+f*A.anchorY)),x.push(A.featureIndex)}return w.sort((T,A)=>g[T]-g[A]||x[A]-x[T]),w}addToSortKeyRanges(s,u){const f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===u?f.symbolInstanceEnd=s+1:this.sortKeyRanges.push({sortKey:u,symbolInstanceStart:s,symbolInstanceEnd:s+1})}sortFeatures(s){if(this.sortFeaturesByY&&this.sortedAngle!==s&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(s),this.sortedAngle=s,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const u of this.symbolInstanceIndexes){const f=this.symbolInstances.get(u);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach((g,x,w)=>{g>=0&&w.indexOf(g)===x&&this.addIndicesForPlacedSymbol(this.text,g)}),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,f.verticalPlacedTextSymbolIndex),f.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.placedIconSymbolIndex),f.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let aS,lS;kt("SymbolBucket",uh,{omit:["layers","collisionBoxArray","features","compareText"]}),uh.MAX_GLYPHS=65535,uh.addDynamicAttributes=h1;var p1={get paint(){return lS=lS||new Dr({"icon-opacity":new ln(Re.paint_symbol["icon-opacity"]),"icon-color":new ln(Re.paint_symbol["icon-color"]),"icon-halo-color":new ln(Re.paint_symbol["icon-halo-color"]),"icon-halo-width":new ln(Re.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ln(Re.paint_symbol["icon-halo-blur"]),"icon-translate":new Xt(Re.paint_symbol["icon-translate"]),"icon-translate-anchor":new Xt(Re.paint_symbol["icon-translate-anchor"]),"text-opacity":new ln(Re.paint_symbol["text-opacity"]),"text-color":new ln(Re.paint_symbol["text-color"],{runtimeType:Cr,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new ln(Re.paint_symbol["text-halo-color"]),"text-halo-width":new ln(Re.paint_symbol["text-halo-width"]),"text-halo-blur":new ln(Re.paint_symbol["text-halo-blur"]),"text-translate":new Xt(Re.paint_symbol["text-translate"]),"text-translate-anchor":new Xt(Re.paint_symbol["text-translate-anchor"])})},get layout(){return aS=aS||new Dr({"symbol-placement":new Xt(Re.layout_symbol["symbol-placement"]),"symbol-spacing":new Xt(Re.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Xt(Re.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ln(Re.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Xt(Re.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Xt(Re.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Xt(Re.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Xt(Re.layout_symbol["icon-ignore-placement"]),"icon-optional":new Xt(Re.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Xt(Re.layout_symbol["icon-rotation-alignment"]),"icon-size":new ln(Re.layout_symbol["icon-size"]),"icon-text-fit":new Xt(Re.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Xt(Re.layout_symbol["icon-text-fit-padding"]),"icon-image":new ln(Re.layout_symbol["icon-image"]),"icon-rotate":new ln(Re.layout_symbol["icon-rotate"]),"icon-padding":new ln(Re.layout_symbol["icon-padding"]),"icon-keep-upright":new Xt(Re.layout_symbol["icon-keep-upright"]),"icon-offset":new ln(Re.layout_symbol["icon-offset"]),"icon-anchor":new ln(Re.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Xt(Re.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Xt(Re.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Xt(Re.layout_symbol["text-rotation-alignment"]),"text-field":new ln(Re.layout_symbol["text-field"]),"text-font":new ln(Re.layout_symbol["text-font"]),"text-size":new ln(Re.layout_symbol["text-size"]),"text-max-width":new ln(Re.layout_symbol["text-max-width"]),"text-line-height":new Xt(Re.layout_symbol["text-line-height"]),"text-letter-spacing":new ln(Re.layout_symbol["text-letter-spacing"]),"text-justify":new ln(Re.layout_symbol["text-justify"]),"text-radial-offset":new ln(Re.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Xt(Re.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new ln(Re.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new ln(Re.layout_symbol["text-anchor"]),"text-max-angle":new Xt(Re.layout_symbol["text-max-angle"]),"text-writing-mode":new Xt(Re.layout_symbol["text-writing-mode"]),"text-rotate":new ln(Re.layout_symbol["text-rotate"]),"text-padding":new Xt(Re.layout_symbol["text-padding"]),"text-keep-upright":new Xt(Re.layout_symbol["text-keep-upright"]),"text-transform":new ln(Re.layout_symbol["text-transform"]),"text-offset":new ln(Re.layout_symbol["text-offset"]),"text-allow-overlap":new Xt(Re.layout_symbol["text-allow-overlap"]),"text-overlap":new Xt(Re.layout_symbol["text-overlap"]),"text-ignore-placement":new Xt(Re.layout_symbol["text-ignore-placement"]),"text-optional":new Xt(Re.layout_symbol["text-optional"])})}};class cS{constructor(s){if(s.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=s.property.overrides?s.property.overrides.runtimeType:yn,this.defaultValue=s}evaluate(s){if(s.formattedSection){const u=this.defaultValue.property.overrides;if(u&&u.hasOverride(s.formattedSection))return u.getOverride(s.formattedSection)}return s.feature&&s.featureState?this.defaultValue.evaluate(s.feature,s.featureState):this.defaultValue.property.specification.default}eachChild(s){this.defaultValue.isConstant()||s(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}kt("FormatSectionOverride",cS,{omit:["defaultValue"]});class Dg extends As{constructor(s){super(s,p1)}recalculate(s,u){if(super.recalculate(s,u),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const f=this.layout.get("text-writing-mode");if(f){const g=[];for(const x of f)g.indexOf(x)<0&&g.push(x);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(s,u,f,g){const x=this.layout.get(s).evaluate(u,{},f,g),w=this._unevaluatedLayout._values[s];return w.isDataDriven()||Gu(w.value)||!x?x:function(T,A){return A.replace(/{([^{}]+)}/g,(k,B)=>B in T?String(T[B]):"")}(u.properties,x)}createBucket(s){return new uh(s)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const s of p1.paint.overridableProperties){if(!Dg.hasPaintOverride(this.layout,s))continue;const u=this.paint.get(s),f=new cS(u),g=new Xd(f,u.property.specification);let x=null;x=u.value.kind==="constant"||u.value.kind==="source"?new Yd("source",g):new Wu("composite",g,u.value.zoomStops),this.paint._values[s]=new Li(u.property,x,u.parameters)}}_handleOverridablePaintPropertyUpdate(s,u,f){return!(!this.layout||u.isDataDriven()||f.isDataDriven())&&Dg.hasPaintOverride(this.layout,s)}static hasPaintOverride(s,u){const f=s.get("text-field"),g=p1.paint.properties[u];let x=!1;const w=T=>{for(const A of T)if(g.overrides&&g.overrides.hasOverride(A))return void(x=!0)};if(f.value.kind==="constant"&&f.value.value instanceof ir)w(f.value.value.sections);else if(f.value.kind==="source"){const T=k=>{x||(k instanceof Vs&&Jn(k.value)===xi?w(k.value.sections):k instanceof $u?w(k.sections):k.eachChild(T))},A=f.value;A._styleExpression&&T(A._styleExpression.expression)}return x}}let uS;var o4={get paint(){return uS=uS||new Dr({"background-color":new Xt(Re.paint_background["background-color"]),"background-pattern":new df(Re.paint_background["background-pattern"]),"background-opacity":new Xt(Re.paint_background["background-opacity"])})}};class a4 extends As{constructor(s){super(s,o4)}}let hS;var l4={get paint(){return hS=hS||new Dr({"raster-opacity":new Xt(Re.paint_raster["raster-opacity"]),"raster-hue-rotate":new Xt(Re.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Xt(Re.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Xt(Re.paint_raster["raster-brightness-max"]),"raster-saturation":new Xt(Re.paint_raster["raster-saturation"]),"raster-contrast":new Xt(Re.paint_raster["raster-contrast"]),"raster-resampling":new Xt(Re.paint_raster["raster-resampling"]),"raster-fade-duration":new Xt(Re.paint_raster["raster-fade-duration"])})}};class c4 extends As{constructor(s){super(s,l4)}}class u4 extends As{constructor(s){super(s,{}),this.onAdd=u=>{this.implementation.onAdd&&this.implementation.onAdd(u,u.painter.context.gl)},this.onRemove=u=>{this.implementation.onRemove&&this.implementation.onRemove(u,u.painter.context.gl)},this.implementation=s}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class h4{constructor(s){this._callback=s,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const m1=63710088e-1;class Fl{constructor(s,u){if(isNaN(s)||isNaN(u))throw new Error(`Invalid LngLat object: (${s}, ${u})`);if(this.lng=+s,this.lat=+u,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Fl(te(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(s){const u=Math.PI/180,f=this.lat*u,g=s.lat*u,x=Math.sin(f)*Math.sin(g)+Math.cos(f)*Math.cos(g)*Math.cos((s.lng-this.lng)*u);return m1*Math.acos(Math.min(x,1))}static convert(s){if(s instanceof Fl)return s;if(Array.isArray(s)&&(s.length===2||s.length===3))return new Fl(Number(s[0]),Number(s[1]));if(!Array.isArray(s)&&typeof s=="object"&&s!==null)return new Fl(Number("lng"in s?s.lng:s.lon),Number(s.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const dS=2*Math.PI*m1;function fS(c){return dS*Math.cos(c*Math.PI/180)}function pS(c){return(180+c)/360}function mS(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function gS(c,s){return c/fS(s)}function g1(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}class zg{constructor(s,u,f=0){this.x=+s,this.y=+u,this.z=+f}static fromLngLat(s,u=0){const f=Fl.convert(s);return new zg(pS(f.lng),mS(f.lat),gS(u,f.lat))}toLngLat(){return new Fl(360*this.x-180,g1(this.y))}toAltitude(){return this.z*fS(g1(this.y))}meterInMercatorCoordinateUnits(){return 1/dS*(s=g1(this.y),1/Math.cos(s*Math.PI/180));var s}}function yS(c,s,u){var f=2*Math.PI*6378137/256/Math.pow(2,u);return[c*f-2*Math.PI*6378137/2,s*f-2*Math.PI*6378137/2]}class y1{constructor(s,u,f){if(s<0||s>25||f<0||f>=Math.pow(2,s)||u<0||u>=Math.pow(2,s))throw new Error(`x=${u}, y=${f}, z=${s} outside of bounds. 0<=x<${Math.pow(2,s)}, 0<=y<${Math.pow(2,s)} 0<=z<=25 `);this.z=s,this.x=u,this.y=f,this.key=Of(0,s,s,u,f)}equals(s){return this.z===s.z&&this.x===s.x&&this.y===s.y}url(s,u,f){const g=(w=this.y,T=this.z,A=yS(256*(x=this.x),256*(w=Math.pow(2,T)-w-1),T),k=yS(256*(x+1),256*(w+1),T),A[0]+","+A[1]+","+k[0]+","+k[1]);var x,w,T,A,k;const B=function(j,W,Y){let J,ae="";for(let pe=j;pe>0;pe--)J=1<<pe-1,ae+=(W&J?1:0)+(Y&J?2:0);return ae}(this.z,this.x,this.y);return s[(this.x+this.y)%s.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(f==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,u>1?"@2x":"").replace(/{quadkey}/g,B).replace(/{bbox-epsg-3857}/g,g)}isChildOf(s){const u=this.z-s.z;return u>0&&s.x===this.x>>u&&s.y===this.y>>u}getTilePoint(s){const u=Math.pow(2,this.z);return new S((s.x*u-this.x)*$r,(s.y*u-this.y)*$r)}toString(){return`${this.z}/${this.x}/${this.y}`}}class _S{constructor(s,u){this.wrap=s,this.canonical=u,this.key=Of(s,u.z,u.z,u.x,u.y)}}class $s{constructor(s,u,f,g,x){if(s<f)throw new Error(`overscaledZ should be >= z; overscaledZ = ${s}; z = ${f}`);this.overscaledZ=s,this.wrap=u,this.canonical=new y1(f,+g,+x),this.key=Of(u,s,f,g,x)}clone(){return new $s(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(s){return this.overscaledZ===s.overscaledZ&&this.wrap===s.wrap&&this.canonical.equals(s.canonical)}scaledTo(s){if(s>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${s}; overscaledZ = ${this.overscaledZ}`);const u=this.canonical.z-s;return s>this.canonical.z?new $s(s,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new $s(s,this.wrap,s,this.canonical.x>>u,this.canonical.y>>u)}calculateScaledKey(s,u){if(s>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${s}; overscaledZ = ${this.overscaledZ}`);const f=this.canonical.z-s;return s>this.canonical.z?Of(this.wrap*+u,s,this.canonical.z,this.canonical.x,this.canonical.y):Of(this.wrap*+u,s,s,this.canonical.x>>f,this.canonical.y>>f)}isChildOf(s){if(s.wrap!==this.wrap)return!1;const u=this.canonical.z-s.canonical.z;return s.overscaledZ===0||s.overscaledZ<this.overscaledZ&&s.canonical.x===this.canonical.x>>u&&s.canonical.y===this.canonical.y>>u}children(s){if(this.overscaledZ>=s)return[new $s(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const u=this.canonical.z+1,f=2*this.canonical.x,g=2*this.canonical.y;return[new $s(u,this.wrap,u,f,g),new $s(u,this.wrap,u,f+1,g),new $s(u,this.wrap,u,f,g+1),new $s(u,this.wrap,u,f+1,g+1)]}isLessThan(s){return this.wrap<s.wrap||!(this.wrap>s.wrap)&&(this.overscaledZ<s.overscaledZ||!(this.overscaledZ>s.overscaledZ)&&(this.canonical.x<s.canonical.x||!(this.canonical.x>s.canonical.x)&&this.canonical.y<s.canonical.y))}wrapped(){return new $s(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(s){return new $s(this.overscaledZ,s,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new _S(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(s){return this.canonical.getTilePoint(new zg(s.x-this.wrap,s.y))}}function Of(c,s,u,f,g){(c*=2)<0&&(c=-1*c-1);const x=1<<u;return(x*x*c+x*g+f).toString(36)+u.toString(36)+s.toString(36)}kt("CanonicalTileID",y1),kt("OverscaledTileID",$s,{omit:["posMatrix"]});class vS{constructor(s,u,f,g=1,x=1,w=1,T=0){if(this.uid=s,u.height!==u.width)throw new RangeError("DEM tiles must be square");if(f&&!["mapbox","terrarium","custom"].includes(f))return void Be(`"${f}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=u.height;const A=this.dim=u.height-2;switch(this.data=new Uint32Array(u.data.buffer),f){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=g,this.greenFactor=x,this.blueFactor=w,this.baseShift=T;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let k=0;k<A;k++)this.data[this._idx(-1,k)]=this.data[this._idx(0,k)],this.data[this._idx(A,k)]=this.data[this._idx(A-1,k)],this.data[this._idx(k,-1)]=this.data[this._idx(k,0)],this.data[this._idx(k,A)]=this.data[this._idx(k,A-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(A,-1)]=this.data[this._idx(A-1,0)],this.data[this._idx(-1,A)]=this.data[this._idx(0,A-1)],this.data[this._idx(A,A)]=this.data[this._idx(A-1,A-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let k=0;k<A;k++)for(let B=0;B<A;B++){const j=this.get(k,B);j>this.max&&(this.max=j),j<this.min&&(this.min=j)}}get(s,u){const f=new Uint8Array(this.data.buffer),g=4*this._idx(s,u);return this.unpack(f[g],f[g+1],f[g+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(s,u){if(s<-1||s>=this.dim+1||u<-1||u>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(u+1)*this.stride+(s+1)}unpack(s,u,f){return s*this.redFactor+u*this.greenFactor+f*this.blueFactor-this.baseShift}getPixels(){return new js({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(s,u,f){if(this.dim!==s.dim)throw new Error("dem dimension mismatch");let g=u*this.dim,x=u*this.dim+this.dim,w=f*this.dim,T=f*this.dim+this.dim;switch(u){case-1:g=x-1;break;case 1:x=g+1}switch(f){case-1:w=T-1;break;case 1:T=w+1}const A=-u*this.dim,k=-f*this.dim;for(let B=w;B<T;B++)for(let j=g;j<x;j++)this.data[this._idx(j,B)]=s.data[this._idx(j+A,B+k)]}}kt("DEMData",vS);class xS{constructor(s){this._stringToNumber={},this._numberToString=[];for(let u=0;u<s.length;u++){const f=s[u];this._stringToNumber[f]=u,this._numberToString[u]=f}}encode(s){return this._stringToNumber[s]}decode(s){if(s>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${s} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[s]}}class bS{constructor(s,u,f,g,x){this.type="Feature",this._vectorTileFeature=s,s._z=u,s._x=f,s._y=g,this.properties=s.properties,this.id=x}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(s){this._geometry=s}toJSON(){const s={geometry:this.geometry};for(const u in this)u!=="_geometry"&&u!=="_vectorTileFeature"&&(s[u]=this[u]);return s}}class wS{constructor(s,u){this.tileID=s,this.x=s.canonical.x,this.y=s.canonical.y,this.z=s.canonical.z,this.grid=new Il($r,16,0),this.grid3D=new Il($r,16,0),this.featureIndexArray=new Qe,this.promoteId=u}insert(s,u,f,g,x,w){const T=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,g,x);const A=w?this.grid3D:this.grid;for(let k=0;k<u.length;k++){const B=u[k],j=[1/0,1/0,-1/0,-1/0];for(let W=0;W<B.length;W++){const Y=B[W];j[0]=Math.min(j[0],Y.x),j[1]=Math.min(j[1],Y.y),j[2]=Math.max(j[2],Y.x),j[3]=Math.max(j[3],Y.y)}j[0]<$r&&j[1]<$r&&j[2]>=0&&j[3]>=0&&A.insert(T,j[0],j[1],j[2],j[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Ol.VectorTile(new s1(this.rawTileData)).layers,this.sourceLayerCoder=new xS(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(s,u,f,g){this.loadVTLayers();const x=s.params||{},w=$r/s.tileSize/s.scale,T=Jd(x.filter),A=s.queryGeometry,k=s.queryPadding*w,B=TS(A),j=this.grid.query(B.minX-k,B.minY-k,B.maxX+k,B.maxY+k),W=TS(s.cameraQueryGeometry),Y=this.grid3D.query(W.minX-k,W.minY-k,W.maxX+k,W.maxY+k,(pe,ye,Ie,be)=>function(ke,ze,Je,Tt,jt){for(const gt of ke)if(ze<=gt.x&&Je<=gt.y&&Tt>=gt.x&&jt>=gt.y)return!0;const wt=[new S(ze,Je),new S(ze,jt),new S(Tt,jt),new S(Tt,Je)];if(ke.length>2){for(const gt of wt)if(rh(ke,gt))return!0}for(let gt=0;gt<ke.length-1;gt++)if($D(ke[gt],ke[gt+1],wt))return!0;return!1}(s.cameraQueryGeometry,pe-k,ye-k,Ie+k,be+k));for(const pe of Y)j.push(pe);j.sort(d4);const J={};let ae;for(let pe=0;pe<j.length;pe++){const ye=j[pe];if(ye===ae)continue;ae=ye;const Ie=this.featureIndexArray.get(ye);let be=null;this.loadMatchingFeature(J,Ie.bucketIndex,Ie.sourceLayerIndex,Ie.featureIndex,T,x.layers,x.availableImages,u,f,g,(ke,ze,Je)=>(be||(be=jc(ke)),ze.queryIntersectsFeature(A,ke,Je,be,this.z,s.transform,w,s.pixelPosMatrix)))}return J}loadMatchingFeature(s,u,f,g,x,w,T,A,k,B,j){const W=this.bucketLayerIDs[u];if(w&&!function(pe,ye){for(let Ie=0;Ie<pe.length;Ie++)if(ye.indexOf(pe[Ie])>=0)return!0;return!1}(w,W))return;const Y=this.sourceLayerCoder.decode(f),J=this.vtLayers[Y].feature(g);if(x.needGeometry){const pe=$c(J,!0);if(!x.filter(new sr(this.tileID.overscaledZ),pe,this.tileID.canonical))return}else if(!x.filter(new sr(this.tileID.overscaledZ),J))return;const ae=this.getId(J,Y);for(let pe=0;pe<W.length;pe++){const ye=W[pe];if(w&&w.indexOf(ye)<0)continue;const Ie=A[ye];if(!Ie)continue;let be={};ae&&B&&(be=B.getState(Ie.sourceLayer||"_geojsonTileLayer",ae));const ke=re({},k[ye]);ke.paint=ES(ke.paint,Ie.paint,J,be,T),ke.layout=ES(ke.layout,Ie.layout,J,be,T);const ze=!j||j(J,Ie,be);if(!ze)continue;const Je=new bS(J,this.z,this.x,this.y,ae);Je.layer=ke;let Tt=s[ye];Tt===void 0&&(Tt=s[ye]=[]),Tt.push({featureIndex:g,feature:Je,intersectionZ:ze})}}lookupSymbolFeatures(s,u,f,g,x,w,T,A){const k={};this.loadVTLayers();const B=Jd(x);for(const j of s)this.loadMatchingFeature(k,f,g,j,B,w,T,A,u);return k}hasLayer(s){for(const u of this.bucketLayerIDs)for(const f of u)if(s===f)return!0;return!1}getId(s,u){let f=s.id;return this.promoteId&&(f=s.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[u]],typeof f=="boolean"&&(f=Number(f))),f}}function ES(c,s,u,f,g){return Ee(c,(x,w)=>{const T=s instanceof th?s.get(w):null;return T&&T.evaluate?T.evaluate(u,f,g):T})}function TS(c){let s=1/0,u=1/0,f=-1/0,g=-1/0;for(const x of c)s=Math.min(s,x.x),u=Math.min(u,x.y),f=Math.max(f,x.x),g=Math.max(g,x.y);return{minX:s,minY:u,maxX:f,maxY:g}}function d4(c,s){return s-c}function SS(c,s,u,f,g){const x=[];for(let w=0;w<c.length;w++){const T=c[w];let A;for(let k=0;k<T.length-1;k++){let B=T[k],j=T[k+1];B.x<s&&j.x<s||(B.x<s?B=new S(s,B.y+(s-B.x)/(j.x-B.x)*(j.y-B.y))._round():j.x<s&&(j=new S(s,B.y+(s-B.x)/(j.x-B.x)*(j.y-B.y))._round()),B.y<u&&j.y<u||(B.y<u?B=new S(B.x+(u-B.y)/(j.y-B.y)*(j.x-B.x),u)._round():j.y<u&&(j=new S(B.x+(u-B.y)/(j.y-B.y)*(j.x-B.x),u)._round()),B.x>=f&&j.x>=f||(B.x>=f?B=new S(f,B.y+(f-B.x)/(j.x-B.x)*(j.y-B.y))._round():j.x>=f&&(j=new S(f,B.y+(f-B.x)/(j.x-B.x)*(j.y-B.y))._round()),B.y>=g&&j.y>=g||(B.y>=g?B=new S(B.x+(g-B.y)/(j.y-B.y)*(j.x-B.x),g)._round():j.y>=g&&(j=new S(B.x+(g-B.y)/(j.y-B.y)*(j.x-B.x),g)._round()),A&&B.equals(A[A.length-1])||(A=[B],x.push(A)),A.push(j)))))}}return x}kt("FeatureIndex",wS,{omit:["rawTileData","sourceLayerCoder"]});class Nl extends S{constructor(s,u,f,g){super(s,u),this.angle=f,g!==void 0&&(this.segment=g)}clone(){return new Nl(this.x,this.y,this.angle,this.segment)}}function PS(c,s,u,f,g){if(s.segment===void 0||u===0)return!0;let x=s,w=s.segment+1,T=0;for(;T>-u/2;){if(w--,w<0)return!1;T-=c[w].dist(x),x=c[w]}T+=c[w].dist(c[w+1]),w++;const A=[];let k=0;for(;T<u/2;){const B=c[w],j=c[w+1];if(!j)return!1;let W=c[w-1].angleTo(B)-B.angleTo(j);for(W=Math.abs((W+3*Math.PI)%(2*Math.PI)-Math.PI),A.push({distance:T,angleDelta:W}),k+=W;T-A[0].distance>f;)k-=A.shift().angleDelta;if(k>g)return!1;w++,T+=B.dist(j)}return!0}function CS(c){let s=0;for(let u=0;u<c.length-1;u++)s+=c[u].dist(c[u+1]);return s}function AS(c,s,u){return c?.6*s*u:0}function IS(c,s){return Math.max(c?c.right-c.left:0,s?s.right-s.left:0)}function f4(c,s,u,f,g,x){const w=AS(u,g,x),T=IS(u,f)*x;let A=0;const k=CS(c)/2;for(let B=0;B<c.length-1;B++){const j=c[B],W=c[B+1],Y=j.dist(W);if(A+Y>k){const J=(k-A)/Y,ae=us.number(j.x,W.x,J),pe=us.number(j.y,W.y,J),ye=new Nl(ae,pe,W.angleTo(j),B);return ye._round(),!w||PS(c,ye,T,w,s)?ye:void 0}A+=Y}}function p4(c,s,u,f,g,x,w,T,A){const k=AS(f,x,w),B=IS(f,g),j=B*w,W=c[0].x===0||c[0].x===A||c[0].y===0||c[0].y===A;return s-j<s/4&&(s=j+s/4),MS(c,W?s/2*T%s:(B/2+2*x)*w*T%s,s,k,u,j,W,!1,A)}function MS(c,s,u,f,g,x,w,T,A){const k=x/2,B=CS(c);let j=0,W=s-u,Y=[];for(let J=0;J<c.length-1;J++){const ae=c[J],pe=c[J+1],ye=ae.dist(pe),Ie=pe.angleTo(ae);for(;W+u<j+ye;){W+=u;const be=(W-j)/ye,ke=us.number(ae.x,pe.x,be),ze=us.number(ae.y,pe.y,be);if(ke>=0&&ke<A&&ze>=0&&ze<A&&W-k>=0&&W+k<=B){const Je=new Nl(ke,ze,Ie,J);Je._round(),f&&!PS(c,Je,x,f,g)||Y.push(Je)}}j+=ye}return T||Y.length||w||(Y=MS(c,j/2,u,f,g,x,w,!0,A)),Y}kt("Anchor",Nl);const hh=ms;function kS(c,s,u,f){const g=[],x=c.image,w=x.pixelRatio,T=x.paddedRect.w-2*hh,A=x.paddedRect.h-2*hh,k=c.right-c.left,B=c.bottom-c.top,j=x.stretchX||[[0,T]],W=x.stretchY||[[0,A]],Y=(ht,Rt)=>ht+Rt[1]-Rt[0],J=j.reduce(Y,0),ae=W.reduce(Y,0),pe=T-J,ye=A-ae;let Ie=0,be=J,ke=0,ze=ae,Je=0,Tt=pe,jt=0,wt=ye;if(x.content&&f){const ht=x.content;Ie=Fg(j,0,ht[0]),ke=Fg(W,0,ht[1]),be=Fg(j,ht[0],ht[2]),ze=Fg(W,ht[1],ht[3]),Je=ht[0]-Ie,jt=ht[1]-ke,Tt=ht[2]-ht[0]-be,wt=ht[3]-ht[1]-ze}const gt=(ht,Rt,pt,rt)=>{const en=Ng(ht.stretch-Ie,be,k,c.left),qt=Bg(ht.fixed-Je,Tt,ht.stretch,J),Tn=Ng(Rt.stretch-ke,ze,B,c.top),ar=Bg(Rt.fixed-jt,wt,Rt.stretch,ae),pr=Ng(pt.stretch-Ie,be,k,c.left),ni=Bg(pt.fixed-Je,Tt,pt.stretch,J),Ms=Ng(rt.stretch-ke,ze,B,c.top),Yi=Bg(rt.fixed-jt,wt,rt.stretch,ae),Gr=new S(en,Tn),mi=new S(pr,Tn),Ti=new S(pr,Ms),Ki=new S(en,Ms),Ji=new S(qt/w,ar/w),ri=new S(ni/w,Yi/w),ii=s*Math.PI/180;if(ii){const Di=Math.sin(ii),gs=Math.cos(ii),ys=[gs,-Di,Di,gs];Gr._matMult(ys),mi._matMult(ys),Ki._matMult(ys),Ti._matMult(ys)}const Oi=ht.stretch+ht.fixed,Qi=Rt.stretch+Rt.fixed;return{tl:Gr,tr:mi,bl:Ki,br:Ti,tex:{x:x.paddedRect.x+hh+Oi,y:x.paddedRect.y+hh+Qi,w:pt.stretch+pt.fixed-Oi,h:rt.stretch+rt.fixed-Qi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ji,pixelOffsetBR:ri,minFontScaleX:Tt/w/k,minFontScaleY:wt/w/B,isSDF:u}};if(f&&(x.stretchX||x.stretchY)){const ht=LS(j,pe,J),Rt=LS(W,ye,ae);for(let pt=0;pt<ht.length-1;pt++){const rt=ht[pt],en=ht[pt+1];for(let qt=0;qt<Rt.length-1;qt++)g.push(gt(rt,Rt[qt],en,Rt[qt+1]))}}else g.push(gt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:T+1},{fixed:0,stretch:A+1}));return g}function Fg(c,s,u){let f=0;for(const g of c)f+=Math.max(s,Math.min(u,g[1]))-Math.max(s,Math.min(u,g[0]));return f}function LS(c,s,u){const f=[{fixed:-hh,stretch:0}];for(const[g,x]of c){const w=f[f.length-1];f.push({fixed:g-w.stretch,stretch:w.stretch}),f.push({fixed:g-w.stretch,stretch:w.stretch+(x-g)})}return f.push({fixed:s+hh,stretch:u}),f}function Ng(c,s,u,f){return c/s*u+f}function Bg(c,s,u,f){return c-s*u/f}class Ug{constructor(s,u,f,g,x,w,T,A,k,B){if(this.boxStartIndex=s.length,k){let j=w.top,W=w.bottom;const Y=w.collisionPadding;Y&&(j-=Y[1],W+=Y[3]);let J=W-j;J>0&&(J=Math.max(10,J),this.circleDiameter=J)}else{let j=w.top*T-A[0],W=w.bottom*T+A[2],Y=w.left*T-A[3],J=w.right*T+A[1];const ae=w.collisionPadding;if(ae&&(Y-=ae[0]*T,j-=ae[1]*T,J+=ae[2]*T,W+=ae[3]*T),B){const pe=new S(Y,j),ye=new S(J,j),Ie=new S(Y,W),be=new S(J,W),ke=B*Math.PI/180;pe._rotate(ke),ye._rotate(ke),Ie._rotate(ke),be._rotate(ke),Y=Math.min(pe.x,ye.x,Ie.x,be.x),J=Math.max(pe.x,ye.x,Ie.x,be.x),j=Math.min(pe.y,ye.y,Ie.y,be.y),W=Math.max(pe.y,ye.y,Ie.y,be.y)}s.emplaceBack(u.x,u.y,Y,j,J,W,f,g,x)}this.boxEndIndex=s.length}}class m4{constructor(s=[],u=g4){if(this.data=s,this.length=this.data.length,this.compare=u,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(s){this.data.push(s),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const s=this.data[0],u=this.data.pop();return this.length--,this.length>0&&(this.data[0]=u,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:u,compare:f}=this,g=u[s];for(;s>0;){const x=s-1>>1,w=u[x];if(f(g,w)>=0)break;u[s]=w,s=x}u[s]=g}_down(s){const{data:u,compare:f}=this,g=this.length>>1,x=u[s];for(;s<g;){let w=1+(s<<1),T=u[w];const A=w+1;if(A<this.length&&f(u[A],T)<0&&(w=A,T=u[A]),f(T,x)>=0)break;u[s]=T,s=w}u[s]=x}}function g4(c,s){return c<s?-1:c>s?1:0}function y4(c,s=1,u=!1){let f=1/0,g=1/0,x=-1/0,w=-1/0;const T=c[0];for(let Y=0;Y<T.length;Y++){const J=T[Y];(!Y||J.x<f)&&(f=J.x),(!Y||J.y<g)&&(g=J.y),(!Y||J.x>x)&&(x=J.x),(!Y||J.y>w)&&(w=J.y)}const A=Math.min(x-f,w-g);let k=A/2;const B=new m4([],_4);if(A===0)return new S(f,g);for(let Y=f;Y<x;Y+=A)for(let J=g;J<w;J+=A)B.push(new dh(Y+k,J+k,k,c));let j=function(Y){let J=0,ae=0,pe=0;const ye=Y[0];for(let Ie=0,be=ye.length,ke=be-1;Ie<be;ke=Ie++){const ze=ye[Ie],Je=ye[ke],Tt=ze.x*Je.y-Je.x*ze.y;ae+=(ze.x+Je.x)*Tt,pe+=(ze.y+Je.y)*Tt,J+=3*Tt}return new dh(ae/J,pe/J,0,Y)}(c),W=B.length;for(;B.length;){const Y=B.pop();(Y.d>j.d||!j.d)&&(j=Y,u&&console.log("found best %d after %d probes",Math.round(1e4*Y.d)/1e4,W)),Y.max-j.d<=s||(k=Y.h/2,B.push(new dh(Y.p.x-k,Y.p.y-k,k,c)),B.push(new dh(Y.p.x+k,Y.p.y-k,k,c)),B.push(new dh(Y.p.x-k,Y.p.y+k,k,c)),B.push(new dh(Y.p.x+k,Y.p.y+k,k,c)),W+=4)}return u&&(console.log(`num probes: ${W}`),console.log(`best distance: ${j.d}`)),j.p}function _4(c,s){return s.max-c.max}function dh(c,s,u,f){this.p=new S(c,s),this.h=u,this.d=function(g,x){let w=!1,T=1/0;for(let A=0;A<x.length;A++){const k=x[A];for(let B=0,j=k.length,W=j-1;B<j;W=B++){const Y=k[B],J=k[W];Y.y>g.y!=J.y>g.y&&g.x<(J.x-Y.x)*(g.y-Y.y)/(J.y-Y.y)+Y.x&&(w=!w),T=Math.min(T,mT(g,Y,J))}}return(w?1:-1)*Math.sqrt(T)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}var Ei;l.TextAnchorEnum=void 0,(Ei=l.TextAnchorEnum||(l.TextAnchorEnum={}))[Ei.center=1]="center",Ei[Ei.left=2]="left",Ei[Ei.right=3]="right",Ei[Ei.top=4]="top",Ei[Ei.bottom=5]="bottom",Ei[Ei["top-left"]=6]="top-left",Ei[Ei["top-right"]=7]="top-right",Ei[Ei["bottom-left"]=8]="bottom-left",Ei[Ei["bottom-right"]=9]="bottom-right";const Bl=7,_1=Number.POSITIVE_INFINITY;function RS(c,s){return s[1]!==_1?function(u,f,g){let x=0,w=0;switch(f=Math.abs(f),g=Math.abs(g),u){case"top-right":case"top-left":case"top":w=g-Bl;break;case"bottom-right":case"bottom-left":case"bottom":w=-g+Bl}switch(u){case"top-right":case"bottom-right":case"right":x=-f;break;case"top-left":case"bottom-left":case"left":x=f}return[x,w]}(c,s[0],s[1]):function(u,f){let g=0,x=0;f<0&&(f=0);const w=f/Math.SQRT2;switch(u){case"top-right":case"top-left":x=w-Bl;break;case"bottom-right":case"bottom-left":x=-w+Bl;break;case"bottom":x=-f+Bl;break;case"top":x=f-Bl}switch(u){case"top-right":case"bottom-right":g=-w;break;case"top-left":case"bottom-left":g=w;break;case"left":g=f;break;case"right":g=-f}return[g,x]}(c,s[0])}function OS(c,s,u){var f;const g=c.layout,x=(f=g.get("text-variable-anchor-offset"))===null||f===void 0?void 0:f.evaluate(s,{},u);if(x){const T=x.values,A=[];for(let k=0;k<T.length;k+=2){const B=A[k]=T[k],j=T[k+1].map(W=>W*ti);B.startsWith("top")?j[1]-=Bl:B.startsWith("bottom")&&(j[1]+=Bl),A[k+1]=j}return new hi(A)}const w=g.get("text-variable-anchor");if(w){let T;T=c._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[g.get("text-radial-offset").evaluate(s,{},u)*ti,_1]:g.get("text-offset").evaluate(s,{},u).map(k=>k*ti);const A=[];for(const k of w)A.push(k,RS(k,T));return new hi(A)}return null}function v1(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function v4(c,s,u,f,g,x,w,T,A,k,B){let j=x.textMaxSize.evaluate(s,{});j===void 0&&(j=w);const W=c.layers[0].layout,Y=W.get("icon-offset").evaluate(s,{},B),J=zS(u.horizontal),ae=w/24,pe=c.tilePixelRatio*ae,ye=c.tilePixelRatio*j/24,Ie=c.tilePixelRatio*T,be=c.tilePixelRatio*W.get("symbol-spacing"),ke=W.get("text-padding")*c.tilePixelRatio,ze=function(rt,en,qt,Tn=1){const ar=rt.get("icon-padding").evaluate(en,{},qt),pr=ar&&ar.values;return[pr[0]*Tn,pr[1]*Tn,pr[2]*Tn,pr[3]*Tn]}(W,s,B,c.tilePixelRatio),Je=W.get("text-max-angle")/180*Math.PI,Tt=W.get("text-rotation-alignment")!=="viewport"&&W.get("symbol-placement")!=="point",jt=W.get("icon-rotation-alignment")==="map"&&W.get("symbol-placement")!=="point",wt=W.get("symbol-placement"),gt=be/2,ht=W.get("icon-text-fit");let Rt;f&&ht!=="none"&&(c.allowVerticalPlacement&&u.vertical&&(Rt=sS(f,u.vertical,ht,W.get("icon-text-fit-padding"),Y,ae)),J&&(f=sS(f,J,ht,W.get("icon-text-fit-padding"),Y,ae)));const pt=(rt,en)=>{en.x<0||en.x>=$r||en.y<0||en.y>=$r||function(qt,Tn,ar,pr,ni,Ms,Yi,Gr,mi,Ti,Ki,Ji,ri,ii,Oi,Qi,Di,gs,ys,si,Mn,zi,Si,oi,xo){const Go=qt.addToLineVertexArray(Tn,ar);let Ho,qa,bo,Gs,_s=0,Za=0,Ff=0,US=0,C1=-1,A1=-1;const Xa={};let VS=$a("");if(qt.allowVerticalPlacement&&pr.vertical){const Fi=Gr.layout.get("text-rotate").evaluate(Mn,{},oi)+90;bo=new Ug(mi,Tn,Ti,Ki,Ji,pr.vertical,ri,ii,Oi,Fi),Yi&&(Gs=new Ug(mi,Tn,Ti,Ki,Ji,Yi,Di,gs,Oi,Fi))}if(ni){const Fi=Gr.layout.get("icon-rotate").evaluate(Mn,{}),Hs=Gr.layout.get("icon-text-fit")!=="none",Hc=kS(ni,Fi,Si,Hs),qo=Yi?kS(Yi,Fi,Si,Hs):void 0;qa=new Ug(mi,Tn,Ti,Ki,Ji,ni,Di,gs,!1,Fi),_s=4*Hc.length;const Wc=qt.iconSizeData;let ma=null;Wc.kind==="source"?(ma=[pa*Gr.layout.get("icon-size").evaluate(Mn,{})],ma[0]>zl&&Be(`${qt.layerIds[0]}: Value for "icon-size" is >= ${Rf}. Reduce your "icon-size".`)):Wc.kind==="composite"&&(ma=[pa*zi.compositeIconSizes[0].evaluate(Mn,{},oi),pa*zi.compositeIconSizes[1].evaluate(Mn,{},oi)],(ma[0]>zl||ma[1]>zl)&&Be(`${qt.layerIds[0]}: Value for "icon-size" is >= ${Rf}. Reduce your "icon-size".`)),qt.addSymbols(qt.icon,Hc,ma,si,ys,Mn,l.WritingMode.none,Tn,Go.lineStartIndex,Go.lineLength,-1,oi),C1=qt.icon.placedSymbolArray.length-1,qo&&(Za=4*qo.length,qt.addSymbols(qt.icon,qo,ma,si,ys,Mn,l.WritingMode.vertical,Tn,Go.lineStartIndex,Go.lineLength,-1,oi),A1=qt.icon.placedSymbolArray.length-1)}const jS=Object.keys(pr.horizontal);for(const Fi of jS){const Hs=pr.horizontal[Fi];if(!Ho){VS=$a(Hs.text);const qo=Gr.layout.get("text-rotate").evaluate(Mn,{},oi);Ho=new Ug(mi,Tn,Ti,Ki,Ji,Hs,ri,ii,Oi,qo)}const Hc=Hs.positionedLines.length===1;if(Ff+=DS(qt,Tn,Hs,Ms,Gr,Oi,Mn,Qi,Go,pr.vertical?l.WritingMode.horizontal:l.WritingMode.horizontalOnly,Hc?jS:[Fi],Xa,C1,zi,oi),Hc)break}pr.vertical&&(US+=DS(qt,Tn,pr.vertical,Ms,Gr,Oi,Mn,Qi,Go,l.WritingMode.vertical,["vertical"],Xa,A1,zi,oi));const w4=Ho?Ho.boxStartIndex:qt.collisionBoxArray.length,E4=Ho?Ho.boxEndIndex:qt.collisionBoxArray.length,T4=bo?bo.boxStartIndex:qt.collisionBoxArray.length,S4=bo?bo.boxEndIndex:qt.collisionBoxArray.length,P4=qa?qa.boxStartIndex:qt.collisionBoxArray.length,C4=qa?qa.boxEndIndex:qt.collisionBoxArray.length,A4=Gs?Gs.boxStartIndex:qt.collisionBoxArray.length,I4=Gs?Gs.boxEndIndex:qt.collisionBoxArray.length;let Wo=-1;const jg=(Fi,Hs)=>Fi&&Fi.circleDiameter?Math.max(Fi.circleDiameter,Hs):Hs;Wo=jg(Ho,Wo),Wo=jg(bo,Wo),Wo=jg(qa,Wo),Wo=jg(Gs,Wo);const $S=Wo>-1?1:0;$S&&(Wo*=xo/ti),qt.glyphOffsetArray.length>=uh.MAX_GLYPHS&&Be("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Mn.sortKey!==void 0&&qt.addToSortKeyRanges(qt.symbolInstances.length,Mn.sortKey);const M4=OS(Gr,Mn,oi),[k4,L4]=function(Fi,Hs){const Hc=Fi.length,qo=Hs==null?void 0:Hs.values;if((qo==null?void 0:qo.length)>0)for(let Wc=0;Wc<qo.length;Wc+=2){const ma=qo[Wc+1];Fi.emplaceBack(l.TextAnchorEnum[qo[Wc]],ma[0],ma[1])}return[Hc,Fi.length]}(qt.textAnchorOffsets,M4);qt.symbolInstances.emplaceBack(Tn.x,Tn.y,Xa.right>=0?Xa.right:-1,Xa.center>=0?Xa.center:-1,Xa.left>=0?Xa.left:-1,Xa.vertical||-1,C1,A1,VS,w4,E4,T4,S4,P4,C4,A4,I4,Ti,Ff,US,_s,Za,$S,0,ri,Wo,k4,L4)}(c,en,rt,u,f,g,Rt,c.layers[0],c.collisionBoxArray,s.index,s.sourceLayerIndex,c.index,pe,[ke,ke,ke,ke],Tt,A,Ie,ze,jt,Y,s,x,k,B,w)};if(wt==="line")for(const rt of SS(s.geometry,0,0,$r,$r)){const en=p4(rt,be,Je,u.vertical||J,f,24,ye,c.overscaling,$r);for(const qt of en)J&&x4(c,J.text,gt,qt)||pt(rt,qt)}else if(wt==="line-center"){for(const rt of s.geometry)if(rt.length>1){const en=f4(rt,Je,u.vertical||J,f,24,ye);en&&pt(rt,en)}}else if(s.type==="Polygon")for(const rt of Kv(s.geometry,0)){const en=y4(rt,16);pt(rt[0],new Nl(en.x,en.y,0))}else if(s.type==="LineString")for(const rt of s.geometry)pt(rt,new Nl(rt[0].x,rt[0].y,0));else if(s.type==="Point")for(const rt of s.geometry)for(const en of rt)pt([en],new Nl(en.x,en.y,0))}function DS(c,s,u,f,g,x,w,T,A,k,B,j,W,Y,J){const ae=function(Ie,be,ke,ze,Je,Tt,jt,wt){const gt=ze.layout.get("text-rotate").evaluate(Tt,{})*Math.PI/180,ht=[];for(const Rt of be.positionedLines)for(const pt of Rt.positionedGlyphs){if(!pt.rect)continue;const rt=pt.rect||{};let en=JT+1,qt=!0,Tn=1,ar=0;const pr=(Je||wt)&&pt.vertical,ni=pt.metrics.advance*pt.scale/2;if(wt&&be.verticalizable&&(ar=Rt.lineOffset/2-(pt.imageName?-(ti-pt.metrics.width*pt.scale)/2:(pt.scale-1)*ti)),pt.imageName){const si=jt[pt.imageName];qt=si.sdf,Tn=si.pixelRatio,en=ms/Tn}const Ms=Je?[pt.x+ni,pt.y]:[0,0];let Yi=Je?[0,0]:[pt.x+ni+ke[0],pt.y+ke[1]-ar],Gr=[0,0];pr&&(Gr=Yi,Yi=[0,0]);const mi=pt.metrics.isDoubleResolution?2:1,Ti=(pt.metrics.left-en)*pt.scale-ni+Yi[0],Ki=(-pt.metrics.top-en)*pt.scale+Yi[1],Ji=Ti+rt.w/mi*pt.scale/Tn,ri=Ki+rt.h/mi*pt.scale/Tn,ii=new S(Ti,Ki),Oi=new S(Ji,Ki),Qi=new S(Ti,ri),Di=new S(Ji,ri);if(pr){const si=new S(-ni,ni-kf),Mn=-Math.PI/2,zi=ti/2-ni,Si=new S(5-kf-zi,-(pt.imageName?zi:0)),oi=new S(...Gr);ii._rotateAround(Mn,si)._add(Si)._add(oi),Oi._rotateAround(Mn,si)._add(Si)._add(oi),Qi._rotateAround(Mn,si)._add(Si)._add(oi),Di._rotateAround(Mn,si)._add(Si)._add(oi)}if(gt){const si=Math.sin(gt),Mn=Math.cos(gt),zi=[Mn,-si,si,Mn];ii._matMult(zi),Oi._matMult(zi),Qi._matMult(zi),Di._matMult(zi)}const gs=new S(0,0),ys=new S(0,0);ht.push({tl:ii,tr:Oi,bl:Qi,br:Di,tex:rt,writingMode:be.writingMode,glyphOffset:Ms,sectionIndex:pt.sectionIndex,isSDF:qt,pixelOffsetTL:gs,pixelOffsetBR:ys,minFontScaleX:0,minFontScaleY:0})}return ht}(0,u,T,g,x,w,f,c.allowVerticalPlacement),pe=c.textSizeData;let ye=null;pe.kind==="source"?(ye=[pa*g.layout.get("text-size").evaluate(w,{})],ye[0]>zl&&Be(`${c.layerIds[0]}: Value for "text-size" is >= ${Rf}. Reduce your "text-size".`)):pe.kind==="composite"&&(ye=[pa*Y.compositeTextSizes[0].evaluate(w,{},J),pa*Y.compositeTextSizes[1].evaluate(w,{},J)],(ye[0]>zl||ye[1]>zl)&&Be(`${c.layerIds[0]}: Value for "text-size" is >= ${Rf}. Reduce your "text-size".`)),c.addSymbols(c.text,ae,ye,T,x,w,k,s,A.lineStartIndex,A.lineLength,W,J);for(const Ie of B)j[Ie]=c.text.placedSymbolArray.length-1;return 4*ae.length}function zS(c){for(const s in c)return c[s];return null}function x4(c,s,u,f){const g=c.compareText;if(s in g){const x=g[s];for(let w=x.length-1;w>=0;w--)if(f.dist(x[w])<u)return!0}else g[s]=[];return g[s].push(f),!1}const FS=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class x1{static from(s){if(!(s instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[u,f]=new Uint8Array(s,0,2);if(u!==219)throw new Error("Data does not appear to be in a KDBush format.");const g=f>>4;if(g!==1)throw new Error(`Got v${g} data when expected v1.`);const x=FS[15&f];if(!x)throw new Error("Unrecognized array type.");const[w]=new Uint16Array(s,2,1),[T]=new Uint32Array(s,4,1);return new x1(T,w,x,s)}constructor(s,u=64,f=Float64Array,g){if(isNaN(s)||s<0)throw new Error(`Unpexpected numItems value: ${s}.`);this.numItems=+s,this.nodeSize=Math.min(Math.max(+u,2),65535),this.ArrayType=f,this.IndexArrayType=s<65536?Uint16Array:Uint32Array;const x=FS.indexOf(this.ArrayType),w=2*s*this.ArrayType.BYTES_PER_ELEMENT,T=s*this.IndexArrayType.BYTES_PER_ELEMENT,A=(8-T%8)%8;if(x<0)throw new Error(`Unexpected typed array class: ${f}.`);g&&g instanceof ArrayBuffer?(this.data=g,this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+T+A,2*s),this._pos=2*s,this._finished=!0):(this.data=new ArrayBuffer(8+w+T+A),this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+T+A,2*s),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+x]),new Uint16Array(this.data,2,1)[0]=u,new Uint32Array(this.data,4,1)[0]=s)}add(s,u){const f=this._pos>>1;return this.ids[f]=f,this.coords[this._pos++]=s,this.coords[this._pos++]=u,f}finish(){const s=this._pos>>1;if(s!==this.numItems)throw new Error(`Added ${s} items when expected ${this.numItems}.`);return b1(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(s,u,f,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:x,coords:w,nodeSize:T}=this,A=[0,x.length-1,0],k=[];for(;A.length;){const B=A.pop()||0,j=A.pop()||0,W=A.pop()||0;if(j-W<=T){for(let pe=W;pe<=j;pe++){const ye=w[2*pe],Ie=w[2*pe+1];ye>=s&&ye<=f&&Ie>=u&&Ie<=g&&k.push(x[pe])}continue}const Y=W+j>>1,J=w[2*Y],ae=w[2*Y+1];J>=s&&J<=f&&ae>=u&&ae<=g&&k.push(x[Y]),(B===0?s<=J:u<=ae)&&(A.push(W),A.push(Y-1),A.push(1-B)),(B===0?f>=J:g>=ae)&&(A.push(Y+1),A.push(j),A.push(1-B))}return k}within(s,u,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:x,nodeSize:w}=this,T=[0,g.length-1,0],A=[],k=f*f;for(;T.length;){const B=T.pop()||0,j=T.pop()||0,W=T.pop()||0;if(j-W<=w){for(let pe=W;pe<=j;pe++)BS(x[2*pe],x[2*pe+1],s,u)<=k&&A.push(g[pe]);continue}const Y=W+j>>1,J=x[2*Y],ae=x[2*Y+1];BS(J,ae,s,u)<=k&&A.push(g[Y]),(B===0?s-f<=J:u-f<=ae)&&(T.push(W),T.push(Y-1),T.push(1-B)),(B===0?s+f>=J:u+f>=ae)&&(T.push(Y+1),T.push(j),T.push(1-B))}return A}}function b1(c,s,u,f,g,x){if(g-f<=u)return;const w=f+g>>1;NS(c,s,w,f,g,x),b1(c,s,u,f,w-1,1-x),b1(c,s,u,w+1,g,1-x)}function NS(c,s,u,f,g,x){for(;g>f;){if(g-f>600){const k=g-f+1,B=u-f+1,j=Math.log(k),W=.5*Math.exp(2*j/3),Y=.5*Math.sqrt(j*W*(k-W)/k)*(B-k/2<0?-1:1);NS(c,s,u,Math.max(f,Math.floor(u-B*W/k+Y)),Math.min(g,Math.floor(u+(k-B)*W/k+Y)),x)}const w=s[2*u+x];let T=f,A=g;for(Df(c,s,f,u),s[2*g+x]>w&&Df(c,s,f,g);T<A;){for(Df(c,s,T,A),T++,A--;s[2*T+x]<w;)T++;for(;s[2*A+x]>w;)A--}s[2*f+x]===w?Df(c,s,f,A):(A++,Df(c,s,A,g)),A<=u&&(f=A+1),u<=A&&(g=A-1)}}function Df(c,s,u,f){w1(c,u,f),w1(s,2*u,2*f),w1(s,2*u+1,2*f+1)}function w1(c,s,u){const f=c[s];c[s]=c[u],c[u]=f}function BS(c,s,u,f){const g=c-u,x=s-f;return g*g+x*x}var E1;l.PerformanceMarkers=void 0,(E1=l.PerformanceMarkers||(l.PerformanceMarkers={})).create="create",E1.load="load",E1.fullLoad="fullLoad";let Vg=null,zf=[];const T1=1e3/60,S1="loadTime",P1="fullLoadTime",b4={mark(c){performance.mark(c)},frame(c){const s=c;Vg!=null&&zf.push(s-Vg),Vg=s},clearMetrics(){Vg=null,zf=[],performance.clearMeasures(S1),performance.clearMeasures(P1);for(const c in l.PerformanceMarkers)performance.clearMarks(l.PerformanceMarkers[c])},getPerformanceMetrics(){performance.measure(S1,l.PerformanceMarkers.create,l.PerformanceMarkers.load),performance.measure(P1,l.PerformanceMarkers.create,l.PerformanceMarkers.fullLoad);const c=performance.getEntriesByName(S1)[0].duration,s=performance.getEntriesByName(P1)[0].duration,u=zf.length,f=1/(zf.reduce((x,w)=>x+w,0)/u/1e3),g=zf.filter(x=>x>T1).reduce((x,w)=>x+(w-T1)/T1,0);return{loadTime:c,fullLoadTime:s,fps:f,percentDroppedFrames:g/(u+g)*100,totalFrames:u}}};l.AJAXError=Kt,l.ARRAY_TYPE=ih,l.Actor=class{constructor(c,s,u){this.receive=f=>{const g=f.data,x=g.id;if(x&&(!g.targetMapId||this.mapId===g.targetMapId))if(g.type==="<cancel>"){delete this.tasks[x];const w=this.cancelCallbacks[x];delete this.cancelCallbacks[x],w&&w()}else je()||g.mustQueue?(this.tasks[x]=g,this.taskQueue.push(x),this.invoker.trigger()):this.processTask(x,g)},this.process=()=>{if(!this.taskQueue.length)return;const f=this.taskQueue.shift(),g=this.tasks[f];delete this.tasks[f],this.taskQueue.length&&this.invoker.trigger(),g&&this.processTask(f,g)},this.target=c,this.parent=s,this.mapId=u,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new h4(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=je()?c:window}send(c,s,u,f,g=!1){const x=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(this.callbacks[x]=u);const w=Me(this.globalScope)?void 0:[];return this.target.postMessage({id:x,type:c,hasCallback:!!u,targetMapId:f,mustQueue:g,sourceMapId:this.mapId,data:ha(s,w)},w),{cancel:()=>{u&&delete this.callbacks[x],this.target.postMessage({id:x,type:"<cancel>",targetMapId:f,sourceMapId:this.mapId})}}}processTask(c,s){if(s.type==="<response>"){const u=this.callbacks[c];delete this.callbacks[c],u&&(s.error?u(Ml(s.error)):u(null,Ml(s.data)))}else{let u=!1;const f=Me(this.globalScope)?void 0:[],g=s.hasCallback?(T,A)=>{u=!0,delete this.cancelCallbacks[c],this.target.postMessage({id:c,type:"<response>",sourceMapId:this.mapId,error:T?ha(T):null,data:ha(A,f)},f)}:T=>{u=!0};let x=null;const w=Ml(s.data);if(this.parent[s.type])x=this.parent[s.type](s.sourceMapId,w,g);else if(this.parent.getWorkerSource){const T=s.type.split(".");x=this.parent.getWorkerSource(s.sourceMapId,T[0],w.source)[T[1]](w,g)}else g(new Error(`Could not find function ${s.type}`));!u&&x&&x.cancel&&(this.cancelCallbacks[c]=x.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},l.AlphaImage=Ef,l.CanonicalTileID=y1,l.CollisionBoxArray=fe,l.CollisionCircleLayoutArray=class extends p{},l.Color=Cn,l.DEMData=vS,l.DataConstantProperty=Xt,l.DictionaryCoder=xS,l.EXTENT=$r,l.ErrorEvent=En,l.EvaluationParameters=sr,l.Event=mn,l.Evented=zn,l.FeatureIndex=wS,l.FillBucket=e1,l.FillExtrusionBucket=n1,l.GeoJSONFeature=bS,l.ImageAtlas=eS,l.ImagePosition=a1,l.KDBush=x1,l.LineBucket=r1,l.LineStripIndexArray=class extends X{},l.LngLat=Fl,l.MercatorCoordinate=zg,l.ONE_EM=ti,l.OverscaledTileID=$s,l.PerformanceUtils=b4,l.Point=S,l.Pos3dArray=class extends Vc{},l.PosArray=ct,l.Properties=Dr,l.Protobuf=s1,l.QuadTriangleArray=class extends b{},l.RGBAImage=js,l.RasterBoundsArray=class extends Va{},l.RequestPerformance=class{constructor(c){this._marks={start:[c.url,"start"].join("#"),end:[c.url,"end"].join("#"),measure:c.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let c=performance.getEntriesByName(this._marks.measure);return c.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),c=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),c}},l.SegmentVector=or,l.SymbolBucket=uh,l.Transitionable=gg,l.TriangleIndexArray=fi,l.Uniform1f=nh,l.Uniform1i=class extends Ga{constructor(c,s){super(c,s),this.current=0}set(c){this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}},l.Uniform2f=class extends Ga{constructor(c,s){super(c,s),this.current=[0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1]))}},l.Uniform3f=class extends Ga{constructor(c,s){super(c,s),this.current=[0,0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2]))}},l.Uniform4f=xg,l.UniformColor=bg,l.UniformMatrix4f=class extends Ga{constructor(c,s){super(c,s),this.current=Bv}set(c){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let s=1;s<16;s++)if(c[s]!==this.current[s]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}},l.UnwrappedTileID=_S,l.ValidationError=Ne,l.ZoomHistory=hg,l.addDynamicAttributes=h1,l.arrayBufferToImage=function(c,s){const u=new Image;u.onload=()=>{s(null,u),URL.revokeObjectURL(u.src),u.onload=null,window.requestAnimationFrame(()=>{u.src=ut})},u.onerror=()=>s(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const f=new Blob([new Uint8Array(c)],{type:"image/png"});u.src=c.byteLength?URL.createObjectURL(f):ut},l.arrayBufferToImageBitmap=function(c,s){const u=new Blob([new Uint8Array(c)],{type:"image/png"});createImageBitmap(u).then(f=>{s(null,f)}).catch(f=>{s(new Error(`Could not load image because of ${f.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},l.asyncAll=function(c,s,u){if(!c.length)return u(null,[]);let f=c.length;const g=new Array(c.length);let x=null;c.forEach((w,T)=>{s(w,(A,k)=>{A&&(x=A),g[T]=k,--f==0&&u(x,g)})})},l.bezier=F,l.browser=xt,l.clamp=Q,l.clipLine=SS,l.clone=function(c){var s=new ih(16);return s[0]=c[0],s[1]=c[1],s[2]=c[2],s[3]=c[3],s[4]=c[4],s[5]=c[5],s[6]=c[6],s[7]=c[7],s[8]=c[8],s[9]=c[9],s[10]=c[10],s[11]=c[11],s[12]=c[12],s[13]=c[13],s[14]=c[14],s[15]=c[15],s},l.clone$1=Le,l.collisionCircleLayout=Bz,l.config=$t,l.copy=function(c,s){return c[0]=s[0],c[1]=s[1],c[2]=s[2],c[3]=s[3],c[4]=s[4],c[5]=s[5],c[6]=s[6],c[7]=s[7],c[8]=s[8],c[9]=s[9],c[10]=s[10],c[11]=s[11],c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15],c},l.create=function(){var c=new ih(16);return ih!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c},l.createExpression=Hu,l.createFilter=Jd,l.createLayout=yr,l.createStyleLayer=function(c){if(c.type==="custom")return new u4(c);switch(c.type){case"background":return new a4(c);case"circle":return new WD(c);case"fill":return new dz(c);case"fill-extrusion":return new Cz(c);case"heatmap":return new ZD(c);case"hillshade":return new YD(c);case"line":return new Dz(c);case"raster":return new c4(c);case"symbol":return new Dg(c)}},l.deepEqual=function c(s,u){if(Array.isArray(s)){if(!Array.isArray(u)||s.length!==u.length)return!1;for(let f=0;f<s.length;f++)if(!c(s[f],u[f]))return!1;return!0}if(typeof s=="object"&&s!==null&&u!==null){if(typeof u!="object"||Object.keys(s).length!==Object.keys(u).length)return!1;for(const f in s)if(!c(s[f],u[f]))return!1;return!0}return s===u},l.defaultEasing=$,l.derefLayers=function(c){c=c.slice();const s=Object.create(null);for(let u=0;u<c.length;u++)s[c[u].id]=c[u];for(let u=0;u<c.length;u++)"ref"in c[u]&&(c[u]=Rn(c[u],s[c[u].ref]));return c},l.diffStyles=function(c,s){if(!c)return[{command:It.setStyle,args:[s]}];let u=[];try{if(!an(c.version,s.version))return[{command:It.setStyle,args:[s]}];an(c.center,s.center)||u.push({command:It.setCenter,args:[s.center]}),an(c.zoom,s.zoom)||u.push({command:It.setZoom,args:[s.zoom]}),an(c.bearing,s.bearing)||u.push({command:It.setBearing,args:[s.bearing]}),an(c.pitch,s.pitch)||u.push({command:It.setPitch,args:[s.pitch]}),an(c.sprite,s.sprite)||u.push({command:It.setSprite,args:[s.sprite]}),an(c.glyphs,s.glyphs)||u.push({command:It.setGlyphs,args:[s.glyphs]}),an(c.transition,s.transition)||u.push({command:It.setTransition,args:[s.transition]}),an(c.light,s.light)||u.push({command:It.setLight,args:[s.light]});const f={},g=[];(function(w,T,A,k){let B;for(B in T=T||{},w=w||{})Object.prototype.hasOwnProperty.call(w,B)&&(Object.prototype.hasOwnProperty.call(T,B)||_t(B,A,k));for(B in T)Object.prototype.hasOwnProperty.call(T,B)&&(Object.prototype.hasOwnProperty.call(w,B)?an(w[B],T[B])||(w[B].type==="geojson"&&T[B].type==="geojson"&&et(w,T,B)?A.push({command:It.setGeoJSONSourceData,args:[B,T[B].data]}):Fe(B,T,A,k)):st(B,T,A))})(c.sources,s.sources,g,f);const x=[];c.layers&&c.layers.forEach(w=>{f[w.source]?u.push({command:It.removeLayer,args:[w.id]}):x.push(w)}),u=u.concat(g),function(w,T,A){T=T||[];const k=(w=w||[]).map(Zt),B=T.map(Zt),j=w.reduce(Mt,{}),W=T.reduce(Mt,{}),Y=k.slice(),J=Object.create(null);let ae,pe,ye,Ie,be,ke,ze;for(ae=0,pe=0;ae<k.length;ae++)ye=k[ae],Object.prototype.hasOwnProperty.call(W,ye)?pe++:(A.push({command:It.removeLayer,args:[ye]}),Y.splice(Y.indexOf(ye,pe),1));for(ae=0,pe=0;ae<B.length;ae++)ye=B[B.length-1-ae],Y[Y.length-1-ae]!==ye&&(Object.prototype.hasOwnProperty.call(j,ye)?(A.push({command:It.removeLayer,args:[ye]}),Y.splice(Y.lastIndexOf(ye,Y.length-pe),1)):pe++,ke=Y[Y.length-ae],A.push({command:It.addLayer,args:[W[ye],ke]}),Y.splice(Y.length-ae,0,ye),J[ye]=!0);for(ae=0;ae<B.length;ae++)if(ye=B[ae],Ie=j[ye],be=W[ye],!J[ye]&&!an(Ie,be))if(an(Ie.source,be.source)&&an(Ie["source-layer"],be["source-layer"])&&an(Ie.type,be.type)){for(ze in ot(Ie.layout,be.layout,A,ye,null,It.setLayoutProperty),ot(Ie.paint,be.paint,A,ye,null,It.setPaintProperty),an(Ie.filter,be.filter)||A.push({command:It.setFilter,args:[ye,be.filter]}),an(Ie.minzoom,be.minzoom)&&an(Ie.maxzoom,be.maxzoom)||A.push({command:It.setLayerZoomRange,args:[ye,be.minzoom,be.maxzoom]}),Ie)Object.prototype.hasOwnProperty.call(Ie,ze)&&ze!=="layout"&&ze!=="paint"&&ze!=="filter"&&ze!=="metadata"&&ze!=="minzoom"&&ze!=="maxzoom"&&(ze.indexOf("paint.")===0?ot(Ie[ze],be[ze],A,ye,ze.slice(6),It.setPaintProperty):an(Ie[ze],be[ze])||A.push({command:It.setLayerProperty,args:[ye,ze,be[ze]]}));for(ze in be)Object.prototype.hasOwnProperty.call(be,ze)&&!Object.prototype.hasOwnProperty.call(Ie,ze)&&ze!=="layout"&&ze!=="paint"&&ze!=="filter"&&ze!=="metadata"&&ze!=="minzoom"&&ze!=="maxzoom"&&(ze.indexOf("paint.")===0?ot(Ie[ze],be[ze],A,ye,ze.slice(6),It.setPaintProperty):an(Ie[ze],be[ze])||A.push({command:It.setLayerProperty,args:[ye,ze,be[ze]]}))}else A.push({command:It.removeLayer,args:[ye]}),ke=Y[Y.lastIndexOf(ye)+1],A.push({command:It.addLayer,args:[be,ke]})}(x,s.layers,u)}catch(f){console.warn("Unable to compute style diff:",f),u=[{command:It.setStyle,args:[s]}]}return u},l.dot=function(c,s){return c[0]*s[0]+c[1]*s[1]+c[2]*s[2]+c[3]*s[3]},l.earthRadius=m1,l.emitValidationErrors=Ju,l.emptyStyle=function(){const c={},s=Re.$version;for(const u in Re.$root){const f=Re.$root[u];if(f.required){let g=null;g=u==="version"?s:f.type==="array"?[]:{},g!=null&&(c[u]=g)}}return c},l.equals=function(c,s){var u=c[0],f=c[1],g=c[2],x=c[3],w=c[4],T=c[5],A=c[6],k=c[7],B=c[8],j=c[9],W=c[10],Y=c[11],J=c[12],ae=c[13],pe=c[14],ye=c[15],Ie=s[0],be=s[1],ke=s[2],ze=s[3],Je=s[4],Tt=s[5],jt=s[6],wt=s[7],gt=s[8],ht=s[9],Rt=s[10],pt=s[11],rt=s[12],en=s[13],qt=s[14],Tn=s[15];return Math.abs(u-Ie)<=Xi*Math.max(1,Math.abs(u),Math.abs(Ie))&&Math.abs(f-be)<=Xi*Math.max(1,Math.abs(f),Math.abs(be))&&Math.abs(g-ke)<=Xi*Math.max(1,Math.abs(g),Math.abs(ke))&&Math.abs(x-ze)<=Xi*Math.max(1,Math.abs(x),Math.abs(ze))&&Math.abs(w-Je)<=Xi*Math.max(1,Math.abs(w),Math.abs(Je))&&Math.abs(T-Tt)<=Xi*Math.max(1,Math.abs(T),Math.abs(Tt))&&Math.abs(A-jt)<=Xi*Math.max(1,Math.abs(A),Math.abs(jt))&&Math.abs(k-wt)<=Xi*Math.max(1,Math.abs(k),Math.abs(wt))&&Math.abs(B-gt)<=Xi*Math.max(1,Math.abs(B),Math.abs(gt))&&Math.abs(j-ht)<=Xi*Math.max(1,Math.abs(j),Math.abs(ht))&&Math.abs(W-Rt)<=Xi*Math.max(1,Math.abs(W),Math.abs(Rt))&&Math.abs(Y-pt)<=Xi*Math.max(1,Math.abs(Y),Math.abs(pt))&&Math.abs(J-rt)<=Xi*Math.max(1,Math.abs(J),Math.abs(rt))&&Math.abs(ae-en)<=Xi*Math.max(1,Math.abs(ae),Math.abs(en))&&Math.abs(pe-qt)<=Xi*Math.max(1,Math.abs(pe),Math.abs(qt))&&Math.abs(ye-Tn)<=Xi*Math.max(1,Math.abs(ye),Math.abs(Tn))},l.evaluateSizeForFeature=function(c,{uSize:s,uSizeT:u},{lowerSize:f,upperSize:g}){return c.kind==="source"?f/pa:c.kind==="composite"?us.number(f/pa,g/pa,u):s},l.evaluateSizeForZoom=function(c,s){let u=0,f=0;if(c.kind==="constant")f=c.layoutSize;else if(c.kind!=="source"){const{interpolationType:g,minZoom:x,maxZoom:w}=c,T=g?Q(hs.interpolationFactor(g,s,x,w),0,1):0;c.kind==="camera"?f=us.number(c.minSize,c.maxSize,T):u=T}return{uSizeT:u,uSize:f}},l.evented=Nc,l.extend=re,l.filterObject=de,l.findLineIntersection=function(c,s,u,f){const g=s.y-c.y,x=s.x-c.x,w=f.y-u.y,T=f.x-u.x,A=w*x-T*g;if(A===0)return null;const k=(T*(c.y-u.y)-w*(c.x-u.x))/A;return new S(c.x+k*x,c.y+k*g)},l.fromScaling=function(c,s){return c[0]=s[0],c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=s[1],c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=s[2],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c},l.getAnchorAlignment=c1,l.getAnchorJustification=v1,l.getArrayBuffer=Wt,l.getDefaultExportFromCjs=m,l.getImageData=async function(c,s,u,f,g){if(N())try{return await zt(c,s,u,f,g)}catch{}return function(x,w,T,A,k){const B=x.width,j=x.height;vt&&yt||(vt=new OffscreenCanvas(B,j),yt=vt.getContext("2d",{willReadFrequently:!0})),vt.width=B,vt.height=j,yt.drawImage(x,0,0,B,j);const W=yt.getImageData(w,T,A,k);return yt.clearRect(0,0,B,j),W.data}(c,s,u,f,g)},l.getJSON=function(c,s){return pn(re(c,{type:"json"}),s)},l.getOverlapMode=u1,l.getProtocolAction=sn,l.getRTLTextPluginStatus=uf,l.getReferrer=Ct,l.getVideo=function(c,s){const u=window.document.createElement("video");u.muted=!0,u.onloadstart=function(){s(null,u)};for(let f=0;f<c.length;f++){const g=window.document.createElement("source");Ot(c[f])||(u.crossOrigin="Anonymous"),g.src=c[f],u.appendChild(g)}return{cancel:()=>{}}},l.groupByLayout=function(c,s){const u={};for(let g=0;g<c.length;g++){const x=s&&s[c[g].id]||Xu(c[g]);s&&(s[c[g].id]=x);let w=u[x];w||(w=u[x]=[]),w.push(c[g])}const f=[];for(const g in u)f.push(u[g]);return f},l.identity=Gv,l.interpolate=us,l.invert=function(c,s){var u=s[0],f=s[1],g=s[2],x=s[3],w=s[4],T=s[5],A=s[6],k=s[7],B=s[8],j=s[9],W=s[10],Y=s[11],J=s[12],ae=s[13],pe=s[14],ye=s[15],Ie=u*T-f*w,be=u*A-g*w,ke=u*k-x*w,ze=f*A-g*T,Je=f*k-x*T,Tt=g*k-x*A,jt=B*ae-j*J,wt=B*pe-W*J,gt=B*ye-Y*J,ht=j*pe-W*ae,Rt=j*ye-Y*ae,pt=W*ye-Y*pe,rt=Ie*pt-be*Rt+ke*ht+ze*gt-Je*wt+Tt*jt;return rt?(c[0]=(T*pt-A*Rt+k*ht)*(rt=1/rt),c[1]=(g*Rt-f*pt-x*ht)*rt,c[2]=(ae*Tt-pe*Je+ye*ze)*rt,c[3]=(W*Je-j*Tt-Y*ze)*rt,c[4]=(A*gt-w*pt-k*wt)*rt,c[5]=(u*pt-g*gt+x*wt)*rt,c[6]=(pe*ke-J*Tt-ye*be)*rt,c[7]=(B*Tt-W*ke+Y*be)*rt,c[8]=(w*Rt-T*gt+k*jt)*rt,c[9]=(f*gt-u*Rt-x*jt)*rt,c[10]=(J*Je-ae*ke+ye*Ie)*rt,c[11]=(j*ke-B*Je-Y*Ie)*rt,c[12]=(T*wt-w*ht-A*jt)*rt,c[13]=(u*ht-f*wt+g*jt)*rt,c[14]=(ae*be-J*ze-pe*Ie)*rt,c[15]=(B*ze-j*be+W*Ie)*rt,c):null},l.isImageBitmap=qe,l.isOffscreenCanvasDistorted=N,l.isSafari=Me,l.isWorker=je,l.keysDifference=function(c,s){const u=[];for(const f in c)f in s||u.push(f);return u},l.lazyLoadRTLTextPlugin=function(){fs.isLoading()||fs.isLoaded()||uf()!=="deferred"||mg()},l.makeRequest=pn,l.mapObject=Ee,l.mercatorXfromLng=pS,l.mercatorYfromLat=mS,l.mercatorZfromAltitude=gS,l.mul=HD,l.mul$1=function(c,s,u){return c[0]=s[0]*u[0],c[1]=s[1]*u[1],c[2]=s[2]*u[2],c[3]=s[3]*u[3],c},l.multiply=vT,l.nextPowerOfTwo=function(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))},l.offscreenCanvasSupported=z,l.operations=It,l.ortho=function(c,s,u,f,g,x,w){var T=1/(s-u),A=1/(f-g),k=1/(x-w);return c[0]=-2*T,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*A,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*k,c[11]=0,c[12]=(s+u)*T,c[13]=(g+f)*A,c[14]=(w+x)*k,c[15]=1,c},l.parseCacheControl=function(c){const s={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(u,f,g,x)=>{const w=g||x;return s[f]=!w||w.toLowerCase(),""}),s["max-age"]){const u=parseInt(s["max-age"],10);isNaN(u)?delete s["max-age"]:s["max-age"]=u}return s},l.parseGlyphPbf=function(c){return new s1(c).readFields(Yz,[])},l.pbf=HT,l.performSymbolLayout=function(c){c.bucket.createArrays(),c.bucket.tilePixelRatio=$r/(512*c.bucket.overscaling),c.bucket.compareText={},c.bucket.iconsNeedLinear=!1;const s=c.bucket.layers[0],u=s.layout,f=s._unevaluatedLayout._values,g={layoutIconSize:f["icon-size"].possiblyEvaluate(new sr(c.bucket.zoom+1),c.canonical),layoutTextSize:f["text-size"].possiblyEvaluate(new sr(c.bucket.zoom+1),c.canonical),textMaxSize:f["text-size"].possiblyEvaluate(new sr(18))};if(c.bucket.textSizeData.kind==="composite"){const{minZoom:k,maxZoom:B}=c.bucket.textSizeData;g.compositeTextSizes=[f["text-size"].possiblyEvaluate(new sr(k),c.canonical),f["text-size"].possiblyEvaluate(new sr(B),c.canonical)]}if(c.bucket.iconSizeData.kind==="composite"){const{minZoom:k,maxZoom:B}=c.bucket.iconSizeData;g.compositeIconSizes=[f["icon-size"].possiblyEvaluate(new sr(k),c.canonical),f["icon-size"].possiblyEvaluate(new sr(B),c.canonical)]}const x=u.get("text-line-height")*ti,w=u.get("text-rotation-alignment")!=="viewport"&&u.get("symbol-placement")!=="point",T=u.get("text-keep-upright"),A=u.get("text-size");for(const k of c.bucket.features){const B=u.get("text-font").evaluate(k,{},c.canonical).join(","),j=A.evaluate(k,{},c.canonical),W=g.layoutTextSize.evaluate(k,{},c.canonical),Y=g.layoutIconSize.evaluate(k,{},c.canonical),J={horizontal:{},vertical:void 0},ae=k.text;let pe,ye=[0,0];if(ae){const ke=ae.toString(),ze=u.get("text-letter-spacing").evaluate(k,{},c.canonical)*ti,Je=nf(ke)?ze:0,Tt=u.get("text-anchor").evaluate(k,{},c.canonical),jt=OS(s,k,c.canonical);if(!jt){const pt=u.get("text-radial-offset").evaluate(k,{},c.canonical);ye=pt?RS(Tt,[pt*ti,_1]):u.get("text-offset").evaluate(k,{},c.canonical).map(rt=>rt*ti)}let wt=w?"center":u.get("text-justify").evaluate(k,{},c.canonical);const gt=u.get("symbol-placement"),ht=gt==="point"?u.get("text-max-width").evaluate(k,{},c.canonical)*ti:0,Rt=()=>{c.bucket.allowVerticalPlacement&&tf(ke)&&(J.vertical=Lg(ae,c.glyphMap,c.glyphPositions,c.imagePositions,B,ht,x,Tt,"left",Je,ye,l.WritingMode.vertical,!0,gt,W,j))};if(!w&&jt){const pt=new Set;if(wt==="auto")for(let en=0;en<jt.values.length;en+=2)pt.add(v1(jt.values[en]));else pt.add(wt);let rt=!1;for(const en of pt)if(!J.horizontal[en])if(rt)J.horizontal[en]=J.horizontal[0];else{const qt=Lg(ae,c.glyphMap,c.glyphPositions,c.imagePositions,B,ht,x,"center",en,Je,ye,l.WritingMode.horizontal,!1,gt,W,j);qt&&(J.horizontal[en]=qt,rt=qt.positionedLines.length===1)}Rt()}else{wt==="auto"&&(wt=v1(Tt));const pt=Lg(ae,c.glyphMap,c.glyphPositions,c.imagePositions,B,ht,x,Tt,wt,Je,ye,l.WritingMode.horizontal,!1,gt,W,j);pt&&(J.horizontal[wt]=pt),Rt(),tf(ke)&&w&&T&&(J.vertical=Lg(ae,c.glyphMap,c.glyphPositions,c.imagePositions,B,ht,x,Tt,wt,Je,ye,l.WritingMode.vertical,!1,gt,W,j))}}let Ie=!1;if(k.icon&&k.icon.name){const ke=c.imageMap[k.icon.name];ke&&(pe=n4(c.imagePositions[k.icon.name],u.get("icon-offset").evaluate(k,{},c.canonical),u.get("icon-anchor").evaluate(k,{},c.canonical)),Ie=!!ke.sdf,c.bucket.sdfIcons===void 0?c.bucket.sdfIcons=Ie:c.bucket.sdfIcons!==Ie&&Be("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ke.pixelRatio!==c.bucket.pixelRatio||u.get("icon-rotate").constantOr(1)!==0)&&(c.bucket.iconsNeedLinear=!0))}const be=zS(J.horizontal)||J.vertical;c.bucket.iconsInText=!!be&&be.iconsInText,(be||pe)&&v4(c.bucket,k,J,pe,c.imageMap,g,W,Y,ye,Ie,c.canonical)}c.showCollisionBoxes&&c.bucket.generateCollisionDebugBuffers()},l.perspective=function(c,s,u,f,g){var x,w=1/Math.tan(s/2);return c[0]=w/u,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=w,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,g!=null&&g!==1/0?(c[10]=(g+f)*(x=1/(f-g)),c[14]=2*g*f*x):(c[10]=-1,c[14]=-2*f),c},l.pick=function(c,s){const u={};for(let f=0;f<s.length;f++){const g=s[f];g in c&&(u[g]=c[g])}return u},l.plugin=fs,l.pointGeometry=_,l.polygonIntersectsPolygon=fT,l.potpack=QT,l.readImageUsingVideoFrame=zt,l.register=kt,l.registerForPluginStateChange=function(c){return c({pluginStatus:qi,pluginURL:da}),Nc.on("pluginStateChange",c),c},l.renderColorRamp=TT,l.rotateX=function(c,s,u){var f=Math.sin(u),g=Math.cos(u),x=s[4],w=s[5],T=s[6],A=s[7],k=s[8],B=s[9],j=s[10],W=s[11];return s!==c&&(c[0]=s[0],c[1]=s[1],c[2]=s[2],c[3]=s[3],c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15]),c[4]=x*g+k*f,c[5]=w*g+B*f,c[6]=T*g+j*f,c[7]=A*g+W*f,c[8]=k*g-x*f,c[9]=B*g-w*f,c[10]=j*g-T*f,c[11]=W*g-A*f,c},l.rotateZ=function(c,s,u){var f=Math.sin(u),g=Math.cos(u),x=s[0],w=s[1],T=s[2],A=s[3],k=s[4],B=s[5],j=s[6],W=s[7];return s!==c&&(c[8]=s[8],c[9]=s[9],c[10]=s[10],c[11]=s[11],c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15]),c[0]=x*g+k*f,c[1]=w*g+B*f,c[2]=T*g+j*f,c[3]=A*g+W*f,c[4]=k*g-x*f,c[5]=B*g-w*f,c[6]=j*g-T*f,c[7]=W*g-A*f,c},l.sameOrigin=Ot,l.scale=function(c,s,u){var f=u[0],g=u[1],x=u[2];return c[0]=s[0]*f,c[1]=s[1]*f,c[2]=s[2]*f,c[3]=s[3]*f,c[4]=s[4]*g,c[5]=s[5]*g,c[6]=s[6]*g,c[7]=s[7]*g,c[8]=s[8]*x,c[9]=s[9]*x,c[10]=s[10]*x,c[11]=s[11]*x,c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15],c},l.setRTLTextPlugin=function(c,s,u=!1){if(qi===sf||qi===of||qi===af)throw new Error("setRTLTextPlugin cannot be called multiple times.");da=xt.resolveURL(c),qi=sf,lf=s,cf(),u||mg()},l.sphericalToCartesian=function([c,s,u]){return s+=90,s*=Math.PI/180,u*=Math.PI/180,{x:c*Math.cos(s)*Math.sin(u),y:c*Math.sin(s)*Math.sin(u),z:c*Math.cos(u)}},l.toEvaluationFeature=$c,l.transformMat4=Sg,l.translate=function(c,s,u){var f,g,x,w,T,A,k,B,j,W,Y,J,ae=u[0],pe=u[1],ye=u[2];return s===c?(c[12]=s[0]*ae+s[4]*pe+s[8]*ye+s[12],c[13]=s[1]*ae+s[5]*pe+s[9]*ye+s[13],c[14]=s[2]*ae+s[6]*pe+s[10]*ye+s[14],c[15]=s[3]*ae+s[7]*pe+s[11]*ye+s[15]):(g=s[1],x=s[2],w=s[3],T=s[4],A=s[5],k=s[6],B=s[7],j=s[8],W=s[9],Y=s[10],J=s[11],c[0]=f=s[0],c[1]=g,c[2]=x,c[3]=w,c[4]=T,c[5]=A,c[6]=k,c[7]=B,c[8]=j,c[9]=W,c[10]=Y,c[11]=J,c[12]=f*ae+T*pe+j*ye+s[12],c[13]=g*ae+A*pe+W*ye+s[13],c[14]=x*ae+k*pe+Y*ye+s[14],c[15]=w*ae+B*pe+J*ye+s[15]),c},l.triggerPluginCompletionEvent=Fc,l.unicodeBlockLookup=Et,l.uniqueId=function(){return we++},l.v8Spec=Re,l.validateCustomStyleLayer=function(c){const s=[],u=c.id;return u===void 0&&s.push({message:`layers.${u}: missing required property "id"`}),c.render===void 0&&s.push({message:`layers.${u}: missing required method "render"`}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&s.push({message:`layers.${u}: property "renderingMode" must be either "2d" or "3d"`}),s},l.validateLight=Dv,l.validateStyle=Vo,l.vectorTile=Ol,l.warnOnce=Be,l.wrap=te}),a(["./shared"],function(l){class m{constructor(G){this.keyCache={},G&&this.replace(G)}replace(G){this._layerConfigs={},this._layers={},this.update(G,[])}update(G,q){for(const ce of G){this._layerConfigs[ce.id]=ce;const _e=this._layers[ce.id]=l.createStyleLayer(ce);_e._featureFilter=l.createFilter(_e.filter),this.keyCache[ce.id]&&delete this.keyCache[ce.id]}for(const ce of q)delete this.keyCache[ce],delete this._layerConfigs[ce],delete this._layers[ce];this.familiesBySource={};const ne=l.groupByLayout(Object.values(this._layerConfigs),this.keyCache);for(const ce of ne){const _e=ce.map(We=>this._layers[We.id]),Se=_e[0];if(Se.visibility==="none")continue;const Te=Se.source||"";let ge=this.familiesBySource[Te];ge||(ge=this.familiesBySource[Te]={});const Ce=Se.sourceLayer||"_geojsonTileLayer";let He=ge[Ce];He||(He=ge[Ce]=[]),He.push(_e)}}}class _{constructor(G){const q={},ne=[];for(const Te in G){const ge=G[Te],Ce=q[Te]={};for(const He in ge){const We=ge[+He];if(!We||We.bitmap.width===0||We.bitmap.height===0)continue;const Ze={x:0,y:0,w:We.bitmap.width+2,h:We.bitmap.height+2};ne.push(Ze),Ce[He]={rect:Ze,metrics:We.metrics}}}const{w:ce,h:_e}=l.potpack(ne),Se=new l.AlphaImage({width:ce||1,height:_e||1});for(const Te in G){const ge=G[Te];for(const Ce in ge){const He=ge[+Ce];if(!He||He.bitmap.width===0||He.bitmap.height===0)continue;const We=q[Te][Ce].rect;l.AlphaImage.copy(He.bitmap,Se,{x:0,y:0},{x:We.x+1,y:We.y+1},He.bitmap)}}this.image=Se,this.positions=q}}l.register("GlyphAtlas",_);class E{constructor(G){this.tileID=new l.OverscaledTileID(G.tileID.overscaledZ,G.tileID.wrap,G.tileID.canonical.z,G.tileID.canonical.x,G.tileID.canonical.y),this.uid=G.uid,this.zoom=G.zoom,this.pixelRatio=G.pixelRatio,this.tileSize=G.tileSize,this.source=G.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=G.showCollisionBoxes,this.collectResourceTiming=!!G.collectResourceTiming,this.returnDependencies=!!G.returnDependencies,this.promoteId=G.promoteId,this.inFlightDependencies=[],this.dependencySentinel=-1}parse(G,q,ne,ce,_e){this.status="parsing",this.data=G,this.collisionBoxArray=new l.CollisionBoxArray;const Se=new l.DictionaryCoder(Object.keys(G.layers).sort()),Te=new l.FeatureIndex(this.tileID,this.promoteId);Te.bucketLayerIDs=[];const ge={},Ce={featureIndex:Te,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ne},He=q.familiesBySource[this.source];for(const dn in He){const _n=G.layers[dn];if(!_n)continue;_n.version===1&&l.warnOnce(`Vector tile source "${this.source}" layer "${dn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ar=Se.encode(dn),Ut=[];for(let On=0;On<_n.length;On++){const xr=_n.feature(On),Us=Te.getId(xr,dn);Ut.push({feature:xr,id:Us,index:On,sourceLayerIndex:Ar})}for(const On of He[dn]){const xr=On[0];xr.source!==this.source&&l.warnOnce(`layer.source = ${xr.source} does not equal this.source = ${this.source}`),xr.minzoom&&this.zoom<Math.floor(xr.minzoom)||xr.maxzoom&&this.zoom>=xr.maxzoom||xr.visibility!=="none"&&(S(On,this.zoom,ne),(ge[xr.id]=xr.createBucket({index:Te.bucketLayerIDs.length,layers:On,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ar,sourceID:this.source})).populate(Ut,Ce,this.tileID.canonical),Te.bucketLayerIDs.push(On.map(Us=>Us.id)))}}let We,Ze,Pt,tn;const Lt=l.mapObject(Ce.glyphDependencies,dn=>Object.keys(dn).map(Number));this.inFlightDependencies.forEach(dn=>dn==null?void 0:dn.cancel()),this.inFlightDependencies=[];const ft=++this.dependencySentinel;Object.keys(Lt).length?this.inFlightDependencies.push(ce.send("getGlyphs",{uid:this.uid,stacks:Lt,source:this.source,tileID:this.tileID,type:"glyphs"},(dn,_n)=>{ft===this.dependencySentinel&&(We||(We=dn,Ze=_n,bn.call(this)))})):Ze={};const Ft=Object.keys(Ce.iconDependencies);Ft.length?this.inFlightDependencies.push(ce.send("getImages",{icons:Ft,source:this.source,tileID:this.tileID,type:"icons"},(dn,_n)=>{ft===this.dependencySentinel&&(We||(We=dn,Pt=_n,bn.call(this)))})):Pt={};const xn=Object.keys(Ce.patternDependencies);function bn(){if(We)return _e(We);if(Ze&&Pt&&tn){const dn=new _(Ze),_n=new l.ImageAtlas(Pt,tn);for(const Ar in ge){const Ut=ge[Ar];Ut instanceof l.SymbolBucket?(S(Ut.layers,this.zoom,ne),l.performSymbolLayout({bucket:Ut,glyphMap:Ze,glyphPositions:dn.positions,imageMap:Pt,imagePositions:_n.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Ut.hasPattern&&(Ut instanceof l.LineBucket||Ut instanceof l.FillBucket||Ut instanceof l.FillExtrusionBucket)&&(S(Ut.layers,this.zoom,ne),Ut.addFeatures(Ce,this.tileID.canonical,_n.patternPositions))}this.status="done",_e(null,{buckets:Object.values(ge).filter(Ar=>!Ar.isEmpty()),featureIndex:Te,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:dn.image,imageAtlas:_n,glyphMap:this.returnDependencies?Ze:null,iconMap:this.returnDependencies?Pt:null,glyphPositions:this.returnDependencies?dn.positions:null})}}xn.length?this.inFlightDependencies.push(ce.send("getImages",{icons:xn,source:this.source,tileID:this.tileID,type:"patterns"},(dn,_n)=>{ft===this.dependencySentinel&&(We||(We=dn,tn=_n,bn.call(this)))})):tn={},bn.call(this)}}function S(he,G,q){const ne=new l.EvaluationParameters(G);for(const ce of he)ce.recalculate(ne,q)}function I(he,G){const q=l.getArrayBuffer(he.request,(ne,ce,_e,Se)=>{if(ne)G(ne);else if(ce)try{const Te=new l.vectorTile.VectorTile(new l.Protobuf(ce));G(null,{vectorTile:Te,rawData:ce,cacheControl:_e,expires:Se})}catch(Te){const ge=new Uint8Array(ce);let Ce=`Unable to parse the tile at ${he.request.url}, `;Ce+=ge[0]===31&&ge[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${Te.messge}`,G(new Error(Ce))}});return()=>{q.cancel(),G()}}class L{constructor(G,q,ne,ce){this.actor=G,this.layerIndex=q,this.availableImages=ne,this.loadVectorData=ce||I,this.fetching={},this.loading={},this.loaded={}}loadTile(G,q){const ne=G.uid;this.loading||(this.loading={});const ce=!!(G&&G.request&&G.request.collectResourceTiming)&&new l.RequestPerformance(G.request),_e=this.loading[ne]=new E(G);_e.abort=this.loadVectorData(G,(Se,Te)=>{if(delete this.loading[ne],Se||!Te)return _e.status="done",this.loaded[ne]=_e,q(Se);const ge=Te.rawData,Ce={};Te.expires&&(Ce.expires=Te.expires),Te.cacheControl&&(Ce.cacheControl=Te.cacheControl);const He={};if(ce){const We=ce.finish();We&&(He.resourceTiming=JSON.parse(JSON.stringify(We)))}_e.vectorTile=Te.vectorTile,_e.parse(Te.vectorTile,this.layerIndex,this.availableImages,this.actor,(We,Ze)=>{if(delete this.fetching[ne],We||!Ze)return q(We);q(null,l.extend({rawTileData:ge.slice(0)},Ze,Ce,He))}),this.loaded=this.loaded||{},this.loaded[ne]=_e,this.fetching[ne]={rawTileData:ge,cacheControl:Ce,resourceTiming:He}})}reloadTile(G,q){const ne=this.loaded,ce=G.uid;if(ne&&ne[ce]){const _e=ne[ce];_e.showCollisionBoxes=G.showCollisionBoxes,_e.status==="parsing"?_e.parse(_e.vectorTile,this.layerIndex,this.availableImages,this.actor,(Se,Te)=>{if(Se||!Te)return q(Se,Te);let ge;if(this.fetching[ce]){const{rawTileData:Ce,cacheControl:He,resourceTiming:We}=this.fetching[ce];delete this.fetching[ce],ge=l.extend({rawTileData:Ce.slice(0)},Te,He,We)}else ge=Te;q(null,ge)}):_e.status==="done"&&(_e.vectorTile?_e.parse(_e.vectorTile,this.layerIndex,this.availableImages,this.actor,q):q())}}abortTile(G,q){const ne=this.loading,ce=G.uid;ne&&ne[ce]&&ne[ce].abort&&(ne[ce].abort(),delete ne[ce]),q()}removeTile(G,q){const ne=this.loaded,ce=G.uid;ne&&ne[ce]&&delete ne[ce],q()}}class O{constructor(){this.loaded={}}async loadTile(G,q){const{uid:ne,encoding:ce,rawImageData:_e,redFactor:Se,greenFactor:Te,blueFactor:ge,baseShift:Ce}=G,He=_e.width+2,We=_e.height+2,Ze=l.isImageBitmap(_e)?new l.RGBAImage({width:He,height:We},await l.getImageData(_e,-1,-1,He,We)):_e,Pt=new l.DEMData(ne,Ze,ce,Se,Te,ge,Ce);this.loaded=this.loaded||{},this.loaded[ne]=Pt,q(null,Pt)}removeTile(G){const q=this.loaded,ne=G.uid;q&&q[ne]&&delete q[ne]}}function D(he,G){if(he.length!==0){H(he[0],G);for(var q=1;q<he.length;q++)H(he[q],!G)}}function H(he,G){for(var q=0,ne=0,ce=0,_e=he.length,Se=_e-1;ce<_e;Se=ce++){var Te=(he[ce][0]-he[Se][0])*(he[Se][1]+he[ce][1]),ge=q+Te;ne+=Math.abs(q)>=Math.abs(Te)?q-ge+Te:Te-ge+q,q=ge}q+ne>=0!=!!G&&he.reverse()}var z=l.getDefaultExportFromCjs(function he(G,q){var ne,ce=G&&G.type;if(ce==="FeatureCollection")for(ne=0;ne<G.features.length;ne++)he(G.features[ne],q);else if(ce==="GeometryCollection")for(ne=0;ne<G.geometries.length;ne++)he(G.geometries[ne],q);else if(ce==="Feature")he(G.geometry,q);else if(ce==="Polygon")D(G.coordinates,q);else if(ce==="MultiPolygon")for(ne=0;ne<G.coordinates.length;ne++)D(G.coordinates[ne],q);return G});const N=l.vectorTile.VectorTileFeature.prototype.toGeoJSON;var F={exports:{}},$=l.pointGeometry,Q=l.vectorTile.VectorTileFeature,te=re;function re(he,G){this.options=G||{},this.features=he,this.length=he.length}function we(he,G){this.id=typeof he.id=="number"?he.id:void 0,this.type=he.type,this.rawGeometry=he.type===1?[he.geometry]:he.geometry,this.properties=he.tags,this.extent=G||4096}re.prototype.feature=function(he){return new we(this.features[he],this.options.extent)},we.prototype.loadGeometry=function(){var he=this.rawGeometry;this.geometry=[];for(var G=0;G<he.length;G++){for(var q=he[G],ne=[],ce=0;ce<q.length;ce++)ne.push(new $(q[ce][0],q[ce][1]));this.geometry.push(ne)}return this.geometry},we.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var he=this.geometry,G=1/0,q=-1/0,ne=1/0,ce=-1/0,_e=0;_e<he.length;_e++)for(var Se=he[_e],Te=0;Te<Se.length;Te++){var ge=Se[Te];G=Math.min(G,ge.x),q=Math.max(q,ge.x),ne=Math.min(ne,ge.y),ce=Math.max(ce,ge.y)}return[G,ne,q,ce]},we.prototype.toGeoJSON=Q.prototype.toGeoJSON;var Ee=l.pbf,de=te;function Le(he){var G=new Ee;return function(q,ne){for(var ce in q.layers)ne.writeMessage(3,Ge,q.layers[ce])}(he,G),G.finish()}function Ge(he,G){var q;G.writeVarintField(15,he.version||1),G.writeStringField(1,he.name||""),G.writeVarintField(5,he.extent||4096);var ne={keys:[],values:[],keycache:{},valuecache:{}};for(q=0;q<he.length;q++)ne.feature=he.feature(q),G.writeMessage(2,Be,ne);var ce=ne.keys;for(q=0;q<ce.length;q++)G.writeStringField(3,ce[q]);var _e=ne.values;for(q=0;q<_e.length;q++)G.writeMessage(4,Me,_e[q])}function Be(he,G){var q=he.feature;q.id!==void 0&&G.writeVarintField(1,q.id),G.writeMessage(2,Oe,he),G.writeVarintField(3,q.type),G.writeMessage(4,it,q)}function Oe(he,G){var q=he.feature,ne=he.keys,ce=he.values,_e=he.keycache,Se=he.valuecache;for(var Te in q.properties){var ge=q.properties[Te],Ce=_e[Te];if(ge!==null){Ce===void 0&&(ne.push(Te),_e[Te]=Ce=ne.length-1),G.writeVarint(Ce);var He=typeof ge;He!=="string"&&He!=="boolean"&&He!=="number"&&(ge=JSON.stringify(ge));var We=He+":"+ge,Ze=Se[We];Ze===void 0&&(ce.push(ge),Se[We]=Ze=ce.length-1),G.writeVarint(Ze)}}}function Ke(he,G){return(G<<3)+(7&he)}function je(he){return he<<1^he>>31}function it(he,G){for(var q=he.loadGeometry(),ne=he.type,ce=0,_e=0,Se=q.length,Te=0;Te<Se;Te++){var ge=q[Te],Ce=1;ne===1&&(Ce=ge.length),G.writeVarint(Ke(1,Ce));for(var He=ne===3?ge.length-1:ge.length,We=0;We<He;We++){We===1&&ne!==1&&G.writeVarint(Ke(2,He-1));var Ze=ge[We].x-ce,Pt=ge[We].y-_e;G.writeVarint(je(Ze)),G.writeVarint(je(Pt)),ce+=Ze,_e+=Pt}ne===3&&G.writeVarint(Ke(7,1))}}function Me(he,G){var q=typeof he;q==="string"?G.writeStringField(1,he):q==="boolean"?G.writeBooleanField(7,he):q==="number"&&(he%1!=0?G.writeDoubleField(3,he):he<0?G.writeSVarintField(6,he):G.writeVarintField(5,he))}F.exports=Le,F.exports.fromVectorTileJs=Le,F.exports.fromGeojsonVt=function(he,G){G=G||{};var q={};for(var ne in he)q[ne]=new de(he[ne].features,G),q[ne].name=ne,q[ne].version=G.version,q[ne].extent=G.extent;return Le({layers:q})},F.exports.GeoJSONWrapper=de;var qe=l.getDefaultExportFromCjs(F.exports);const ut={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:he=>he},zt=Math.fround||(vt=new Float32Array(1),he=>(vt[0]=+he,vt[0]));var vt;const yt=3,at=5,bt=6;class xt{constructor(G){this.options=Object.assign(Object.create(ut),G),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(G){const{log:q,minZoom:ne,maxZoom:ce}=this.options;q&&console.time("total time");const _e=`prepare ${G.length} points`;q&&console.time(_e),this.points=G;const Se=[];for(let ge=0;ge<G.length;ge++){const Ce=G[ge];if(!Ce.geometry)continue;const[He,We]=Ce.geometry.coordinates,Ze=zt(Ct(He)),Pt=zt(sn(We));Se.push(Ze,Pt,1/0,ge,-1,1),this.options.reduce&&Se.push(0)}let Te=this.trees[ce+1]=this._createTree(Se);q&&console.timeEnd(_e);for(let ge=ce;ge>=ne;ge--){const Ce=+Date.now();Te=this.trees[ge]=this._createTree(this._cluster(Te,ge)),q&&console.log("z%d: %d clusters in %dms",ge,Te.numItems,+Date.now()-Ce)}return q&&console.timeEnd("total time"),this}getClusters(G,q){let ne=((G[0]+180)%360+360)%360-180;const ce=Math.max(-90,Math.min(90,G[1]));let _e=G[2]===180?180:((G[2]+180)%360+360)%360-180;const Se=Math.max(-90,Math.min(90,G[3]));if(G[2]-G[0]>=360)ne=-180,_e=180;else if(ne>_e){const We=this.getClusters([ne,ce,180,Se],q),Ze=this.getClusters([-180,ce,_e,Se],q);return We.concat(Ze)}const Te=this.trees[this._limitZoom(q)],ge=Te.range(Ct(ne),sn(Se),Ct(_e),sn(ce)),Ce=Te.data,He=[];for(const We of ge){const Ze=this.stride*We;He.push(Ce[Ze+at]>1?$t(Ce,Ze,this.clusterProps):this.points[Ce[Ze+yt]])}return He}getChildren(G){const q=this._getOriginId(G),ne=this._getOriginZoom(G),ce="No cluster with the specified id.",_e=this.trees[ne];if(!_e)throw new Error(ce);const Se=_e.data;if(q*this.stride>=Se.length)throw new Error(ce);const Te=this.options.radius/(this.options.extent*Math.pow(2,ne-1)),ge=_e.within(Se[q*this.stride],Se[q*this.stride+1],Te),Ce=[];for(const He of ge){const We=He*this.stride;Se[We+4]===G&&Ce.push(Se[We+at]>1?$t(Se,We,this.clusterProps):this.points[Se[We+yt]])}if(Ce.length===0)throw new Error(ce);return Ce}getLeaves(G,q,ne){const ce=[];return this._appendLeaves(ce,G,q=q||10,ne=ne||0,0),ce}getTile(G,q,ne){const ce=this.trees[this._limitZoom(G)],_e=Math.pow(2,G),{extent:Se,radius:Te}=this.options,ge=Te/Se,Ce=(ne-ge)/_e,He=(ne+1+ge)/_e,We={features:[]};return this._addTileFeatures(ce.range((q-ge)/_e,Ce,(q+1+ge)/_e,He),ce.data,q,ne,_e,We),q===0&&this._addTileFeatures(ce.range(1-ge/_e,Ce,1,He),ce.data,_e,ne,_e,We),q===_e-1&&this._addTileFeatures(ce.range(0,Ce,ge/_e,He),ce.data,-1,ne,_e,We),We.features.length?We:null}getClusterExpansionZoom(G){let q=this._getOriginZoom(G)-1;for(;q<=this.options.maxZoom;){const ne=this.getChildren(G);if(q++,ne.length!==1)break;G=ne[0].properties.cluster_id}return q}_appendLeaves(G,q,ne,ce,_e){const Se=this.getChildren(q);for(const Te of Se){const ge=Te.properties;if(ge&&ge.cluster?_e+ge.point_count<=ce?_e+=ge.point_count:_e=this._appendLeaves(G,ge.cluster_id,ne,ce,_e):_e<ce?_e++:G.push(Te),G.length===ne)break}return _e}_createTree(G){const q=new l.KDBush(G.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ne=0;ne<G.length;ne+=this.stride)q.add(G[ne],G[ne+1]);return q.finish(),q.data=G,q}_addTileFeatures(G,q,ne,ce,_e,Se){for(const Te of G){const ge=Te*this.stride,Ce=q[ge+at]>1;let He,We,Ze;if(Ce)He=Kt(q,ge,this.clusterProps),We=q[ge],Ze=q[ge+1];else{const Lt=this.points[q[ge+yt]];He=Lt.properties;const[ft,Ft]=Lt.geometry.coordinates;We=Ct(ft),Ze=sn(Ft)}const Pt={type:1,geometry:[[Math.round(this.options.extent*(We*_e-ne)),Math.round(this.options.extent*(Ze*_e-ce))]],tags:He};let tn;tn=Ce||this.options.generateId?q[ge+yt]:this.points[q[ge+yt]].id,tn!==void 0&&(Pt.id=tn),Se.features.push(Pt)}}_limitZoom(G){return Math.max(this.options.minZoom,Math.min(Math.floor(+G),this.options.maxZoom+1))}_cluster(G,q){const{radius:ne,extent:ce,reduce:_e,minPoints:Se}=this.options,Te=ne/(ce*Math.pow(2,q)),ge=G.data,Ce=[],He=this.stride;for(let We=0;We<ge.length;We+=He){if(ge[We+2]<=q)continue;ge[We+2]=q;const Ze=ge[We],Pt=ge[We+1],tn=G.within(ge[We],ge[We+1],Te),Lt=ge[We+at];let ft=Lt;for(const Ft of tn){const xn=Ft*He;ge[xn+2]>q&&(ft+=ge[xn+at])}if(ft>Lt&&ft>=Se){let Ft,xn=Ze*Lt,bn=Pt*Lt,dn=-1;const _n=((We/He|0)<<5)+(q+1)+this.points.length;for(const Ar of tn){const Ut=Ar*He;if(ge[Ut+2]<=q)continue;ge[Ut+2]=q;const On=ge[Ut+at];xn+=ge[Ut]*On,bn+=ge[Ut+1]*On,ge[Ut+4]=_n,_e&&(Ft||(Ft=this._map(ge,We,!0),dn=this.clusterProps.length,this.clusterProps.push(Ft)),_e(Ft,this._map(ge,Ut)))}ge[We+4]=_n,Ce.push(xn/ft,bn/ft,1/0,_n,-1,ft),_e&&Ce.push(dn)}else{for(let Ft=0;Ft<He;Ft++)Ce.push(ge[We+Ft]);if(ft>1)for(const Ft of tn){const xn=Ft*He;if(!(ge[xn+2]<=q)){ge[xn+2]=q;for(let bn=0;bn<He;bn++)Ce.push(ge[xn+bn])}}}}return Ce}_getOriginId(G){return G-this.points.length>>5}_getOriginZoom(G){return(G-this.points.length)%32}_map(G,q,ne){if(G[q+at]>1){const Se=this.clusterProps[G[q+bt]];return ne?Object.assign({},Se):Se}const ce=this.points[G[q+yt]].properties,_e=this.options.map(ce);return ne&&_e===ce?Object.assign({},_e):_e}}function $t(he,G,q){return{type:"Feature",id:he[G+yt],properties:Kt(he,G,q),geometry:{type:"Point",coordinates:[(ne=he[G],360*(ne-.5)),Qt(he[G+1])]}};var ne}function Kt(he,G,q){const ne=he[G+at],ce=ne>=1e4?`${Math.round(ne/1e3)}k`:ne>=1e3?Math.round(ne/100)/10+"k":ne,_e=he[G+bt],Se=_e===-1?{}:Object.assign({},q[_e]);return Object.assign(Se,{cluster:!0,cluster_id:he[G+yt],point_count:ne,point_count_abbreviated:ce})}function Ct(he){return he/360+.5}function sn(he){const G=Math.sin(he*Math.PI/180),q=.5-.25*Math.log((1+G)/(1-G))/Math.PI;return q<0?0:q>1?1:q}function Qt(he){const G=(180-360*he)*Math.PI/180;return 360*Math.atan(Math.exp(G))/Math.PI-90}function pn(he,G,q,ne){for(var ce,_e=ne,Se=q-G>>1,Te=q-G,ge=he[G],Ce=he[G+1],He=he[q],We=he[q+1],Ze=G+3;Ze<q;Ze+=3){var Pt=Wt(he[Ze],he[Ze+1],ge,Ce,He,We);if(Pt>_e)ce=Ze,_e=Pt;else if(Pt===_e){var tn=Math.abs(Ze-Se);tn<Te&&(ce=Ze,Te=tn)}}_e>ne&&(ce-G>3&&pn(he,G,ce,ne),he[ce+2]=_e,q-ce>3&&pn(he,ce,q,ne))}function Wt(he,G,q,ne,ce,_e){var Se=ce-q,Te=_e-ne;if(Se!==0||Te!==0){var ge=((he-q)*Se+(G-ne)*Te)/(Se*Se+Te*Te);ge>1?(q=ce,ne=_e):ge>0&&(q+=Se*ge,ne+=Te*ge)}return(Se=he-q)*Se+(Te=G-ne)*Te}function Ot(he,G,q,ne){var ce={id:he===void 0?null:he,type:G,geometry:q,tags:ne,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(_e){var Se=_e.geometry,Te=_e.type;if(Te==="Point"||Te==="MultiPoint"||Te==="LineString")Dt(_e,Se);else if(Te==="Polygon"||Te==="MultiLineString")for(var ge=0;ge<Se.length;ge++)Dt(_e,Se[ge]);else if(Te==="MultiPolygon")for(ge=0;ge<Se.length;ge++)for(var Ce=0;Ce<Se[ge].length;Ce++)Dt(_e,Se[ge][Ce])}(ce),ce}function Dt(he,G){for(var q=0;q<G.length;q+=3)he.minX=Math.min(he.minX,G[q]),he.minY=Math.min(he.minY,G[q+1]),he.maxX=Math.max(he.maxX,G[q]),he.maxY=Math.max(he.maxY,G[q+1])}function wn(he,G,q,ne){if(G.geometry){var ce=G.geometry.coordinates,_e=G.geometry.type,Se=Math.pow(q.tolerance/((1<<q.maxZoom)*q.extent),2),Te=[],ge=G.id;if(q.promoteId?ge=G.properties[q.promoteId]:q.generateId&&(ge=ne||0),_e==="Point")mn(ce,Te);else if(_e==="MultiPoint")for(var Ce=0;Ce<ce.length;Ce++)mn(ce[Ce],Te);else if(_e==="LineString")En(ce,Te,Se,!1);else if(_e==="MultiLineString"){if(q.lineMetrics){for(Ce=0;Ce<ce.length;Ce++)En(ce[Ce],Te=[],Se,!1),he.push(Ot(ge,"LineString",Te,G.properties));return}zn(ce,Te,Se,!1)}else if(_e==="Polygon")zn(ce,Te,Se,!0);else{if(_e!=="MultiPolygon"){if(_e==="GeometryCollection"){for(Ce=0;Ce<G.geometry.geometries.length;Ce++)wn(he,{id:ge,geometry:G.geometry.geometries[Ce],properties:G.properties},q,ne);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ce=0;Ce<ce.length;Ce++){var He=[];zn(ce[Ce],He,Se,!0),Te.push(He)}}he.push(Ot(ge,_e,Te,G.properties))}}function mn(he,G){G.push(Re(he[0])),G.push(Bt(he[1])),G.push(0)}function En(he,G,q,ne){for(var ce,_e,Se=0,Te=0;Te<he.length;Te++){var ge=Re(he[Te][0]),Ce=Bt(he[Te][1]);G.push(ge),G.push(Ce),G.push(0),Te>0&&(Se+=ne?(ce*Ce-ge*_e)/2:Math.sqrt(Math.pow(ge-ce,2)+Math.pow(Ce-_e,2))),ce=ge,_e=Ce}var He=G.length-3;G[2]=1,pn(G,0,He,q),G[He+2]=1,G.size=Math.abs(Se),G.start=0,G.end=G.size}function zn(he,G,q,ne){for(var ce=0;ce<he.length;ce++){var _e=[];En(he[ce],_e,q,ne),G.push(_e)}}function Re(he){return he/360+.5}function Bt(he){var G=Math.sin(he*Math.PI/180),q=.5-.25*Math.log((1+G)/(1-G))/Math.PI;return q<0?0:q>1?1:q}function Rn(he,G,q,ne,ce,_e,Se,Te){if(ne/=G,_e>=(q/=G)&&Se<ne)return he;if(Se<q||_e>=ne)return null;for(var ge=[],Ce=0;Ce<he.length;Ce++){var He=he[Ce],We=He.geometry,Ze=He.type,Pt=ce===0?He.minX:He.minY,tn=ce===0?He.maxX:He.maxY;if(Pt>=q&&tn<ne)ge.push(He);else if(!(tn<q||Pt>=ne)){var Lt=[];if(Ze==="Point"||Ze==="MultiPoint")an(We,Lt,q,ne,ce);else if(Ze==="LineString")It(We,Lt,q,ne,ce,!1,Te.lineMetrics);else if(Ze==="MultiLineString")_t(We,Lt,q,ne,ce,!1);else if(Ze==="Polygon")_t(We,Lt,q,ne,ce,!0);else if(Ze==="MultiPolygon")for(var ft=0;ft<We.length;ft++){var Ft=[];_t(We[ft],Ft,q,ne,ce,!0),Ft.length&&Lt.push(Ft)}if(Lt.length){if(Te.lineMetrics&&Ze==="LineString"){for(ft=0;ft<Lt.length;ft++)ge.push(Ot(He.id,Ze,Lt[ft],He.tags));continue}Ze!=="LineString"&&Ze!=="MultiLineString"||(Lt.length===1?(Ze="LineString",Lt=Lt[0]):Ze="MultiLineString"),Ze!=="Point"&&Ze!=="MultiPoint"||(Ze=Lt.length===3?"Point":"MultiPoint"),ge.push(Ot(He.id,Ze,Lt,He.tags))}}}return ge.length?ge:null}function an(he,G,q,ne,ce){for(var _e=0;_e<he.length;_e+=3){var Se=he[_e+ce];Se>=q&&Se<=ne&&(G.push(he[_e]),G.push(he[_e+1]),G.push(he[_e+2]))}}function It(he,G,q,ne,ce,_e,Se){for(var Te,ge,Ce=st(he),He=ce===0?et:ot,We=he.start,Ze=0;Ze<he.length-3;Ze+=3){var Pt=he[Ze],tn=he[Ze+1],Lt=he[Ze+2],ft=he[Ze+3],Ft=he[Ze+4],xn=ce===0?Pt:tn,bn=ce===0?ft:Ft,dn=!1;Se&&(Te=Math.sqrt(Math.pow(Pt-ft,2)+Math.pow(tn-Ft,2))),xn<q?bn>q&&(ge=He(Ce,Pt,tn,ft,Ft,q),Se&&(Ce.start=We+Te*ge)):xn>ne?bn<ne&&(ge=He(Ce,Pt,tn,ft,Ft,ne),Se&&(Ce.start=We+Te*ge)):Fe(Ce,Pt,tn,Lt),bn<q&&xn>=q&&(ge=He(Ce,Pt,tn,ft,Ft,q),dn=!0),bn>ne&&xn<=ne&&(ge=He(Ce,Pt,tn,ft,Ft,ne),dn=!0),!_e&&dn&&(Se&&(Ce.end=We+Te*ge),G.push(Ce),Ce=st(he)),Se&&(We+=Te)}var _n=he.length-3;Pt=he[_n],tn=he[_n+1],Lt=he[_n+2],(xn=ce===0?Pt:tn)>=q&&xn<=ne&&Fe(Ce,Pt,tn,Lt),_n=Ce.length-3,_e&&_n>=3&&(Ce[_n]!==Ce[0]||Ce[_n+1]!==Ce[1])&&Fe(Ce,Ce[0],Ce[1],Ce[2]),Ce.length&&G.push(Ce)}function st(he){var G=[];return G.size=he.size,G.start=he.start,G.end=he.end,G}function _t(he,G,q,ne,ce,_e){for(var Se=0;Se<he.length;Se++)It(he[Se],G,q,ne,ce,_e,!1)}function Fe(he,G,q,ne){he.push(G),he.push(q),he.push(ne)}function et(he,G,q,ne,ce,_e){var Se=(_e-G)/(ne-G);return he.push(_e),he.push(q+(ce-q)*Se),he.push(1),Se}function ot(he,G,q,ne,ce,_e){var Se=(_e-q)/(ce-q);return he.push(G+(ne-G)*Se),he.push(_e),he.push(1),Se}function Zt(he,G){for(var q=[],ne=0;ne<he.length;ne++){var ce,_e=he[ne],Se=_e.type;if(Se==="Point"||Se==="MultiPoint"||Se==="LineString")ce=Mt(_e.geometry,G);else if(Se==="MultiLineString"||Se==="Polygon"){ce=[];for(var Te=0;Te<_e.geometry.length;Te++)ce.push(Mt(_e.geometry[Te],G))}else if(Se==="MultiPolygon")for(ce=[],Te=0;Te<_e.geometry.length;Te++){for(var ge=[],Ce=0;Ce<_e.geometry[Te].length;Ce++)ge.push(Mt(_e.geometry[Te][Ce],G));ce.push(ge)}q.push(Ot(_e.id,Se,ce,_e.tags))}return q}function Mt(he,G){var q=[];q.size=he.size,he.start!==void 0&&(q.start=he.start,q.end=he.end);for(var ne=0;ne<he.length;ne+=3)q.push(he[ne]+G,he[ne+1],he[ne+2]);return q}function Ne(he,G){if(he.transformed)return he;var q,ne,ce,_e=1<<he.z,Se=he.x,Te=he.y;for(q=0;q<he.features.length;q++){var ge=he.features[q],Ce=ge.geometry,He=ge.type;if(ge.geometry=[],He===1)for(ne=0;ne<Ce.length;ne+=2)ge.geometry.push(Ye(Ce[ne],Ce[ne+1],G,_e,Se,Te));else for(ne=0;ne<Ce.length;ne++){var We=[];for(ce=0;ce<Ce[ne].length;ce+=2)We.push(Ye(Ce[ne][ce],Ce[ne][ce+1],G,_e,Se,Te));ge.geometry.push(We)}}return he.transformed=!0,he}function Ye(he,G,q,ne,ce,_e){return[Math.round(q*(he*ne-ce)),Math.round(q*(G*ne-_e))]}function St(he,G,q,ne,ce){for(var _e=G===ce.maxZoom?0:ce.tolerance/((1<<G)*ce.extent),Se={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:q,y:ne,z:G,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Te=0;Te<he.length;Te++){Se.numFeatures++,gn(Se,he[Te],_e,ce);var ge=he[Te].minX,Ce=he[Te].minY,He=he[Te].maxX,We=he[Te].maxY;ge<Se.minX&&(Se.minX=ge),Ce<Se.minY&&(Se.minY=Ce),He>Se.maxX&&(Se.maxX=He),We>Se.maxY&&(Se.maxY=We)}return Se}function gn(he,G,q,ne){var ce=G.geometry,_e=G.type,Se=[];if(_e==="Point"||_e==="MultiPoint")for(var Te=0;Te<ce.length;Te+=3)Se.push(ce[Te]),Se.push(ce[Te+1]),he.numPoints++,he.numSimplified++;else if(_e==="LineString")yn(Se,ce,he,q,!1,!1);else if(_e==="MultiLineString"||_e==="Polygon")for(Te=0;Te<ce.length;Te++)yn(Se,ce[Te],he,q,_e==="Polygon",Te===0);else if(_e==="MultiPolygon")for(var ge=0;ge<ce.length;ge++){var Ce=ce[ge];for(Te=0;Te<Ce.length;Te++)yn(Se,Ce[Te],he,q,!0,Te===0)}if(Se.length){var He=G.tags||null;if(_e==="LineString"&&ne.lineMetrics){for(var We in He={},G.tags)He[We]=G.tags[We];He.mapbox_clip_start=ce.start/ce.size,He.mapbox_clip_end=ce.end/ce.size}var Ze={geometry:Se,type:_e==="Polygon"||_e==="MultiPolygon"?3:_e==="LineString"||_e==="MultiLineString"?2:1,tags:He};G.id!==null&&(Ze.id=G.id),he.features.push(Ze)}}function yn(he,G,q,ne,ce,_e){var Se=ne*ne;if(ne>0&&G.size<(ce?Se:ne))q.numPoints+=G.length/3;else{for(var Te=[],ge=0;ge<G.length;ge+=3)(ne===0||G[ge+2]>Se)&&(q.numSimplified++,Te.push(G[ge]),Te.push(G[ge+1])),q.numPoints++;ce&&function(Ce,He){for(var We=0,Ze=0,Pt=Ce.length,tn=Pt-2;Ze<Pt;tn=Ze,Ze+=2)We+=(Ce[Ze]-Ce[tn])*(Ce[Ze+1]+Ce[tn+1]);if(We>0===He)for(Ze=0,Pt=Ce.length;Ze<Pt/2;Ze+=2){var Lt=Ce[Ze],ft=Ce[Ze+1];Ce[Ze]=Ce[Pt-2-Ze],Ce[Ze+1]=Ce[Pt-1-Ze],Ce[Pt-2-Ze]=Lt,Ce[Pt-1-Ze]=ft}}(Te,_e),he.push(Te)}}function nt(he,G){var q=(G=this.options=function(ce,_e){for(var Se in _e)ce[Se]=_e[Se];return ce}(Object.create(this.options),G)).debug;if(q&&console.time("preprocess data"),G.maxZoom<0||G.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(G.promoteId&&G.generateId)throw new Error("promoteId and generateId cannot be used together.");var ne=function(ce,_e){var Se=[];if(ce.type==="FeatureCollection")for(var Te=0;Te<ce.features.length;Te++)wn(Se,ce.features[Te],_e,Te);else wn(Se,ce.type==="Feature"?ce:{geometry:ce},_e);return Se}(he,G);this.tiles={},this.tileCoords=[],q&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",G.indexMaxZoom,G.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ne=function(ce,_e){var Se=_e.buffer/_e.extent,Te=ce,ge=Rn(ce,1,-1-Se,Se,0,-1,2,_e),Ce=Rn(ce,1,1-Se,2+Se,0,-1,2,_e);return(ge||Ce)&&(Te=Rn(ce,1,-Se,1+Se,0,-1,2,_e)||[],ge&&(Te=Zt(ge,1).concat(Te)),Ce&&(Te=Te.concat(Zt(Ce,-1)))),Te}(ne,G),ne.length&&this.splitTile(ne,0,0,0),q&&(ne.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function on(he,G,q){return 32*((1<<he)*q+G)+he}function rn(he,G){return G?he.properties[G]:he.id}function Cr(he,G){if(he==null)return!0;if(he.type==="Feature")return rn(he,G)!=null;if(he.type==="FeatureCollection"){const q=new Set;for(const ne of he.features){const ce=rn(ne,G);if(ce==null||q.has(ce))return!1;q.add(ce)}return!0}return!1}function li(he,G){const q=new Map;if(he!=null)if(he.type==="Feature")q.set(rn(he,G),he);else for(const ne of he.features)q.set(rn(ne,G),ne);return q}function un(he,G){const q=he.tileID.canonical;if(!this._geoJSONIndex)return G(null,null);const ne=this._geoJSONIndex.getTile(q.z,q.x,q.y);if(!ne)return G(null,null);const ce=new class{constructor(Se){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=l.EXTENT,this.length=Se.length,this._features=Se}feature(Se){return new class{constructor(Te){this._feature=Te,this.extent=l.EXTENT,this.type=Te.type,this.properties=Te.tags,"id"in Te&&!isNaN(Te.id)&&(this.id=parseInt(Te.id,10))}loadGeometry(){if(this._feature.type===1){const Te=[];for(const ge of this._feature.geometry)Te.push([new l.Point(ge[0],ge[1])]);return Te}{const Te=[];for(const ge of this._feature.geometry){const Ce=[];for(const He of ge)Ce.push(new l.Point(He[0],He[1]));Te.push(Ce)}return Te}}toGeoJSON(Te,ge,Ce){return N.call(this,Te,ge,Ce)}}(this._features[Se])}}(ne.features);let _e=qe(ce);_e.byteOffset===0&&_e.byteLength===_e.buffer.byteLength||(_e=new Uint8Array(_e)),G(null,{vectorTile:ce,rawData:_e.buffer})}nt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},nt.prototype.splitTile=function(he,G,q,ne,ce,_e,Se){for(var Te=[he,G,q,ne],ge=this.options,Ce=ge.debug;Te.length;){ne=Te.pop(),q=Te.pop(),G=Te.pop(),he=Te.pop();var He=1<<G,We=on(G,q,ne),Ze=this.tiles[We];if(!Ze&&(Ce>1&&console.time("creation"),Ze=this.tiles[We]=St(he,G,q,ne,ge),this.tileCoords.push({z:G,x:q,y:ne}),Ce)){Ce>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",G,q,ne,Ze.numFeatures,Ze.numPoints,Ze.numSimplified),console.timeEnd("creation"));var Pt="z"+G;this.stats[Pt]=(this.stats[Pt]||0)+1,this.total++}if(Ze.source=he,ce){if(G===ge.maxZoom||G===ce)continue;var tn=1<<ce-G;if(q!==Math.floor(_e/tn)||ne!==Math.floor(Se/tn))continue}else if(G===ge.indexMaxZoom||Ze.numPoints<=ge.indexMaxPoints)continue;if(Ze.source=null,he.length!==0){Ce>1&&console.time("clipping");var Lt,ft,Ft,xn,bn,dn,_n=.5*ge.buffer/ge.extent,Ar=.5-_n,Ut=.5+_n,On=1+_n;Lt=ft=Ft=xn=null,bn=Rn(he,He,q-_n,q+Ut,0,Ze.minX,Ze.maxX,ge),dn=Rn(he,He,q+Ar,q+On,0,Ze.minX,Ze.maxX,ge),he=null,bn&&(Lt=Rn(bn,He,ne-_n,ne+Ut,1,Ze.minY,Ze.maxY,ge),ft=Rn(bn,He,ne+Ar,ne+On,1,Ze.minY,Ze.maxY,ge),bn=null),dn&&(Ft=Rn(dn,He,ne-_n,ne+Ut,1,Ze.minY,Ze.maxY,ge),xn=Rn(dn,He,ne+Ar,ne+On,1,Ze.minY,Ze.maxY,ge),dn=null),Ce>1&&console.timeEnd("clipping"),Te.push(Lt||[],G+1,2*q,2*ne),Te.push(ft||[],G+1,2*q,2*ne+1),Te.push(Ft||[],G+1,2*q+1,2*ne),Te.push(xn||[],G+1,2*q+1,2*ne+1)}}},nt.prototype.getTile=function(he,G,q){var ne=this.options,ce=ne.extent,_e=ne.debug;if(he<0||he>24)return null;var Se=1<<he,Te=on(he,G=(G%Se+Se)%Se,q);if(this.tiles[Te])return Ne(this.tiles[Te],ce);_e>1&&console.log("drilling down to z%d-%d-%d",he,G,q);for(var ge,Ce=he,He=G,We=q;!ge&&Ce>0;)Ce--,He=Math.floor(He/2),We=Math.floor(We/2),ge=this.tiles[on(Ce,He,We)];return ge&&ge.source?(_e>1&&console.log("found parent tile z%d-%d-%d",Ce,He,We),_e>1&&console.time("drilling down"),this.splitTile(ge.source,Ce,He,We,he,G,q),_e>1&&console.timeEnd("drilling down"),this.tiles[Te]?Ne(this.tiles[Te],ce):null):null};class Kr extends L{constructor(G,q,ne,ce){super(G,q,ne,un),this._dataUpdateable=new Map,this.loadGeoJSON=(_e,Se)=>{const{promoteId:Te}=_e;if(_e.request)return l.getJSON(_e.request,(ge,Ce,He,We)=>{this._dataUpdateable=Cr(Ce,Te)?li(Ce,Te):void 0,Se(ge,Ce,He,We)});if(typeof _e.data=="string")try{const ge=JSON.parse(_e.data);this._dataUpdateable=Cr(ge,Te)?li(ge,Te):void 0,Se(null,ge)}catch{Se(new Error(`Input data given to '${_e.source}' is not a valid GeoJSON object.`))}else _e.dataDiff?this._dataUpdateable?(function(ge,Ce,He){var We,Ze,Pt,tn;if(Ce.removeAll&&ge.clear(),Ce.remove)for(const Lt of Ce.remove)ge.delete(Lt);if(Ce.add)for(const Lt of Ce.add){const ft=rn(Lt,He);ft!=null&&ge.set(ft,Lt)}if(Ce.update)for(const Lt of Ce.update){let ft=ge.get(Lt.id);if(ft==null)continue;const Ft=!Lt.removeAllProperties&&(((We=Lt.removeProperties)===null||We===void 0?void 0:We.length)>0||((Ze=Lt.addOrUpdateProperties)===null||Ze===void 0?void 0:Ze.length)>0);if((Lt.newGeometry||Lt.removeAllProperties||Ft)&&(ft={...ft},ge.set(Lt.id,ft),Ft&&(ft.properties={...ft.properties})),Lt.newGeometry&&(ft.geometry=Lt.newGeometry),Lt.removeAllProperties)ft.properties={};else if(((Pt=Lt.removeProperties)===null||Pt===void 0?void 0:Pt.length)>0)for(const xn of Lt.removeProperties)Object.prototype.hasOwnProperty.call(ft.properties,xn)&&delete ft.properties[xn];if(((tn=Lt.addOrUpdateProperties)===null||tn===void 0?void 0:tn.length)>0)for(const{key:xn,value:bn}of Lt.addOrUpdateProperties)ft.properties[xn]=bn}}(this._dataUpdateable,_e.dataDiff,Te),Se(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):Se(new Error(`Cannot update existing geojson data in ${_e.source}`)):Se(new Error(`Input data given to '${_e.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},ce&&(this.loadGeoJSON=ce)}loadData(G,q){var ne;(ne=this._pendingRequest)===null||ne===void 0||ne.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const ce=!!(G&&G.request&&G.request.collectResourceTiming)&&new l.RequestPerformance(G.request);this._pendingCallback=q,this._pendingRequest=this.loadGeoJSON(G,(_e,Se)=>{if(delete this._pendingCallback,delete this._pendingRequest,_e||!Se)return q(_e);if(typeof Se!="object")return q(new Error(`Input data given to '${G.source}' is not a valid GeoJSON object.`));{z(Se,!0);try{if(G.filter){const ge=l.createExpression(G.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ge.result==="error")throw new Error(ge.value.map(He=>`${He.key}: ${He.message}`).join(", "));Se={type:"FeatureCollection",features:Se.features.filter(He=>ge.value.evaluate({zoom:0},He))}}this._geoJSONIndex=G.cluster?new xt(function({superclusterOptions:ge,clusterProperties:Ce}){if(!Ce||!ge)return ge;const He={},We={},Ze={accumulated:null,zoom:0},Pt={properties:null},tn=Object.keys(Ce);for(const Lt of tn){const[ft,Ft]=Ce[Lt],xn=l.createExpression(Ft),bn=l.createExpression(typeof ft=="string"?[ft,["accumulated"],["get",Lt]]:ft);He[Lt]=xn.value,We[Lt]=bn.value}return ge.map=Lt=>{Pt.properties=Lt;const ft={};for(const Ft of tn)ft[Ft]=He[Ft].evaluate(Ze,Pt);return ft},ge.reduce=(Lt,ft)=>{Pt.properties=ft;for(const Ft of tn)Ze.accumulated=Lt[Ft],Lt[Ft]=We[Ft].evaluate(Ze,Pt)},ge}(G)).load(Se.features):function(ge,Ce){return new nt(ge,Ce)}(Se,G.geojsonVtOptions)}catch(ge){return q(ge)}this.loaded={};const Te={};if(ce){const ge=ce.finish();ge&&(Te.resourceTiming={},Te.resourceTiming[G.source]=JSON.parse(JSON.stringify(ge)))}q(null,Te)}})}reloadTile(G,q){const ne=this.loaded;return ne&&ne[G.uid]?super.reloadTile(G,q):this.loadTile(G,q)}removeSource(G,q){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),q()}getClusterExpansionZoom(G,q){try{q(null,this._geoJSONIndex.getClusterExpansionZoom(G.clusterId))}catch(ne){q(ne)}}getClusterChildren(G,q){try{q(null,this._geoJSONIndex.getChildren(G.clusterId))}catch(ne){q(ne)}}getClusterLeaves(G,q){try{q(null,this._geoJSONIndex.getLeaves(G.clusterId,G.limit,G.offset))}catch(ne){q(ne)}}}class xi{constructor(G){this.self=G,this.actor=new l.Actor(G,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:L,geojson:Kr},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(q,ne)=>{if(this.workerSourceTypes[q])throw new Error(`Worker source with name "${q}" already registered.`);this.workerSourceTypes[q]=ne},this.self.registerRTLTextPlugin=q=>{if(l.plugin.isParsed())throw new Error("RTL text plugin already registered.");l.plugin.applyArabicShaping=q.applyArabicShaping,l.plugin.processBidirectionalText=q.processBidirectionalText,l.plugin.processStyledBidirectionalText=q.processStyledBidirectionalText}}setReferrer(G,q){this.referrer=q}setImages(G,q,ne){this.availableImages[G]=q;for(const ce in this.workerSources[G]){const _e=this.workerSources[G][ce];for(const Se in _e)_e[Se].availableImages=q}ne()}setLayers(G,q,ne){this.getLayerIndex(G).replace(q),ne()}updateLayers(G,q,ne){this.getLayerIndex(G).update(q.layers,q.removedIds),ne()}loadTile(G,q,ne){this.getWorkerSource(G,q.type,q.source).loadTile(q,ne)}loadDEMTile(G,q,ne){this.getDEMWorkerSource(G,q.source).loadTile(q,ne)}reloadTile(G,q,ne){this.getWorkerSource(G,q.type,q.source).reloadTile(q,ne)}abortTile(G,q,ne){this.getWorkerSource(G,q.type,q.source).abortTile(q,ne)}removeTile(G,q,ne){this.getWorkerSource(G,q.type,q.source).removeTile(q,ne)}removeDEMTile(G,q){this.getDEMWorkerSource(G,q.source).removeTile(q)}removeSource(G,q,ne){if(!this.workerSources[G]||!this.workerSources[G][q.type]||!this.workerSources[G][q.type][q.source])return;const ce=this.workerSources[G][q.type][q.source];delete this.workerSources[G][q.type][q.source],ce.removeSource!==void 0?ce.removeSource(q,ne):ne()}loadWorkerSource(G,q,ne){try{this.self.importScripts(q.url),ne()}catch(ce){ne(ce.toString())}}syncRTLPluginState(G,q,ne){try{l.plugin.setState(q);const ce=l.plugin.getPluginURL();if(l.plugin.isLoaded()&&!l.plugin.isParsed()&&ce!=null){this.self.importScripts(ce);const _e=l.plugin.isParsed();ne(_e?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ce}`),_e)}}catch(ce){ne(ce.toString())}}getAvailableImages(G){let q=this.availableImages[G];return q||(q=[]),q}getLayerIndex(G){let q=this.layerIndexes[G];return q||(q=this.layerIndexes[G]=new m),q}getWorkerSource(G,q,ne){if(this.workerSources[G]||(this.workerSources[G]={}),this.workerSources[G][q]||(this.workerSources[G][q]={}),!this.workerSources[G][q][ne]){const ce={send:(_e,Se,Te)=>{this.actor.send(_e,Se,Te,G)}};this.workerSources[G][q][ne]=new this.workerSourceTypes[q](ce,this.getLayerIndex(G),this.getAvailableImages(G))}return this.workerSources[G][q][ne]}getDEMWorkerSource(G,q){return this.demWorkerSources[G]||(this.demWorkerSources[G]={}),this.demWorkerSources[G][q]||(this.demWorkerSources[G][q]=new O),this.demWorkerSources[G][q]}}return l.isWorker()&&(self.worker=new xi(self)),xi}),a(["./shared"],function(l){var m="3.5.0";class _{static testProp(o){if(!_.docStyle)return o[0];for(let d=0;d<o.length;d++)if(o[d]in _.docStyle)return o[d];return o[0]}static create(o,d,p){const y=window.document.createElement(o);return d!==void 0&&(y.className=d),p&&p.appendChild(y),y}static createNS(o,d){return window.document.createElementNS(o,d)}static disableDrag(){_.docStyle&&_.selectProp&&(_.userSelect=_.docStyle[_.selectProp],_.docStyle[_.selectProp]="none")}static enableDrag(){_.docStyle&&_.selectProp&&(_.docStyle[_.selectProp]=_.userSelect)}static setTransform(o,d){o.style[_.transformProp]=d}static addEventListener(o,d,p,y={}){o.addEventListener(d,p,"passive"in y?y:y.capture)}static removeEventListener(o,d,p,y={}){o.removeEventListener(d,p,"passive"in y?y:y.capture)}static suppressClickInternal(o){o.preventDefault(),o.stopPropagation(),window.removeEventListener("click",_.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",_.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",_.suppressClickInternal,!0)},0)}static mousePos(o,d){const p=o.getBoundingClientRect();return new l.Point(d.clientX-p.left-o.clientLeft,d.clientY-p.top-o.clientTop)}static touchPos(o,d){const p=o.getBoundingClientRect(),y=[];for(let b=0;b<d.length;b++)y.push(new l.Point(d[b].clientX-p.left-o.clientLeft,d[b].clientY-p.top-o.clientTop));return y}static mouseButton(o){return o.button}static remove(o){o.parentNode&&o.parentNode.removeChild(o)}}_.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,_.selectProp=_.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),_.transformProp=_.testProp(["transform","WebkitTransform"]);const E={supported:!1,testSupport:function(v){!L&&I&&(O?D(v):S=v)}};let S,I,L=!1,O=!1;function D(v){const o=v.createTexture();v.bindTexture(v.TEXTURE_2D,o);try{if(v.texImage2D(v.TEXTURE_2D,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,I),v.isContextLost())return;E.supported=!0}catch{}v.deleteTexture(o),L=!0}var H,z;typeof document<"u"&&(I=document.createElement("img"),I.onload=function(){S&&D(S),S=null,O=!0},I.onerror=function(){L=!0,S=null},I.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(v){let o,d,p,y;v.resetRequestQueue=()=>{o=[],d=0,p=0,y={}},v.addThrottleControl=R=>{const U=p++;return y[U]=R,U},v.removeThrottleControl=R=>{delete y[R],C()},v.getImage=(R,U,V=!0)=>{E.supported&&(R.headers||(R.headers={}),R.headers.accept="image/webp,*/*");const X={requestParameters:R,supportImageRefresh:V,callback:U,cancelled:!1,completed:!1,cancel:()=>{X.completed||X.cancelled||(X.cancelled=!0,X.innerRequest&&(X.innerRequest.cancel(),d--),C())}};return o.push(X),C(),X};const b=R=>{const{requestParameters:U,supportImageRefresh:V,callback:X}=R;return l.extend(U,{type:"image"}),(V!==!1||l.isWorker()||l.getProtocolAction(U.url)||U.headers&&!Object.keys(U.headers).reduce((ue,le)=>ue&&le==="accept",!0)?l.makeRequest:M)(U,(ue,le,fe,oe)=>{P(R,X,ue,le,fe,oe)})},P=(R,U,V,X,ue,le)=>{V?U(V):X instanceof HTMLImageElement||l.isImageBitmap(X)?U(null,X):X&&((fe,oe)=>{typeof createImageBitmap=="function"?l.arrayBufferToImageBitmap(fe,oe):l.arrayBufferToImage(fe,oe)})(X,(fe,oe)=>{fe!=null?U(fe):oe!=null&&U(null,oe,{cacheControl:ue,expires:le})}),R.cancelled||(R.completed=!0,d--,C())},C=()=>{const R=(()=>{const U=Object.keys(y);let V=!1;if(U.length>0){for(const X of U)if(V=y[X](),V)break}return V})()?l.config.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:l.config.MAX_PARALLEL_IMAGE_REQUESTS;for(let U=d;U<R&&o.length>0;U++){const V=o.shift();if(V.cancelled){U--;continue}const X=b(V);d++,V.innerRequest=X}},M=(R,U)=>{const V=new Image,X=R.url;let ue=!1;const le=R.credentials;return le&&le==="include"?V.crossOrigin="use-credentials":(le&&le==="same-origin"||!l.sameOrigin(X))&&(V.crossOrigin="anonymous"),V.fetchPriority="high",V.onload=()=>{U(null,V),V.onerror=V.onload=null},V.onerror=()=>{ue||U(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),V.onerror=V.onload=null},V.src=X,{cancel:()=>{ue=!0,V.src=""}}}}(H||(H={})),H.resetRequestQueue(),function(v){v.Glyphs="Glyphs",v.Image="Image",v.Source="Source",v.SpriteImage="SpriteImage",v.SpriteJSON="SpriteJSON",v.Style="Style",v.Tile="Tile",v.Unknown="Unknown"}(z||(z={}));class N{constructor(o){this._transformRequestFn=o}transformRequest(o,d){return this._transformRequestFn&&this._transformRequestFn(o,d)||{url:o}}normalizeSpriteURL(o,d,p){const y=function(b){const P=b.match(F);if(!P)throw new Error(`Unable to parse URL "${b}"`);return{protocol:P[1],authority:P[2],path:P[3]||"/",params:P[4]?P[4].split("&"):[]}}(o);return y.path+=`${d}${p}`,function(b){const P=b.params.length?`?${b.params.join("&")}`:"";return`${b.protocol}://${b.authority}${b.path}${P}`}(y)}setTransformRequest(o){this._transformRequestFn=o}}const F=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function $(v){var o=new l.ARRAY_TYPE(3);return o[0]=v[0],o[1]=v[1],o[2]=v[2],o}var Q,te=function(v,o,d){return v[0]=o[0]-d[0],v[1]=o[1]-d[1],v[2]=o[2]-d[2],v};Q=new l.ARRAY_TYPE(3),l.ARRAY_TYPE!=Float32Array&&(Q[0]=0,Q[1]=0,Q[2]=0);var re=function(v){var o=v[0],d=v[1];return o*o+d*d};function we(v){const o=[];if(typeof v=="string")o.push({id:"default",url:v});else if(v&&v.length>0){const d=[];for(const{id:p,url:y}of v){const b=`${p}${y}`;d.indexOf(b)===-1&&(d.push(b),o.push({id:p,url:y}))}}return o}function Ee(v,o,d,p,y){if(p)return void v(p);if(y!==Object.values(o).length||y!==Object.values(d).length)return;const b={};for(const P in o){b[P]={};const C=l.browser.getImageCanvasContext(d[P]),M=o[P];for(const R in M){const{width:U,height:V,x:X,y:ue,sdf:le,pixelRatio:fe,stretchX:oe,stretchY:Pe,content:De}=M[R];b[P][R]={data:null,pixelRatio:fe,sdf:le,stretchX:oe,stretchY:Pe,content:De,spriteData:{width:U,height:V,x:X,y:ue,context:C}}}}v(null,b)}(function(){var v=new l.ARRAY_TYPE(2);l.ARRAY_TYPE!=Float32Array&&(v[0]=0,v[1]=0)})();class de{constructor(o,d,p,y){this.context=o,this.format=p,this.texture=o.gl.createTexture(),this.update(d,y)}update(o,d,p){const{width:y,height:b}=o,P=!(this.size&&this.size[0]===y&&this.size[1]===b||p),{context:C}=this,{gl:M}=C;if(this.useMipmap=!!(d&&d.useMipmap),M.bindTexture(M.TEXTURE_2D,this.texture),C.pixelStoreUnpackFlipY.set(!1),C.pixelStoreUnpack.set(1),C.pixelStoreUnpackPremultiplyAlpha.set(this.format===M.RGBA&&(!d||d.premultiply!==!1)),P)this.size=[y,b],o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||l.isImageBitmap(o)?M.texImage2D(M.TEXTURE_2D,0,this.format,this.format,M.UNSIGNED_BYTE,o):M.texImage2D(M.TEXTURE_2D,0,this.format,y,b,0,this.format,M.UNSIGNED_BYTE,o.data);else{const{x:R,y:U}=p||{x:0,y:0};o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||l.isImageBitmap(o)?M.texSubImage2D(M.TEXTURE_2D,0,R,U,M.RGBA,M.UNSIGNED_BYTE,o):M.texSubImage2D(M.TEXTURE_2D,0,R,U,y,b,M.RGBA,M.UNSIGNED_BYTE,o.data)}this.useMipmap&&this.isSizePowerOfTwo()&&M.generateMipmap(M.TEXTURE_2D)}bind(o,d,p){const{context:y}=this,{gl:b}=y;b.bindTexture(b.TEXTURE_2D,this.texture),p!==b.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(p=b.LINEAR),o!==this.filter&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,o),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,p||o),this.filter=o),d!==this.wrap&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,d),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,d),this.wrap=d)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:o}=this.context;o.deleteTexture(this.texture),this.texture=null}}function Le(v){const{userImage:o}=v;return!!(o&&o.render&&o.render())&&(v.data.replace(new Uint8Array(o.data.buffer)),!0)}class Ge extends l.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:d,callback:p}of this.requestors)this._notify(d,p);this.requestors=[]}}getImage(o){const d=this.images[o];if(d&&!d.data&&d.spriteData){const p=d.spriteData;d.data=new l.RGBAImage({width:p.width,height:p.height},p.context.getImageData(p.x,p.y,p.width,p.height).data),d.spriteData=null}return d}addImage(o,d){if(this.images[o])throw new Error(`Image id ${o} already exist, use updateImage instead`);this._validate(o,d)&&(this.images[o]=d)}_validate(o,d){let p=!0;const y=d.data||d.spriteData;return this._validateStretch(d.stretchX,y&&y.width)||(this.fire(new l.ErrorEvent(new Error(`Image "${o}" has invalid "stretchX" value`))),p=!1),this._validateStretch(d.stretchY,y&&y.height)||(this.fire(new l.ErrorEvent(new Error(`Image "${o}" has invalid "stretchY" value`))),p=!1),this._validateContent(d.content,d)||(this.fire(new l.ErrorEvent(new Error(`Image "${o}" has invalid "content" value`))),p=!1),p}_validateStretch(o,d){if(!o)return!0;let p=0;for(const y of o){if(y[0]<p||y[1]<y[0]||d<y[1])return!1;p=y[1]}return!0}_validateContent(o,d){if(!o)return!0;if(o.length!==4)return!1;const p=d.spriteData,y=p&&p.width||d.data.width,b=p&&p.height||d.data.height;return!(o[0]<0||y<o[0]||o[1]<0||b<o[1]||o[2]<0||y<o[2]||o[3]<0||b<o[3]||o[2]<o[0]||o[3]<o[1])}updateImage(o,d,p=!0){const y=this.getImage(o);if(p&&(y.data.width!==d.data.width||y.data.height!==d.data.height))throw new Error(`size mismatch between old image (${y.data.width}x${y.data.height}) and new image (${d.data.width}x${d.data.height}).`);d.version=y.version+1,this.images[o]=d,this.updatedImages[o]=!0}removeImage(o){const d=this.images[o];delete this.images[o],delete this.patterns[o],d.userImage&&d.userImage.onRemove&&d.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o,d){let p=!0;if(!this.isLoaded())for(const y of o)this.images[y]||(p=!1);this.isLoaded()||p?this._notify(o,d):this.requestors.push({ids:o,callback:d})}_notify(o,d){const p={};for(const y of o){let b=this.getImage(y);b||(this.fire(new l.Event("styleimagemissing",{id:y})),b=this.getImage(y)),b?p[y]={data:b.data.clone(),pixelRatio:b.pixelRatio,sdf:b.sdf,version:b.version,stretchX:b.stretchX,stretchY:b.stretchY,content:b.content,hasRenderCallback:!!(b.userImage&&b.userImage.render)}:l.warnOnce(`Image "${y}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}d(null,p)}getPixelSize(){const{width:o,height:d}=this.atlasImage;return{width:o,height:d}}getPattern(o){const d=this.patterns[o],p=this.getImage(o);if(!p)return null;if(d&&d.position.version===p.version)return d.position;if(d)d.position.version=p.version;else{const y={w:p.data.width+2,h:p.data.height+2,x:0,y:0},b=new l.ImagePosition(y,p);this.patterns[o]={bin:y,position:b}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const d=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new de(o,this.atlasImage,d.RGBA),this.atlasTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const b in this.patterns)o.push(this.patterns[b].bin);const{w:d,h:p}=l.potpack(o),y=this.atlasImage;y.resize({width:d||1,height:p||1});for(const b in this.patterns){const{bin:P}=this.patterns[b],C=P.x+1,M=P.y+1,R=this.getImage(b).data,U=R.width,V=R.height;l.RGBAImage.copy(R,y,{x:0,y:0},{x:C,y:M},{width:U,height:V}),l.RGBAImage.copy(R,y,{x:0,y:V-1},{x:C,y:M-1},{width:U,height:1}),l.RGBAImage.copy(R,y,{x:0,y:0},{x:C,y:M+V},{width:U,height:1}),l.RGBAImage.copy(R,y,{x:U-1,y:0},{x:C-1,y:M},{width:1,height:V}),l.RGBAImage.copy(R,y,{x:0,y:0},{x:C+U,y:M},{width:1,height:V})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const d of o){if(this.callbackDispatchedThisFrame[d])continue;this.callbackDispatchedThisFrame[d]=!0;const p=this.getImage(d);p||l.warnOnce(`Image with ID: "${d}" was not found`),Le(p)&&this.updateImage(d,p)}}}const Be=1e20;function Oe(v,o,d,p,y,b,P,C,M){for(let R=o;R<o+p;R++)Ke(v,d*b+R,b,y,P,C,M);for(let R=d;R<d+y;R++)Ke(v,R*b+o,1,p,P,C,M)}function Ke(v,o,d,p,y,b,P){b[0]=0,P[0]=-Be,P[1]=Be,y[0]=v[o];for(let C=1,M=0,R=0;C<p;C++){y[C]=v[o+C*d];const U=C*C;do{const V=b[M];R=(y[C]-y[V]+U-V*V)/(C-V)/2}while(R<=P[M]&&--M>-1);M++,b[M]=C,P[M]=R,P[M+1]=Be}for(let C=0,M=0;C<p;C++){for(;P[M+1]<C;)M++;const R=b[M],U=C-R;v[o+C*d]=y[R]+U*U}}class je{constructor(o,d){this.requestManager=o,this.localIdeographFontFamily=d,this.entries={}}setURL(o){this.url=o}getGlyphs(o,d){const p=[];for(const y in o)for(const b of o[y])p.push({stack:y,id:b});l.asyncAll(p,({stack:y,id:b},P)=>{let C=this.entries[y];C||(C=this.entries[y]={glyphs:{},requests:{},ranges:{}});let M=C.glyphs[b];if(M!==void 0)return void P(null,{stack:y,id:b,glyph:M});if(M=this._tinySDF(C,y,b),M)return C.glyphs[b]=M,void P(null,{stack:y,id:b,glyph:M});const R=Math.floor(b/256);if(256*R>65535)return void P(new Error("glyphs > 65535 not supported"));if(C.ranges[R])return void P(null,{stack:y,id:b,glyph:M});if(!this.url)return void P(new Error("glyphsUrl is not set"));let U=C.requests[R];U||(U=C.requests[R]=[],je.loadGlyphRange(y,R,this.url,this.requestManager,(V,X)=>{if(X){for(const ue in X)this._doesCharSupportLocalGlyph(+ue)||(C.glyphs[+ue]=X[+ue]);C.ranges[R]=!0}for(const ue of U)ue(V,X);delete C.requests[R]})),U.push((V,X)=>{V?P(V):X&&P(null,{stack:y,id:b,glyph:X[b]||null})})},(y,b)=>{if(y)d(y);else if(b){const P={};for(const{stack:C,id:M,glyph:R}of b)(P[C]||(P[C]={}))[M]=R&&{id:R.id,bitmap:R.bitmap.clone(),metrics:R.metrics};d(null,P)}})}_doesCharSupportLocalGlyph(o){return!!this.localIdeographFontFamily&&(l.unicodeBlockLookup["CJK Unified Ideographs"](o)||l.unicodeBlockLookup["Hangul Syllables"](o)||l.unicodeBlockLookup.Hiragana(o)||l.unicodeBlockLookup.Katakana(o))}_tinySDF(o,d,p){const y=this.localIdeographFontFamily;if(!y||!this._doesCharSupportLocalGlyph(p))return;let b=o.tinySDF;if(!b){let C="400";/bold/i.test(d)?C="900":/medium/i.test(d)?C="500":/light/i.test(d)&&(C="200"),b=o.tinySDF=new je.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:y,fontWeight:C})}const P=b.draw(String.fromCharCode(p));return{id:p,bitmap:new l.AlphaImage({width:P.width||60,height:P.height||60},P.data),metrics:{width:P.glyphWidth/2||24,height:P.glyphHeight/2||24,left:P.glyphLeft/2+.5||0,top:P.glyphTop/2-27.5||-8,advance:P.glyphAdvance/2||24,isDoubleResolution:!0}}}}je.loadGlyphRange=function(v,o,d,p,y){const b=256*o,P=b+255,C=p.transformRequest(d.replace("{fontstack}",v).replace("{range}",`${b}-${P}`),z.Glyphs);l.getArrayBuffer(C,(M,R)=>{if(M)y(M);else if(R){const U={};for(const V of l.parseGlyphPbf(R))U[V.id]=V;y(null,U)}})},je.TinySDF=class{constructor({fontSize:v=24,buffer:o=3,radius:d=8,cutoff:p=.25,fontFamily:y="sans-serif",fontWeight:b="normal",fontStyle:P="normal"}={}){this.buffer=o,this.cutoff=p,this.radius=d;const C=this.size=v+4*o,M=this._createCanvas(C),R=this.ctx=M.getContext("2d",{willReadFrequently:!0});R.font=`${P} ${b} ${v}px ${y}`,R.textBaseline="alphabetic",R.textAlign="left",R.fillStyle="black",this.gridOuter=new Float64Array(C*C),this.gridInner=new Float64Array(C*C),this.f=new Float64Array(C),this.z=new Float64Array(C+1),this.v=new Uint16Array(C)}_createCanvas(v){const o=document.createElement("canvas");return o.width=o.height=v,o}draw(v){const{width:o,actualBoundingBoxAscent:d,actualBoundingBoxDescent:p,actualBoundingBoxLeft:y,actualBoundingBoxRight:b}=this.ctx.measureText(v),P=Math.ceil(d),C=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(b-y))),M=Math.min(this.size-this.buffer,P+Math.ceil(p)),R=C+2*this.buffer,U=M+2*this.buffer,V=Math.max(R*U,0),X=new Uint8ClampedArray(V),ue={data:X,width:R,height:U,glyphWidth:C,glyphHeight:M,glyphTop:P,glyphLeft:0,glyphAdvance:o};if(C===0||M===0)return ue;const{ctx:le,buffer:fe,gridInner:oe,gridOuter:Pe}=this;le.clearRect(fe,fe,C,M),le.fillText(v,fe,fe+P);const De=le.getImageData(fe,fe,C,M);Pe.fill(Be,0,V),oe.fill(0,0,V);for(let me=0;me<M;me++)for(let Ae=0;Ae<C;Ae++){const Ue=De.data[4*(me*C+Ae)+3]/255;if(Ue===0)continue;const $e=(me+fe)*R+Ae+fe;if(Ue===1)Pe[$e]=0,oe[$e]=Be;else{const Xe=.5-Ue;Pe[$e]=Xe>0?Xe*Xe:0,oe[$e]=Xe<0?Xe*Xe:0}}Oe(Pe,0,0,R,U,R,this.f,this.v,this.z),Oe(oe,fe,fe,C,M,R,this.f,this.v,this.z);for(let me=0;me<V;me++){const Ae=Math.sqrt(Pe[me])-Math.sqrt(oe[me]);X[me]=Math.round(255-255*(Ae/this.radius+this.cutoff))}return ue}};class it{constructor(){this.specification=l.v8Spec.light.position}possiblyEvaluate(o,d){return l.sphericalToCartesian(o.expression.evaluate(d))}interpolate(o,d,p){return{x:l.interpolate.number(o.x,d.x,p),y:l.interpolate.number(o.y,d.y,p),z:l.interpolate.number(o.z,d.z,p)}}}let Me;class qe extends l.Evented{constructor(o){super(),Me=Me||new l.Properties({anchor:new l.DataConstantProperty(l.v8Spec.light.anchor),position:new it,color:new l.DataConstantProperty(l.v8Spec.light.color),intensity:new l.DataConstantProperty(l.v8Spec.light.intensity)}),this._transitionable=new l.Transitionable(Me),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,d={}){if(!this._validate(l.validateLight,o,d))for(const p in o){const y=o[p];p.endsWith("-transition")?this._transitionable.setTransition(p.slice(0,-11),y):this._transitionable.setValue(p,y)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,d,p){return(!p||p.validate!==!1)&&l.emitValidationErrors(this,o.call(l.validateStyle,l.extend({value:d,style:{glyphs:!0,sprite:!0},styleSpec:l.v8Spec})))}}class ut{constructor(o,d){this.width=o,this.height=d,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(o,d){const p=o.join(",")+String(d);return this.dashEntry[p]||(this.dashEntry[p]=this.addDash(o,d)),this.dashEntry[p]}getDashRanges(o,d,p){const y=[];let b=o.length%2==1?-o[o.length-1]*p:0,P=o[0]*p,C=!0;y.push({left:b,right:P,isDash:C,zeroLength:o[0]===0});let M=o[0];for(let R=1;R<o.length;R++){C=!C;const U=o[R];b=M*p,M+=U,P=M*p,y.push({left:b,right:P,isDash:C,zeroLength:U===0})}return y}addRoundDash(o,d,p){const y=d/2;for(let b=-p;b<=p;b++){const P=this.width*(this.nextRow+p+b);let C=0,M=o[C];for(let R=0;R<this.width;R++){R/M.right>1&&(M=o[++C]);const U=Math.abs(R-M.left),V=Math.abs(R-M.right),X=Math.min(U,V);let ue;const le=b/p*(y+1);if(M.isDash){const fe=y-Math.abs(le);ue=Math.sqrt(X*X+fe*fe)}else ue=y-Math.sqrt(X*X+le*le);this.data[P+R]=Math.max(0,Math.min(255,ue+128))}}}addRegularDash(o){for(let C=o.length-1;C>=0;--C){const M=o[C],R=o[C+1];M.zeroLength?o.splice(C,1):R&&R.isDash===M.isDash&&(R.left=M.left,o.splice(C,1))}const d=o[0],p=o[o.length-1];d.isDash===p.isDash&&(d.left=p.left-this.width,p.right=d.right+this.width);const y=this.width*this.nextRow;let b=0,P=o[b];for(let C=0;C<this.width;C++){C/P.right>1&&(P=o[++b]);const M=Math.abs(C-P.left),R=Math.abs(C-P.right),U=Math.min(M,R);this.data[y+C]=Math.max(0,Math.min(255,(P.isDash?U:-U)+128))}}addDash(o,d){const p=d?7:0,y=2*p+1;if(this.nextRow+y>this.height)return l.warnOnce("LineAtlas out of space"),null;let b=0;for(let C=0;C<o.length;C++)b+=o[C];if(b!==0){const C=this.width/b,M=this.getDashRanges(o,this.width,C);d?this.addRoundDash(M,C,p):this.addRegularDash(M)}const P={y:(this.nextRow+p+.5)/this.height,height:2*p/this.height,width:b};return this.nextRow+=y,this.dirty=!0,P}bind(o){const d=o.gl;this.texture?(d.bindTexture(d.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,d.texSubImage2D(d.TEXTURE_2D,0,0,0,this.width,this.height,d.ALPHA,d.UNSIGNED_BYTE,this.data))):(this.texture=d.createTexture(),d.bindTexture(d.TEXTURE_2D,this.texture),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texImage2D(d.TEXTURE_2D,0,d.ALPHA,this.width,this.height,0,d.ALPHA,d.UNSIGNED_BYTE,this.data))}}class zt{constructor(o,d,p){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=p;const y=this.workerPool.acquire(p);for(let b=0;b<y.length;b++){const P=new zt.Actor(y[b],d,p);P.name=`Worker ${b}`,this.actors.push(P)}if(!this.actors.length)throw new Error("No actors found")}broadcast(o,d,p){l.asyncAll(this.actors,(y,b)=>{y.send(o,d,b)},p=p||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(o=!0){this.actors.forEach(d=>{d.remove()}),this.actors=[],o&&this.workerPool.release(this.id)}}function vt(v,o,d){const p=function(y,b){if(y)return d(y);if(b){const P=l.pick(l.extend(b,v),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);b.vector_layers&&(P.vectorLayers=b.vector_layers,P.vectorLayerIds=P.vectorLayers.map(C=>C.id)),d(null,P)}};return v.url?l.getJSON(o.transformRequest(v.url,z.Source),p):l.browser.frame(()=>p(null,v))}zt.Actor=l.Actor;class yt{constructor(o,d){o&&(d?this.setSouthWest(o).setNorthEast(d):Array.isArray(o)&&(o.length===4?this.setSouthWest([o[0],o[1]]).setNorthEast([o[2],o[3]]):this.setSouthWest(o[0]).setNorthEast(o[1])))}setNorthEast(o){return this._ne=o instanceof l.LngLat?new l.LngLat(o.lng,o.lat):l.LngLat.convert(o),this}setSouthWest(o){return this._sw=o instanceof l.LngLat?new l.LngLat(o.lng,o.lat):l.LngLat.convert(o),this}extend(o){const d=this._sw,p=this._ne;let y,b;if(o instanceof l.LngLat)y=o,b=o;else{if(!(o instanceof yt))return Array.isArray(o)?o.length===4||o.every(Array.isArray)?this.extend(yt.convert(o)):this.extend(l.LngLat.convert(o)):o&&("lng"in o||"lon"in o)&&"lat"in o?this.extend(l.LngLat.convert(o)):this;if(y=o._sw,b=o._ne,!y||!b)return this}return d||p?(d.lng=Math.min(y.lng,d.lng),d.lat=Math.min(y.lat,d.lat),p.lng=Math.max(b.lng,p.lng),p.lat=Math.max(b.lat,p.lat)):(this._sw=new l.LngLat(y.lng,y.lat),this._ne=new l.LngLat(b.lng,b.lat)),this}getCenter(){return new l.LngLat((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new l.LngLat(this.getWest(),this.getNorth())}getSouthEast(){return new l.LngLat(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:d,lat:p}=l.LngLat.convert(o);let y=this._sw.lng<=d&&d<=this._ne.lng;return this._sw.lng>this._ne.lng&&(y=this._sw.lng>=d&&d>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&y}static convert(o){return o instanceof yt?o:o&&new yt(o)}static fromLngLat(o,d=0){const p=360*d/40075017,y=p/Math.cos(Math.PI/180*o.lat);return new yt(new l.LngLat(o.lng-y,o.lat-p),new l.LngLat(o.lng+y,o.lat+p))}}class at{constructor(o,d,p){this.bounds=yt.convert(this.validateBounds(o)),this.minzoom=d||0,this.maxzoom=p||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const d=Math.pow(2,o.z),p=Math.floor(l.mercatorXfromLng(this.bounds.getWest())*d),y=Math.floor(l.mercatorYfromLat(this.bounds.getNorth())*d),b=Math.ceil(l.mercatorXfromLng(this.bounds.getEast())*d),P=Math.ceil(l.mercatorYfromLat(this.bounds.getSouth())*d);return o.x>=p&&o.x<b&&o.y>=y&&o.y<P}}class bt extends l.Evented{constructor(o,d,p,y){if(super(),this.load=()=>{this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=vt(this._options,this.map._requestManager,(b,P)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),b?this.fire(new l.ErrorEvent(b)):P&&(l.extend(this,P),P.bounds&&(this.tileBounds=new at(P.bounds,this.minzoom,this.maxzoom)),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})))})},this.serialize=()=>l.extend({},this._options),this.id=o,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.extend(this,l.pick(d,["url","scheme","tileSize","promoteId"])),this._options=l.extend({type:"vector"},d),this._collectResourceTiming=d.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(y)}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}setSourceProperty(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.load()}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}setUrl(o){return this.setSourceProperty(()=>{this.url=o,this._options.url=o}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}loadTile(o,d){const p=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),y={request:this.map._requestManager.transformRequest(p,z.Tile),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function b(P,C){return delete o.request,o.aborted?d(null):P&&P.status!==404?d(P):(C&&C.resourceTiming&&(o.resourceTiming=C.resourceTiming),this.map._refreshExpiredTiles&&C&&o.setExpiryData(C),o.loadVectorData(C,this.map.painter),d(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}y.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired"?o.state==="loading"?o.reloadCallback=d:o.request=o.actor.send("reloadTile",y,b.bind(this)):(o.actor=this.dispatcher.getActor(),o.request=o.actor.send("loadTile",y,b.bind(this)))}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id},void 0)}unloadTile(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class xt extends l.Evented{constructor(o,d,p,y){super(),this.id=o,this.dispatcher=p,this.setEventedParent(y),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.extend({type:"raster"},d),l.extend(this,l.pick(d,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=vt(this._options,this.map._requestManager,(o,d)=>{this._tileJSONRequest=null,this._loaded=!0,o?this.fire(new l.ErrorEvent(o)):d&&(l.extend(this,d),d.bounds&&(this.tileBounds=new at(d.bounds,this.minzoom,this.maxzoom)),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}setSourceProperty(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.load()}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}serialize(){return l.extend({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,d){const p=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);o.request=H.getImage(this.map._requestManager.transformRequest(p,z.Tile),(y,b,P)=>{if(delete o.request,o.aborted)o.state="unloaded",d(null);else if(y)o.state="errored",d(y);else if(b){this.map._refreshExpiredTiles&&P&&o.setExpiryData(P);const C=this.map.painter.context,M=C.gl;o.texture=this.map.painter.getTileTexture(b.width),o.texture?o.texture.update(b,{useMipmap:!0}):(o.texture=new de(C,b,M.RGBA,{useMipmap:!0}),o.texture.bind(M.LINEAR,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),C.extTextureFilterAnisotropic&&M.texParameterf(M.TEXTURE_2D,C.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,C.extTextureFilterAnisotropicMax)),o.state="loaded",d(null)}},this.map._refreshExpiredTiles)}abortTile(o,d){o.request&&(o.request.cancel(),delete o.request),d()}unloadTile(o,d){o.texture&&this.map.painter.saveTileTexture(o.texture),d()}hasTransition(){return!1}}class $t extends xt{constructor(o,d,p,y){super(o,d,p,y),this.type="raster-dem",this.maxzoom=22,this._options=l.extend({type:"raster-dem"},d),this.encoding=d.encoding||"mapbox",this.redFactor=d.redFactor,this.greenFactor=d.greenFactor,this.blueFactor=d.blueFactor,this.baseShift=d.baseShift}loadTile(o,d){const p=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),y=this.map._requestManager.transformRequest(p,z.Tile);function b(P,C){P&&(o.state="errored",d(P)),C&&(o.dem=C,o.needsHillshadePrepare=!0,o.needsTerrainPrepare=!0,o.state="loaded",d(null))}o.neighboringTiles=this._getNeighboringTiles(o.tileID),o.request=H.getImage(y,async(P,C,M)=>{if(delete o.request,o.aborted)o.state="unloaded",d(null);else if(P)o.state="errored",d(P);else if(C){this.map._refreshExpiredTiles&&o.setExpiryData(M);const R=l.isImageBitmap(C)&&l.offscreenCanvasSupported()?C:await async function(V){if(typeof VideoFrame<"u"&&l.isOffscreenCanvasDistorted()){const X=V.width+2,ue=V.height+2;try{return new l.RGBAImage({width:X,height:ue},await l.readImageUsingVideoFrame(V,-1,-1,X,ue))}catch{}}return l.browser.getImageData(V,1)}(C),U={uid:o.uid,coord:o.tileID,source:this.id,rawImageData:R,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};o.actor&&o.state!=="expired"||(o.actor=this.dispatcher.getActor(),o.actor.send("loadDEMTile",U,b))}},this.map._refreshExpiredTiles)}_getNeighboringTiles(o){const d=o.canonical,p=Math.pow(2,d.z),y=(d.x-1+p)%p,b=d.x===0?o.wrap-1:o.wrap,P=(d.x+1+p)%p,C=d.x+1===p?o.wrap+1:o.wrap,M={};return M[new l.OverscaledTileID(o.overscaledZ,b,d.z,y,d.y).key]={backfilled:!1},M[new l.OverscaledTileID(o.overscaledZ,C,d.z,P,d.y).key]={backfilled:!1},d.y>0&&(M[new l.OverscaledTileID(o.overscaledZ,b,d.z,y,d.y-1).key]={backfilled:!1},M[new l.OverscaledTileID(o.overscaledZ,o.wrap,d.z,d.x,d.y-1).key]={backfilled:!1},M[new l.OverscaledTileID(o.overscaledZ,C,d.z,P,d.y-1).key]={backfilled:!1}),d.y+1<p&&(M[new l.OverscaledTileID(o.overscaledZ,b,d.z,y,d.y+1).key]={backfilled:!1},M[new l.OverscaledTileID(o.overscaledZ,o.wrap,d.z,d.x,d.y+1).key]={backfilled:!1},M[new l.OverscaledTileID(o.overscaledZ,C,d.z,P,d.y+1).key]={backfilled:!1}),M}unloadTile(o){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&o.actor.send("removeDEMTile",{uid:o.uid,source:this.id})}}class Kt extends l.Evented{constructor(o,d,p,y){super(),this.load=()=>{this._updateWorkerData()},this.serialize=()=>l.extend({},this._options,{type:this.type,data:this._data}),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=p.getActor(),this.setEventedParent(y),this._data=d.data,this._options=l.extend({},d),this._collectResourceTiming=d.collectResourceTiming,d.maxzoom!==void 0&&(this.maxzoom=d.maxzoom),d.type&&(this.type=d.type),d.attribution&&(this.attribution=d.attribution),this.promoteId=d.promoteId;const b=l.EXTENT/this.tileSize;this.workerOptions=l.extend({source:this.id,cluster:d.cluster||!1,geojsonVtOptions:{buffer:(d.buffer!==void 0?d.buffer:128)*b,tolerance:(d.tolerance!==void 0?d.tolerance:.375)*b,extent:l.EXTENT,maxZoom:this.maxzoom,lineMetrics:d.lineMetrics||!1,generateId:d.generateId||!1},superclusterOptions:{maxZoom:d.clusterMaxZoom!==void 0?d.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,d.clusterMinPoints||2),extent:l.EXTENT,radius:(d.clusterRadius||50)*b,log:!1,generateId:d.generateId||!1},clusterProperties:d.clusterProperties,filter:d.filter},d.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}onAdd(o){this.map=o,this.load()}setData(o){return this._data=o,this._updateWorkerData(),this}updateData(o){return this._updateWorkerData(o),this}setClusterOptions(o){return this.workerOptions.cluster=o.cluster,o&&(o.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=o.clusterRadius),o.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=o.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(o,d){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:o,source:this.id},d),this}getClusterChildren(o,d){return this.actor.send("geojson.getClusterChildren",{clusterId:o,source:this.id},d),this}getClusterLeaves(o,d,p,y){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:o,limit:d,offset:p},y),this}_updateWorkerData(o){const d=l.extend({},this.workerOptions);o?d.dataDiff=o:typeof this._data=="string"?(d.request=this.map._requestManager.transformRequest(l.browser.resolveURL(this._data),z.Source),d.request.collectResourceTiming=this._collectResourceTiming):d.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new l.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,d,(p,y)=>{if(this._pendingLoads--,this._removed||y&&y.abandoned)return void this.fire(new l.Event("dataabort",{dataType:"source"}));let b=null;if(y&&y.resourceTiming&&y.resourceTiming[this.id]&&(b=y.resourceTiming[this.id].slice(0)),p)return void this.fire(new l.ErrorEvent(p));const P={dataType:"source"};this._collectResourceTiming&&b&&b.length>0&&l.extend(P,{resourceTiming:b}),this.fire(new l.Event("data",{...P,sourceDataType:"metadata"})),this.fire(new l.Event("data",{...P,sourceDataType:"content"}))})}loaded(){return this._pendingLoads===0}loadTile(o,d){const p=o.actor?"reloadTile":"loadTile";o.actor=this.actor;const y={type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};o.request=this.actor.send(p,y,(b,P)=>(delete o.request,o.unloadVectorData(),o.aborted?d(null):b?d(b):(o.loadVectorData(P,this.map.painter,p==="reloadTile"),d(null))))}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.aborted=!0}unloadTile(o){o.unloadVectorData(),this.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}hasTransition(){return!1}}var Ct=l.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class sn extends l.Evented{constructor(o,d,p,y){super(),this.load=(b,P)=>{this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=H.getImage(this.map._requestManager.transformRequest(this.url,z.Image),(C,M)=>{this._request=null,this._loaded=!0,C?this.fire(new l.ErrorEvent(C)):M&&(this.image=M,b&&(this.coordinates=b),P&&P(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||!this.image)return;const b=this.map.painter.context,P=b.gl;this.boundsBuffer||(this.boundsBuffer=b.createVertexBuffer(this._boundsArray,Ct.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new de(b,this.image,P.RGBA),this.texture.bind(P.LINEAR,P.CLAMP_TO_EDGE));let C=!1;for(const M in this.tiles){const R=this.tiles[M];R.state!=="loaded"&&(R.state="loaded",R.texture=this.texture,C=!0)}C&&this.fire(new l.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"image",url:this.options.url,coordinates:this.coordinates}),this.id=o,this.dispatcher=p,this.coordinates=d.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(y),this.options=d}loaded(){return this._loaded}updateImage(o){return o.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=o.url,this.load(o.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(o){this.coordinates=o;const d=o.map(l.MercatorCoordinate.fromLngLat);this.tileID=function(y){let b=1/0,P=1/0,C=-1/0,M=-1/0;for(const X of y)b=Math.min(b,X.x),P=Math.min(P,X.y),C=Math.max(C,X.x),M=Math.max(M,X.y);const R=Math.max(C-b,M-P),U=Math.max(0,Math.floor(-Math.log(R)/Math.LN2)),V=Math.pow(2,U);return new l.CanonicalTileID(U,Math.floor((b+C)/2*V),Math.floor((P+M)/2*V))}(d),this.minzoom=this.maxzoom=this.tileID.z;const p=d.map(y=>this.tileID.getTilePoint(y)._round());return this._boundsArray=new l.RasterBoundsArray,this._boundsArray.emplaceBack(p[0].x,p[0].y,0,0),this._boundsArray.emplaceBack(p[1].x,p[1].y,l.EXTENT,0),this._boundsArray.emplaceBack(p[3].x,p[3].y,0,l.EXTENT),this._boundsArray.emplaceBack(p[2].x,p[2].y,l.EXTENT,l.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})),this}loadTile(o,d){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},d(null)):(o.state="errored",d(null))}hasTransition(){return!1}}class Qt extends sn{constructor(o,d,p,y){super(o,d,p,y),this.load=()=>{this._loaded=!1;const b=this.options;this.urls=[];for(const P of b.urls)this.urls.push(this.map._requestManager.transformRequest(P,z.Source).url);l.getVideo(this.urls,(P,C)=>{this._loaded=!0,P?this.fire(new l.ErrorEvent(P)):C&&(this.video=C,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const b=this.map.painter.context,P=b.gl;this.boundsBuffer||(this.boundsBuffer=b.createVertexBuffer(this._boundsArray,Ct.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(P.LINEAR,P.CLAMP_TO_EDGE),P.texSubImage2D(P.TEXTURE_2D,0,0,0,P.RGBA,P.UNSIGNED_BYTE,this.video)):(this.texture=new de(b,this.video,P.RGBA),this.texture.bind(P.LINEAR,P.CLAMP_TO_EDGE));let C=!1;for(const M in this.tiles){const R=this.tiles[M];R.state!=="loaded"&&(R.state="loaded",R.texture=this.texture,C=!0)}C&&this.fire(new l.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"video",urls:this.urls,coordinates:this.coordinates}),this.roundZoom=!0,this.type="video",this.options=d}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(o){if(this.video){const d=this.video.seekable;o<d.start(0)||o>d.end(0)?this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${d.start(0)} and ${d.end(0)}-second mark.`))):this.video.currentTime=o}}getVideo(){return this.video}onAdd(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}hasTransition(){return this.video&&!this.video.paused}}class pn extends sn{constructor(o,d,p,y){super(o,d,p,y),this.load=()=>{this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},this.prepare=()=>{let b=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,b=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,b=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const P=this.map.painter.context,C=P.gl;this.boundsBuffer||(this.boundsBuffer=P.createVertexBuffer(this._boundsArray,Ct.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(b||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new de(P,this.canvas,C.RGBA,{premultiply:!0});let M=!1;for(const R in this.tiles){const U=this.tiles[R];U.state!=="loaded"&&(U.state="loaded",U.texture=this.texture,M=!0)}M&&this.fire(new l.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"canvas",coordinates:this.coordinates}),d.coordinates?Array.isArray(d.coordinates)&&d.coordinates.length===4&&!d.coordinates.some(b=>!Array.isArray(b)||b.length!==2||b.some(P=>typeof P!="number"))||this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${o}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${o}`,null,'missing required property "coordinates"'))),d.animate&&typeof d.animate!="boolean"&&this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${o}`,null,'optional "animate" property must be a boolean value'))),d.canvas?typeof d.canvas=="string"||d.canvas instanceof HTMLCanvasElement||this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${o}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${o}`,null,'missing required property "canvas"'))),this.options=d,this.animate=d.animate===void 0||d.animate}getCanvas(){return this.canvas}onAdd(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const o of[this.canvas.width,this.canvas.height])if(isNaN(o)||o<=0)return!0;return!1}}const Wt={},Ot=v=>{switch(v){case"geojson":return Kt;case"image":return sn;case"raster":return xt;case"raster-dem":return $t;case"vector":return bt;case"video":return Qt;case"canvas":return pn}return Wt[v]};function Dt(v,o){const d=l.create();return l.translate(d,d,[1,1,0]),l.scale(d,d,[.5*v.width,.5*v.height,1]),l.multiply(d,d,v.calculatePosMatrix(o.toUnwrapped()))}function wn(v,o,d,p,y,b){const P=function(V,X,ue){if(V)for(const le of V){const fe=X[le];if(fe&&fe.source===ue&&fe.type==="fill-extrusion")return!0}else for(const le in X){const fe=X[le];if(fe.source===ue&&fe.type==="fill-extrusion")return!0}return!1}(y&&y.layers,o,v.id),C=b.maxPitchScaleFactor(),M=v.tilesIn(p,C,P);M.sort(mn);const R=[];for(const V of M)R.push({wrappedTileID:V.tileID.wrapped().key,queryResults:V.tile.queryRenderedFeatures(o,d,v._state,V.queryGeometry,V.cameraQueryGeometry,V.scale,y,b,C,Dt(v.transform,V.tileID))});const U=function(V){const X={},ue={};for(const le of V){const fe=le.queryResults,oe=le.wrappedTileID,Pe=ue[oe]=ue[oe]||{};for(const De in fe){const me=fe[De],Ae=Pe[De]=Pe[De]||{},Ue=X[De]=X[De]||[];for(const $e of me)Ae[$e.featureIndex]||(Ae[$e.featureIndex]=!0,Ue.push($e))}}return X}(R);for(const V in U)U[V].forEach(X=>{const ue=X.feature,le=v.getFeatureState(ue.layer["source-layer"],ue.id);ue.source=ue.layer.source,ue.layer["source-layer"]&&(ue.sourceLayer=ue.layer["source-layer"]),ue.state=le});return U}function mn(v,o){const d=v.tileID,p=o.tileID;return d.overscaledZ-p.overscaledZ||d.canonical.y-p.canonical.y||d.wrap-p.wrap||d.canonical.x-p.canonical.x}class En{constructor(o,d){this.timeAdded=0,this.fadeEndTime=0,this.tileID=o,this.uid=l.uniqueId(),this.uses=0,this.tileSize=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(o){const d=o+this.timeAdded;d<this.fadeEndTime||(this.fadeEndTime=d)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(o){this.demTexture&&o.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(o,d,p){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=function(y,b){const P={};if(!b)return P;for(const C of y){const M=C.layerIds.map(R=>b.getLayer(R)).filter(Boolean);if(M.length!==0){C.layers=M,C.stateDependentLayerIds&&(C.stateDependentLayers=C.stateDependentLayerIds.map(R=>M.filter(U=>U.id===R)[0]));for(const R of M)P[R.id]=C}}return P}(o.buckets,d.style),this.hasSymbolBuckets=!1;for(const y in this.buckets){const b=this.buckets[y];if(b instanceof l.SymbolBucket){if(this.hasSymbolBuckets=!0,!p)break;b.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const y in this.buckets){const b=this.buckets[y];if(b instanceof l.SymbolBucket&&b.hasRTLText){this.hasRTLText=!0,l.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const y in this.buckets){const b=this.buckets[y];this.queryPadding=Math.max(this.queryPadding,d.style.getLayer(y).queryRadius(b))}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage)}else this.collisionBoxArray=new l.CollisionBoxArray}unloadVectorData(){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(o){return this.buckets[o.id]}upload(o){for(const p in this.buckets){const y=this.buckets[p];y.uploadPending()&&y.upload(o)}const d=o.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new de(o,this.imageAtlas.image,d.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new de(o,this.glyphAtlasImage,d.ALPHA),this.glyphAtlasImage=null)}prepare(o){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture)}queryRenderedFeatures(o,d,p,y,b,P,C,M,R,U){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:y,cameraQueryGeometry:b,scale:P,tileSize:this.tileSize,pixelPosMatrix:U,transform:M,params:C,queryPadding:this.queryPadding*R},o,d,p):{}}querySourceFeatures(o,d){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const y=p.loadVTLayers(),b=d&&d.sourceLayer?d.sourceLayer:"",P=y._geojsonTileLayer||y[b];if(!P)return;const C=l.createFilter(d&&d.filter),{z:M,x:R,y:U}=this.tileID.canonical,V={z:M,x:R,y:U};for(let X=0;X<P.length;X++){const ue=P.feature(X);if(C.needGeometry){const oe=l.toEvaluationFeature(ue,!0);if(!C.filter(new l.EvaluationParameters(this.tileID.overscaledZ),oe,this.tileID.canonical))continue}else if(!C.filter(new l.EvaluationParameters(this.tileID.overscaledZ),ue))continue;const le=p.getId(ue,b),fe=new l.GeoJSONFeature(ue,M,R,U,le);fe.tile=V,o.push(fe)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const d=this.expirationTime;if(o.cacheControl){const p=l.parseCacheControl(o.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const p=Date.now();let y=!1;if(this.expirationTime>p)y=!1;else if(d)if(this.expirationTime<d)y=!0;else{const b=this.expirationTime-d;b?this.expirationTime=p+Math.max(b,3e4):y=!0}else y=!0;y?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(o,d){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(o).length===0)return;const p=this.latestFeatureIndex.loadVTLayers();for(const y in this.buckets){if(!d.style.hasLayer(y))continue;const b=this.buckets[y],P=b.layers[0].sourceLayer||"_geojsonTileLayer",C=p[P],M=o[P];if(!C||!M||Object.keys(M).length===0)continue;b.update(M,C,this.imageAtlas&&this.imageAtlas.patternPositions||{});const R=d&&d.style&&d.style.getLayer(y);R&&(this.queryPadding=Math.max(this.queryPadding,R.queryRadius(b)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<l.browser.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=l.browser.now()+o}setDependencies(o,d){const p={};for(const y of d)p[y]=!0;this.dependencies[o]=p}hasDependency(o,d){for(const p of o){const y=this.dependencies[p];if(y){for(const b of d)if(y[b])return!0}}return!1}}class zn{constructor(o,d){this.max=o,this.onRemove=d,this.reset()}reset(){for(const o in this.data)for(const d of this.data[o])d.timeout&&clearTimeout(d.timeout),this.onRemove(d.value);return this.data={},this.order=[],this}add(o,d,p){const y=o.wrapped().key;this.data[y]===void 0&&(this.data[y]=[]);const b={value:d,timeout:void 0};if(p!==void 0&&(b.timeout=setTimeout(()=>{this.remove(o,b)},p)),this.data[y].push(b),this.order.push(y),this.order.length>this.max){const P=this._getAndRemoveByKey(this.order[0]);P&&this.onRemove(P)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const d=this.data[o].shift();return d.timeout&&clearTimeout(d.timeout),this.data[o].length===0&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),d.value}getByKey(o){const d=this.data[o];return d?d[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,d){if(!this.has(o))return this;const p=o.wrapped().key,y=d===void 0?0:this.data[p].indexOf(d),b=this.data[p][y];return this.data[p].splice(y,1),b.timeout&&clearTimeout(b.timeout),this.data[p].length===0&&delete this.data[p],this.onRemove(b.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const d=this._getAndRemoveByKey(this.order[0]);d&&this.onRemove(d)}return this}filter(o){const d=[];for(const p in this.data)for(const y of this.data[p])o(y.value)||d.push(y);for(const p of d)this.remove(p.value.tileID,p)}}class Re{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,d,p){const y=String(d);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][y]=this.stateChanges[o][y]||{},l.extend(this.stateChanges[o][y],p),this.deletedStates[o]===null){this.deletedStates[o]={};for(const b in this.state[o])b!==y&&(this.deletedStates[o][b]=null)}else if(this.deletedStates[o]&&this.deletedStates[o][y]===null){this.deletedStates[o][y]={};for(const b in this.state[o][y])p[b]||(this.deletedStates[o][y][b]=null)}else for(const b in p)this.deletedStates[o]&&this.deletedStates[o][y]&&this.deletedStates[o][y][b]===null&&delete this.deletedStates[o][y][b]}removeFeatureState(o,d,p){if(this.deletedStates[o]===null)return;const y=String(d);if(this.deletedStates[o]=this.deletedStates[o]||{},p&&d!==void 0)this.deletedStates[o][y]!==null&&(this.deletedStates[o][y]=this.deletedStates[o][y]||{},this.deletedStates[o][y][p]=null);else if(d!==void 0)if(this.stateChanges[o]&&this.stateChanges[o][y])for(p in this.deletedStates[o][y]={},this.stateChanges[o][y])this.deletedStates[o][y][p]=null;else this.deletedStates[o][y]=null;else this.deletedStates[o]=null}getState(o,d){const p=String(d),y=l.extend({},(this.state[o]||{})[p],(this.stateChanges[o]||{})[p]);if(this.deletedStates[o]===null)return{};if(this.deletedStates[o]){const b=this.deletedStates[o][d];if(b===null)return{};for(const P in b)delete y[P]}return y}initializeTileState(o,d){o.setFeatureState(this.state,d)}coalesceChanges(o,d){const p={};for(const y in this.stateChanges){this.state[y]=this.state[y]||{};const b={};for(const P in this.stateChanges[y])this.state[y][P]||(this.state[y][P]={}),l.extend(this.state[y][P],this.stateChanges[y][P]),b[P]=this.state[y][P];p[y]=b}for(const y in this.deletedStates){this.state[y]=this.state[y]||{};const b={};if(this.deletedStates[y]===null)for(const P in this.state[y])b[P]={},this.state[y][P]={};else for(const P in this.deletedStates[y]){if(this.deletedStates[y][P]===null)this.state[y][P]={};else for(const C of Object.keys(this.deletedStates[y][P]))delete this.state[y][P][C];b[P]=this.state[y][P]}p[y]=p[y]||{},l.extend(p[y],b)}if(this.stateChanges={},this.deletedStates={},Object.keys(p).length!==0)for(const y in o)o[y].setFeatureState(p,d)}}class Bt extends l.Evented{constructor(o,d,p){super(),this.id=o,this.dispatcher=p,this.on("data",y=>{y.dataType==="source"&&y.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&y.dataType==="source"&&y.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((y,b,P,C)=>{const M=new(Ot(b.type))(y,b,P,C);if(M.id!==y)throw new Error(`Expected Source id to be ${y} instead of ${M.id}`);return M})(o,d,p,this),this._tiles={},this._cache=new zn(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Re,this._didEmitContent=!1,this._updated=!1}onAdd(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._maxTileCacheZoomLevels=o?o._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(o)}onRemove(o){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(o)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const o in this._tiles){const d=this._tiles[o];if(d.state!=="loaded"&&d.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(o,d){return this._source.loadTile(o,d)}_unloadTile(o){if(this._source.unloadTile)return this._source.unloadTile(o,()=>{})}_abortTile(o){this._source.abortTile&&this._source.abortTile(o,()=>{}),this._source.fire(new l.Event("dataabort",{tile:o,coord:o.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const d in this._tiles){const p=this._tiles[d];p.upload(o),p.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(o=>o.tileID).sort(Rn).map(o=>o.key)}getRenderableIds(o){const d=[];for(const p in this._tiles)this._isIdRenderable(p,o)&&d.push(this._tiles[p]);return o?d.sort((p,y)=>{const b=p.tileID,P=y.tileID,C=new l.Point(b.canonical.x,b.canonical.y)._rotate(this.transform.angle),M=new l.Point(P.canonical.x,P.canonical.y)._rotate(this.transform.angle);return b.overscaledZ-P.overscaledZ||M.y-C.y||M.x-C.x}).map(p=>p.tileID.key):d.map(p=>p.tileID).sort(Rn).map(p=>p.key)}hasRenderableParent(o){const d=this.findLoadedParent(o,0);return!!d&&this._isIdRenderable(d.tileID.key)}_isIdRenderable(o,d){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(d||!this._tiles[o].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(o,"reloading")}}_reloadTile(o,d){const p=this._tiles[o];p&&(p.state!=="loading"&&(p.state=d),this._loadTile(p,this._tileLoaded.bind(this,p,o,d)))}_tileLoaded(o,d,p,y){if(y)return o.state="errored",void(y.status!==404?this._source.fire(new l.ErrorEvent(y,{tile:o})):this.update(this.transform,this.terrain));o.timeAdded=l.browser.now(),p==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(d,o),this.getSource().type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),o.aborted||this._source.fire(new l.Event("data",{dataType:"source",tile:o,coord:o.tileID}))}_backfillDEM(o){const d=this.getRenderableIds();for(let y=0;y<d.length;y++){const b=d[y];if(o.neighboringTiles&&o.neighboringTiles[b]){const P=this.getTileByID(b);p(o,P),p(P,o)}}function p(y,b){y.needsHillshadePrepare=!0,y.needsTerrainPrepare=!0;let P=b.tileID.canonical.x-y.tileID.canonical.x;const C=b.tileID.canonical.y-y.tileID.canonical.y,M=Math.pow(2,y.tileID.canonical.z),R=b.tileID.key;P===0&&C===0||Math.abs(C)>1||(Math.abs(P)>1&&(Math.abs(P+M)===1?P+=M:Math.abs(P-M)===1&&(P-=M)),b.dem&&y.dem&&(y.dem.backfillBorder(b.dem,P,C),y.neighboringTiles&&y.neighboringTiles[R]&&(y.neighboringTiles[R].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,d,p,y){for(const b in this._tiles){let P=this._tiles[b];if(y[b]||!P.hasData()||P.tileID.overscaledZ<=d||P.tileID.overscaledZ>p)continue;let C=P.tileID;for(;P&&P.tileID.overscaledZ>d+1;){const R=P.tileID.scaledTo(P.tileID.overscaledZ-1);P=this._tiles[R.key],P&&P.hasData()&&(C=R)}let M=C;for(;M.overscaledZ>d;)if(M=M.scaledTo(M.overscaledZ-1),o[M.key]){y[C.key]=C;break}}}findLoadedParent(o,d){if(o.key in this._loadedParentTiles){const p=this._loadedParentTiles[o.key];return p&&p.tileID.overscaledZ>=d?p:null}for(let p=o.overscaledZ-1;p>=d;p--){const y=o.scaledTo(p),b=this._getLoadedTile(y);if(b)return b}}_getLoadedTile(o){const d=this._tiles[o.key];return d&&d.hasData()?d:this._cache.getByKey(o.wrapped().key)}updateCacheSize(o){const d=Math.ceil(o.width/this._source.tileSize)+1,p=Math.ceil(o.height/this._source.tileSize)+1,y=Math.floor(d*p*(this._maxTileCacheZoomLevels===null?l.config.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),b=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,y):y;this._cache.setMaxSize(b)}handleWrapJump(o){const d=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,d){const p={};for(const y in this._tiles){const b=this._tiles[y];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+d),p[b.tileID.key]=b}this._tiles=p;for(const y in this._timers)clearTimeout(this._timers[y]),delete this._timers[y];for(const y in this._tiles)this._setTileReloadTimer(y,this._tiles[y])}}update(o,d){if(this.transform=o,this.terrain=d,!this._sourceLoaded||this._paused)return;let p;this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?p=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(U=>new l.OverscaledTileID(U.canonical.z,U.wrap,U.canonical.z,U.canonical.x,U.canonical.y)):(p=o.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:d}),this._source.hasTile&&(p=p.filter(U=>this._source.hasTile(U)))):p=[];const y=o.coveringZoomLevel(this._source),b=Math.max(y-Bt.maxOverzooming,this._source.minzoom),P=Math.max(y+Bt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const U={};for(const V of p)if(V.canonical.z>this._source.minzoom){const X=V.scaledTo(V.canonical.z-1);U[X.key]=X;const ue=V.scaledTo(Math.max(this._source.minzoom,Math.min(V.canonical.z,5)));U[ue.key]=ue}p=p.concat(Object.values(U))}const C=p.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,C&&this.fire(new l.Event("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const M=this._updateRetainedTiles(p,y);if(an(this._source.type)){const U={},V={},X=Object.keys(M),ue=l.browser.now();for(const le of X){const fe=M[le],oe=this._tiles[le];if(!oe||oe.fadeEndTime!==0&&oe.fadeEndTime<=ue)continue;const Pe=this.findLoadedParent(fe,b);Pe&&(this._addTile(Pe.tileID),U[Pe.tileID.key]=Pe.tileID),V[le]=fe}this._retainLoadedChildren(V,y,P,M);for(const le in U)M[le]||(this._coveredTiles[le]=!0,M[le]=U[le]);if(d){const le={},fe={};for(const oe of p)this._tiles[oe.key].hasData()?le[oe.key]=oe:fe[oe.key]=oe;for(const oe in fe){const Pe=fe[oe].children(this._source.maxzoom);this._tiles[Pe[0].key]&&this._tiles[Pe[1].key]&&this._tiles[Pe[2].key]&&this._tiles[Pe[3].key]&&(le[Pe[0].key]=M[Pe[0].key]=Pe[0],le[Pe[1].key]=M[Pe[1].key]=Pe[1],le[Pe[2].key]=M[Pe[2].key]=Pe[2],le[Pe[3].key]=M[Pe[3].key]=Pe[3],delete fe[oe])}for(const oe in fe){const Pe=this.findLoadedParent(fe[oe],this._source.minzoom);if(Pe){le[Pe.tileID.key]=M[Pe.tileID.key]=Pe.tileID;for(const De in le)le[De].isChildOf(Pe.tileID)&&delete le[De]}}for(const oe in this._tiles)le[oe]||(this._coveredTiles[oe]=!0)}}for(const U in M)this._tiles[U].clearFadeHold();const R=l.keysDifference(this._tiles,M);for(const U of R){const V=this._tiles[U];V.hasSymbolBuckets&&!V.holdingForFade()?V.setHoldDuration(this.map._fadeDuration):V.hasSymbolBuckets&&!V.symbolFadeFinished()||this._removeTile(U)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)}_updateRetainedTiles(o,d){const p={},y={},b=Math.max(d-Bt.maxOverzooming,this._source.minzoom),P=Math.max(d+Bt.maxUnderzooming,this._source.minzoom),C={};for(const M of o){const R=this._addTile(M);p[M.key]=M,R.hasData()||d<this._source.maxzoom&&(C[M.key]=M)}this._retainLoadedChildren(C,d,P,p);for(const M of o){let R=this._tiles[M.key];if(R.hasData())continue;if(d+1>this._source.maxzoom){const V=M.children(this._source.maxzoom)[0],X=this.getTile(V);if(X&&X.hasData()){p[V.key]=V;continue}}else{const V=M.children(this._source.maxzoom);if(p[V[0].key]&&p[V[1].key]&&p[V[2].key]&&p[V[3].key])continue}let U=R.wasRequested();for(let V=M.overscaledZ-1;V>=b;--V){const X=M.scaledTo(V);if(y[X.key])break;if(y[X.key]=!0,R=this.getTile(X),!R&&U&&(R=this._addTile(X)),R){const ue=R.hasData();if((U||ue)&&(p[X.key]=X),U=R.wasRequested(),ue)break}}}return p}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const d=[];let p,y=this._tiles[o].tileID;for(;y.overscaledZ>0;){if(y.key in this._loadedParentTiles){p=this._loadedParentTiles[y.key];break}d.push(y.key);const b=y.scaledTo(y.overscaledZ-1);if(p=this._getLoadedTile(b),p)break;y=b}for(const b of d)this._loadedParentTiles[b]=p}}_addTile(o){let d=this._tiles[o.key];if(d)return d;d=this._cache.getAndRemove(o),d&&(this._setTileReloadTimer(o.key,d),d.tileID=o,this._state.initializeTileState(d,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,d)));const p=d;return d||(d=new En(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(d,this._tileLoaded.bind(this,d,o.key,d.state))),d.uses++,this._tiles[o.key]=d,p||this._source.fire(new l.Event("dataloading",{tile:d,coord:d.tileID,dataType:"source"})),d}_setTileReloadTimer(o,d){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const p=d.getExpiryTimeout();p&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},p))}_removeTile(o){const d=this._tiles[o];d&&(d.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),d.uses>0||(d.hasData()&&d.state!=="reloading"?this._cache.add(d.tileID,d,d.getExpiryTimeout()):(d.aborted=!0,this._abortTile(d),this._unloadTile(d))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(o);this._cache.reset()}tilesIn(o,d,p){const y=[],b=this.transform;if(!b)return y;const P=p?b.getCameraQueryGeometry(o):o,C=o.map(le=>b.pointCoordinate(le,this.terrain)),M=P.map(le=>b.pointCoordinate(le,this.terrain)),R=this.getIds();let U=1/0,V=1/0,X=-1/0,ue=-1/0;for(const le of M)U=Math.min(U,le.x),V=Math.min(V,le.y),X=Math.max(X,le.x),ue=Math.max(ue,le.y);for(let le=0;le<R.length;le++){const fe=this._tiles[R[le]];if(fe.holdingForFade())continue;const oe=fe.tileID,Pe=Math.pow(2,b.zoom-fe.tileID.overscaledZ),De=d*fe.queryPadding*l.EXTENT/fe.tileSize/Pe,me=[oe.getTilePoint(new l.MercatorCoordinate(U,V)),oe.getTilePoint(new l.MercatorCoordinate(X,ue))];if(me[0].x-De<l.EXTENT&&me[0].y-De<l.EXTENT&&me[1].x+De>=0&&me[1].y+De>=0){const Ae=C.map($e=>oe.getTilePoint($e)),Ue=M.map($e=>oe.getTilePoint($e));y.push({tile:fe,tileID:oe,queryGeometry:Ae,cameraQueryGeometry:Ue,scale:Pe})}}return y}getVisibleCoordinates(o){const d=this.getRenderableIds(o).map(p=>this._tiles[p].tileID);for(const p of d)p.posMatrix=this.transform.calculatePosMatrix(p.toUnwrapped());return d}hasTransition(){if(this._source.hasTransition())return!0;if(an(this._source.type)){const o=l.browser.now();for(const d in this._tiles)if(this._tiles[d].fadeEndTime>=o)return!0}return!1}setFeatureState(o,d,p){this._state.updateState(o=o||"_geojsonTileLayer",d,p)}removeFeatureState(o,d,p){this._state.removeFeatureState(o=o||"_geojsonTileLayer",d,p)}getFeatureState(o,d){return this._state.getState(o=o||"_geojsonTileLayer",d)}setDependencies(o,d,p){const y=this._tiles[o];y&&y.setDependencies(d,p)}reloadTilesForDependencies(o,d){for(const p in this._tiles)this._tiles[p].hasDependency(o,d)&&this._reloadTile(p,"reloading");this._cache.filter(p=>!p.hasDependency(o,d))}}function Rn(v,o){const d=Math.abs(2*v.wrap)-+(v.wrap<0),p=Math.abs(2*o.wrap)-+(o.wrap<0);return v.overscaledZ-o.overscaledZ||p-d||o.canonical.y-v.canonical.y||o.canonical.x-v.canonical.x}function an(v){return v==="raster"||v==="image"||v==="video"}Bt.maxOverzooming=10,Bt.maxUnderzooming=3;const It="mapboxgl_preloaded_worker_pool";class st{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<st.workerCount;)this.workers.push(new Worker(l.config.WORKER_URL));return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.numActive()===0&&(this.workers.forEach(d=>{d.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[It]}numActive(){return Object.keys(this.active).length}}const _t=Math.floor(l.browser.hardwareConcurrency/2);let Fe;function et(){return Fe||(Fe=new st),Fe}st.workerCount=l.isSafari(globalThis)?Math.max(Math.min(_t,3),1):1;class ot{constructor(o,d){this.reset(o,d)}reset(o,d){this.points=o||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=l.clamp(o,0,1);let d=1,p=this._distances[d];const y=o*this.paddedLength+this.padding;for(;p<y&&d<this._distances.length;)p=this._distances[++d];const b=d-1,P=this._distances[b],C=p-P,M=C>0?(y-P)/C:0;return this.points[b].mult(1-M).add(this.points[d].mult(M))}}function Zt(v,o){let d=!0;return v==="always"||v!=="never"&&o!=="never"||(d=!1),d}class Mt{constructor(o,d,p){const y=this.boxCells=[],b=this.circleCells=[];this.xCellCount=Math.ceil(o/p),this.yCellCount=Math.ceil(d/p);for(let P=0;P<this.xCellCount*this.yCellCount;P++)y.push([]),b.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=d,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,d,p,y,b){this._forEachCell(d,p,y,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(d),this.bboxes.push(p),this.bboxes.push(y),this.bboxes.push(b)}insertCircle(o,d,p,y){this._forEachCell(d-y,p-y,d+y,p+y,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(d),this.circles.push(p),this.circles.push(y)}_insertBoxCell(o,d,p,y,b,P){this.boxCells[b].push(P)}_insertCircleCell(o,d,p,y,b,P){this.circleCells[b].push(P)}_query(o,d,p,y,b,P,C){if(p<0||o>this.width||y<0||d>this.height)return[];const M=[];if(o<=0&&d<=0&&this.width<=p&&this.height<=y){if(b)return[{key:null,x1:o,y1:d,x2:p,y2:y}];for(let R=0;R<this.boxKeys.length;R++)M.push({key:this.boxKeys[R],x1:this.bboxes[4*R],y1:this.bboxes[4*R+1],x2:this.bboxes[4*R+2],y2:this.bboxes[4*R+3]});for(let R=0;R<this.circleKeys.length;R++){const U=this.circles[3*R],V=this.circles[3*R+1],X=this.circles[3*R+2];M.push({key:this.circleKeys[R],x1:U-X,y1:V-X,x2:U+X,y2:V+X})}}else this._forEachCell(o,d,p,y,this._queryCell,M,{hitTest:b,overlapMode:P,seenUids:{box:{},circle:{}}},C);return M}query(o,d,p,y){return this._query(o,d,p,y,!1,null)}hitTest(o,d,p,y,b,P){return this._query(o,d,p,y,!0,b,P).length>0}hitTestCircle(o,d,p,y,b){const P=o-p,C=o+p,M=d-p,R=d+p;if(C<0||P>this.width||R<0||M>this.height)return!1;const U=[];return this._forEachCell(P,M,C,R,this._queryCellCircle,U,{hitTest:!0,overlapMode:y,circle:{x:o,y:d,radius:p},seenUids:{box:{},circle:{}}},b),U.length>0}_queryCell(o,d,p,y,b,P,C,M){const{seenUids:R,hitTest:U,overlapMode:V}=C,X=this.boxCells[b];if(X!==null){const le=this.bboxes;for(const fe of X)if(!R.box[fe]){R.box[fe]=!0;const oe=4*fe,Pe=this.boxKeys[fe];if(o<=le[oe+2]&&d<=le[oe+3]&&p>=le[oe+0]&&y>=le[oe+1]&&(!M||M(Pe))&&(!U||!Zt(V,Pe.overlapMode))&&(P.push({key:Pe,x1:le[oe],y1:le[oe+1],x2:le[oe+2],y2:le[oe+3]}),U))return!0}}const ue=this.circleCells[b];if(ue!==null){const le=this.circles;for(const fe of ue)if(!R.circle[fe]){R.circle[fe]=!0;const oe=3*fe,Pe=this.circleKeys[fe];if(this._circleAndRectCollide(le[oe],le[oe+1],le[oe+2],o,d,p,y)&&(!M||M(Pe))&&(!U||!Zt(V,Pe.overlapMode))){const De=le[oe],me=le[oe+1],Ae=le[oe+2];if(P.push({key:Pe,x1:De-Ae,y1:me-Ae,x2:De+Ae,y2:me+Ae}),U)return!0}}}return!1}_queryCellCircle(o,d,p,y,b,P,C,M){const{circle:R,seenUids:U,overlapMode:V}=C,X=this.boxCells[b];if(X!==null){const le=this.bboxes;for(const fe of X)if(!U.box[fe]){U.box[fe]=!0;const oe=4*fe,Pe=this.boxKeys[fe];if(this._circleAndRectCollide(R.x,R.y,R.radius,le[oe+0],le[oe+1],le[oe+2],le[oe+3])&&(!M||M(Pe))&&!Zt(V,Pe.overlapMode))return P.push(!0),!0}}const ue=this.circleCells[b];if(ue!==null){const le=this.circles;for(const fe of ue)if(!U.circle[fe]){U.circle[fe]=!0;const oe=3*fe,Pe=this.circleKeys[fe];if(this._circlesCollide(le[oe],le[oe+1],le[oe+2],R.x,R.y,R.radius)&&(!M||M(Pe))&&!Zt(V,Pe.overlapMode))return P.push(!0),!0}}}_forEachCell(o,d,p,y,b,P,C,M){const R=this._convertToXCellCoord(o),U=this._convertToYCellCoord(d),V=this._convertToXCellCoord(p),X=this._convertToYCellCoord(y);for(let ue=R;ue<=V;ue++)for(let le=U;le<=X;le++)if(b.call(this,o,d,p,y,this.xCellCount*le+ue,P,C,M))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,d,p,y,b,P){const C=y-o,M=b-d,R=p+P;return R*R>C*C+M*M}_circleAndRectCollide(o,d,p,y,b,P,C){const M=(P-y)/2,R=Math.abs(o-(y+M));if(R>M+p)return!1;const U=(C-b)/2,V=Math.abs(d-(b+U));if(V>U+p)return!1;if(R<=M||V<=U)return!0;const X=R-M,ue=V-U;return X*X+ue*ue<=p*p}}function Ne(v,o,d,p,y){const b=l.create();return o?(l.scale(b,b,[1/y,1/y,1]),d||l.rotateZ(b,b,p.angle)):l.multiply(b,p.labelPlaneMatrix,v),b}function Ye(v,o,d,p,y){if(o){const b=l.clone(v);return l.scale(b,b,[y,y,1]),d||l.rotateZ(b,b,-p.angle),b}return p.glCoordMatrix}function St(v,o,d){let p;d?(p=[v.x,v.y,d(v.x,v.y),1],l.transformMat4(p,p,o)):(p=[v.x,v.y,0,1],ne(p,p,o));const y=p[3];return{point:new l.Point(p[0]/y,p[1]/y),signedDistanceFromCamera:y}}function gn(v,o){return .5+v/o*.5}function yn(v,o){const d=v[0]/v[3],p=v[1]/v[3];return d>=-o[0]&&d<=o[0]&&p>=-o[1]&&p<=o[1]}function nt(v,o,d,p,y,b,P,C,M,R){const U=p?v.textSizeData:v.iconSizeData,V=l.evaluateSizeForZoom(U,d.transform.zoom),X=[256/d.width*2+1,256/d.height*2+1],ue=p?v.text.dynamicLayoutVertexArray:v.icon.dynamicLayoutVertexArray;ue.clear();const le=v.lineVertexArray,fe=p?v.text.placedSymbolArray:v.icon.placedSymbolArray,oe=d.transform.width/d.transform.height;let Pe=!1;for(let De=0;De<fe.length;De++){const me=fe.get(De);if(me.hidden||me.writingMode===l.WritingMode.vertical&&!Pe){q(me.numGlyphs,ue);continue}let Ae;if(Pe=!1,R?(Ae=[me.anchorX,me.anchorY,R(me.anchorX,me.anchorY),1],l.transformMat4(Ae,Ae,o)):(Ae=[me.anchorX,me.anchorY,0,1],ne(Ae,Ae,o)),!yn(Ae,X)){q(me.numGlyphs,ue);continue}const Ue=gn(d.transform.cameraToCenterDistance,Ae[3]),$e=l.evaluateSizeForFeature(U,V,me),Xe=P?$e/Ue:$e*Ue,tt=new l.Point(me.anchorX,me.anchorY),Qe=St(tt,y,R).point,ct={projections:{},offsets:{}},Vt=Cr(me,Xe,!1,C,o,y,b,v.glyphOffsetArray,le,ue,Qe,tt,ct,oe,M,R);Pe=Vt.useVertical,(Vt.notEnoughRoom||Pe||Vt.needsFlipping&&Cr(me,Xe,!0,C,o,y,b,v.glyphOffsetArray,le,ue,Qe,tt,ct,oe,M,R).notEnoughRoom)&&q(me.numGlyphs,ue)}p?v.text.dynamicLayoutVertexBuffer.updateData(ue):v.icon.dynamicLayoutVertexBuffer.updateData(ue)}function on(v,o,d,p,y,b,P,C,M,R,U,V,X){const ue=C.glyphStartIndex+C.numGlyphs,le=C.lineStartIndex,fe=C.lineStartIndex+C.lineLength,oe=o.getoffsetX(C.glyphStartIndex),Pe=o.getoffsetX(ue-1),De=he(v*oe,d,p,y,b,P,C.segment,le,fe,M,R,U,V,X);if(!De)return null;const me=he(v*Pe,d,p,y,b,P,C.segment,le,fe,M,R,U,V,X);return me?{first:De,last:me}:null}function rn(v,o,d,p){return v===l.WritingMode.horizontal&&Math.abs(d.y-o.y)>Math.abs(d.x-o.x)*p?{useVertical:!0}:(v===l.WritingMode.vertical?o.y<d.y:o.x>d.x)?{needsFlipping:!0}:null}function Cr(v,o,d,p,y,b,P,C,M,R,U,V,X,ue,le,fe){const oe=o/24,Pe=v.lineOffsetX*oe,De=v.lineOffsetY*oe;let me;if(v.numGlyphs>1){const Ae=v.glyphStartIndex+v.numGlyphs,Ue=v.lineStartIndex,$e=v.lineStartIndex+v.lineLength,Xe=on(oe,C,Pe,De,d,U,V,v,M,b,X,le,fe);if(!Xe)return{notEnoughRoom:!0};const tt=St(Xe.first.point,P,fe).point,Qe=St(Xe.last.point,P,fe).point;if(p&&!d){const ct=rn(v.writingMode,tt,Qe,ue);if(ct)return ct}me=[Xe.first];for(let ct=v.glyphStartIndex+1;ct<Ae-1;ct++)me.push(he(oe*C.getoffsetX(ct),Pe,De,d,U,V,v.segment,Ue,$e,M,b,X,le,fe));me.push(Xe.last)}else{if(p&&!d){const Ue=St(V,y,fe).point,$e=v.lineStartIndex+v.segment+1,Xe=new l.Point(M.getx($e),M.gety($e)),tt=St(Xe,y,fe),Qe=tt.signedDistanceFromCamera>0?tt.point:li(V,Xe,Ue,1,y,fe),ct=rn(v.writingMode,Ue,Qe,ue);if(ct)return ct}const Ae=he(oe*C.getoffsetX(v.glyphStartIndex),Pe,De,d,U,V,v.segment,v.lineStartIndex,v.lineStartIndex+v.lineLength,M,b,X,le,fe);if(!Ae)return{notEnoughRoom:!0};me=[Ae]}for(const Ae of me)l.addDynamicAttributes(R,Ae.point,Ae.angle);return{}}function li(v,o,d,p,y,b){const P=St(v.add(v.sub(o)._unit()),y,b).point,C=d.sub(P);return d.add(C._mult(p/C.mag()))}function un(v,o){const{projectionCache:d,lineVertexArray:p,labelPlaneMatrix:y,tileAnchorPoint:b,distanceFromAnchor:P,getElevation:C,previousVertex:M,direction:R,absOffsetX:U}=o;if(d.projections[v])return d.projections[v];const V=new l.Point(p.getx(v),p.gety(v)),X=St(V,y,C);if(X.signedDistanceFromCamera>0)return d.projections[v]=X.point,X.point;const ue=v-R;return li(P===0?b:new l.Point(p.getx(ue),p.gety(ue)),V,M,U-P+1,y,C)}function Kr(v,o,d){return v._unit()._perp()._mult(o*d)}function xi(v,o,d,p,y,b,P,C){const{projectionCache:M,direction:R}=C;if(M.offsets[v])return M.offsets[v];const U=d.add(o);if(v+R<p||v+R>=y)return M.offsets[v]=U,U;const V=un(v+R,C),X=Kr(V.sub(d),P,R),ue=d.add(X),le=V.add(X);return M.offsets[v]=l.findLineIntersection(b,U,ue,le)||U,M.offsets[v]}function he(v,o,d,p,y,b,P,C,M,R,U,V,X,ue){const le=p?v-o:v+o;let fe=le>0?1:-1,oe=0;p&&(fe*=-1,oe=Math.PI),fe<0&&(oe+=Math.PI);let Pe,De,me=fe>0?C+P:C+P+1,Ae=y,Ue=y,$e=0,Xe=0;const tt=Math.abs(le),Qe=[];let ct;for(;$e+Xe<=tt;){if(me+=fe,me<C||me>=M)return null;$e+=Xe,Ue=Ae,De=Pe;const mt={projectionCache:V,lineVertexArray:R,labelPlaneMatrix:U,tileAnchorPoint:b,distanceFromAnchor:$e,getElevation:ue,previousVertex:Ue,direction:fe,absOffsetX:tt};if(Ae=un(me,mt),d===0)Qe.push(Ue),ct=Ae.sub(Ue);else{let cn;const Gt=Ae.sub(Ue);cn=Gt.mag()===0?Kr(un(me+fe,mt).sub(Ae),d,fe):Kr(Gt,d,fe),De||(De=Ue.add(cn)),Pe=xi(me,cn,Ae,C,M,De,d,mt),Qe.push(De),ct=Pe.sub(De)}Xe=ct.mag()}const Vt=ct._mult((tt-$e)/Xe)._add(De||Ue),An=oe+Math.atan2(Ae.y-Ue.y,Ae.x-Ue.x);return Qe.push(Vt),{point:Vt,angle:X?An:0,path:Qe}}const G=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function q(v,o){for(let d=0;d<v;d++){const p=o.length;o.resize(p+4),o.float32.set(G,3*p)}}function ne(v,o,d){const p=o[0],y=o[1];return v[0]=d[0]*p+d[4]*y+d[12],v[1]=d[1]*p+d[5]*y+d[13],v[3]=d[3]*p+d[7]*y+d[15],v}const ce=100;class _e{constructor(o,d=new Mt(o.width+200,o.height+200,25),p=new Mt(o.width+200,o.height+200,25)){this.transform=o,this.grid=d,this.ignoredGrid=p,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+ce,this.screenBottomBoundary=o.height+ce,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(o,d,p,y,b,P){const C=this.projectAndGetPerspectiveRatio(y,o.anchorPointX,o.anchorPointY,P),M=p*C.perspectiveRatio,R=o.x1*M+C.point.x,U=o.y1*M+C.point.y,V=o.x2*M+C.point.x,X=o.y2*M+C.point.y;return!this.isInsideGrid(R,U,V,X)||d!=="always"&&this.grid.hitTest(R,U,V,X,d,b)||C.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[R,U,V,X],offscreen:this.isOffscreen(R,U,V,X)}}placeCollisionCircles(o,d,p,y,b,P,C,M,R,U,V,X,ue,le){const fe=[],oe=new l.Point(d.anchorX,d.anchorY),Pe=St(oe,P,le),De=gn(this.transform.cameraToCenterDistance,Pe.signedDistanceFromCamera),me=(U?b/De:b*De)/l.ONE_EM,Ae=St(oe,C,le).point,Ue=on(me,y,d.lineOffsetX*me,d.lineOffsetY*me,!1,Ae,oe,d,p,C,{projections:{},offsets:{}},!1,le);let $e=!1,Xe=!1,tt=!0;if(Ue){const Qe=.5*X*De+ue,ct=new l.Point(-100,-100),Vt=new l.Point(this.screenRightBoundary,this.screenBottomBoundary),An=new ot,mt=Ue.first,cn=Ue.last;let Gt=[];for(let vn=mt.path.length-1;vn>=1;vn--)Gt.push(mt.path[vn]);for(let vn=1;vn<cn.path.length;vn++)Gt.push(cn.path[vn]);const Hn=2.5*Qe;if(M){const vn=Gt.map(In=>St(In,M,le));Gt=vn.some(In=>In.signedDistanceFromCamera<=0)?[]:vn.map(In=>In.point)}let Pn=[];if(Gt.length>0){const vn=Gt[0].clone(),In=Gt[0].clone();for(let Mr=1;Mr<Gt.length;Mr++)vn.x=Math.min(vn.x,Gt[Mr].x),vn.y=Math.min(vn.y,Gt[Mr].y),In.x=Math.max(In.x,Gt[Mr].x),In.y=Math.max(In.y,Gt[Mr].y);Pn=vn.x>=ct.x&&In.x<=Vt.x&&vn.y>=ct.y&&In.y<=Vt.y?[Gt]:In.x<ct.x||vn.x>Vt.x||In.y<ct.y||vn.y>Vt.y?[]:l.clipLine([Gt],ct.x,ct.y,Vt.x,Vt.y)}for(const vn of Pn){An.reset(vn,.25*Qe);let In=0;In=An.length<=.5*Qe?1:Math.ceil(An.paddedLength/Hn)+1;for(let Mr=0;Mr<In;Mr++){const tr=Mr/Math.max(In-1,1),fi=An.lerp(tr),Qr=fi.x+ce,zr=fi.y+ce;fe.push(Qr,zr,Qe,0);const ps=Qr-Qe,or=zr-Qe,mo=Qr+Qe,go=zr+Qe;if(tt=tt&&this.isOffscreen(ps,or,mo,go),Xe=Xe||this.isInsideGrid(ps,or,mo,go),o!=="always"&&this.grid.hitTestCircle(Qr,zr,Qe,o,V)&&($e=!0,!R))return{circles:[],offscreen:!1,collisionDetected:$e}}}}return{circles:!R&&$e||!Xe||De<this.perspectiveRatioCutoff?[]:fe,offscreen:tt,collisionDetected:$e}}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const d=[];let p=1/0,y=1/0,b=-1/0,P=-1/0;for(const U of o){const V=new l.Point(U.x+ce,U.y+ce);p=Math.min(p,V.x),y=Math.min(y,V.y),b=Math.max(b,V.x),P=Math.max(P,V.y),d.push(V)}const C=this.grid.query(p,y,b,P).concat(this.ignoredGrid.query(p,y,b,P)),M={},R={};for(const U of C){const V=U.key;if(M[V.bucketInstanceId]===void 0&&(M[V.bucketInstanceId]={}),M[V.bucketInstanceId][V.featureIndex])continue;const X=[new l.Point(U.x1,U.y1),new l.Point(U.x2,U.y1),new l.Point(U.x2,U.y2),new l.Point(U.x1,U.y2)];l.polygonIntersectsPolygon(d,X)&&(M[V.bucketInstanceId][V.featureIndex]=!0,R[V.bucketInstanceId]===void 0&&(R[V.bucketInstanceId]=[]),R[V.bucketInstanceId].push(V.featureIndex))}return R}insertCollisionBox(o,d,p,y,b,P){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:y,featureIndex:b,collisionGroupID:P,overlapMode:d},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,d,p,y,b,P){const C=p?this.ignoredGrid:this.grid,M={bucketInstanceId:y,featureIndex:b,collisionGroupID:P,overlapMode:d};for(let R=0;R<o.length;R+=4)C.insertCircle(M,o[R],o[R+1],o[R+2])}projectAndGetPerspectiveRatio(o,d,p,y){let b;return y?(b=[d,p,y(d,p),1],l.transformMat4(b,b,o)):(b=[d,p,0,1],ne(b,b,o)),{point:new l.Point((b[0]/b[3]+1)/2*this.transform.width+ce,(-b[1]/b[3]+1)/2*this.transform.height+ce),perspectiveRatio:.5+this.transform.cameraToCenterDistance/b[3]*.5}}isOffscreen(o,d,p,y){return p<ce||o>=this.screenRightBoundary||y<ce||d>this.screenBottomBoundary}isInsideGrid(o,d,p,y){return p>=0&&o<this.gridRightBoundary&&y>=0&&d<this.gridBottomBoundary}getViewportMatrix(){const o=l.identity([]);return l.translate(o,o,[-100,-100,0]),o}}function Se(v,o,d){return o*(l.EXTENT/(v.tileSize*Math.pow(2,d-v.tileID.overscaledZ)))}class Te{constructor(o,d,p,y){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?d:-d))):y&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class ge{constructor(o,d,p,y,b){this.text=new Te(o?o.text:null,d,p,b),this.icon=new Te(o?o.icon:null,d,y,b)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ce{constructor(o,d,p){this.text=o,this.icon=d,this.skipFade=p}}class He{constructor(){this.invProjMatrix=l.create(),this.viewportMatrix=l.create(),this.circles=[]}}class We{constructor(o,d,p,y,b){this.bucketInstanceId=o,this.featureIndex=d,this.sourceLayerIndex=p,this.bucketIndex=y,this.tileID=b}}class Ze{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const d=++this.maxGroupID;this.collisionGroups[o]={ID:d,predicate:p=>p.collisionGroupID===d}}return this.collisionGroups[o]}}function Pt(v,o,d,p,y){const{horizontalAlign:b,verticalAlign:P}=l.getAnchorAlignment(v);return new l.Point(-(b-.5)*o+p[0]*y,-(P-.5)*d+p[1]*y)}function tn(v,o,d,p,y,b){const{x1:P,x2:C,y1:M,y2:R,anchorPointX:U,anchorPointY:V}=v,X=new l.Point(o,d);return p&&X._rotate(y?b:-b),{x1:P+X.x,y1:M+X.y,x2:C+X.x,y2:R+X.y,anchorPointX:U,anchorPointY:V}}class Lt{constructor(o,d,p,y,b){this.transform=o.clone(),this.terrain=d,this.collisionIndex=new _e(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new Ze(y),this.collisionCircleArrays={},this.prevPlacement=b,b&&(b.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,d,p,y){const b=p.getBucket(d),P=p.latestFeatureIndex;if(!b||!P||d.id!==b.layerIds[0])return;const C=p.collisionBoxArray,M=b.layers[0].layout,R=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),U=p.tileSize/l.EXTENT,V=this.transform.calculatePosMatrix(p.tileID.toUnwrapped()),X=M.get("text-pitch-alignment")==="map",ue=M.get("text-rotation-alignment")==="map",le=Se(p,1,this.transform.zoom),fe=Ne(V,X,ue,this.transform,le);let oe=null;if(X){const De=Ye(V,X,ue,this.transform,le);oe=l.multiply([],this.transform.labelPlaneMatrix,De)}this.retainedQueryData[b.bucketInstanceId]=new We(b.bucketInstanceId,P,b.sourceLayerIndex,b.index,p.tileID);const Pe={bucket:b,layout:M,posMatrix:V,textLabelPlaneMatrix:fe,labelToScreenMatrix:oe,scale:R,textPixelRatio:U,holdingForFade:p.holdingForFade(),collisionBoxArray:C,partiallyEvaluatedTextSize:l.evaluateSizeForZoom(b.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(b.sourceID)};if(y)for(const De of b.sortKeyRanges){const{sortKey:me,symbolInstanceStart:Ae,symbolInstanceEnd:Ue}=De;o.push({sortKey:me,symbolInstanceStart:Ae,symbolInstanceEnd:Ue,parameters:Pe})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:b.symbolInstances.length,parameters:Pe})}attemptAnchorPlacement(o,d,p,y,b,P,C,M,R,U,V,X,ue,le,fe,oe){const Pe=l.TextAnchorEnum[o.textAnchor],De=[o.textOffset0,o.textOffset1],me=Pt(Pe,p,y,De,b),Ae=this.collisionIndex.placeCollisionBox(tn(d,me.x,me.y,P,C,this.transform.angle),V,M,R,U.predicate,oe);if((!fe||this.collisionIndex.placeCollisionBox(tn(fe,me.x,me.y,P,C,this.transform.angle),V,M,R,U.predicate,oe).box.length!==0)&&Ae.box.length>0){let Ue;if(this.prevPlacement&&this.prevPlacement.variableOffsets[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID].text&&(Ue=this.prevPlacement.variableOffsets[X.crossTileID].anchor),X.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[X.crossTileID]={textOffset:De,width:p,height:y,anchor:Pe,textBoxScale:b,prevAnchor:Ue},this.markUsedJustification(ue,Pe,X,le),ue.allowVerticalPlacement&&(this.markUsedOrientation(ue,le,X),this.placedOrientations[X.crossTileID]=le),{shift:me,placedGlyphBoxes:Ae}}}placeLayerBucketPart(o,d,p){const{bucket:y,layout:b,posMatrix:P,textLabelPlaneMatrix:C,labelToScreenMatrix:M,textPixelRatio:R,holdingForFade:U,collisionBoxArray:V,partiallyEvaluatedTextSize:X,collisionGroup:ue}=o.parameters,le=b.get("text-optional"),fe=b.get("icon-optional"),oe=l.getOverlapMode(b,"text-overlap","text-allow-overlap"),Pe=oe==="always",De=l.getOverlapMode(b,"icon-overlap","icon-allow-overlap"),me=De==="always",Ae=b.get("text-rotation-alignment")==="map",Ue=b.get("text-pitch-alignment")==="map",$e=b.get("icon-text-fit")!=="none",Xe=b.get("symbol-z-order")==="viewport-y",tt=Pe&&(me||!y.hasIconData()||fe),Qe=me&&(Pe||!y.hasTextData()||le);!y.collisionArrays&&V&&y.deserializeCollisionBoxes(V);const ct=this.retainedQueryData[y.bucketInstanceId].tileID,Vt=this.terrain?(mt,cn)=>this.terrain.getElevation(ct,mt,cn):null,An=(mt,cn)=>{var Gt,Hn;if(d[mt.crossTileID])return;if(U)return void(this.placements[mt.crossTileID]=new Ce(!1,!1,!1));let Pn=!1,vn=!1,In=!0,Mr=null,tr={box:null,offscreen:null},fi={box:null,offscreen:null},Qr=null,zr=null,ps=null,or=0,mo=0,go=0;cn.textFeatureIndex?or=cn.textFeatureIndex:mt.useRuntimeCollisionCircles&&(or=mt.featureIndex),cn.verticalTextFeatureIndex&&(mo=cn.verticalTextFeatureIndex);const fa=cn.textBox;if(fa){const wi=kr=>{let ei=l.WritingMode.horizontal;if(y.allowVerticalPlacement&&!kr&&this.prevPlacement){const Zi=this.prevPlacement.placedOrientations[mt.crossTileID];Zi&&(this.placedOrientations[mt.crossTileID]=Zi,ei=Zi,this.markUsedOrientation(y,ei,mt))}return ei},pi=(kr,ei)=>{if(y.allowVerticalPlacement&&mt.numVerticalGlyphVertices>0&&cn.verticalTextBox){for(const Zi of y.writingModes)if(Zi===l.WritingMode.vertical?(tr=ei(),fi=tr):tr=kr(),tr&&tr.box&&tr.box.length)break}else tr=kr()},Ri=mt.textAnchorOffsetStartIndex,$a=mt.textAnchorOffsetEndIndex;if($a===Ri){const kr=(ei,Zi)=>{const Lr=this.collisionIndex.placeCollisionBox(ei,oe,R,P,ue.predicate,Vt);return Lr&&Lr.box&&Lr.box.length&&(this.markUsedOrientation(y,Zi,mt),this.placedOrientations[mt.crossTileID]=Zi),Lr};pi(()=>kr(fa,l.WritingMode.horizontal),()=>{const ei=cn.verticalTextBox;return y.allowVerticalPlacement&&mt.numVerticalGlyphVertices>0&&ei?kr(ei,l.WritingMode.vertical):{box:null,offscreen:null}}),wi(tr&&tr.box&&tr.box.length)}else{let kr=l.TextAnchorEnum[(Hn=(Gt=this.prevPlacement)===null||Gt===void 0?void 0:Gt.variableOffsets[mt.crossTileID])===null||Hn===void 0?void 0:Hn.anchor];const ei=(Lr,Ga,nh)=>{const xg=Lr.x2-Lr.x1,bg=Lr.y2-Lr.y1,Bv=mt.textBoxScale,vf=$e&&De==="never"?Ga:null;let yo={box:[],offscreen:!1},Ha=oe==="never"?1:2,_o="never";kr&&Ha++;for(let Is=0;Is<Ha;Is++){for(let vo=Ri;vo<$a;vo++){const xf=y.textAnchorOffsets.get(vo);if(kr&&xf.textAnchor!==kr)continue;const $o=this.attemptAnchorPlacement(xf,Lr,xg,bg,Bv,Ae,Ue,R,P,ue,_o,mt,y,nh,vf,Vt);if($o&&(yo=$o.placedGlyphBoxes,yo&&yo.box&&yo.box.length))return Pn=!0,Mr=$o.shift,yo}kr?kr=null:_o=oe}return yo};pi(()=>ei(fa,cn.iconBox,l.WritingMode.horizontal),()=>{const Lr=cn.verticalTextBox;return y.allowVerticalPlacement&&!(tr&&tr.box&&tr.box.length)&&mt.numVerticalGlyphVertices>0&&Lr?ei(Lr,cn.verticalIconBox,l.WritingMode.vertical):{box:null,offscreen:null}}),tr&&(Pn=tr.box,In=tr.offscreen);const Zi=wi(tr&&tr.box);if(!Pn&&this.prevPlacement){const Lr=this.prevPlacement.variableOffsets[mt.crossTileID];Lr&&(this.variableOffsets[mt.crossTileID]=Lr,this.markUsedJustification(y,Lr.anchor,mt,Zi))}}}if(Qr=tr,Pn=Qr&&Qr.box&&Qr.box.length>0,In=Qr&&Qr.offscreen,mt.useRuntimeCollisionCircles){const wi=y.text.placedSymbolArray.get(mt.centerJustifiedTextSymbolIndex),pi=l.evaluateSizeForFeature(y.textSizeData,X,wi),Ri=b.get("text-padding");zr=this.collisionIndex.placeCollisionCircles(oe,wi,y.lineVertexArray,y.glyphOffsetArray,pi,P,C,M,p,Ue,ue.predicate,mt.collisionCircleDiameter,Ri,Vt),zr.circles.length&&zr.collisionDetected&&!p&&l.warnOnce("Collisions detected, but collision boxes are not shown"),Pn=Pe||zr.circles.length>0&&!zr.collisionDetected,In=In&&zr.offscreen}if(cn.iconFeatureIndex&&(go=cn.iconFeatureIndex),cn.iconBox){const wi=pi=>{const Ri=$e&&Mr?tn(pi,Mr.x,Mr.y,Ae,Ue,this.transform.angle):pi;return this.collisionIndex.placeCollisionBox(Ri,De,R,P,ue.predicate,Vt)};fi&&fi.box&&fi.box.length&&cn.verticalIconBox?(ps=wi(cn.verticalIconBox),vn=ps.box.length>0):(ps=wi(cn.iconBox),vn=ps.box.length>0),In=In&&ps.offscreen}const ja=le||mt.numHorizontalGlyphVertices===0&&mt.numVerticalGlyphVertices===0,Rl=fe||mt.numIconVertices===0;if(ja||Rl?Rl?ja||(vn=vn&&Pn):Pn=vn&&Pn:vn=Pn=vn&&Pn,Pn&&Qr&&Qr.box&&this.collisionIndex.insertCollisionBox(Qr.box,oe,b.get("text-ignore-placement"),y.bucketInstanceId,fi&&fi.box&&mo?mo:or,ue.ID),vn&&ps&&this.collisionIndex.insertCollisionBox(ps.box,De,b.get("icon-ignore-placement"),y.bucketInstanceId,go,ue.ID),zr&&(Pn&&this.collisionIndex.insertCollisionCircles(zr.circles,oe,b.get("text-ignore-placement"),y.bucketInstanceId,or,ue.ID),p)){const wi=y.bucketInstanceId;let pi=this.collisionCircleArrays[wi];pi===void 0&&(pi=this.collisionCircleArrays[wi]=new He);for(let Ri=0;Ri<zr.circles.length;Ri+=4)pi.circles.push(zr.circles[Ri+0]),pi.circles.push(zr.circles[Ri+1]),pi.circles.push(zr.circles[Ri+2]),pi.circles.push(zr.collisionDetected?1:0)}if(mt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(y.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[mt.crossTileID]=new Ce(Pn||tt,vn||Qe,In||y.justReloaded),d[mt.crossTileID]=!0};if(Xe){if(o.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const mt=y.getSortedSymbolIndexes(this.transform.angle);for(let cn=mt.length-1;cn>=0;--cn){const Gt=mt[cn];An(y.symbolInstances.get(Gt),y.collisionArrays[Gt])}}else for(let mt=o.symbolInstanceStart;mt<o.symbolInstanceEnd;mt++)An(y.symbolInstances.get(mt),y.collisionArrays[mt]);if(p&&y.bucketInstanceId in this.collisionCircleArrays){const mt=this.collisionCircleArrays[y.bucketInstanceId];l.invert(mt.invProjMatrix,P),mt.viewportMatrix=this.collisionIndex.getViewportMatrix()}y.justReloaded=!1}markUsedJustification(o,d,p,y){let b;b=y===l.WritingMode.vertical?p.verticalPlacedTextSymbolIndex:{left:p.leftJustifiedTextSymbolIndex,center:p.centerJustifiedTextSymbolIndex,right:p.rightJustifiedTextSymbolIndex}[l.getAnchorJustification(d)];const P=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex,p.verticalPlacedTextSymbolIndex];for(const C of P)C>=0&&(o.text.placedSymbolArray.get(C).crossTileID=b>=0&&C!==b?0:p.crossTileID)}markUsedOrientation(o,d,p){const y=d===l.WritingMode.horizontal||d===l.WritingMode.horizontalOnly?d:0,b=d===l.WritingMode.vertical?d:0,P=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex];for(const C of P)o.text.placedSymbolArray.get(C).placedOrientation=y;p.verticalPlacedTextSymbolIndex&&(o.text.placedSymbolArray.get(p.verticalPlacedTextSymbolIndex).placedOrientation=b)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const d=this.prevPlacement;let p=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;const y=d?d.symbolFadeChange(o):1,b=d?d.opacities:{},P=d?d.variableOffsets:{},C=d?d.placedOrientations:{};for(const M in this.placements){const R=this.placements[M],U=b[M];U?(this.opacities[M]=new ge(U,y,R.text,R.icon),p=p||R.text!==U.text.placed||R.icon!==U.icon.placed):(this.opacities[M]=new ge(null,y,R.text,R.icon,R.skipFade),p=p||R.text||R.icon)}for(const M in b){const R=b[M];if(!this.opacities[M]){const U=new ge(R,y,!1,!1);U.isHidden()||(this.opacities[M]=U,p=p||R.text.placed||R.icon.placed)}}for(const M in P)this.variableOffsets[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.variableOffsets[M]=P[M]);for(const M in C)this.placedOrientations[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.placedOrientations[M]=C[M]);if(d&&d.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");p?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:o)}updateLayerOpacities(o,d){const p={};for(const y of d){const b=y.getBucket(o);b&&y.latestFeatureIndex&&o.id===b.layerIds[0]&&this.updateBucketOpacities(b,p,y.collisionBoxArray)}}updateBucketOpacities(o,d,p){o.hasTextData()&&(o.text.opacityVertexArray.clear(),o.text.hasVisibleVertices=!1),o.hasIconData()&&(o.icon.opacityVertexArray.clear(),o.icon.hasVisibleVertices=!1),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const y=o.layers[0],b=y.layout,P=new ge(null,0,!1,!1,!0),C=b.get("text-allow-overlap"),M=b.get("icon-allow-overlap"),R=y._unevaluatedLayout.hasValue("text-variable-anchor")||y._unevaluatedLayout.hasValue("text-variable-anchor-offset"),U=b.get("text-rotation-alignment")==="map",V=b.get("text-pitch-alignment")==="map",X=b.get("icon-text-fit")!=="none",ue=new ge(null,0,C&&(M||!o.hasIconData()||b.get("icon-optional")),M&&(C||!o.hasTextData()||b.get("text-optional")),!0);!o.collisionArrays&&p&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(p);const le=(fe,oe,Pe)=>{for(let De=0;De<oe/4;De++)fe.opacityVertexArray.emplaceBack(Pe);fe.hasVisibleVertices=fe.hasVisibleVertices||Pe!==xr};for(let fe=0;fe<o.symbolInstances.length;fe++){const oe=o.symbolInstances.get(fe),{numHorizontalGlyphVertices:Pe,numVerticalGlyphVertices:De,crossTileID:me}=oe;let Ae=this.opacities[me];d[me]?Ae=P:Ae||(Ae=ue,this.opacities[me]=Ae),d[me]=!0;const Ue=oe.numIconVertices>0,$e=this.placedOrientations[oe.crossTileID],Xe=$e===l.WritingMode.vertical,tt=$e===l.WritingMode.horizontal||$e===l.WritingMode.horizontalOnly;if(Pe>0||De>0){const Qe=On(Ae.text);le(o.text,Pe,Xe?xr:Qe),le(o.text,De,tt?xr:Qe);const ct=Ae.text.isHidden();[oe.rightJustifiedTextSymbolIndex,oe.centerJustifiedTextSymbolIndex,oe.leftJustifiedTextSymbolIndex].forEach(mt=>{mt>=0&&(o.text.placedSymbolArray.get(mt).hidden=ct||Xe?1:0)}),oe.verticalPlacedTextSymbolIndex>=0&&(o.text.placedSymbolArray.get(oe.verticalPlacedTextSymbolIndex).hidden=ct||tt?1:0);const Vt=this.variableOffsets[oe.crossTileID];Vt&&this.markUsedJustification(o,Vt.anchor,oe,$e);const An=this.placedOrientations[oe.crossTileID];An&&(this.markUsedJustification(o,"left",oe,An),this.markUsedOrientation(o,An,oe))}if(Ue){const Qe=On(Ae.icon),ct=!(X&&oe.verticalPlacedIconSymbolIndex&&Xe);oe.placedIconSymbolIndex>=0&&(le(o.icon,oe.numIconVertices,ct?Qe:xr),o.icon.placedSymbolArray.get(oe.placedIconSymbolIndex).hidden=Ae.icon.isHidden()),oe.verticalPlacedIconSymbolIndex>=0&&(le(o.icon,oe.numVerticalIconVertices,ct?xr:Qe),o.icon.placedSymbolArray.get(oe.verticalPlacedIconSymbolIndex).hidden=Ae.icon.isHidden())}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const Qe=o.collisionArrays[fe];if(Qe){let ct=new l.Point(0,0);if(Qe.textBox||Qe.verticalTextBox){let An=!0;if(R){const mt=this.variableOffsets[me];mt?(ct=Pt(mt.anchor,mt.width,mt.height,mt.textOffset,mt.textBoxScale),U&&ct._rotate(V?this.transform.angle:-this.transform.angle)):An=!1}Qe.textBox&&ft(o.textCollisionBox.collisionVertexArray,Ae.text.placed,!An||Xe,ct.x,ct.y),Qe.verticalTextBox&&ft(o.textCollisionBox.collisionVertexArray,Ae.text.placed,!An||tt,ct.x,ct.y)}const Vt=!!(!tt&&Qe.verticalIconBox);Qe.iconBox&&ft(o.iconCollisionBox.collisionVertexArray,Ae.icon.placed,Vt,X?ct.x:0,X?ct.y:0),Qe.verticalIconBox&&ft(o.iconCollisionBox.collisionVertexArray,Ae.icon.placed,!Vt,X?ct.x:0,X?ct.y:0)}}}if(o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.text.opacityVertexArray.length!==o.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${o.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${o.text.layoutVertexArray.length}) / 4`);if(o.icon.opacityVertexArray.length!==o.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${o.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${o.icon.layoutVertexArray.length}) / 4`);if(o.bucketInstanceId in this.collisionCircleArrays){const fe=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=fe.invProjMatrix,o.placementViewportMatrix=fe.viewportMatrix,o.collisionCircleArray=fe.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,d){const p=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*p>o}setStale(){this.stale=!0}}function ft(v,o,d,p,y){v.emplaceBack(o?1:0,d?1:0,p||0,y||0),v.emplaceBack(o?1:0,d?1:0,p||0,y||0),v.emplaceBack(o?1:0,d?1:0,p||0,y||0),v.emplaceBack(o?1:0,d?1:0,p||0,y||0)}const Ft=Math.pow(2,25),xn=Math.pow(2,24),bn=Math.pow(2,17),dn=Math.pow(2,16),_n=Math.pow(2,9),Ar=Math.pow(2,8),Ut=Math.pow(2,1);function On(v){if(v.opacity===0&&!v.placed)return 0;if(v.opacity===1&&v.placed)return 4294967295;const o=v.placed?1:0,d=Math.floor(127*v.opacity);return d*Ft+o*xn+d*bn+o*dn+d*_n+o*Ar+d*Ut+o}const xr=0;class Us{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&!o.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(o,d,p,y,b){const P=this._bucketParts;for(;this._currentTileIndex<o.length;)if(d.getBucketParts(P,y,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,P.sort((C,M)=>C.sortKey-M.sortKey));this._currentPartIndex<P.length;)if(d.placeLayerBucketPart(P[this._currentPartIndex],this._seenCrossTileIDs,p),this._currentPartIndex++,b())return!0;return!1}}class Jr{constructor(o,d,p,y,b,P,C,M){this.placement=new Lt(o,d,P,C,M),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=y,this._showCollisionBoxes=b,this._done=!1}isDone(){return this._done}continuePlacement(o,d,p){const y=l.browser.now(),b=()=>!this._forceFullPlacement&&l.browser.now()-y>2;for(;this._currentPlacementIndex>=0;){const P=d[o[this._currentPlacementIndex]],C=this.placement.collisionIndex.transform.zoom;if(P.type==="symbol"&&(!P.minzoom||P.minzoom<=C)&&(!P.maxzoom||P.maxzoom>C)){if(this._inProgressLayer||(this._inProgressLayer=new Us(P)),this._inProgressLayer.continuePlacement(p[P.source],this.placement,this._showCollisionBoxes,P,b))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const ls=512/l.EXTENT/2;class ho{constructor(o,d,p){this.tileID=o,this.bucketInstanceId=p,this._symbolsByKey={};const y=new Map;for(let b=0;b<d.length;b++){const P=d.get(b),C=P.key,M=y.get(C);M?M.push(P):y.set(C,[P])}for(const[b,P]of y){const C={positions:P.map(M=>({x:Math.floor(M.anchorX*ls),y:Math.floor(M.anchorY*ls)})),crossTileIDs:P.map(M=>M.crossTileID)};if(C.positions.length>128){const M=new l.KDBush(C.positions.length,16,Uint16Array);for(const{x:R,y:U}of C.positions)M.add(R,U);M.finish(),delete C.positions,C.index=M}this._symbolsByKey[b]=C}}getScaledCoordinates(o,d){const{x:p,y,z:b}=this.tileID.canonical,{x:P,y:C,z:M}=d.canonical,R=ls/Math.pow(2,M-b),U=(C*l.EXTENT+o.anchorY)*R,V=y*l.EXTENT*ls;return{x:Math.floor((P*l.EXTENT+o.anchorX)*R-p*l.EXTENT*ls),y:Math.floor(U-V)}}findMatches(o,d,p){const y=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z);for(let b=0;b<o.length;b++){const P=o.get(b);if(P.crossTileID)continue;const C=this._symbolsByKey[P.key];if(!C)continue;const M=this.getScaledCoordinates(P,d);if(C.index){const R=C.index.range(M.x-y,M.y-y,M.x+y,M.y+y).sort();for(const U of R){const V=C.crossTileIDs[U];if(!p[V]){p[V]=!0,P.crossTileID=V;break}}}else if(C.positions)for(let R=0;R<C.positions.length;R++){const U=C.positions[R],V=C.crossTileIDs[R];if(Math.abs(U.x-M.x)<=y&&Math.abs(U.y-M.y)<=y&&!p[V]){p[V]=!0,P.crossTileID=V;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:o})=>o)}}class Cn{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class zo{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const d=Math.round((o-this.lng)/360);if(d!==0)for(const p in this.indexes){const y=this.indexes[p],b={};for(const P in y){const C=y[P];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+d),b[C.tileID.key]=C}this.indexes[p]=b}this.lng=o}addBucket(o,d,p){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let b=0;b<d.symbolInstances.length;b++)d.symbolInstances.get(b).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]={});const y=this.usedCrossTileIDs[o.overscaledZ];for(const b in this.indexes){const P=this.indexes[b];if(Number(b)>o.overscaledZ)for(const C in P){const M=P[C];M.tileID.isChildOf(o)&&M.findMatches(d.symbolInstances,o,y)}else{const C=P[o.scaledTo(Number(b)).key];C&&C.findMatches(d.symbolInstances,o,y)}}for(let b=0;b<d.symbolInstances.length;b++){const P=d.symbolInstances.get(b);P.crossTileID||(P.crossTileID=p.generate(),y[P.crossTileID]=!0)}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new ho(o,d.symbolInstances,d.bucketInstanceId),!0}removeBucketCrossTileIDs(o,d){for(const p of d.getCrossTileIDsLists())for(const y of p)delete this.usedCrossTileIDs[o][y]}removeStaleBuckets(o){let d=!1;for(const p in this.indexes){const y=this.indexes[p];for(const b in y)o[y[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,y[b]),delete y[b],d=!0)}return d}}class ki{constructor(){this.layerIndexes={},this.crossTileIDs=new Cn,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,d,p){let y=this.layerIndexes[o.id];y===void 0&&(y=this.layerIndexes[o.id]=new zo);let b=!1;const P={};y.handleWrapJump(p);for(const C of d){const M=C.getBucket(o);M&&o.id===M.layerIds[0]&&(M.bucketInstanceId||(M.bucketInstanceId=++this.maxBucketInstanceId),y.addBucket(C.tileID,M,this.crossTileIDs)&&(b=!0),P[M.bucketInstanceId]=!0)}return y.removeStaleBuckets(P)&&(b=!0),b}pruneUnusedLayers(o){const d={};o.forEach(p=>{d[p]=!0});for(const p in this.layerIndexes)d[p]||delete this.layerIndexes[p]}}const ir=(v,o)=>l.emitValidationErrors(v,o&&o.filter(d=>d.identifier!=="source.canvas")),bi=l.pick(l.operations,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),Lu=l.pick(l.operations,["setCenter","setZoom","setBearing","setPitch"]),hi=l.emptyStyle();class Zn extends l.Evented{constructor(o,d={}){super(),this.map=o,this.dispatcher=new zt(et(),this,o._getMapId()),this.imageManager=new Ge,this.imageManager.setEventedParent(this),this.glyphManager=new je(o._requestManager,d.localIdeographFontFamily),this.lineAtlas=new ut(256,512),this.crossTileSymbolIndex=new ki,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new l.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",l.getReferrer());const p=this;this._rtlTextPluginCallback=Zn.registerForPluginStateChange(y=>{p.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:y.pluginStatus,pluginURL:y.pluginURL},(b,P)=>{if(l.triggerPluginCompletionEvent(b),P&&P.every(C=>C))for(const C in p.sourceCaches){const M=p.sourceCaches[C].getSource().type;M!=="vector"&&M!=="geojson"||p.sourceCaches[C].reload()}})}),this.on("data",y=>{if(y.dataType!=="source"||y.sourceDataType!=="metadata")return;const b=this.sourceCaches[y.sourceId];if(!b)return;const P=b.getSource();if(P&&P.vectorLayerIds)for(const C in this._layers){const M=this._layers[C];M.source===P.id&&this._validateLayer(M)}})}loadURL(o,d={},p){this.fire(new l.Event("dataloading",{dataType:"style"})),d.validate=typeof d.validate!="boolean"||d.validate;const y=this.map._requestManager.transformRequest(o,z.Style);this._request=l.getJSON(y,(b,P)=>{this._request=null,b?this.fire(new l.ErrorEvent(b)):P&&this._load(P,d,p)})}loadJSON(o,d={},p){this.fire(new l.Event("dataloading",{dataType:"style"})),this._request=l.browser.frame(()=>{this._request=null,d.validate=d.validate!==!1,this._load(o,d,p)})}loadEmpty(){this.fire(new l.Event("dataloading",{dataType:"style"})),this._load(hi,{validate:!1})}_load(o,d,p){var y;const b=d.transformStyle?d.transformStyle(p,o):o;if(!d.validate||!ir(this,l.validateStyle(b))){this._loaded=!0,this.stylesheet=b;for(const P in b.sources)this.addSource(P,b.sources[P],{validate:!1});b.sprite?this._loadSprite(b.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(b.glyphs),this._createLayers(),this.light=new qe(this.stylesheet.light),this.map.setTerrain((y=this.stylesheet.terrain)!==null&&y!==void 0?y:null),this.fire(new l.Event("data",{dataType:"style"})),this.fire(new l.Event("style.load"))}}_createLayers(){const o=l.derefLayers(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",o),this._order=o.map(d=>d.id),this._layers={},this._serializedLayers=null;for(const d of o){const p=l.createStyleLayer(d);p.setEventedParent(this,{layer:{id:d.id}}),this._layers[d.id]=p}}_loadSprite(o,d=!1,p=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(y,b,P,C){const M=we(y),R=M.length,U=P>1?"@2x":"",V={},X={},ue={};for(const{id:le,url:fe}of M){const oe=b.transformRequest(b.normalizeSpriteURL(fe,U,".json"),z.SpriteJSON),Pe=`${le}_${oe.url}`;V[Pe]=l.getJSON(oe,(Ae,Ue)=>{delete V[Pe],X[le]=Ue,Ee(C,X,ue,Ae,R)});const De=b.transformRequest(b.normalizeSpriteURL(fe,U,".png"),z.SpriteImage),me=`${le}_${De.url}`;V[me]=H.getImage(De,(Ae,Ue)=>{delete V[me],ue[le]=Ue,Ee(C,X,ue,Ae,R)})}return{cancel(){for(const le of Object.values(V))le.cancel()}}}(o,this.map._requestManager,this.map.getPixelRatio(),(y,b)=>{if(this._spriteRequest=null,y)this.fire(new l.ErrorEvent(y));else if(b)for(const P in b){this._spritesImagesIds[P]=[];const C=this._spritesImagesIds[P]?this._spritesImagesIds[P].filter(M=>!(M in b)):[];for(const M of C)this.imageManager.removeImage(M),this._changedImages[M]=!0;for(const M in b[P]){const R=P==="default"?M:`${P}:${M}`;this._spritesImagesIds[P].push(R),R in this.imageManager.images?this.imageManager.updateImage(R,b[P][M],!1):this.imageManager.addImage(R,b[P][M]),d&&(this._changedImages[R]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),d&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"})),p&&p(y)})}_unloadSprite(){for(const o of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(o),this._changedImages[o]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))}_validateLayer(o){const d=this.sourceCaches[o.source];if(!d)return;const p=o.sourceLayer;if(!p)return;const y=d.getSource();(y.type==="geojson"||y.vectorLayerIds&&y.vectorLayerIds.indexOf(p)===-1)&&this.fire(new l.ErrorEvent(new Error(`Source layer "${p}" does not exist on source "${y.id}" as specified by style layer "${o.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(o){const d=this._serializedAllLayers();if(!o||o.length===0)return Object.values(d);const p=[];for(const y of o)d[y]&&p.push(d[y]);return p}_serializedAllLayers(){let o=this._serializedLayers;if(o)return o;o=this._serializedLayers={};const d=Object.keys(this._layers);for(const p of d){const y=this._layers[p];y.type!=="custom"&&(o[p]=y.serialize())}return o}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(o){if(!this._loaded)return;const d=this._changed;if(this._changed){const y=Object.keys(this._updatedLayers),b=Object.keys(this._removedLayers);(y.length||b.length)&&this._updateWorkerLayers(y,b);for(const P in this._updatedSources){const C=this._updatedSources[P];if(C==="reload")this._reloadSource(P);else{if(C!=="clear")throw new Error(`Invalid action ${C}`);this._clearSource(P)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const P in this._updatedPaintProps)this._layers[P].updateTransitions(o);this.light.updateTransitions(o),this._resetUpdates()}const p={};for(const y in this.sourceCaches){const b=this.sourceCaches[y];p[y]=b.used,b.used=!1}for(const y of this._order){const b=this._layers[y];b.recalculate(o,this._availableImages),!b.isHidden(o.zoom)&&b.source&&(this.sourceCaches[b.source].used=!0)}for(const y in p){const b=this.sourceCaches[y];p[y]!==b.used&&b.fire(new l.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:y}))}this.light.recalculate(o),this.z=o.zoom,d&&this.fire(new l.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const d in this.sourceCaches)this.sourceCaches[d].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const o in this.sourceCaches)this.sourceCaches[o].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(o,d){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(o),removedIds:d})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(o,d={}){this._checkLoaded();const p=this.serialize();if(o=d.transformStyle?d.transformStyle(p,o):o,ir(this,l.validateStyle(o)))return!1;(o=l.clone$1(o)).layers=l.derefLayers(o.layers);const y=l.diffStyles(p,o).filter(P=>!(P.command in Lu));if(y.length===0)return!1;const b=y.filter(P=>!(P.command in bi));if(b.length>0)throw new Error(`Unimplemented: ${b.map(P=>P.command).join(", ")}.`);for(const P of y)P.command!=="setTransition"&&this[P.command].apply(this,P.args);return this.stylesheet=o,this._serializedLayers=null,!0}addImage(o,d){if(this.getImage(o))return this.fire(new l.ErrorEvent(new Error(`An image named "${o}" already exists.`)));this.imageManager.addImage(o,d),this._afterImageUpdated(o)}updateImage(o,d){this.imageManager.updateImage(o,d)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){if(!this.getImage(o))return this.fire(new l.ErrorEvent(new Error(`An image named "${o}" does not exist.`)));this.imageManager.removeImage(o),this._afterImageUpdated(o)}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(o,d,p={}){if(this._checkLoaded(),this.sourceCaches[o]!==void 0)throw new Error(`Source "${o}" already exists.`);if(!d.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(d).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(l.validateStyle.source,`sources.${o}`,d,null,p))return;this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);const y=this.sourceCaches[o]=new Bt(o,d,this.dispatcher);y.style=this,y.setEventedParent(this,()=>({isSourceLoaded:y.loaded(),source:y.serialize(),sourceId:o})),y.onAdd(this.map),this._changed=!0}removeSource(o){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error("There is no source with this ID");for(const p in this._layers)if(this._layers[p].source===o)return this.fire(new l.ErrorEvent(new Error(`Source "${o}" cannot be removed while layer "${p}" is using it.`)));const d=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],d.fire(new l.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),d.setEventedParent(null),d.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(o,d){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error(`There is no source with this ID=${o}`);const p=this.sourceCaches[o].getSource();if(p.type!=="geojson")throw new Error(`geojsonSource.type is ${p.type}, which is !== 'geojson`);p.setData(d),this._changed=!0}getSource(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()}addLayer(o,d,p={}){this._checkLoaded();const y=o.id;if(this.getLayer(y))return void this.fire(new l.ErrorEvent(new Error(`Layer "${y}" already exists on this map.`)));let b;if(o.type==="custom"){if(ir(this,l.validateCustomStyleLayer(o)))return;b=l.createStyleLayer(o)}else{if("source"in o&&typeof o.source=="object"&&(this.addSource(y,o.source),o=l.clone$1(o),o=l.extend(o,{source:y})),this._validate(l.validateStyle.layer,`layers.${y}`,o,{arrayIndex:-1},p))return;b=l.createStyleLayer(o),this._validateLayer(b),b.setEventedParent(this,{layer:{id:y}})}const P=d?this._order.indexOf(d):this._order.length;if(d&&P===-1)this.fire(new l.ErrorEvent(new Error(`Cannot add layer "${y}" before non-existing layer "${d}".`)));else{if(this._order.splice(P,0,y),this._layerOrderChanged=!0,this._layers[y]=b,this._removedLayers[y]&&b.source&&b.type!=="custom"){const C=this._removedLayers[y];delete this._removedLayers[y],C.type!==b.type?this._updatedSources[b.source]="clear":(this._updatedSources[b.source]="reload",this.sourceCaches[b.source].pause())}this._updateLayer(b),b.onAdd&&b.onAdd(this.map)}}moveLayer(o,d){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new l.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===d)return;const p=this._order.indexOf(o);this._order.splice(p,1);const y=d?this._order.indexOf(d):this._order.length;d&&y===-1?this.fire(new l.ErrorEvent(new Error(`Cannot move layer "${o}" before non-existing layer "${d}".`))):(this._order.splice(y,0,o),this._layerOrderChanged=!0)}removeLayer(o){this._checkLoaded();const d=this._layers[o];if(!d)return void this.fire(new l.ErrorEvent(new Error(`Cannot remove non-existing layer "${o}".`)));d.setEventedParent(null);const p=this._order.indexOf(o);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=d,delete this._layers[o],this._serializedLayers&&delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],d.onRemove&&d.onRemove(this.map)}getLayer(o){return this._layers[o]}hasLayer(o){return o in this._layers}setLayerZoomRange(o,d,p){this._checkLoaded();const y=this.getLayer(o);y?y.minzoom===d&&y.maxzoom===p||(d!=null&&(y.minzoom=d),p!=null&&(y.maxzoom=p),this._updateLayer(y)):this.fire(new l.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${o}".`)))}setFilter(o,d,p={}){this._checkLoaded();const y=this.getLayer(o);if(y){if(!l.deepEqual(y.filter,d))return d==null?(y.filter=void 0,void this._updateLayer(y)):void(this._validate(l.validateStyle.filter,`layers.${y.id}.filter`,d,null,p)||(y.filter=l.clone$1(d),this._updateLayer(y)))}else this.fire(new l.ErrorEvent(new Error(`Cannot filter non-existing layer "${o}".`)))}getFilter(o){return l.clone$1(this.getLayer(o).filter)}setLayoutProperty(o,d,p,y={}){this._checkLoaded();const b=this.getLayer(o);b?l.deepEqual(b.getLayoutProperty(d),p)||(b.setLayoutProperty(d,p,y),this._updateLayer(b)):this.fire(new l.ErrorEvent(new Error(`Cannot style non-existing layer "${o}".`)))}getLayoutProperty(o,d){const p=this.getLayer(o);if(p)return p.getLayoutProperty(d);this.fire(new l.ErrorEvent(new Error(`Cannot get style of non-existing layer "${o}".`)))}setPaintProperty(o,d,p,y={}){this._checkLoaded();const b=this.getLayer(o);b?l.deepEqual(b.getPaintProperty(d),p)||(b.setPaintProperty(d,p,y)&&this._updateLayer(b),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new l.ErrorEvent(new Error(`Cannot style non-existing layer "${o}".`)))}getPaintProperty(o,d){return this.getLayer(o).getPaintProperty(d)}setFeatureState(o,d){this._checkLoaded();const p=o.source,y=o.sourceLayer,b=this.sourceCaches[p];if(b===void 0)return void this.fire(new l.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const P=b.getSource().type;P==="geojson"&&y?this.fire(new l.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):P!=="vector"||y?(o.id===void 0&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),b.setFeatureState(y,o.id,d)):this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(o,d){this._checkLoaded();const p=o.source,y=this.sourceCaches[p];if(y===void 0)return void this.fire(new l.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const b=y.getSource().type,P=b==="vector"?o.sourceLayer:void 0;b!=="vector"||P?d&&typeof o.id!="string"&&typeof o.id!="number"?this.fire(new l.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):y.removeFeatureState(P,o.id,d):this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(o){this._checkLoaded();const d=o.source,p=o.sourceLayer,y=this.sourceCaches[d];if(y!==void 0)return y.getSource().type!=="vector"||p?(o.id===void 0&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),y.getFeatureState(p,o.id)):void this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new l.ErrorEvent(new Error(`The source '${d}' does not exist in the map's style.`)))}getTransition(){return l.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const o=l.mapObject(this.sourceCaches,y=>y.serialize()),d=this._serializeByIds(this._order),p=this.stylesheet;return l.filterObject({version:p.version,name:p.name,metadata:p.metadata,light:p.light,center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch,sprite:p.sprite,glyphs:p.glyphs,transition:p.transition,sources:o,layers:d},y=>y!==void 0)}_updateLayer(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&this.sourceCaches[o.source].getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(o){const d=P=>this._layers[P].type==="fill-extrusion",p={},y=[];for(let P=this._order.length-1;P>=0;P--){const C=this._order[P];if(d(C)){p[C]=P;for(const M of o){const R=M[C];if(R)for(const U of R)y.push(U)}}}y.sort((P,C)=>C.intersectionZ-P.intersectionZ);const b=[];for(let P=this._order.length-1;P>=0;P--){const C=this._order[P];if(d(C))for(let M=y.length-1;M>=0;M--){const R=y[M].feature;if(p[R.layer.id]<P)break;b.push(R),y.pop()}else for(const M of o){const R=M[C];if(R)for(const U of R)b.push(U.feature)}}return b}queryRenderedFeatures(o,d,p){d&&d.filter&&this._validate(l.validateStyle.filter,"queryRenderedFeatures.filter",d.filter,null,d);const y={};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new l.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const C of d.layers){const M=this._layers[C];if(!M)return this.fire(new l.ErrorEvent(new Error(`The layer '${C}' does not exist in the map's style and cannot be queried for features.`))),[];y[M.source]=!0}}const b=[];d.availableImages=this._availableImages;const P=this._serializedAllLayers();for(const C in this.sourceCaches)d.layers&&!y[C]||b.push(wn(this.sourceCaches[C],this._layers,P,o,d,p));return this.placement&&b.push(function(C,M,R,U,V,X,ue){const le={},fe=X.queryRenderedSymbols(U),oe=[];for(const Pe of Object.keys(fe).map(Number))oe.push(ue[Pe]);oe.sort(mn);for(const Pe of oe){const De=Pe.featureIndex.lookupSymbolFeatures(fe[Pe.bucketInstanceId],M,Pe.bucketIndex,Pe.sourceLayerIndex,V.filter,V.layers,V.availableImages,C);for(const me in De){const Ae=le[me]=le[me]||[],Ue=De[me];Ue.sort(($e,Xe)=>{const tt=Pe.featureSortOrder;if(tt){const Qe=tt.indexOf($e.featureIndex);return tt.indexOf(Xe.featureIndex)-Qe}return Xe.featureIndex-$e.featureIndex});for(const $e of Ue)Ae.push($e)}}for(const Pe in le)le[Pe].forEach(De=>{const me=De.feature,Ae=R[C[Pe].source].getFeatureState(me.layer["source-layer"],me.id);me.source=me.layer.source,me.layer["source-layer"]&&(me.sourceLayer=me.layer["source-layer"]),me.state=Ae});return le}(this._layers,P,this.sourceCaches,o,d,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(b)}querySourceFeatures(o,d){d&&d.filter&&this._validate(l.validateStyle.filter,"querySourceFeatures.filter",d.filter,null,d);const p=this.sourceCaches[o];return p?function(y,b){const P=y.getRenderableIds().map(R=>y.getTileByID(R)),C=[],M={};for(let R=0;R<P.length;R++){const U=P[R],V=U.tileID.canonical.key;M[V]||(M[V]=!0,U.querySourceFeatures(C,b))}return C}(p,d):[]}addSourceType(o,d,p){return Ot(o)?p(new Error(`A source type called "${o}" already exists.`)):(((y,b)=>{Wt[y]=b})(o,d),d.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:d.workerSourceURL},p):p(null,null))}getLight(){return this.light.getLight()}setLight(o,d={}){this._checkLoaded();const p=this.light.getLight();let y=!1;for(const P in o)if(!l.deepEqual(o[P],p[P])){y=!0;break}if(!y)return;const b={now:l.browser.now(),transition:l.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,d),this.light.updateTransitions(b)}_validate(o,d,p,y,b={}){return(!b||b.validate!==!1)&&ir(this,o.call(l.validateStyle,l.extend({key:d,style:this.serialize(),value:p,styleSpec:l.v8Spec},y)))}_remove(o=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),l.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const d in this._layers)this._layers[d].setEventedParent(null);for(const d in this.sourceCaches){const p=this.sourceCaches[d];p.setEventedParent(null),p.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(o)}_clearSource(o){this.sourceCaches[o].clearTiles()}_reloadSource(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()}_updateSources(o){for(const d in this.sourceCaches)this.sourceCaches[d].update(o,this.map.terrain)}_generateCollisionBoxes(){for(const o in this.sourceCaches)this._reloadSource(o)}_updatePlacement(o,d,p,y,b=!1){let P=!1,C=!1;const M={};for(const R of this._order){const U=this._layers[R];if(U.type!=="symbol")continue;if(!M[U.source]){const X=this.sourceCaches[U.source];M[U.source]=X.getRenderableIds(!0).map(ue=>X.getTileByID(ue)).sort((ue,le)=>le.tileID.overscaledZ-ue.tileID.overscaledZ||(ue.tileID.isLessThan(le.tileID)?-1:1))}const V=this.crossTileSymbolIndex.addLayer(U,M[U.source],o.center.lng);P=P||V}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((b=b||this._layerOrderChanged||p===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(l.browser.now(),o.zoom))&&(this.pauseablePlacement=new Jr(o,this.map.terrain,this._order,b,d,p,y,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,M),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(l.browser.now()),C=!0),P&&this.pauseablePlacement.placement.setStale()),C||P)for(const R of this._order){const U=this._layers[R];U.type==="symbol"&&this.placement.updateLayerOpacities(U,M[U.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(l.browser.now())}_releaseSymbolFadeTiles(){for(const o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()}getImages(o,d,p){this.imageManager.getImages(d.icons,p),this._updateTilesForChangedImages();const y=this.sourceCaches[d.source];y&&y.setDependencies(d.tileID.key,d.type,d.icons)}getGlyphs(o,d,p){this.glyphManager.getGlyphs(d.stacks,p);const y=this.sourceCaches[d.source];y&&y.setDependencies(d.tileID.key,d.type,[""])}getResource(o,d,p){return l.makeRequest(d,p)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(o,d={}){this._checkLoaded(),o&&this._validate(l.validateStyle.glyphs,"glyphs",o,null,d)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=o,this.glyphManager.entries={},this.glyphManager.setURL(o))}addSprite(o,d,p={},y){this._checkLoaded();const b=[{id:o,url:d}],P=[...we(this.stylesheet.sprite),...b];this._validate(l.validateStyle.sprite,"sprite",P,null,p)||(this.stylesheet.sprite=P,this._loadSprite(b,!0,y))}removeSprite(o){this._checkLoaded();const d=we(this.stylesheet.sprite);if(d.find(p=>p.id===o)){if(this._spritesImagesIds[o])for(const p of this._spritesImagesIds[o])this.imageManager.removeImage(p),this._changedImages[p]=!0;d.splice(d.findIndex(p=>p.id===o),1),this.stylesheet.sprite=d.length>0?d:void 0,delete this._spritesImagesIds[o],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))}else this.fire(new l.ErrorEvent(new Error(`Sprite "${o}" doesn't exists on this map.`)))}getSprite(){return we(this.stylesheet.sprite)}setSprite(o,d={},p){this._checkLoaded(),o&&this._validate(l.validateStyle.sprite,"sprite",o,null,d)||(this.stylesheet.sprite=o,o?this._loadSprite(o,!0,p):(this._unloadSprite(),p&&p(null)))}}Zn.registerForPluginStateChange=l.registerForPluginStateChange;var Fo=l.createLayout([{name:"a_pos",type:"Int16",components:2}]),fo="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const Jn={prelude:Dn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Dn(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Dn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Dn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Dn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Dn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:Dn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Dn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Dn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Dn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Dn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Dn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Dn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Dn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Dn(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Dn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Dn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Dn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Dn(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Dn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Dn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Dn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Dn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Dn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Dn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Dn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Dn("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",fo),terrainDepth:Dn("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",fo),terrainCoords:Dn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",fo)};function Dn(v,o){const d=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=o.match(/attribute ([\w]+) ([\w]+)/g),y=v.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),b=o.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),P=b?b.concat(y):y,C={};return{fragmentSource:v=v.replace(d,(M,R,U,V,X)=>(C[X]=!0,R==="define"?`
#ifndef HAS_UNIFORM_u_${X}
varying ${U} ${V} ${X};
#else
uniform ${U} ${V} u_${X};
#endif
`:`
#ifdef HAS_UNIFORM_u_${X}
    ${U} ${V} ${X} = u_${X};
#endif
`)),vertexSource:o=o.replace(d,(M,R,U,V,X)=>{const ue=V==="float"?"vec2":"vec4",le=X.match(/color/)?"color":ue;return C[X]?R==="define"?`
#ifndef HAS_UNIFORM_u_${X}
uniform lowp float u_${X}_t;
attribute ${U} ${ue} a_${X};
varying ${U} ${V} ${X};
#else
uniform ${U} ${V} u_${X};
#endif
`:le==="vec4"?`
#ifndef HAS_UNIFORM_u_${X}
    ${X} = a_${X};
#else
    ${U} ${V} ${X} = u_${X};
#endif
`:`
#ifndef HAS_UNIFORM_u_${X}
    ${X} = unpack_mix_${le}(a_${X}, u_${X}_t);
#else
    ${U} ${V} ${X} = u_${X};
#endif
`:R==="define"?`
#ifndef HAS_UNIFORM_u_${X}
uniform lowp float u_${X}_t;
attribute ${U} ${ue} a_${X};
#else
uniform ${U} ${V} u_${X};
#endif
`:le==="vec4"?`
#ifndef HAS_UNIFORM_u_${X}
    ${U} ${V} ${X} = a_${X};
#else
    ${U} ${V} ${X} = u_${X};
#endif
`:`
#ifndef HAS_UNIFORM_u_${X}
    ${U} ${V} ${X} = unpack_mix_${le}(a_${X}, u_${X}_t);
#else
    ${U} ${V} ${X} = u_${X};
#endif
`}),staticAttributes:p,staticUniforms:P}}class Vs{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(o,d,p,y,b,P,C,M,R){this.context=o;let U=this.boundPaintVertexBuffers.length!==y.length;for(let V=0;!U&&V<y.length;V++)this.boundPaintVertexBuffers[V]!==y[V]&&(U=!0);!this.vao||this.boundProgram!==d||this.boundLayoutVertexBuffer!==p||U||this.boundIndexBuffer!==b||this.boundVertexOffset!==P||this.boundDynamicVertexBuffer!==C||this.boundDynamicVertexBuffer2!==M||this.boundDynamicVertexBuffer3!==R?this.freshBind(d,p,y,b,P,C,M,R):(o.bindVertexArray.set(this.vao),C&&C.bind(),b&&b.dynamicDraw&&b.bind(),M&&M.bind(),R&&R.bind())}freshBind(o,d,p,y,b,P,C,M){const R=o.numAttributes,U=this.context,V=U.gl;this.vao&&this.destroy(),this.vao=U.createVertexArray(),U.bindVertexArray.set(this.vao),this.boundProgram=o,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=y,this.boundVertexOffset=b,this.boundDynamicVertexBuffer=P,this.boundDynamicVertexBuffer2=C,this.boundDynamicVertexBuffer3=M,d.enableAttributes(V,o);for(const X of p)X.enableAttributes(V,o);P&&P.enableAttributes(V,o),C&&C.enableAttributes(V,o),M&&M.enableAttributes(V,o),d.bind(),d.setVertexAttribPointers(V,o,b);for(const X of p)X.bind(),X.setVertexAttribPointers(V,o,b);P&&(P.bind(),P.setVertexAttribPointers(V,o,b)),y&&y.bind(),C&&(C.bind(),C.setVertexAttribPointers(V,o,b)),M&&(M.bind(),M.setVertexAttribPointers(V,o,b)),U.currentNumAttributes=R}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function Qn(v){const o=[];for(let d=0;d<v.length;d++){if(v[d]===null)continue;const p=v[d].split(" ");o.push(p.pop())}return o}class Gi{constructor(o,d,p,y,b,P){const C=o.gl;this.program=C.createProgram();const M=Qn(d.staticAttributes),R=p?p.getBinderAttributes():[],U=M.concat(R),V=Jn.prelude.staticUniforms?Qn(Jn.prelude.staticUniforms):[],X=d.staticUniforms?Qn(d.staticUniforms):[],ue=p?p.getBinderUniforms():[],le=V.concat(X).concat(ue),fe=[];for(const $e of le)fe.indexOf($e)<0&&fe.push($e);const oe=p?p.defines():[];b&&oe.push("#define OVERDRAW_INSPECTOR;"),P&&oe.push("#define TERRAIN3D;");const Pe=oe.concat(Jn.prelude.fragmentSource,d.fragmentSource).join(`
`),De=oe.concat(Jn.prelude.vertexSource,d.vertexSource).join(`
`),me=C.createShader(C.FRAGMENT_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);if(C.shaderSource(me,Pe),C.compileShader(me),!C.getShaderParameter(me,C.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${C.getShaderInfoLog(me)}`);C.attachShader(this.program,me);const Ae=C.createShader(C.VERTEX_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);if(C.shaderSource(Ae,De),C.compileShader(Ae),!C.getShaderParameter(Ae,C.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${C.getShaderInfoLog(Ae)}`);C.attachShader(this.program,Ae),this.attributes={};const Ue={};this.numAttributes=U.length;for(let $e=0;$e<this.numAttributes;$e++)U[$e]&&(C.bindAttribLocation(this.program,$e,U[$e]),this.attributes[U[$e]]=$e);if(C.linkProgram(this.program),!C.getProgramParameter(this.program,C.LINK_STATUS))throw new Error(`Program failed to link: ${C.getProgramInfoLog(this.program)}`);C.deleteShader(Ae),C.deleteShader(me);for(let $e=0;$e<fe.length;$e++){const Xe=fe[$e];if(Xe&&!Ue[Xe]){const tt=C.getUniformLocation(this.program,Xe);tt&&(Ue[Xe]=tt)}}this.fixedUniforms=y(o,Ue),this.terrainUniforms=(($e,Xe)=>({u_depth:new l.Uniform1i($e,Xe.u_depth),u_terrain:new l.Uniform1i($e,Xe.u_terrain),u_terrain_dim:new l.Uniform1f($e,Xe.u_terrain_dim),u_terrain_matrix:new l.UniformMatrix4f($e,Xe.u_terrain_matrix),u_terrain_unpack:new l.Uniform4f($e,Xe.u_terrain_unpack),u_terrain_exaggeration:new l.Uniform1f($e,Xe.u_terrain_exaggeration)}))(o,Ue),this.binderUniforms=p?p.getUniforms(o,Ue):[]}draw(o,d,p,y,b,P,C,M,R,U,V,X,ue,le,fe,oe,Pe,De){const me=o.gl;if(this.failedToCreate)return;if(o.program.set(this.program),o.setDepthMode(p),o.setStencilMode(y),o.setColorMode(b),o.setCullFace(P),M){o.activeTexture.set(me.TEXTURE2),me.bindTexture(me.TEXTURE_2D,M.depthTexture),o.activeTexture.set(me.TEXTURE3),me.bindTexture(me.TEXTURE_2D,M.texture);for(const Ue in this.terrainUniforms)this.terrainUniforms[Ue].set(M[Ue])}for(const Ue in this.fixedUniforms)this.fixedUniforms[Ue].set(C[Ue]);fe&&fe.setUniforms(o,this.binderUniforms,ue,{zoom:le});let Ae=0;switch(d){case me.LINES:Ae=2;break;case me.TRIANGLES:Ae=3;break;case me.LINE_STRIP:Ae=1}for(const Ue of X.get()){const $e=Ue.vaos||(Ue.vaos={});($e[R]||($e[R]=new Vs)).bind(o,this,U,fe?fe.getPaintVertexBuffers():[],V,Ue.vertexOffset,oe,Pe,De),me.drawElements(d,Ue.primitiveLength*Ae,me.UNSIGNED_SHORT,Ue.primitiveOffset*Ae*2)}}}function Hi(v,o,d){const p=1/Se(d,1,o.transform.tileZoom),y=Math.pow(2,d.tileID.overscaledZ),b=d.tileSize*Math.pow(2,o.transform.tileZoom)/y,P=b*(d.tileID.canonical.x+d.tileID.wrap*y),C=b*d.tileID.canonical.y;return{u_image:0,u_texsize:d.imageAtlasTexture.size,u_scale:[p,v.fromScale,v.toScale],u_fade:v.t,u_pixel_coord_upper:[P>>16,C>>16],u_pixel_coord_lower:[65535&P,65535&C]}}const bl=(v,o,d,p)=>{const y=o.style.light,b=y.properties.get("position"),P=[b.x,b.y,b.z],C=function(){var R=new l.ARRAY_TYPE(9);return l.ARRAY_TYPE!=Float32Array&&(R[1]=0,R[2]=0,R[3]=0,R[5]=0,R[6]=0,R[7]=0),R[0]=1,R[4]=1,R[8]=1,R}();y.properties.get("anchor")==="viewport"&&function(R,U){var V=Math.sin(U),X=Math.cos(U);R[0]=X,R[1]=V,R[2]=0,R[3]=-V,R[4]=X,R[5]=0,R[6]=0,R[7]=0,R[8]=1}(C,-o.transform.angle),function(R,U,V){var X=U[0],ue=U[1],le=U[2];R[0]=X*V[0]+ue*V[3]+le*V[6],R[1]=X*V[1]+ue*V[4]+le*V[7],R[2]=X*V[2]+ue*V[5]+le*V[8]}(P,P,C);const M=y.properties.get("color");return{u_matrix:v,u_lightpos:P,u_lightintensity:y.properties.get("intensity"),u_lightcolor:[M.r,M.g,M.b],u_vertical_gradient:+d,u_opacity:p}},Ss=(v,o,d,p,y,b,P)=>l.extend(bl(v,o,d,p),Hi(b,o,P),{u_height_factor:-Math.pow(2,y.overscaledZ)/P.tileSize/8}),Sc=v=>({u_matrix:v}),Pc=(v,o,d,p)=>l.extend(Sc(v),Hi(d,o,p)),wl=(v,o)=>({u_matrix:v,u_world:o}),ee=(v,o,d,p,y)=>l.extend(Pc(v,o,d,p),{u_world:y}),ie=(v,o,d,p)=>{const y=v.transform;let b,P;if(p.paint.get("circle-pitch-alignment")==="map"){const C=Se(d,1,y.zoom);b=!0,P=[C,C]}else b=!1,P=y.pixelsToGLUnits;return{u_camera_to_center_distance:y.cameraToCenterDistance,u_scale_with_map:+(p.paint.get("circle-pitch-scale")==="map"),u_matrix:v.translatePosMatrix(o.posMatrix,d,p.paint.get("circle-translate"),p.paint.get("circle-translate-anchor")),u_pitch_with_map:+b,u_device_pixel_ratio:v.pixelRatio,u_extrude_scale:P}},xe=(v,o,d)=>{const p=Se(d,1,o.zoom),y=Math.pow(2,o.zoom-d.tileID.overscaledZ),b=d.tileID.overscaleFactor();return{u_matrix:v,u_camera_to_center_distance:o.cameraToCenterDistance,u_pixels_to_tile_units:p,u_extrude_scale:[o.pixelsToGLUnits[0]/(p*y),o.pixelsToGLUnits[1]/(p*y)],u_overscale_factor:b}},Ve=(v,o,d=1)=>({u_matrix:v,u_color:o,u_overlay:0,u_overlay_scale:d}),lt=v=>({u_matrix:v}),Nt=(v,o,d,p)=>({u_matrix:v,u_extrude_scale:Se(o,1,d),u_intensity:p});function Sn(v,o){const d=Math.pow(2,o.canonical.z),p=o.canonical.y;return[new l.MercatorCoordinate(0,p/d).toLngLat().lat,new l.MercatorCoordinate(0,(p+1)/d).toLngLat().lat]}const Ir=(v,o,d,p)=>{const y=v.transform;return{u_matrix:Ru(v,o,d,p),u_ratio:1/Se(o,1,y.zoom),u_device_pixel_ratio:v.pixelRatio,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},jr=(v,o,d,p,y)=>l.extend(Ir(v,o,d,y),{u_image:0,u_image_height:p}),di=(v,o,d,p,y)=>{const b=v.transform,P=Vm(o,b);return{u_matrix:Ru(v,o,d,y),u_texsize:o.imageAtlasTexture.size,u_ratio:1/Se(o,1,b.zoom),u_device_pixel_ratio:v.pixelRatio,u_image:0,u_scale:[P,p.fromScale,p.toScale],u_fade:p.t,u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]]}},cs=(v,o,d,p,y,b)=>{const P=v.lineAtlas,C=Vm(o,v.transform),M=d.layout.get("line-cap")==="round",R=P.getDash(p.from,M),U=P.getDash(p.to,M),V=R.width*y.fromScale,X=U.width*y.toScale;return l.extend(Ir(v,o,d,b),{u_patternscale_a:[C/V,-R.height/2],u_patternscale_b:[C/X,-U.height/2],u_sdfgamma:P.width/(256*Math.min(V,X)*v.pixelRatio)/2,u_image:0,u_tex_y_a:R.y,u_tex_y_b:U.y,u_mix:y.t})};function Vm(v,o){return 1/Se(v,1,o.tileZoom)}function Ru(v,o,d,p){return v.translatePosMatrix(p?p.posMatrix:o.tileID.posMatrix,o,d.paint.get("line-translate"),d.paint.get("line-translate-anchor"))}const jm=(v,o,d,p,y)=>{return{u_matrix:v,u_tl_parent:o,u_scale_parent:d,u_buffer_scale:1,u_fade_t:p.mix,u_opacity:p.opacity*y.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:y.paint.get("raster-brightness-min"),u_brightness_high:y.paint.get("raster-brightness-max"),u_saturation_factor:(P=y.paint.get("raster-saturation"),P>0?1-1/(1.001-P):-P),u_contrast_factor:(b=y.paint.get("raster-contrast"),b>0?1/(1-b):1+b),u_spin_weights:$m(y.paint.get("raster-hue-rotate"))};var b,P};function $m(v){v*=Math.PI/180;const o=Math.sin(v),d=Math.cos(v);return[(2*d+1)/3,(-Math.sqrt(3)*o-d+1)/3,(Math.sqrt(3)*o-d+1)/3]}const Fd=(v,o,d,p,y,b,P,C,M,R)=>{const U=y.transform;return{u_is_size_zoom_constant:+(v==="constant"||v==="source"),u_is_size_feature_constant:+(v==="constant"||v==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:U.cameraToCenterDistance,u_pitch:U.pitch/360*2*Math.PI,u_rotate_symbol:+d,u_aspect_ratio:U.width/U.height,u_fade_change:y.options.fadeDuration?y.symbolFadeChange:1,u_matrix:b,u_label_plane_matrix:P,u_coord_matrix:C,u_is_text:+M,u_pitch_with_map:+p,u_texsize:R,u_texture:0}},Nd=(v,o,d,p,y,b,P,C,M,R,U)=>{const V=y.transform;return l.extend(Fd(v,o,d,p,y,b,P,C,M,R),{u_gamma_scale:p?Math.cos(V._pitch)*V.cameraToCenterDistance:1,u_device_pixel_ratio:y.pixelRatio,u_is_halo:+U})},Da=(v,o,d,p,y,b,P,C,M,R)=>l.extend(Nd(v,o,d,p,y,b,P,C,!0,M,!0),{u_texsize_icon:R,u_texture_icon:1}),Ou=(v,o,d)=>({u_matrix:v,u_opacity:o,u_color:d}),Ps=(v,o,d,p,y,b)=>l.extend(function(P,C,M,R){const U=M.imageManager.getPattern(P.from.toString()),V=M.imageManager.getPattern(P.to.toString()),{width:X,height:ue}=M.imageManager.getPixelSize(),le=Math.pow(2,R.tileID.overscaledZ),fe=R.tileSize*Math.pow(2,M.transform.tileZoom)/le,oe=fe*(R.tileID.canonical.x+R.tileID.wrap*le),Pe=fe*R.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:U.tl,u_pattern_br_a:U.br,u_pattern_tl_b:V.tl,u_pattern_br_b:V.br,u_texsize:[X,ue],u_mix:C.t,u_pattern_size_a:U.displaySize,u_pattern_size_b:V.displaySize,u_scale_a:C.fromScale,u_scale_b:C.toScale,u_tile_units_to_pixels:1/Se(R,1,M.transform.tileZoom),u_pixel_coord_upper:[oe>>16,Pe>>16],u_pixel_coord_lower:[65535&oe,65535&Pe]}}(p,b,d,y),{u_matrix:v,u_opacity:o}),Du={fillExtrusion:(v,o)=>({u_matrix:new l.UniformMatrix4f(v,o.u_matrix),u_lightpos:new l.Uniform3f(v,o.u_lightpos),u_lightintensity:new l.Uniform1f(v,o.u_lightintensity),u_lightcolor:new l.Uniform3f(v,o.u_lightcolor),u_vertical_gradient:new l.Uniform1f(v,o.u_vertical_gradient),u_opacity:new l.Uniform1f(v,o.u_opacity)}),fillExtrusionPattern:(v,o)=>({u_matrix:new l.UniformMatrix4f(v,o.u_matrix),u_lightpos:new l.Uniform3f(v,o.u_lightpos),u_lightintensity:new l.Uniform1f(v,o.u_lightintensity),u_lightcolor:new l.Uniform3f(v,o.u_lightcolor),u_vertical_gradient:new l.Uniform1f(v,o.u_vertical_gradient),u_height_factor:new l.Uniform1f(v,o.u_height_factor),u_image:new l.Uniform1i(v,o.u_image),u_texsize:new l.Uniform2f(v,o.u_texsize),u_pixel_coord_upper:new l.Uniform2f(v,o.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(v,o.u_pixel_coord_lower),u_scale:new l.Uniform3f(v,o.u_scale),u_fade:new l.Uniform1f(v,o.u_fade),u_opacity:new l.Uniform1f(v,o.u_opacity)}),fill:(v,o)=>({u_matrix:new l.UniformMatrix4f(v,o.u_matrix)}),fillPattern:(v,o)=>({u_matrix:new l.UniformMatrix4f(v,o.u_matrix),u_image:new l.Uniform1i(v,o.u_image),u_texsize:new l.Uniform2f(v,o.u_texsize),u_pixel_coord_upper:new l.Uniform2f(v,o.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(v,o.u_pixel_coord_lower),u_scale:new l.Uniform3f(v,o.u_scale),u_fade:new l.Uniform1f(v,o.u_fade)}),fillOutline:(v,o)=>({u_matrix:new l.UniformMatrix4f(v,o.u_matrix),u_world:new l.Uniform2f(v,o.u_world)}),fillOutlinePattern:(v,o)=>({u_matrix:new l.UniformMatrix4f(v,o.u_matrix),u_world:new l.Uniform2f(v,o.u_world),u_image:new l.Uniform1i(v,o.u_image),u_texsize:new l.Uniform2f(v,o.u_texsize),u_pixel_coord_upper:new l.Uniform2f(v,o.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(v,o.u_pixel_coord_lower),u_scale:new l.Uniform3f(v,o.u_scale),u_fade:new l.Uniform1f(v,o.u_fade)}),circle:(v,o)=>({u_camera_to_center_distance:new l.Uniform1f(v,o.u_camera_to_center_distance),u_scale_with_map:new l.Uniform1i(v,o.u_scale_with_map),u_pitch_with_map:new l.Uniform1i(v,o.u_pitch_with_map),u_extrude_scale:new l.Uniform2f(v,o.u_extrude_scale),u_device_pixel_ratio:new l.Uniform1f(v,o.u_device_pixel_ratio),u_matrix:new l.UniformMatrix4f(v,o.u_matrix)}),collisionBox:(v,o)=>({u_matrix:new l.UniformMatrix4f(v,o.u_matrix),u_camera_to_center_distance:new l.Uniform1f(v,o.u_camera_to_center_distance),u_pixels_to_tile_units:new l.Uniform1f(v,o.u_pixels_to_tile_units),u_extrude_scale:new l.Uniform2f(v,o.u_extrude_scale),u_overscale_factor:new l.Uniform1f(v,o.u_overscale_factor)}),collisionCircle:(v,o)=>({u_matrix:new l.UniformMatrix4f(v,o.u_matrix),u_inv_matrix:new l.UniformMatrix4f(v,o.u_inv_matrix),u_camera_to_center_distance:new l.Uniform1f(v,o.u_camera_to_center_distance),u_viewport_size:new l.Uniform2f(v,o.u_viewport_size)}),debug:(v,o)=>({u_color:new l.UniformColor(v,o.u_color),u_matrix:new l.UniformMatrix4f(v,o.u_matrix),u_overlay:new l.Uniform1i(v,o.u_overlay),u_overlay_scale:new l.Uniform1f(v,o.u_overlay_scale)}),clippingMask:(v,o)=>({u_matrix:new l.UniformMatrix4f(v,o.u_matrix)}),heatmap:(v,o)=>({u_extrude_scale:new l.Uniform1f(v,o.u_extrude_scale),u_intensity:new l.Uniform1f(v,o.u_intensity),u_matrix:new l.UniformMatrix4f(v,o.u_matrix)}),heatmapTexture:(v,o)=>({u_matrix:new l.UniformMatrix4f(v,o.u_matrix),u_world:new l.Uniform2f(v,o.u_world),u_image:new l.Uniform1i(v,o.u_image),u_color_ramp:new l.Uniform1i(v,o.u_color_ramp),u_opacity:new l.Uniform1f(v,o.u_opacity)}),hillshade:(v,o)=>({u_matrix:new l.UniformMatrix4f(v,o.u_matrix),u_image:new l.Uniform1i(v,o.u_image),u_latrange:new l.Uniform2f(v,o.u_latrange),u_light:new l.Uniform2f(v,o.u_light),u_shadow:new l.UniformColor(v,o.u_shadow),u_highlight:new l.UniformColor(v,o.u_highlight),u_accent:new l.UniformColor(v,o.u_accent)}),hillshadePrepare:(v,o)=>({u_matrix:new l.UniformMatrix4f(v,o.u_matrix),u_image:new l.Uniform1i(v,o.u_image),u_dimension:new l.Uniform2f(v,o.u_dimension),u_zoom:new l.Uniform1f(v,o.u_zoom),u_unpack:new l.Uniform4f(v,o.u_unpack)}),line:(v,o)=>({u_matrix:new l.UniformMatrix4f(v,o.u_matrix),u_ratio:new l.Uniform1f(v,o.u_ratio),u_device_pixel_ratio:new l.Uniform1f(v,o.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(v,o.u_units_to_pixels)}),lineGradient:(v,o)=>({u_matrix:new l.UniformMatrix4f(v,o.u_matrix),u_ratio:new l.Uniform1f(v,o.u_ratio),u_device_pixel_ratio:new l.Uniform1f(v,o.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(v,o.u_units_to_pixels),u_image:new l.Uniform1i(v,o.u_image),u_image_height:new l.Uniform1f(v,o.u_image_height)}),linePattern:(v,o)=>({u_matrix:new l.UniformMatrix4f(v,o.u_matrix),u_texsize:new l.Uniform2f(v,o.u_texsize),u_ratio:new l.Uniform1f(v,o.u_ratio),u_device_pixel_ratio:new l.Uniform1f(v,o.u_device_pixel_ratio),u_image:new l.Uniform1i(v,o.u_image),u_units_to_pixels:new l.Uniform2f(v,o.u_units_to_pixels),u_scale:new l.Uniform3f(v,o.u_scale),u_fade:new l.Uniform1f(v,o.u_fade)}),lineSDF:(v,o)=>({u_matrix:new l.UniformMatrix4f(v,o.u_matrix),u_ratio:new l.Uniform1f(v,o.u_ratio),u_device_pixel_ratio:new l.Uniform1f(v,o.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(v,o.u_units_to_pixels),u_patternscale_a:new l.Uniform2f(v,o.u_patternscale_a),u_patternscale_b:new l.Uniform2f(v,o.u_patternscale_b),u_sdfgamma:new l.Uniform1f(v,o.u_sdfgamma),u_image:new l.Uniform1i(v,o.u_image),u_tex_y_a:new l.Uniform1f(v,o.u_tex_y_a),u_tex_y_b:new l.Uniform1f(v,o.u_tex_y_b),u_mix:new l.Uniform1f(v,o.u_mix)}),raster:(v,o)=>({u_matrix:new l.UniformMatrix4f(v,o.u_matrix),u_tl_parent:new l.Uniform2f(v,o.u_tl_parent),u_scale_parent:new l.Uniform1f(v,o.u_scale_parent),u_buffer_scale:new l.Uniform1f(v,o.u_buffer_scale),u_fade_t:new l.Uniform1f(v,o.u_fade_t),u_opacity:new l.Uniform1f(v,o.u_opacity),u_image0:new l.Uniform1i(v,o.u_image0),u_image1:new l.Uniform1i(v,o.u_image1),u_brightness_low:new l.Uniform1f(v,o.u_brightness_low),u_brightness_high:new l.Uniform1f(v,o.u_brightness_high),u_saturation_factor:new l.Uniform1f(v,o.u_saturation_factor),u_contrast_factor:new l.Uniform1f(v,o.u_contrast_factor),u_spin_weights:new l.Uniform3f(v,o.u_spin_weights)}),symbolIcon:(v,o)=>({u_is_size_zoom_constant:new l.Uniform1i(v,o.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(v,o.u_is_size_feature_constant),u_size_t:new l.Uniform1f(v,o.u_size_t),u_size:new l.Uniform1f(v,o.u_size),u_camera_to_center_distance:new l.Uniform1f(v,o.u_camera_to_center_distance),u_pitch:new l.Uniform1f(v,o.u_pitch),u_rotate_symbol:new l.Uniform1i(v,o.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(v,o.u_aspect_ratio),u_fade_change:new l.Uniform1f(v,o.u_fade_change),u_matrix:new l.UniformMatrix4f(v,o.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(v,o.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(v,o.u_coord_matrix),u_is_text:new l.Uniform1i(v,o.u_is_text),u_pitch_with_map:new l.Uniform1i(v,o.u_pitch_with_map),u_texsize:new l.Uniform2f(v,o.u_texsize),u_texture:new l.Uniform1i(v,o.u_texture)}),symbolSDF:(v,o)=>({u_is_size_zoom_constant:new l.Uniform1i(v,o.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(v,o.u_is_size_feature_constant),u_size_t:new l.Uniform1f(v,o.u_size_t),u_size:new l.Uniform1f(v,o.u_size),u_camera_to_center_distance:new l.Uniform1f(v,o.u_camera_to_center_distance),u_pitch:new l.Uniform1f(v,o.u_pitch),u_rotate_symbol:new l.Uniform1i(v,o.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(v,o.u_aspect_ratio),u_fade_change:new l.Uniform1f(v,o.u_fade_change),u_matrix:new l.UniformMatrix4f(v,o.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(v,o.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(v,o.u_coord_matrix),u_is_text:new l.Uniform1i(v,o.u_is_text),u_pitch_with_map:new l.Uniform1i(v,o.u_pitch_with_map),u_texsize:new l.Uniform2f(v,o.u_texsize),u_texture:new l.Uniform1i(v,o.u_texture),u_gamma_scale:new l.Uniform1f(v,o.u_gamma_scale),u_device_pixel_ratio:new l.Uniform1f(v,o.u_device_pixel_ratio),u_is_halo:new l.Uniform1i(v,o.u_is_halo)}),symbolTextAndIcon:(v,o)=>({u_is_size_zoom_constant:new l.Uniform1i(v,o.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(v,o.u_is_size_feature_constant),u_size_t:new l.Uniform1f(v,o.u_size_t),u_size:new l.Uniform1f(v,o.u_size),u_camera_to_center_distance:new l.Uniform1f(v,o.u_camera_to_center_distance),u_pitch:new l.Uniform1f(v,o.u_pitch),u_rotate_symbol:new l.Uniform1i(v,o.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(v,o.u_aspect_ratio),u_fade_change:new l.Uniform1f(v,o.u_fade_change),u_matrix:new l.UniformMatrix4f(v,o.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(v,o.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(v,o.u_coord_matrix),u_is_text:new l.Uniform1i(v,o.u_is_text),u_pitch_with_map:new l.Uniform1i(v,o.u_pitch_with_map),u_texsize:new l.Uniform2f(v,o.u_texsize),u_texsize_icon:new l.Uniform2f(v,o.u_texsize_icon),u_texture:new l.Uniform1i(v,o.u_texture),u_texture_icon:new l.Uniform1i(v,o.u_texture_icon),u_gamma_scale:new l.Uniform1f(v,o.u_gamma_scale),u_device_pixel_ratio:new l.Uniform1f(v,o.u_device_pixel_ratio),u_is_halo:new l.Uniform1i(v,o.u_is_halo)}),background:(v,o)=>({u_matrix:new l.UniformMatrix4f(v,o.u_matrix),u_opacity:new l.Uniform1f(v,o.u_opacity),u_color:new l.UniformColor(v,o.u_color)}),backgroundPattern:(v,o)=>({u_matrix:new l.UniformMatrix4f(v,o.u_matrix),u_opacity:new l.Uniform1f(v,o.u_opacity),u_image:new l.Uniform1i(v,o.u_image),u_pattern_tl_a:new l.Uniform2f(v,o.u_pattern_tl_a),u_pattern_br_a:new l.Uniform2f(v,o.u_pattern_br_a),u_pattern_tl_b:new l.Uniform2f(v,o.u_pattern_tl_b),u_pattern_br_b:new l.Uniform2f(v,o.u_pattern_br_b),u_texsize:new l.Uniform2f(v,o.u_texsize),u_mix:new l.Uniform1f(v,o.u_mix),u_pattern_size_a:new l.Uniform2f(v,o.u_pattern_size_a),u_pattern_size_b:new l.Uniform2f(v,o.u_pattern_size_b),u_scale_a:new l.Uniform1f(v,o.u_scale_a),u_scale_b:new l.Uniform1f(v,o.u_scale_b),u_pixel_coord_upper:new l.Uniform2f(v,o.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(v,o.u_pixel_coord_lower),u_tile_units_to_pixels:new l.Uniform1f(v,o.u_tile_units_to_pixels)}),terrain:(v,o)=>({u_matrix:new l.UniformMatrix4f(v,o.u_matrix),u_texture:new l.Uniform1i(v,o.u_texture),u_ele_delta:new l.Uniform1f(v,o.u_ele_delta)}),terrainDepth:(v,o)=>({u_matrix:new l.UniformMatrix4f(v,o.u_matrix),u_ele_delta:new l.Uniform1f(v,o.u_ele_delta)}),terrainCoords:(v,o)=>({u_matrix:new l.UniformMatrix4f(v,o.u_matrix),u_texture:new l.Uniform1i(v,o.u_texture),u_terrain_coords_id:new l.Uniform1f(v,o.u_terrain_coords_id),u_ele_delta:new l.Uniform1f(v,o.u_ele_delta)})};class zu{constructor(o,d,p){this.context=o;const y=o.gl;this.buffer=y.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),y.bufferData(y.ELEMENT_ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const d=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),d.bufferSubData(d.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Cc={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Fu{constructor(o,d,p,y){this.length=d.length,this.attributes=p,this.itemSize=d.bytesPerElement,this.dynamicDraw=y,this.context=o;const b=o.gl;this.buffer=b.createBuffer(),o.bindVertexBuffer.set(this.buffer),b.bufferData(b.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){if(o.length!==this.length)throw new Error(`Length of new data is ${o.length}, which doesn't match current length of ${this.length}`);const d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,d){for(let p=0;p<this.attributes.length;p++){const y=d.attributes[this.attributes[p].name];y!==void 0&&o.enableVertexAttribArray(y)}}setVertexAttribPointers(o,d,p){for(let y=0;y<this.attributes.length;y++){const b=this.attributes[y],P=d.attributes[b.name];P!==void 0&&o.vertexAttribPointer(P,b.components,o[Cc[b.type]],!1,this.itemSize,b.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const El=new WeakMap;function ca(v){if(El.has(v))return El.get(v);{const o=v.getParameter(v.VERSION).startsWith("WebGL 2.0");return El.set(v,o),o}}class kn{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Nu extends kn{getDefault(){return l.Color.transparent}set(o){const d=this.current;(o.r!==d.r||o.g!==d.g||o.b!==d.b||o.a!==d.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class us extends kn{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class hs extends kn{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class Bd extends kn{getDefault(){return[!0,!0,!0,!0]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||o[3]!==d[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Bu extends kn{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class Uu extends kn{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class Ud extends kn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const d=this.current;(o.func!==d.func||o.ref!==d.ref||o.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class Vd extends kn{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class Vu extends kn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=o,this.dirty=!1}}class jd extends kn{getDefault(){return[0,1]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class $d extends kn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=o,this.dirty=!1}}class ju extends kn{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class Gm extends kn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.BLEND):d.disable(d.BLEND),this.current=o,this.dirty=!1}}class Hm extends kn{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class Tl extends kn{getDefault(){return l.Color.transparent}set(o){const d=this.current;(o.r!==d.r||o.g!==d.g||o.b!==d.b||o.a!==d.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Pv extends kn{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class Cv extends kn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=o,this.dirty=!1}}class Av extends kn{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class Iv extends kn{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}class Mv extends kn{getDefault(){return null}set(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)}}class kv extends kn{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class Gd extends kn{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||o[3]!==d[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class $u extends kn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class Hd extends kn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Wd extends kn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindTexture(d.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class Sl extends kn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class Wm extends kn{getDefault(){return null}set(o){const d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class qm extends kn{getDefault(){return null}set(o){var d;if(o===this.current&&!this.dirty)return;const p=this.gl;ca(p)?p.bindVertexArray(o):(d=p.getExtension("OES_vertex_array_object"))===null||d===void 0||d.bindVertexArrayOES(o),this.current=o,this.dirty=!1}}class qd extends kn{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class za extends kn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class Zm extends kn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class ua extends kn{constructor(o,d){super(o),this.context=o,this.parent=d}getDefault(){return null}}class Pl extends ua{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class Xm extends ua{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Zd extends ua{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_STENCIL_ATTACHMENT,d.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Un{constructor(o,d,p,y,b){this.context=o,this.width=d,this.height=p;const P=o.gl,C=this.framebuffer=P.createFramebuffer();if(this.colorAttachment=new Pl(o,C),y)this.depthAttachment=b?new Zd(o,C):new Xm(o,C);else if(b)throw new Error("Stencil cannot be setted without depth");if(P.checkFramebufferStatus(P.FRAMEBUFFER)!==P.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const o=this.context.gl,d=this.colorAttachment.get();if(d&&o.deleteTexture(d),this.depthAttachment){const p=this.depthAttachment.get();p&&o.deleteRenderbuffer(p)}o.deleteFramebuffer(this.framebuffer)}}class mr{constructor(o,d,p){this.blendFunction=o,this.blendColor=d,this.mask=p}}mr.Replace=[1,0],mr.disabled=new mr(mr.Replace,l.Color.transparent,[!1,!1,!1,!1]),mr.unblended=new mr(mr.Replace,l.Color.transparent,[!0,!0,!0,!0]),mr.alphaBlended=new mr([1,771],l.Color.transparent,[!0,!0,!0,!0]);class Lv{constructor(o){var d,p;if(this.gl=o,this.clearColor=new Nu(this),this.clearDepth=new us(this),this.clearStencil=new hs(this),this.colorMask=new Bd(this),this.depthMask=new Bu(this),this.stencilMask=new Uu(this),this.stencilFunc=new Ud(this),this.stencilOp=new Vd(this),this.stencilTest=new Vu(this),this.depthRange=new jd(this),this.depthTest=new $d(this),this.depthFunc=new ju(this),this.blend=new Gm(this),this.blendFunc=new Hm(this),this.blendColor=new Tl(this),this.blendEquation=new Pv(this),this.cullFace=new Cv(this),this.cullFaceSide=new Av(this),this.frontFace=new Iv(this),this.program=new Mv(this),this.activeTexture=new kv(this),this.viewport=new Gd(this),this.bindFramebuffer=new $u(this),this.bindRenderbuffer=new Hd(this),this.bindTexture=new Wd(this),this.bindVertexBuffer=new Sl(this),this.bindElementBuffer=new Wm(this),this.bindVertexArray=new qm(this),this.pixelStoreUnpack=new qd(this),this.pixelStoreUnpackPremultiplyAlpha=new za(this),this.pixelStoreUnpackFlipY=new Zm(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE),ca(o)){this.HALF_FLOAT=o.HALF_FLOAT;const y=o.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(d=o.RGBA16F)!==null&&d!==void 0?d:y==null?void 0:y.RGBA16F_EXT,this.RGB16F=(p=o.RGB16F)!==null&&p!==void 0?p:y==null?void 0:y.RGB16F_EXT,o.getExtension("EXT_color_buffer_float")}else{o.getExtension("EXT_color_buffer_half_float"),o.getExtension("OES_texture_half_float_linear");const y=o.getExtension("OES_texture_half_float");this.HALF_FLOAT=y==null?void 0:y.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,d){return new zu(this,o,d)}createVertexBuffer(o,d,p){return new Fu(this,o,d,p)}createRenderbuffer(o,d,p){const y=this.gl,b=y.createRenderbuffer();return this.bindRenderbuffer.set(b),y.renderbufferStorage(y.RENDERBUFFER,o,d,p),this.bindRenderbuffer.set(null),b}createFramebuffer(o,d,p,y){return new Un(this,o,d,p,y)}clear({color:o,depth:d,stencil:p}){const y=this.gl;let b=0;o&&(b|=y.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),d!==void 0&&(b|=y.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(d),this.depthMask.set(!0)),p!==void 0&&(b|=y.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),y.clear(b)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){l.deepEqual(o.blendFunction,mr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}createVertexArray(){var o;return ca(this.gl)?this.gl.createVertexArray():(o=this.gl.getExtension("OES_vertex_array_object"))===null||o===void 0?void 0:o.createVertexArrayOES()}deleteVertexArray(o){var d;return ca(this.gl)?this.gl.deleteVertexArray(o):(d=this.gl.getExtension("OES_vertex_array_object"))===null||d===void 0?void 0:d.deleteVertexArrayOES(o)}unbindVAO(){this.bindVertexArray.set(null)}}class Ln{constructor(o,d,p){this.func=o,this.mask=d,this.range=p}}Ln.ReadOnly=!1,Ln.ReadWrite=!0,Ln.disabled=new Ln(519,Ln.ReadOnly,[0,1]);const Fa=7680;class gr{constructor(o,d,p,y,b,P){this.test=o,this.ref=d,this.mask=p,this.fail=y,this.depthFail=b,this.pass=P}}gr.disabled=new gr({func:519,mask:0},0,0,Fa,Fa,Fa);class fr{constructor(o,d,p){this.enable=o,this.mode=d,this.frontFace=p}}let Ac;function Ym(v,o,d,p,y,b,P){const C=v.context,M=C.gl,R=v.useProgram("collisionBox"),U=[];let V=0,X=0;for(let me=0;me<p.length;me++){const Ae=p[me],Ue=o.getTile(Ae),$e=Ue.getBucket(d);if(!$e)continue;let Xe=Ae.posMatrix;y[0]===0&&y[1]===0||(Xe=v.translatePosMatrix(Ae.posMatrix,Ue,y,b));const tt=P?$e.textCollisionBox:$e.iconCollisionBox,Qe=$e.collisionCircleArray;if(Qe.length>0){const ct=l.create(),Vt=Xe;l.mul(ct,$e.placementInvProjMatrix,v.transform.glCoordMatrix),l.mul(ct,ct,$e.placementViewportMatrix),U.push({circleArray:Qe,circleOffset:X,transform:Vt,invTransform:ct,coord:Ae}),V+=Qe.length/4,X=V}tt&&R.draw(C,M.LINES,Ln.disabled,gr.disabled,v.colorModeForRenderPass(),fr.disabled,xe(Xe,v.transform,Ue),v.style.map.terrain&&v.style.map.terrain.getTerrainData(Ae),d.id,tt.layoutVertexBuffer,tt.indexBuffer,tt.segments,null,v.transform.zoom,null,null,tt.collisionVertexBuffer)}if(!P||!U.length)return;const ue=v.useProgram("collisionCircle"),le=new l.CollisionCircleLayoutArray;le.resize(4*V),le._trim();let fe=0;for(const me of U)for(let Ae=0;Ae<me.circleArray.length/4;Ae++){const Ue=4*Ae,$e=me.circleArray[Ue+0],Xe=me.circleArray[Ue+1],tt=me.circleArray[Ue+2],Qe=me.circleArray[Ue+3];le.emplace(fe++,$e,Xe,tt,Qe,0),le.emplace(fe++,$e,Xe,tt,Qe,1),le.emplace(fe++,$e,Xe,tt,Qe,2),le.emplace(fe++,$e,Xe,tt,Qe,3)}(!Ac||Ac.length<2*V)&&(Ac=function(me){const Ae=2*me,Ue=new l.QuadTriangleArray;Ue.resize(Ae),Ue._trim();for(let $e=0;$e<Ae;$e++){const Xe=6*$e;Ue.uint16[Xe+0]=4*$e+0,Ue.uint16[Xe+1]=4*$e+1,Ue.uint16[Xe+2]=4*$e+2,Ue.uint16[Xe+3]=4*$e+2,Ue.uint16[Xe+4]=4*$e+3,Ue.uint16[Xe+5]=4*$e+0}return Ue}(V));const oe=C.createIndexBuffer(Ac,!0),Pe=C.createVertexBuffer(le,l.collisionCircleLayout.members,!0);for(const me of U){const Ae={u_matrix:me.transform,u_inv_matrix:me.invTransform,u_camera_to_center_distance:(De=v.transform).cameraToCenterDistance,u_viewport_size:[De.width,De.height]};ue.draw(C,M.TRIANGLES,Ln.disabled,gr.disabled,v.colorModeForRenderPass(),fr.disabled,Ae,v.style.map.terrain&&v.style.map.terrain.getTerrainData(me.coord),d.id,Pe,oe,l.SegmentVector.simpleSegment(0,2*me.circleOffset,me.circleArray.length,me.circleArray.length/2),null,v.transform.zoom,null,null,null)}var De;Pe.destroy(),oe.destroy()}fr.disabled=new fr(!1,1029,2305),fr.backCCW=new fr(!0,1029,2305);const Xd=l.identity(new Float32Array(16));function Gu(v,o,d,p,y,b){const{horizontalAlign:P,verticalAlign:C}=l.getAnchorAlignment(v);return new l.Point((-(P-.5)*o/y+p[0])*b,(-(C-.5)*d/y+p[1])*b)}function Hu(v,o,d,p,y,b,P,C,M,R,U){const V=v.text.placedSymbolArray,X=v.text.dynamicLayoutVertexArray,ue=v.icon.dynamicLayoutVertexArray,le={};X.clear();for(let fe=0;fe<V.length;fe++){const oe=V.get(fe),Pe=oe.hidden||!oe.crossTileID||v.allowVerticalPlacement&&!oe.placedOrientation?null:p[oe.crossTileID];if(Pe){const De=new l.Point(oe.anchorX,oe.anchorY),me=St(De,d?P:b,U),Ae=gn(y.cameraToCenterDistance,me.signedDistanceFromCamera);let Ue=l.evaluateSizeForFeature(v.textSizeData,M,oe)*Ae/l.ONE_EM;d&&(Ue*=v.tilePixelRatio/C);const{width:$e,height:Xe,anchor:tt,textOffset:Qe,textBoxScale:ct}=Pe,Vt=Gu(tt,$e,Xe,Qe,ct,Ue),An=d?St(De.add(Vt),b,U).point:me.point.add(o?Vt.rotate(-y.angle):Vt),mt=v.allowVerticalPlacement&&oe.placedOrientation===l.WritingMode.vertical?Math.PI/2:0;for(let cn=0;cn<oe.numGlyphs;cn++)l.addDynamicAttributes(X,An,mt);R&&oe.associatedIconIndex>=0&&(le[oe.associatedIconIndex]={shiftedAnchor:An,angle:mt})}else q(oe.numGlyphs,X)}if(R){ue.clear();const fe=v.icon.placedSymbolArray;for(let oe=0;oe<fe.length;oe++){const Pe=fe.get(oe);if(Pe.hidden)q(Pe.numGlyphs,ue);else{const De=le[oe];if(De)for(let me=0;me<Pe.numGlyphs;me++)l.addDynamicAttributes(ue,De.shiftedAnchor,De.angle);else q(Pe.numGlyphs,ue)}}v.icon.dynamicLayoutVertexBuffer.updateData(ue)}v.text.dynamicLayoutVertexBuffer.updateData(X)}function Yd(v,o,d){return d.iconsInText&&o?"symbolTextAndIcon":v?"symbolSDF":"symbolIcon"}function Wu(v,o,d,p,y,b,P,C,M,R,U,V){const X=v.context,ue=X.gl,le=v.transform,fe=C==="map",oe=M==="map",Pe=C!=="viewport"&&d.layout.get("symbol-placement")!=="point",De=fe&&!oe&&!Pe,me=!d.layout.get("symbol-sort-key").isConstant();let Ae=!1;const Ue=v.depthModeForSublayer(0,Ln.ReadOnly),$e=d._unevaluatedLayout.hasValue("text-variable-anchor")||d._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Xe=[];for(const tt of p){const Qe=o.getTile(tt),ct=Qe.getBucket(d);if(!ct)continue;const Vt=y?ct.text:ct.icon;if(!Vt||!Vt.segments.get().length||!Vt.hasVisibleVertices)continue;const An=Vt.programConfigurations.get(d.id),mt=y||ct.sdfIcons,cn=y?ct.textSizeData:ct.iconSizeData,Gt=oe||le.pitch!==0,Hn=v.useProgram(Yd(mt,y,ct),An),Pn=l.evaluateSizeForZoom(cn,le.zoom),vn=v.style.map.terrain&&v.style.map.terrain.getTerrainData(tt);let In,Mr,tr,fi,Qr=[0,0],zr=null;if(y)Mr=Qe.glyphAtlasTexture,tr=ue.LINEAR,In=Qe.glyphAtlasTexture.size,ct.iconsInText&&(Qr=Qe.imageAtlasTexture.size,zr=Qe.imageAtlasTexture,fi=Gt||v.options.rotating||v.options.zooming||cn.kind==="composite"||cn.kind==="camera"?ue.LINEAR:ue.NEAREST);else{const kr=d.layout.get("icon-size").constantOr(0)!==1||ct.iconsNeedLinear;Mr=Qe.imageAtlasTexture,tr=mt||v.options.rotating||v.options.zooming||kr||Gt?ue.LINEAR:ue.NEAREST,In=Qe.imageAtlasTexture.size}const ps=Se(Qe,1,v.transform.zoom),or=Ne(tt.posMatrix,oe,fe,v.transform,ps),mo=Ye(tt.posMatrix,oe,fe,v.transform,ps),go=$e&&ct.hasTextData(),fa=d.layout.get("icon-text-fit")!=="none"&&go&&ct.hasIconData();if(Pe){const kr=v.style.map.terrain?(Zi,Lr)=>v.style.map.terrain.getElevation(tt,Zi,Lr):null,ei=d.layout.get("text-rotation-alignment")==="map";nt(ct,tt.posMatrix,v,y,or,mo,oe,R,ei,kr)}const ja=v.translatePosMatrix(tt.posMatrix,Qe,b,P),Rl=Pe||y&&$e||fa?Xd:or,wi=v.translatePosMatrix(mo,Qe,b,P,!0),pi=mt&&d.paint.get(y?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Ri;Ri=mt?ct.iconsInText?Da(cn.kind,Pn,De,oe,v,ja,Rl,wi,In,Qr):Nd(cn.kind,Pn,De,oe,v,ja,Rl,wi,y,In,!0):Fd(cn.kind,Pn,De,oe,v,ja,Rl,wi,y,In);const $a={program:Hn,buffers:Vt,uniformValues:Ri,atlasTexture:Mr,atlasTextureIcon:zr,atlasInterpolation:tr,atlasInterpolationIcon:fi,isSDF:mt,hasHalo:pi};if(me&&ct.canOverlap){Ae=!0;const kr=Vt.segments.get();for(const ei of kr)Xe.push({segments:new l.SegmentVector([ei]),sortKey:ei.sortKey,state:$a,terrainData:vn})}else Xe.push({segments:Vt.segments,sortKey:0,state:$a,terrainData:vn})}Ae&&Xe.sort((tt,Qe)=>tt.sortKey-Qe.sortKey);for(const tt of Xe){const Qe=tt.state;if(X.activeTexture.set(ue.TEXTURE0),Qe.atlasTexture.bind(Qe.atlasInterpolation,ue.CLAMP_TO_EDGE),Qe.atlasTextureIcon&&(X.activeTexture.set(ue.TEXTURE1),Qe.atlasTextureIcon&&Qe.atlasTextureIcon.bind(Qe.atlasInterpolationIcon,ue.CLAMP_TO_EDGE)),Qe.isSDF){const ct=Qe.uniformValues;Qe.hasHalo&&(ct.u_is_halo=1,Kd(Qe.buffers,tt.segments,d,v,Qe.program,Ue,U,V,ct,tt.terrainData)),ct.u_is_halo=0}Kd(Qe.buffers,tt.segments,d,v,Qe.program,Ue,U,V,Qe.uniformValues,tt.terrainData)}}function Kd(v,o,d,p,y,b,P,C,M,R){const U=p.context;y.draw(U,U.gl.TRIANGLES,b,P,C,fr.disabled,M,R,d.id,v.layoutVertexBuffer,v.indexBuffer,o,d.paint,p.transform.zoom,v.programConfigurations.get(d.id),v.dynamicLayoutVertexBuffer,v.opacityVertexBuffer)}function Ic(v,o,d,p,y){if(!d||!p||!p.imageAtlas)return;const b=p.imageAtlas.patternPositions;let P=b[d.to.toString()],C=b[d.from.toString()];if(!P||!C){const M=y.getPaintProperty(o);P=b[M],C=b[M]}P&&C&&v.setConstantPatternPositions(P,C)}function Mc(v,o,d,p,y,b,P){const C=v.context.gl,M="fill-pattern",R=d.paint.get(M),U=R&&R.constantOr(1),V=d.getCrossfadeParameters();let X,ue,le,fe,oe;P?(ue=U&&!d.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",X=C.LINES):(ue=U?"fillPattern":"fill",X=C.TRIANGLES);const Pe=R.constantOr(null);for(const De of p){const me=o.getTile(De);if(U&&!me.patternsLoaded())continue;const Ae=me.getBucket(d);if(!Ae)continue;const Ue=Ae.programConfigurations.get(d.id),$e=v.useProgram(ue,Ue),Xe=v.style.map.terrain&&v.style.map.terrain.getTerrainData(De);U&&(v.context.activeTexture.set(C.TEXTURE0),me.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),Ue.updatePaintBuffers(V)),Ic(Ue,M,Pe,me,d);const tt=Xe?De:null,Qe=v.translatePosMatrix(tt?tt.posMatrix:De.posMatrix,me,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor"));if(P){fe=Ae.indexBuffer2,oe=Ae.segments2;const ct=[C.drawingBufferWidth,C.drawingBufferHeight];le=ue==="fillOutlinePattern"&&U?ee(Qe,v,V,me,ct):wl(Qe,ct)}else fe=Ae.indexBuffer,oe=Ae.segments,le=U?Pc(Qe,v,V,me):Sc(Qe);$e.draw(v.context,X,y,v.stencilModeForClipping(De),b,fr.disabled,le,Xe,d.id,Ae.layoutVertexBuffer,fe,oe,d.paint,v.transform.zoom,Ue)}}function kc(v,o,d,p,y,b,P){const C=v.context,M=C.gl,R="fill-extrusion-pattern",U=d.paint.get(R),V=U.constantOr(1),X=d.getCrossfadeParameters(),ue=d.paint.get("fill-extrusion-opacity"),le=U.constantOr(null);for(const fe of p){const oe=o.getTile(fe),Pe=oe.getBucket(d);if(!Pe)continue;const De=v.style.map.terrain&&v.style.map.terrain.getTerrainData(fe),me=Pe.programConfigurations.get(d.id),Ae=v.useProgram(V?"fillExtrusionPattern":"fillExtrusion",me);V&&(v.context.activeTexture.set(M.TEXTURE0),oe.imageAtlasTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE),me.updatePaintBuffers(X)),Ic(me,R,le,oe,d);const Ue=v.translatePosMatrix(fe.posMatrix,oe,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),$e=d.paint.get("fill-extrusion-vertical-gradient"),Xe=V?Ss(Ue,v,$e,ue,fe,X,oe):bl(Ue,v,$e,ue);Ae.draw(C,C.gl.TRIANGLES,y,b,P,fr.backCCW,Xe,De,d.id,Pe.layoutVertexBuffer,Pe.indexBuffer,Pe.segments,d.paint,v.transform.zoom,me,v.style.map.terrain&&Pe.centroidVertexBuffer)}}function Rv(v,o,d,p,y,b,P){const C=v.context,M=C.gl,R=d.fbo;if(!R)return;const U=v.useProgram("hillshade"),V=v.style.map.terrain&&v.style.map.terrain.getTerrainData(o);C.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,R.colorAttachment.get()),U.draw(C,M.TRIANGLES,y,b,P,fr.disabled,((X,ue,le,fe)=>{const oe=le.paint.get("hillshade-shadow-color"),Pe=le.paint.get("hillshade-highlight-color"),De=le.paint.get("hillshade-accent-color");let me=le.paint.get("hillshade-illumination-direction")*(Math.PI/180);le.paint.get("hillshade-illumination-anchor")==="viewport"&&(me-=X.transform.angle);const Ae=!X.options.moving;return{u_matrix:fe?fe.posMatrix:X.transform.calculatePosMatrix(ue.tileID.toUnwrapped(),Ae),u_image:0,u_latrange:Sn(0,ue.tileID),u_light:[le.paint.get("hillshade-exaggeration"),me],u_shadow:oe,u_highlight:Pe,u_accent:De}})(v,d,p,V?o:null),V,p.id,v.rasterBoundsBuffer,v.quadTriangleIndexBuffer,v.rasterBoundsSegments)}function Jd(v,o,d,p,y,b){const P=v.context,C=P.gl,M=o.dem;if(M&&M.data){const R=M.dim,U=M.stride,V=M.getPixels();if(P.activeTexture.set(C.TEXTURE1),P.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||v.getTileTexture(U),o.demTexture){const ue=o.demTexture;ue.update(V,{premultiply:!1}),ue.bind(C.NEAREST,C.CLAMP_TO_EDGE)}else o.demTexture=new de(P,V,C.RGBA,{premultiply:!1}),o.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE);P.activeTexture.set(C.TEXTURE0);let X=o.fbo;if(!X){const ue=new de(P,{width:R,height:R,data:null},C.RGBA);ue.bind(C.LINEAR,C.CLAMP_TO_EDGE),X=o.fbo=P.createFramebuffer(R,R,!0,!1),X.colorAttachment.set(ue.texture)}P.bindFramebuffer.set(X.framebuffer),P.viewport.set([0,0,R,R]),v.useProgram("hillshadePrepare").draw(P,C.TRIANGLES,p,y,b,fr.disabled,((ue,le)=>{const fe=le.stride,oe=l.create();return l.ortho(oe,0,l.EXTENT,-l.EXTENT,0,0,1),l.translate(oe,oe,[0,-l.EXTENT,0]),{u_matrix:oe,u_image:1,u_dimension:[fe,fe],u_zoom:ue.overscaledZ,u_unpack:le.getUnpackVector()}})(o.tileID,M),null,d.id,v.rasterBoundsBuffer,v.quadTriangleIndexBuffer,v.rasterBoundsSegments),o.needsHillshadePrepare=!1}}function Ov(v,o,d,p,y,b){const P=p.paint.get("raster-fade-duration");if(!b&&P>0){const C=l.browser.now(),M=(C-v.timeAdded)/P,R=o?(C-o.timeAdded)/P:-1,U=d.getSource(),V=y.coveringZoomLevel({tileSize:U.tileSize,roundZoom:U.roundZoom}),X=!o||Math.abs(o.tileID.overscaledZ-V)>Math.abs(v.tileID.overscaledZ-V),ue=X&&v.refreshedUponExpiration?1:l.clamp(X?M:1-R,0,1);return v.refreshedUponExpiration&&M>=1&&(v.refreshedUponExpiration=!1),o?{opacity:1,mix:1-ue}:{opacity:ue,mix:0}}return{opacity:1,mix:0}}const Km=new l.Color(1,0,0,1),qu=new l.Color(0,1,0,1),Qd=new l.Color(0,0,1,1),Jm=new l.Color(1,0,1,1),Qm=new l.Color(0,1,1,1);function Lc(v,o,d,p){Xu(v,0,o+d/2,v.transform.width,d,p)}function Zu(v,o,d,p){Xu(v,o-d/2,0,d,v.transform.height,p)}function Xu(v,o,d,p,y,b){const P=v.context,C=P.gl;C.enable(C.SCISSOR_TEST),C.scissor(o*v.pixelRatio,d*v.pixelRatio,p*v.pixelRatio,y*v.pixelRatio),P.clear({color:b}),C.disable(C.SCISSOR_TEST)}function eg(v,o,d){const p=v.context,y=p.gl,b=d.posMatrix,P=v.useProgram("debug"),C=Ln.disabled,M=gr.disabled,R=v.colorModeForRenderPass(),U="$debug",V=v.style.map.terrain&&v.style.map.terrain.getTerrainData(d);p.activeTexture.set(y.TEXTURE0);const X=o.getTileByID(d.key).latestRawTileData,ue=Math.floor((X&&X.byteLength||0)/1024),le=o.getTile(d).tileSize,fe=512/Math.min(le,512)*(d.overscaledZ/v.transform.zoom)*.5;let oe=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(oe+=` => ${d.overscaledZ}`),function(Pe,De){Pe.initDebugOverlayCanvas();const me=Pe.debugOverlayCanvas,Ae=Pe.context.gl,Ue=Pe.debugOverlayCanvas.getContext("2d");Ue.clearRect(0,0,me.width,me.height),Ue.shadowColor="white",Ue.shadowBlur=2,Ue.lineWidth=1.5,Ue.strokeStyle="white",Ue.textBaseline="top",Ue.font="bold 36px Open Sans, sans-serif",Ue.fillText(De,5,5),Ue.strokeText(De,5,5),Pe.debugOverlayTexture.update(me),Pe.debugOverlayTexture.bind(Ae.LINEAR,Ae.CLAMP_TO_EDGE)}(v,`${oe} ${ue}kB`),P.draw(p,y.TRIANGLES,C,M,mr.alphaBlended,fr.disabled,Ve(b,l.Color.transparent,fe),null,U,v.debugBuffer,v.quadTriangleIndexBuffer,v.debugSegments),P.draw(p,y.LINE_STRIP,C,M,R,fr.disabled,Ve(b,l.Color.red),V,U,v.debugBuffer,v.tileBorderIndexBuffer,v.debugSegments)}function br(v,o,d){const p=v.context,y=p.gl,b=v.colorModeForRenderPass(),P=new Ln(y.LEQUAL,Ln.ReadWrite,v.depthRangeFor3D),C=v.useProgram("terrain"),M=o.getTerrainMesh();p.bindFramebuffer.set(null),p.viewport.set([0,0,v.width,v.height]);for(const R of d){const U=v.renderToTexture.getTexture(R),V=o.getTerrainData(R.tileID);p.activeTexture.set(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,U.texture);const X={u_matrix:v.transform.calculatePosMatrix(R.tileID.toUnwrapped()),u_texture:0,u_ele_delta:o.getMeshFrameDelta(v.transform.zoom)};C.draw(p,y.TRIANGLES,P,gr.disabled,b,fr.backCCW,X,V,"terrain",M.vertexBuffer,M.indexBuffer,M.segments)}}class Na{constructor(o,d){this.context=new Lv(o),this.transform=d,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:l.create(),renderTime:0},this.setup(),this.numSublayers=Bt.maxUnderzooming+Bt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ki}resize(o,d,p){if(this.width=Math.floor(o*p),this.height=Math.floor(d*p),this.pixelRatio=p,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const y of this.style._order)this.style._layers[y].resize()}setup(){const o=this.context,d=new l.PosArray;d.emplaceBack(0,0),d.emplaceBack(l.EXTENT,0),d.emplaceBack(0,l.EXTENT),d.emplaceBack(l.EXTENT,l.EXTENT),this.tileExtentBuffer=o.createVertexBuffer(d,Fo.members),this.tileExtentSegments=l.SegmentVector.simpleSegment(0,0,4,2);const p=new l.PosArray;p.emplaceBack(0,0),p.emplaceBack(l.EXTENT,0),p.emplaceBack(0,l.EXTENT),p.emplaceBack(l.EXTENT,l.EXTENT),this.debugBuffer=o.createVertexBuffer(p,Fo.members),this.debugSegments=l.SegmentVector.simpleSegment(0,0,4,5);const y=new l.RasterBoundsArray;y.emplaceBack(0,0,0,0),y.emplaceBack(l.EXTENT,0,l.EXTENT,0),y.emplaceBack(0,l.EXTENT,0,l.EXTENT),y.emplaceBack(l.EXTENT,l.EXTENT,l.EXTENT,l.EXTENT),this.rasterBoundsBuffer=o.createVertexBuffer(y,Ct.members),this.rasterBoundsSegments=l.SegmentVector.simpleSegment(0,0,4,2);const b=new l.PosArray;b.emplaceBack(0,0),b.emplaceBack(1,0),b.emplaceBack(0,1),b.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(b,Fo.members),this.viewportSegments=l.SegmentVector.simpleSegment(0,0,4,2);const P=new l.LineStripIndexArray;P.emplaceBack(0),P.emplaceBack(1),P.emplaceBack(3),P.emplaceBack(2),P.emplaceBack(0),this.tileBorderIndexBuffer=o.createIndexBuffer(P);const C=new l.TriangleIndexArray;C.emplaceBack(0,1,2),C.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(C);const M=this.context.gl;this.stencilClearMode=new gr({func:M.ALWAYS,mask:0},0,255,M.ZERO,M.ZERO,M.ZERO)}clearStencil(){const o=this.context,d=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const p=l.create();l.ortho(p,0,this.width,this.height,0,0,1),l.scale(p,p,[d.drawingBufferWidth,d.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(o,d.TRIANGLES,Ln.disabled,this.stencilClearMode,mr.disabled,fr.disabled,lt(p),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(o,d){if(this.currentStencilSource===o.source||!o.isTileClipped()||!d||!d.length)return;this.currentStencilSource=o.source;const p=this.context,y=p.gl;this.nextStencilID+d.length>256&&this.clearStencil(),p.setColorMode(mr.disabled),p.setDepthMode(Ln.disabled);const b=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const P of d){const C=this._tileClippingMaskIDs[P.key]=this.nextStencilID++,M=this.style.map.terrain&&this.style.map.terrain.getTerrainData(P);b.draw(p,y.TRIANGLES,Ln.disabled,new gr({func:y.ALWAYS,mask:0},C,255,y.KEEP,y.KEEP,y.REPLACE),mr.disabled,fr.disabled,lt(P.posMatrix),M,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,d=this.context.gl;return new gr({func:d.NOTEQUAL,mask:255},o,255,d.KEEP,d.KEEP,d.REPLACE)}stencilModeForClipping(o){const d=this.context.gl;return new gr({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,d.KEEP,d.KEEP,d.REPLACE)}stencilConfigForOverlap(o){const d=this.context.gl,p=o.sort((P,C)=>C.overscaledZ-P.overscaledZ),y=p[p.length-1].overscaledZ,b=p[0].overscaledZ-y+1;if(b>1){this.currentStencilSource=void 0,this.nextStencilID+b>256&&this.clearStencil();const P={};for(let C=0;C<b;C++)P[C+y]=new gr({func:d.GEQUAL,mask:255},C+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=b,[P,p]}return[{[y]:gr.disabled},p]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new mr([o.CONSTANT_COLOR,o.ONE],new l.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?mr.unblended:mr.alphaBlended}depthModeForSublayer(o,d,p){if(!this.opaquePassEnabledForLayer())return Ln.disabled;const y=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new Ln(p||this.context.gl.LEQUAL,d,[y,y])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,d){this.style=o,this.options=d,this.lineAtlas=o.lineAtlas,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(l.browser.now()),this.imageManager.beginFrame();const p=this.style._order,y=this.style.sourceCaches,b={},P={},C={};for(const M in y){const R=y[M];R.used&&R.prepare(this.context),b[M]=R.getVisibleCoordinates(),P[M]=b[M].slice().reverse(),C[M]=R.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let M=0;M<p.length;M++)if(this.style._layers[p[M]].is3D()){this.opaquePassCutoff=M;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const M=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!l.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||M.length)&&(l.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(R,U){const V=R.context,X=V.gl,ue=mr.unblended,le=new Ln(X.LEQUAL,Ln.ReadWrite,[0,1]),fe=U.getTerrainMesh(),oe=U.sourceCache.getRenderableTiles(),Pe=R.useProgram("terrainDepth");V.bindFramebuffer.set(U.getFramebuffer("depth").framebuffer),V.viewport.set([0,0,R.width/devicePixelRatio,R.height/devicePixelRatio]),V.clear({color:l.Color.transparent,depth:1});for(const De of oe){const me=U.getTerrainData(De.tileID),Ae={u_matrix:R.transform.calculatePosMatrix(De.tileID.toUnwrapped()),u_ele_delta:U.getMeshFrameDelta(R.transform.zoom)};Pe.draw(V,X.TRIANGLES,le,gr.disabled,ue,fr.backCCW,Ae,me,"terrain",fe.vertexBuffer,fe.indexBuffer,fe.segments)}V.bindFramebuffer.set(null),V.viewport.set([0,0,R.width,R.height])}(this,this.style.map.terrain),function(R,U){const V=R.context,X=V.gl,ue=mr.unblended,le=new Ln(X.LEQUAL,Ln.ReadWrite,[0,1]),fe=U.getTerrainMesh(),oe=U.getCoordsTexture(),Pe=U.sourceCache.getRenderableTiles(),De=R.useProgram("terrainCoords");V.bindFramebuffer.set(U.getFramebuffer("coords").framebuffer),V.viewport.set([0,0,R.width/devicePixelRatio,R.height/devicePixelRatio]),V.clear({color:l.Color.transparent,depth:1}),U.coordsIndex=[];for(const me of Pe){const Ae=U.getTerrainData(me.tileID);V.activeTexture.set(X.TEXTURE0),X.bindTexture(X.TEXTURE_2D,oe.texture);const Ue={u_matrix:R.transform.calculatePosMatrix(me.tileID.toUnwrapped()),u_terrain_coords_id:(255-U.coordsIndex.length)/255,u_texture:0,u_ele_delta:U.getMeshFrameDelta(R.transform.zoom)};De.draw(V,X.TRIANGLES,le,gr.disabled,ue,fr.backCCW,Ue,Ae,"terrain",fe.vertexBuffer,fe.indexBuffer,fe.segments),U.coordsIndex.push(me.tileID.key)}V.bindFramebuffer.set(null),V.viewport.set([0,0,R.width,R.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const M of p){const R=this.style._layers[M];if(!R.hasOffscreenPass()||R.isHidden(this.transform.zoom))continue;const U=P[R.source];(R.type==="custom"||U.length)&&this.renderLayer(this,y[R.source],R,U)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:d.showOverdrawInspector?l.Color.black:l.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=d.showOverdrawInspector,this.depthRangeFor3D=[0,1-(o._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){const M=this.style._layers[p[this.currentLayer]],R=y[M.source],U=b[M.source];this._renderTileClippingMasks(M,U),this.renderLayer(this,R,M,U)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){const M=this.style._layers[p[this.currentLayer]],R=y[M.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(M))continue;const U=(M.type==="symbol"?C:P)[M.source];this._renderTileClippingMasks(M,b[M.source]),this.renderLayer(this,R,M,U)}if(this.options.showTileBoundaries){const M=function(R,U){let V=null;const X=Object.values(R._layers).flatMap(oe=>oe.source&&!oe.isHidden(U)?[R.sourceCaches[oe.source]]:[]),ue=X.filter(oe=>oe.getSource().type==="vector"),le=X.filter(oe=>oe.getSource().type!=="vector"),fe=oe=>{(!V||V.getSource().maxzoom<oe.getSource().maxzoom)&&(V=oe)};return ue.forEach(oe=>fe(oe)),V||le.forEach(oe=>fe(oe)),V}(this.style,this.transform.zoom);M&&function(R,U,V){for(let X=0;X<V.length;X++)eg(R,U,V[X])}(this,M,M.getVisibleCoordinates())}this.options.showPadding&&function(M){const R=M.transform.padding;Lc(M,M.transform.height-(R.top||0),3,Km),Lc(M,R.bottom||0,3,qu),Zu(M,R.left||0,3,Qd),Zu(M,M.transform.width-(R.right||0),3,Jm);const U=M.transform.centerPoint;(function(V,X,ue,le){Xu(V,X-1,ue-10,2,20,le),Xu(V,X-10,ue-1,20,2,le)})(M,U.x,M.transform.height-U.y,Qm)}(this),this.context.setDefault()}renderLayer(o,d,p,y){if(!p.isHidden(this.transform.zoom)&&(p.type==="background"||p.type==="custom"||(y||[]).length))switch(this.id=p.id,p.type){case"symbol":(function(b,P,C,M,R){if(b.renderPass!=="translucent")return;const U=gr.disabled,V=b.colorModeForRenderPass();(C._unevaluatedLayout.hasValue("text-variable-anchor")||C._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(X,ue,le,fe,oe,Pe,De){const me=ue.transform,Ae=oe==="map",Ue=Pe==="map";for(const $e of X){const Xe=fe.getTile($e),tt=Xe.getBucket(le);if(!tt||!tt.text||!tt.text.segments.get().length)continue;const Qe=l.evaluateSizeForZoom(tt.textSizeData,me.zoom),ct=Se(Xe,1,ue.transform.zoom),Vt=Ne($e.posMatrix,Ue,Ae,ue.transform,ct),An=le.layout.get("icon-text-fit")!=="none"&&tt.hasIconData();if(Qe){const mt=Math.pow(2,me.zoom-Xe.tileID.overscaledZ);Hu(tt,Ae,Ue,De,me,Vt,$e.posMatrix,mt,Qe,An,ue.style.map.terrain?(cn,Gt)=>ue.style.map.terrain.getElevation($e,cn,Gt):null)}}}(M,b,C,P,C.layout.get("text-rotation-alignment"),C.layout.get("text-pitch-alignment"),R),C.paint.get("icon-opacity").constantOr(1)!==0&&Wu(b,P,C,M,!1,C.paint.get("icon-translate"),C.paint.get("icon-translate-anchor"),C.layout.get("icon-rotation-alignment"),C.layout.get("icon-pitch-alignment"),C.layout.get("icon-keep-upright"),U,V),C.paint.get("text-opacity").constantOr(1)!==0&&Wu(b,P,C,M,!0,C.paint.get("text-translate"),C.paint.get("text-translate-anchor"),C.layout.get("text-rotation-alignment"),C.layout.get("text-pitch-alignment"),C.layout.get("text-keep-upright"),U,V),P.map.showCollisionBoxes&&(Ym(b,P,C,M,C.paint.get("text-translate"),C.paint.get("text-translate-anchor"),!0),Ym(b,P,C,M,C.paint.get("icon-translate"),C.paint.get("icon-translate-anchor"),!1))})(o,d,p,y,this.style.placement.variableOffsets);break;case"circle":(function(b,P,C,M){if(b.renderPass!=="translucent")return;const R=C.paint.get("circle-opacity"),U=C.paint.get("circle-stroke-width"),V=C.paint.get("circle-stroke-opacity"),X=!C.layout.get("circle-sort-key").isConstant();if(R.constantOr(1)===0&&(U.constantOr(1)===0||V.constantOr(1)===0))return;const ue=b.context,le=ue.gl,fe=b.depthModeForSublayer(0,Ln.ReadOnly),oe=gr.disabled,Pe=b.colorModeForRenderPass(),De=[];for(let me=0;me<M.length;me++){const Ae=M[me],Ue=P.getTile(Ae),$e=Ue.getBucket(C);if(!$e)continue;const Xe=$e.programConfigurations.get(C.id),tt=b.useProgram("circle",Xe),Qe=$e.layoutVertexBuffer,ct=$e.indexBuffer,Vt=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Ae),An={programConfiguration:Xe,program:tt,layoutVertexBuffer:Qe,indexBuffer:ct,uniformValues:ie(b,Ae,Ue,C),terrainData:Vt};if(X){const mt=$e.segments.get();for(const cn of mt)De.push({segments:new l.SegmentVector([cn]),sortKey:cn.sortKey,state:An})}else De.push({segments:$e.segments,sortKey:0,state:An})}X&&De.sort((me,Ae)=>me.sortKey-Ae.sortKey);for(const me of De){const{programConfiguration:Ae,program:Ue,layoutVertexBuffer:$e,indexBuffer:Xe,uniformValues:tt,terrainData:Qe}=me.state;Ue.draw(ue,le.TRIANGLES,fe,oe,Pe,fr.disabled,tt,Qe,C.id,$e,Xe,me.segments,C.paint,b.transform.zoom,Ae)}})(o,d,p,y);break;case"heatmap":(function(b,P,C,M){if(C.paint.get("heatmap-opacity")!==0)if(b.renderPass==="offscreen"){const R=b.context,U=R.gl,V=gr.disabled,X=new mr([U.ONE,U.ONE],l.Color.transparent,[!0,!0,!0,!0]);(function(ue,le,fe){const oe=ue.gl;ue.activeTexture.set(oe.TEXTURE1),ue.viewport.set([0,0,le.width/4,le.height/4]);let Pe=fe.heatmapFbo;if(Pe)oe.bindTexture(oe.TEXTURE_2D,Pe.colorAttachment.get()),ue.bindFramebuffer.set(Pe.framebuffer);else{const De=oe.createTexture();oe.bindTexture(oe.TEXTURE_2D,De),oe.texParameteri(oe.TEXTURE_2D,oe.TEXTURE_WRAP_S,oe.CLAMP_TO_EDGE),oe.texParameteri(oe.TEXTURE_2D,oe.TEXTURE_WRAP_T,oe.CLAMP_TO_EDGE),oe.texParameteri(oe.TEXTURE_2D,oe.TEXTURE_MIN_FILTER,oe.LINEAR),oe.texParameteri(oe.TEXTURE_2D,oe.TEXTURE_MAG_FILTER,oe.LINEAR),Pe=fe.heatmapFbo=ue.createFramebuffer(le.width/4,le.height/4,!1,!1),function(me,Ae,Ue,$e){var Xe,tt;const Qe=me.gl,ct=(Xe=me.HALF_FLOAT)!==null&&Xe!==void 0?Xe:Qe.UNSIGNED_BYTE,Vt=(tt=me.RGBA16F)!==null&&tt!==void 0?tt:Qe.RGBA;Qe.texImage2D(Qe.TEXTURE_2D,0,Vt,Ae.width/4,Ae.height/4,0,Qe.RGBA,ct,null),$e.colorAttachment.set(Ue)}(ue,le,De,Pe)}})(R,b,C),R.clear({color:l.Color.transparent});for(let ue=0;ue<M.length;ue++){const le=M[ue];if(P.hasRenderableParent(le))continue;const fe=P.getTile(le),oe=fe.getBucket(C);if(!oe)continue;const Pe=oe.programConfigurations.get(C.id),De=b.useProgram("heatmap",Pe),{zoom:me}=b.transform;De.draw(R,U.TRIANGLES,Ln.disabled,V,X,fr.disabled,Nt(le.posMatrix,fe,me,C.paint.get("heatmap-intensity")),null,C.id,oe.layoutVertexBuffer,oe.indexBuffer,oe.segments,C.paint,b.transform.zoom,Pe)}R.viewport.set([0,0,b.width,b.height])}else b.renderPass==="translucent"&&(b.context.setColorMode(b.colorModeForRenderPass()),function(R,U){const V=R.context,X=V.gl,ue=U.heatmapFbo;if(!ue)return;V.activeTexture.set(X.TEXTURE0),X.bindTexture(X.TEXTURE_2D,ue.colorAttachment.get()),V.activeTexture.set(X.TEXTURE1);let le=U.colorRampTexture;le||(le=U.colorRampTexture=new de(V,U.colorRamp,X.RGBA)),le.bind(X.LINEAR,X.CLAMP_TO_EDGE),R.useProgram("heatmapTexture").draw(V,X.TRIANGLES,Ln.disabled,gr.disabled,R.colorModeForRenderPass(),fr.disabled,((fe,oe,Pe,De)=>{const me=l.create();l.ortho(me,0,fe.width,fe.height,0,0,1);const Ae=fe.context.gl;return{u_matrix:me,u_world:[Ae.drawingBufferWidth,Ae.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:oe.paint.get("heatmap-opacity")}})(R,U),null,U.id,R.viewportBuffer,R.quadTriangleIndexBuffer,R.viewportSegments,U.paint,R.transform.zoom)}(b,C))})(o,d,p,y);break;case"line":(function(b,P,C,M){if(b.renderPass!=="translucent")return;const R=C.paint.get("line-opacity"),U=C.paint.get("line-width");if(R.constantOr(1)===0||U.constantOr(1)===0)return;const V=b.depthModeForSublayer(0,Ln.ReadOnly),X=b.colorModeForRenderPass(),ue=C.paint.get("line-dasharray"),le=C.paint.get("line-pattern"),fe=le.constantOr(1),oe=C.paint.get("line-gradient"),Pe=C.getCrossfadeParameters(),De=fe?"linePattern":ue?"lineSDF":oe?"lineGradient":"line",me=b.context,Ae=me.gl;let Ue=!0;for(const $e of M){const Xe=P.getTile($e);if(fe&&!Xe.patternsLoaded())continue;const tt=Xe.getBucket(C);if(!tt)continue;const Qe=tt.programConfigurations.get(C.id),ct=b.context.program.get(),Vt=b.useProgram(De,Qe),An=Ue||Vt.program!==ct,mt=b.style.map.terrain&&b.style.map.terrain.getTerrainData($e),cn=le.constantOr(null);if(cn&&Xe.imageAtlas){const Pn=Xe.imageAtlas,vn=Pn.patternPositions[cn.to.toString()],In=Pn.patternPositions[cn.from.toString()];vn&&In&&Qe.setConstantPatternPositions(vn,In)}const Gt=mt?$e:null,Hn=fe?di(b,Xe,C,Pe,Gt):ue?cs(b,Xe,C,ue,Pe,Gt):oe?jr(b,Xe,C,tt.lineClipsArray.length,Gt):Ir(b,Xe,C,Gt);if(fe)me.activeTexture.set(Ae.TEXTURE0),Xe.imageAtlasTexture.bind(Ae.LINEAR,Ae.CLAMP_TO_EDGE),Qe.updatePaintBuffers(Pe);else if(ue&&(An||b.lineAtlas.dirty))me.activeTexture.set(Ae.TEXTURE0),b.lineAtlas.bind(me);else if(oe){const Pn=tt.gradients[C.id];let vn=Pn.texture;if(C.gradientVersion!==Pn.version){let In=256;if(C.stepInterpolant){const Mr=P.getSource().maxzoom,tr=$e.canonical.z===Mr?Math.ceil(1<<b.transform.maxZoom-$e.canonical.z):1;In=l.clamp(l.nextPowerOfTwo(tt.maxLineLength/l.EXTENT*1024*tr),256,me.maxTextureSize)}Pn.gradient=l.renderColorRamp({expression:C.gradientExpression(),evaluationKey:"lineProgress",resolution:In,image:Pn.gradient||void 0,clips:tt.lineClipsArray}),Pn.texture?Pn.texture.update(Pn.gradient):Pn.texture=new de(me,Pn.gradient,Ae.RGBA),Pn.version=C.gradientVersion,vn=Pn.texture}me.activeTexture.set(Ae.TEXTURE0),vn.bind(C.stepInterpolant?Ae.NEAREST:Ae.LINEAR,Ae.CLAMP_TO_EDGE)}Vt.draw(me,Ae.TRIANGLES,V,b.stencilModeForClipping($e),X,fr.disabled,Hn,mt,C.id,tt.layoutVertexBuffer,tt.indexBuffer,tt.segments,C.paint,b.transform.zoom,Qe,tt.layoutVertexBuffer2),Ue=!1}})(o,d,p,y);break;case"fill":(function(b,P,C,M){const R=C.paint.get("fill-color"),U=C.paint.get("fill-opacity");if(U.constantOr(1)===0)return;const V=b.colorModeForRenderPass(),X=C.paint.get("fill-pattern"),ue=b.opaquePassEnabledForLayer()&&!X.constantOr(1)&&R.constantOr(l.Color.transparent).a===1&&U.constantOr(0)===1?"opaque":"translucent";if(b.renderPass===ue){const le=b.depthModeForSublayer(1,b.renderPass==="opaque"?Ln.ReadWrite:Ln.ReadOnly);Mc(b,P,C,M,le,V,!1)}if(b.renderPass==="translucent"&&C.paint.get("fill-antialias")){const le=b.depthModeForSublayer(C.getPaintProperty("fill-outline-color")?2:0,Ln.ReadOnly);Mc(b,P,C,M,le,V,!0)}})(o,d,p,y);break;case"fill-extrusion":(function(b,P,C,M){const R=C.paint.get("fill-extrusion-opacity");if(R!==0&&b.renderPass==="translucent"){const U=new Ln(b.context.gl.LEQUAL,Ln.ReadWrite,b.depthRangeFor3D);if(R!==1||C.paint.get("fill-extrusion-pattern").constantOr(1))kc(b,P,C,M,U,gr.disabled,mr.disabled),kc(b,P,C,M,U,b.stencilModeFor3D(),b.colorModeForRenderPass());else{const V=b.colorModeForRenderPass();kc(b,P,C,M,U,gr.disabled,V)}}})(o,d,p,y);break;case"hillshade":(function(b,P,C,M){if(b.renderPass!=="offscreen"&&b.renderPass!=="translucent")return;const R=b.context,U=b.depthModeForSublayer(0,Ln.ReadOnly),V=b.colorModeForRenderPass(),[X,ue]=b.renderPass==="translucent"?b.stencilConfigForOverlap(M):[{},M];for(const le of ue){const fe=P.getTile(le);fe.needsHillshadePrepare!==void 0&&fe.needsHillshadePrepare&&b.renderPass==="offscreen"?Jd(b,fe,C,U,gr.disabled,V):b.renderPass==="translucent"&&Rv(b,le,fe,C,U,X[le.overscaledZ],V)}R.viewport.set([0,0,b.width,b.height])})(o,d,p,y);break;case"raster":(function(b,P,C,M){if(b.renderPass!=="translucent"||C.paint.get("raster-opacity")===0||!M.length)return;const R=b.context,U=R.gl,V=P.getSource(),X=b.useProgram("raster"),ue=b.colorModeForRenderPass(),[le,fe]=V instanceof sn?[{},M]:b.stencilConfigForOverlap(M),oe=fe[fe.length-1].overscaledZ,Pe=!b.options.moving;for(const De of fe){const me=b.depthModeForSublayer(De.overscaledZ-oe,C.paint.get("raster-opacity")===1?Ln.ReadWrite:Ln.ReadOnly,U.LESS),Ae=P.getTile(De);Ae.registerFadeDuration(C.paint.get("raster-fade-duration"));const Ue=P.findLoadedParent(De,0),$e=Ov(Ae,Ue,P,C,b.transform,b.style.map.terrain);let Xe,tt;const Qe=C.paint.get("raster-resampling")==="nearest"?U.NEAREST:U.LINEAR;R.activeTexture.set(U.TEXTURE0),Ae.texture.bind(Qe,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST),R.activeTexture.set(U.TEXTURE1),Ue?(Ue.texture.bind(Qe,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST),Xe=Math.pow(2,Ue.tileID.overscaledZ-Ae.tileID.overscaledZ),tt=[Ae.tileID.canonical.x*Xe%1,Ae.tileID.canonical.y*Xe%1]):Ae.texture.bind(Qe,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST);const ct=b.style.map.terrain&&b.style.map.terrain.getTerrainData(De),Vt=ct?De:null,An=Vt?Vt.posMatrix:b.transform.calculatePosMatrix(De.toUnwrapped(),Pe),mt=jm(An,tt||[0,0],Xe||1,$e,C);V instanceof sn?X.draw(R,U.TRIANGLES,me,gr.disabled,ue,fr.disabled,mt,ct,C.id,V.boundsBuffer,b.quadTriangleIndexBuffer,V.boundsSegments):X.draw(R,U.TRIANGLES,me,le[De.overscaledZ],ue,fr.disabled,mt,ct,C.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments)}})(o,d,p,y);break;case"background":(function(b,P,C,M){const R=C.paint.get("background-color"),U=C.paint.get("background-opacity");if(U===0)return;const V=b.context,X=V.gl,ue=b.transform,le=ue.tileSize,fe=C.paint.get("background-pattern");if(b.isPatternMissing(fe))return;const oe=!fe&&R.a===1&&U===1&&b.opaquePassEnabledForLayer()?"opaque":"translucent";if(b.renderPass!==oe)return;const Pe=gr.disabled,De=b.depthModeForSublayer(0,oe==="opaque"?Ln.ReadWrite:Ln.ReadOnly),me=b.colorModeForRenderPass(),Ae=b.useProgram(fe?"backgroundPattern":"background"),Ue=M||ue.coveringTiles({tileSize:le,terrain:b.style.map.terrain});fe&&(V.activeTexture.set(X.TEXTURE0),b.imageManager.bind(b.context));const $e=C.getCrossfadeParameters();for(const Xe of Ue){const tt=M?Xe.posMatrix:b.transform.calculatePosMatrix(Xe.toUnwrapped()),Qe=fe?Ps(tt,U,b,fe,{tileID:Xe,tileSize:le},$e):Ou(tt,U,R),ct=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Xe);Ae.draw(V,X.TRIANGLES,De,Pe,me,fr.disabled,Qe,ct,C.id,b.tileExtentBuffer,b.quadTriangleIndexBuffer,b.tileExtentSegments)}})(o,0,p,y);break;case"custom":(function(b,P,C){const M=b.context,R=C.implementation;if(b.renderPass==="offscreen"){const U=R.prerender;U&&(b.setCustomLayerDefaults(),M.setColorMode(b.colorModeForRenderPass()),U.call(R,M.gl,b.transform.customLayerMatrix()),M.setDirty(),b.setBaseState())}else if(b.renderPass==="translucent"){b.setCustomLayerDefaults(),M.setColorMode(b.colorModeForRenderPass()),M.setStencilMode(gr.disabled);const U=R.renderingMode==="3d"?new Ln(b.context.gl.LEQUAL,Ln.ReadWrite,b.depthRangeFor3D):b.depthModeForSublayer(0,Ln.ReadOnly);M.setDepthMode(U),R.render(M.gl,b.transform.customLayerMatrix()),M.setDirty(),b.setBaseState(),M.bindFramebuffer.set(null)}})(o,0,p)}}translatePosMatrix(o,d,p,y,b){if(!p[0]&&!p[1])return o;const P=b?y==="map"?this.transform.angle:0:y==="viewport"?-this.transform.angle:0;if(P){const R=Math.sin(P),U=Math.cos(P);p=[p[0]*U-p[1]*R,p[0]*R+p[1]*U]}const C=[b?p[0]:Se(d,p[0],this.transform.zoom),b?p[1]:Se(d,p[1],this.transform.zoom),0],M=new Float32Array(16);return l.translate(M,o,C),M}saveTileTexture(o){const d=this._tileTextures[o.size[0]];d?d.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const d=this._tileTextures[o];return d&&d.length>0?d.pop():null}isPatternMissing(o){if(!o)return!1;if(!o.from||!o.to)return!0;const d=this.imageManager.getPattern(o.from.toString()),p=this.imageManager.getPattern(o.to.toString());return!d||!p}useProgram(o,d){this.cache=this.cache||{};const p=o+(d?d.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[p]||(this.cache[p]=new Gi(this.context,Jn[o],d,Du[o],this._showOverdrawInspector,this.style.map.terrain)),this.cache[p]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new de(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:o,drawingBufferHeight:d}=this.context.gl;return this.width!==o||this.height!==d}}class Wi{constructor(o,d){this.points=o,this.planes=d}static fromInvProjectionMatrix(o,d,p){const y=Math.pow(2,p),b=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(C=>{const M=1/(C=l.transformMat4([],C,o))[3]/d*y;return l.mul$1(C,C,[M,M,1/C[3],M])}),P=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(C=>{const M=function(X,ue){var le=ue[0],fe=ue[1],oe=ue[2],Pe=le*le+fe*fe+oe*oe;return Pe>0&&(Pe=1/Math.sqrt(Pe)),X[0]=ue[0]*Pe,X[1]=ue[1]*Pe,X[2]=ue[2]*Pe,X}([],function(X,ue,le){var fe=ue[0],oe=ue[1],Pe=ue[2],De=le[0],me=le[1],Ae=le[2];return X[0]=oe*Ae-Pe*me,X[1]=Pe*De-fe*Ae,X[2]=fe*me-oe*De,X}([],te([],b[C[0]],b[C[1]]),te([],b[C[2]],b[C[1]]))),R=-((U=M)[0]*(V=b[C[1]])[0]+U[1]*V[1]+U[2]*V[2]);var U,V;return M.concat(R)});return new Wi(b,P)}}class Cl{constructor(o,d){this.min=o,this.max=d,this.center=function(p,y,b){return p[0]=.5*y[0],p[1]=.5*y[1],p[2]=.5*y[2],p}([],function(p,y,b){return p[0]=y[0]+b[0],p[1]=y[1]+b[1],p[2]=y[2]+b[2],p}([],this.min,this.max))}quadrant(o){const d=[o%2==0,o<2],p=$(this.min),y=$(this.max);for(let b=0;b<d.length;b++)p[b]=d[b]?this.min[b]:this.center[b],y[b]=d[b]?this.center[b]:this.max[b];return y[2]=this.max[2],new Cl(p,y)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}intersects(o){const d=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let p=!0;for(let y=0;y<o.planes.length;y++){const b=o.planes[y];let P=0;for(let C=0;C<d.length;C++)l.dot(b,d[C])>=0&&P++;if(P===0)return 0;P!==d.length&&(p=!1)}if(p)return 2;for(let y=0;y<3;y++){let b=Number.MAX_VALUE,P=-Number.MAX_VALUE;for(let C=0;C<o.points.length;C++){const M=o.points[C][y]-this.min[y];b=Math.min(b,M),P=Math.max(P,M)}if(P<0||b>this.max[y]-this.min[y])return 0}return 1}}class Rc{constructor(o=0,d=0,p=0,y=0){if(isNaN(o)||o<0||isNaN(d)||d<0||isNaN(p)||p<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=d,this.left=p,this.right=y}interpolate(o,d,p){return d.top!=null&&o.top!=null&&(this.top=l.interpolate.number(o.top,d.top,p)),d.bottom!=null&&o.bottom!=null&&(this.bottom=l.interpolate.number(o.bottom,d.bottom,p)),d.left!=null&&o.left!=null&&(this.left=l.interpolate.number(o.left,d.left,p)),d.right!=null&&o.right!=null&&(this.right=l.interpolate.number(o.right,d.right,p)),this}getCenter(o,d){const p=l.clamp((this.left+o-this.right)/2,0,o),y=l.clamp((this.top+d-this.bottom)/2,0,d);return new l.Point(p,y)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new Rc(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class Yu{constructor(o,d,p,y,b){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=b===void 0||!!b,this._minZoom=o||0,this._maxZoom=d||22,this._minPitch=p??0,this._maxPitch=y??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new l.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Rc,this._posMatrixCache={},this._alignedPosMatrixCache={},this._minEleveationForCurrentTile=0}clone(){const o=new Yu(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return o.apply(this),o}apply(o){this.tileSize=o.tileSize,this.latRange=o.latRange,this.width=o.width,this.height=o.height,this._center=o._center,this._elevation=o._elevation,this._minEleveationForCurrentTile=o._minEleveationForCurrentTile,this.zoom=o.zoom,this.angle=o.angle,this._fov=o._fov,this._pitch=o._pitch,this._unmodified=o._unmodified,this._edgeInsets=o._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new l.Point(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(o){const d=-l.wrap(o,-180,180)*Math.PI/180;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=function(){var p=new l.ARRAY_TYPE(4);return l.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p}(),function(p,y,b){var P=y[0],C=y[1],M=y[2],R=y[3],U=Math.sin(b),V=Math.cos(b);p[0]=P*V+M*U,p[1]=C*V+R*U,p[2]=P*-U+M*V,p[3]=C*-U+R*V}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const d=l.clamp(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=o/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(o){const d=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==d&&(this._unmodified=!1,this._zoom=d,this.tileZoom=Math.max(0,Math.floor(d)),this.scale=this.zoomScale(d),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(o){o!==this._elevation&&(this._elevation=o,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,d,p){this._unmodified=!1,this._edgeInsets.interpolate(o,d,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const d=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,d)}getVisibleUnwrappedCoordinates(o){const d=[new l.UnwrappedTileID(0,o)];if(this._renderWorldCopies){const p=this.pointCoordinate(new l.Point(0,0)),y=this.pointCoordinate(new l.Point(this.width,0)),b=this.pointCoordinate(new l.Point(this.width,this.height)),P=this.pointCoordinate(new l.Point(0,this.height)),C=Math.floor(Math.min(p.x,y.x,b.x,P.x)),M=Math.floor(Math.max(p.x,y.x,b.x,P.x)),R=1;for(let U=C-R;U<=M+R;U++)U!==0&&d.push(new l.UnwrappedTileID(U,o))}return d}coveringTiles(o){var d,p;let y=this.coveringZoomLevel(o);const b=y;if(o.minzoom!==void 0&&y<o.minzoom)return[];o.maxzoom!==void 0&&y>o.maxzoom&&(y=o.maxzoom);const P=this.pointCoordinate(this.getCameraPoint()),C=l.MercatorCoordinate.fromLngLat(this.center),M=Math.pow(2,y),R=[M*P.x,M*P.y,0],U=[M*C.x,M*C.y,0],V=Wi.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,y);let X=o.minzoom||0;!o.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(X=y);const ue=o.terrain?2/Math.min(this.tileSize,o.tileSize)*this.tileSize:3,le=me=>({aabb:new Cl([me*M,0,0],[(me+1)*M,M,0]),zoom:0,x:0,y:0,wrap:me,fullyVisible:!1}),fe=[],oe=[],Pe=y,De=o.reparseOverscaled?b:y;if(this._renderWorldCopies)for(let me=1;me<=3;me++)fe.push(le(-me)),fe.push(le(me));for(fe.push(le(0));fe.length>0;){const me=fe.pop(),Ae=me.x,Ue=me.y;let $e=me.fullyVisible;if(!$e){const Vt=me.aabb.intersects(V);if(Vt===0)continue;$e=Vt===2}const Xe=o.terrain?R:U,tt=me.aabb.distanceX(Xe),Qe=me.aabb.distanceY(Xe),ct=Math.max(Math.abs(tt),Math.abs(Qe));if(me.zoom===Pe||ct>ue+(1<<Pe-me.zoom)-2&&me.zoom>=X){const Vt=Pe-me.zoom,An=R[0]-.5-(Ae<<Vt),mt=R[1]-.5-(Ue<<Vt);oe.push({tileID:new l.OverscaledTileID(me.zoom===Pe?De:me.zoom,me.wrap,me.zoom,Ae,Ue),distanceSq:re([U[0]-.5-Ae,U[1]-.5-Ue]),tileDistanceToCamera:Math.sqrt(An*An+mt*mt)})}else for(let Vt=0;Vt<4;Vt++){const An=(Ae<<1)+Vt%2,mt=(Ue<<1)+(Vt>>1),cn=me.zoom+1;let Gt=me.aabb.quadrant(Vt);if(o.terrain){const Hn=new l.OverscaledTileID(cn,me.wrap,cn,An,mt),Pn=o.terrain.getMinMaxElevation(Hn),vn=(d=Pn.minElevation)!==null&&d!==void 0?d:this.elevation,In=(p=Pn.maxElevation)!==null&&p!==void 0?p:this.elevation;Gt=new Cl([Gt.min[0],Gt.min[1],vn],[Gt.max[0],Gt.max[1],In])}fe.push({aabb:Gt,zoom:cn,x:An,y:mt,wrap:me.wrap,fullyVisible:$e})}}return oe.sort((me,Ae)=>me.distanceSq-Ae.distanceSq).map(me=>me.tileID)}resize(o,d){this.width=o,this.height=d,this.pixelsToGLUnits=[2/o,-2/d],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const d=l.clamp(o.lat,-this.maxValidLatitude,this.maxValidLatitude);return new l.Point(l.mercatorXfromLng(o.lng)*this.worldSize,l.mercatorYfromLat(d)*this.worldSize)}unproject(o){return new l.MercatorCoordinate(o.x/this.worldSize,o.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(o){const d=this.pointLocation(this.centerPoint,o),p=o.getElevationForLngLatZoom(d,this.tileZoom);if(!(this.elevation-p))return;const y=this.getCameraPosition(),b=l.MercatorCoordinate.fromLngLat(y.lngLat,y.altitude),P=l.MercatorCoordinate.fromLngLat(d,p),C=b.x-P.x,M=b.y-P.y,R=b.z-P.z,U=Math.sqrt(C*C+M*M+R*R),V=this.scaleZoom(this.cameraToCenterDistance/U/this.tileSize);this._elevation=p,this._center=d,this.zoom=V}setLocationAtPoint(o,d){const p=this.pointCoordinate(d),y=this.pointCoordinate(this.centerPoint),b=this.locationCoordinate(o),P=new l.MercatorCoordinate(b.x-(p.x-y.x),b.y-(p.y-y.y));this.center=this.coordinateLocation(P),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(o,d){return d?this.coordinatePoint(this.locationCoordinate(o),d.getElevationForLngLatZoom(o,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(o))}pointLocation(o,d){return this.coordinateLocation(this.pointCoordinate(o,d))}locationCoordinate(o){return l.MercatorCoordinate.fromLngLat(o)}coordinateLocation(o){return o&&o.toLngLat()}pointCoordinate(o,d){if(d){const X=d.pointCoordinate(o);if(X!=null)return X}const p=[o.x,o.y,0,1],y=[o.x,o.y,1,1];l.transformMat4(p,p,this.pixelMatrixInverse),l.transformMat4(y,y,this.pixelMatrixInverse);const b=p[3],P=y[3],C=p[1]/b,M=y[1]/P,R=p[2]/b,U=y[2]/P,V=R===U?0:(0-R)/(U-R);return new l.MercatorCoordinate(l.interpolate.number(p[0]/b,y[0]/P,V)/this.worldSize,l.interpolate.number(C,M,V)/this.worldSize)}coordinatePoint(o,d=0,p=this.pixelMatrix){const y=[o.x*this.worldSize,o.y*this.worldSize,d,1];return l.transformMat4(y,y,p),new l.Point(y[0]/y[3],y[1]/y[3])}getBounds(){const o=Math.max(0,this.height/2-this.getHorizon());return new yt().extend(this.pointLocation(new l.Point(0,o))).extend(this.pointLocation(new l.Point(this.width,o))).extend(this.pointLocation(new l.Point(this.width,this.height))).extend(this.pointLocation(new l.Point(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new yt([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(o){o?(this.lngRange=[o.getWest(),o.getEast()],this.latRange=[o.getSouth(),o.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(o,d=!1){const p=o.key,y=d?this._alignedPosMatrixCache:this._posMatrixCache;if(y[p])return y[p];const b=o.canonical,P=this.worldSize/this.zoomScale(b.z),C=b.x+Math.pow(2,b.z)*o.wrap,M=l.identity(new Float64Array(16));return l.translate(M,M,[C*P,b.y*P,0]),l.scale(M,M,[P/l.EXTENT,P/l.EXTENT,1]),l.multiply(M,d?this.alignedProjMatrix:this.projMatrix,M),y[p]=new Float32Array(M),y[p]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let o,d,p,y,b=-90,P=90,C=-180,M=180;const R=this.size,U=this._unmodified;if(this.latRange){const ue=this.latRange;b=l.mercatorYfromLat(ue[1])*this.worldSize,P=l.mercatorYfromLat(ue[0])*this.worldSize,o=P-b<R.y?R.y/(P-b):0}if(this.lngRange){const ue=this.lngRange;C=l.wrap(l.mercatorXfromLng(ue[0])*this.worldSize,0,this.worldSize),M=l.wrap(l.mercatorXfromLng(ue[1])*this.worldSize,0,this.worldSize),M<C&&(M+=this.worldSize),d=M-C<R.x?R.x/(M-C):0}const V=this.point,X=Math.max(d||0,o||0);if(X)return this.center=this.unproject(new l.Point(d?(M+C)/2:V.x,o?(P+b)/2:V.y)),this.zoom+=this.scaleZoom(X),this._unmodified=U,void(this._constraining=!1);if(this.latRange){const ue=V.y,le=R.y/2;ue-le<b&&(y=b+le),ue+le>P&&(y=P-le)}if(this.lngRange){const ue=(C+M)/2,le=l.wrap(V.x,ue-this.worldSize/2,ue+this.worldSize/2),fe=R.x/2;le-fe<C&&(p=C+fe),le+fe>M&&(p=M-fe)}p===void 0&&y===void 0||(this.center=this.unproject(new l.Point(p!==void 0?p:V.x,y!==void 0?y:V.y)).wrap()),this._unmodified=U,this._constraining=!1}_calcMatrices(){if(!this.height)return;const o=this.centerOffset,d=this.point.x,p=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=l.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let y=l.identity(new Float64Array(16));l.scale(y,y,[this.width/2,-this.height/2,1]),l.translate(y,y,[1,-1,0]),this.labelPlaneMatrix=y,y=l.identity(new Float64Array(16)),l.scale(y,y,[1,-1,1]),l.translate(y,y,[-1,-1,0]),l.scale(y,y,[2/this.width,2/this.height,1]),this.glCoordMatrix=y;const b=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),P=Math.min(this.elevation,this._minEleveationForCurrentTile),C=b-P*this._pixelPerMeter/Math.cos(this._pitch),M=P<0?C:b,R=Math.PI/2+this._pitch,U=this._fov*(.5+o.y/this.height),V=Math.sin(U)*M/Math.sin(l.clamp(Math.PI-R-U,.01,Math.PI-.01)),X=this.getHorizon(),ue=2*Math.atan(X/this.cameraToCenterDistance)*(.5+o.y/(2*X)),le=Math.sin(ue)*M/Math.sin(l.clamp(Math.PI-R-ue,.01,Math.PI-.01)),fe=Math.min(V,le),oe=1.01*(Math.cos(Math.PI/2-this._pitch)*fe+M),Pe=this.height/50;y=new Float64Array(16),l.perspective(y,this._fov,this.width/this.height,Pe,oe),y[8]=2*-o.x/this.width,y[9]=2*o.y/this.height,l.scale(y,y,[1,-1,1]),l.translate(y,y,[0,0,-this.cameraToCenterDistance]),l.rotateX(y,y,this._pitch),l.rotateZ(y,y,this.angle),l.translate(y,y,[-d,-p,0]),this.mercatorMatrix=l.scale([],y,[this.worldSize,this.worldSize,this.worldSize]),l.scale(y,y,[1,1,this._pixelPerMeter]),this.pixelMatrix=l.multiply(new Float64Array(16),this.labelPlaneMatrix,y),l.translate(y,y,[0,0,-this.elevation]),this.projMatrix=y,this.invProjMatrix=l.invert([],y),this.pixelMatrix3D=l.multiply(new Float64Array(16),this.labelPlaneMatrix,y);const De=this.width%2/2,me=this.height%2/2,Ae=Math.cos(this.angle),Ue=Math.sin(this.angle),$e=d-Math.round(d)+Ae*De+Ue*me,Xe=p-Math.round(p)+Ae*me+Ue*De,tt=new Float64Array(y);if(l.translate(tt,tt,[$e>.5?$e-1:$e,Xe>.5?Xe-1:Xe,0]),this.alignedProjMatrix=tt,y=l.invert(new Float64Array(16),this.pixelMatrix),!y)throw new Error("failed to invert matrix");this.pixelMatrixInverse=y,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const o=this.pointCoordinate(new l.Point(0,0)),d=[o.x*this.worldSize,o.y*this.worldSize,0,1];return l.transformMat4(d,d,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.Point(0,o))}getCameraQueryGeometry(o){const d=this.getCameraPoint();if(o.length===1)return[o[0],d];{let p=d.x,y=d.y,b=d.x,P=d.y;for(const C of o)p=Math.min(p,C.x),y=Math.min(y,C.y),b=Math.max(b,C.x),P=Math.max(P,C.y);return[new l.Point(p,y),new l.Point(b,y),new l.Point(b,P),new l.Point(p,P),new l.Point(p,y)]}}}function Ba(v,o){let d,p=!1,y=null,b=null;const P=()=>{y=null,p&&(v.apply(b,d),y=setTimeout(P,o),p=!1)};return(...C)=>(p=!0,b=this,d=C,y||P(),y)}class Oc{constructor(o){this._getCurrentHash=()=>{const d=window.location.hash.replace("#","");if(this._hashName){let p;return d.split("&").map(y=>y.split("=")).forEach(y=>{y[0]===this._hashName&&(p=y)}),(p&&p[1]||"").split("/")}return d.split("/")},this._onHashChange=()=>{const d=this._getCurrentHash();if(d.length>=3&&!d.some(p=>isNaN(p))){const p=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(d[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:p,pitch:+(d[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const d=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,d)}catch{}},this._updateHash=Ba(this._updateHashUnthrottled,300),this._hashName=o&&encodeURIComponent(o)}addTo(o){return this._map=o,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(o){const d=this._map.getCenter(),p=Math.round(100*this._map.getZoom())/100,y=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,y),P=Math.round(d.lng*b)/b,C=Math.round(d.lat*b)/b,M=this._map.getBearing(),R=this._map.getPitch();let U="";if(U+=o?`/${P}/${C}/${p}`:`${p}/${C}/${P}`,(M||R)&&(U+="/"+Math.round(10*M)/10),R&&(U+=`/${Math.round(R)}`),this._hashName){const V=this._hashName;let X=!1;const ue=window.location.hash.slice(1).split("&").map(le=>{const fe=le.split("=")[0];return fe===V?(X=!0,`${fe}=${U}`):le}).filter(le=>le);return X||ue.push(`${V}=${U}`),`#${ue.join("&")}`}return`#${U}`}}const Al={linearity:.3,easing:l.bezier(0,0,.3,1)},tg=l.extend({deceleration:2500,maxSpeed:1400},Al),ng=l.extend({deceleration:20,maxSpeed:1400},Al),rg=l.extend({deceleration:1e3,maxSpeed:360},Al),ig=l.extend({deceleration:1e3,maxSpeed:90},Al);class sg{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:l.browser.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,d=l.browser.now();for(;o.length>0&&d-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const d={zoom:0,bearing:0,pitch:0,pan:new l.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:b}of this._inertiaBuffer)d.zoom+=b.zoomDelta||0,d.bearing+=b.bearingDelta||0,d.pitch+=b.pitchDelta||0,b.panDelta&&d.pan._add(b.panDelta),b.around&&(d.around=b.around),b.pinchAround&&(d.pinchAround=b.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,y={};if(d.pan.mag()){const b=Dc(d.pan.mag(),p,l.extend({},tg,o||{}));y.offset=d.pan.mult(b.amount/d.pan.mag()),y.center=this._map.transform.center,po(y,b)}if(d.zoom){const b=Dc(d.zoom,p,ng);y.zoom=this._map.transform.zoom+b.amount,po(y,b)}if(d.bearing){const b=Dc(d.bearing,p,rg);y.bearing=this._map.transform.bearing+l.clamp(b.amount,-179,179),po(y,b)}if(d.pitch){const b=Dc(d.pitch,p,ig);y.pitch=this._map.transform.pitch+b.amount,po(y,b)}if(y.zoom||y.bearing){const b=d.pinchAround===void 0?d.around:d.pinchAround;y.around=b?this._map.unproject(b):this._map.getCenter()}return this.clear(),l.extend(y,{noMoveStart:!0})}}function po(v,o){(!v.duration||v.duration<o.duration)&&(v.duration=o.duration,v.easing=o.easing)}function Dc(v,o,d){const{maxSpeed:p,linearity:y,deceleration:b}=d,P=l.clamp(v*y/(o/1e3),-p,p),C=Math.abs(P)/(b*y);return{easing:d.easing,duration:1e3*C,amount:P*(C/2)}}class ds extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,p,y={}){const b=_.mousePos(d.getCanvasContainer(),p),P=d.unproject(b);super(o,l.extend({point:b,lngLat:P,originalEvent:p},y)),this._defaultPrevented=!1,this.target=d}}class zc extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,p){const y=o==="touchend"?p.changedTouches:p.touches,b=_.touchPos(d.getCanvasContainer(),y),P=b.map(M=>d.unproject(M)),C=b.reduce((M,R,U,V)=>M.add(R.div(V.length)),new l.Point(0,0));super(o,{points:b,point:C,lngLats:P,lngLat:d.unproject(C),originalEvent:p}),this._defaultPrevented=!1}}class og extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,p){super(o,{originalEvent:p}),this._defaultPrevented=!1}}class ag{constructor(o,d){this._map=o,this._clickTolerance=d.clickTolerance}reset(){delete this._mousedownPos}wheel(o){return this._firePreventable(new og(o.type,this._map,o))}mousedown(o,d){return this._mousedownPos=d,this._firePreventable(new ds(o.type,this._map,o))}mouseup(o){this._map.fire(new ds(o.type,this._map,o))}click(o,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||this._map.fire(new ds(o.type,this._map,o))}dblclick(o){return this._firePreventable(new ds(o.type,this._map,o))}mouseover(o){this._map.fire(new ds(o.type,this._map,o))}mouseout(o){this._map.fire(new ds(o.type,this._map,o))}touchstart(o){return this._firePreventable(new zc(o.type,this._map,o))}touchmove(o){this._map.fire(new zc(o.type,this._map,o))}touchend(o){this._map.fire(new zc(o.type,this._map,o))}touchcancel(o){this._map.fire(new zc(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class lg{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(o){this._map.fire(new ds(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ds("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._ignoreContextMenu||this._map.fire(new ds(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class No{constructor(o){this._map=o}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(o){return this.transform.pointLocation(l.Point.convert(o),this._map.terrain)}}class cg{constructor(o,d){this._map=o,this._tr=new No(o),this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=d.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,d){this.isEnabled()&&o.shiftKey&&o.button===0&&(_.disableDrag(),this._startPos=this._lastPos=d,this._active=!0)}mousemoveWindow(o,d){if(!this._active)return;const p=d;if(this._lastPos.equals(p)||!this._box&&p.dist(this._startPos)<this._clickTolerance)return;const y=this._startPos;this._lastPos=p,this._box||(this._box=_.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",o));const b=Math.min(y.x,p.x),P=Math.max(y.x,p.x),C=Math.min(y.y,p.y),M=Math.max(y.y,p.y);_.setTransform(this._box,`translate(${b}px,${C}px)`),this._box.style.width=P-b+"px",this._box.style.height=M-C+"px"}mouseupWindow(o,d){if(!this._active||o.button!==0)return;const p=this._startPos,y=d;if(this.reset(),_.suppressClick(),p.x!==y.x||p.y!==y.y)return this._map.fire(new l.Event("boxzoomend",{originalEvent:o})),{cameraAnimation:b=>b.fitScreenCoordinates(p,y,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",o)}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(_.remove(this._box),this._box=null),_.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(o,d){return this._map.fire(new l.Event(o,{originalEvent:d}))}}function Cs(v,o){if(v.length!==o.length)throw new Error(`The number of touches and points are not equal - touches ${v.length}, points ${o.length}`);const d={};for(let p=0;p<v.length;p++)d[v[p].identifier]=o[p];return d}class Bo{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(o,d,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=o.timeStamp),p.length===this.numTouches&&(this.centroid=function(y){const b=new l.Point(0,0);for(const P of y)b._add(P);return b.div(y.length)}(d),this.touches=Cs(p,d)))}touchmove(o,d,p){if(this.aborted||!this.centroid)return;const y=Cs(p,d);for(const b in this.touches){const P=y[b];(!P||P.dist(this.touches[b])>30)&&(this.aborted=!0)}}touchend(o,d,p){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){const y=!this.aborted&&this.centroid;if(this.reset(),y)return y}}}class Ku{constructor(o){this.singleTap=new Bo(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(o,d,p){this.singleTap.touchstart(o,d,p)}touchmove(o,d,p){this.singleTap.touchmove(o,d,p)}touchend(o,d,p){const y=this.singleTap.touchend(o,d,p);if(y){const b=o.timeStamp-this.lastTime<500,P=!this.lastTap||this.lastTap.dist(y)<30;if(b&&P||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=y,this.count===this.numTaps)return this.reset(),y}}}class Uo{constructor(o){this._tr=new No(o),this._zoomIn=new Ku({numTouches:1,numTaps:2}),this._zoomOut=new Ku({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,d,p){this._zoomIn.touchstart(o,d,p),this._zoomOut.touchstart(o,d,p)}touchmove(o,d,p){this._zoomIn.touchmove(o,d,p),this._zoomOut.touchmove(o,d,p)}touchend(o,d,p){const y=this._zoomIn.touchend(o,d,p),b=this._zoomOut.touchend(o,d,p),P=this._tr;return y?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:P.zoom+1,around:P.unproject(y)},{originalEvent:o})}):b?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:P.zoom-1,around:P.unproject(b)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Vo{constructor(o){this._enabled=!!o.enable,this._moveStateManager=o.moveStateManager,this._clickTolerance=o.clickTolerance||1,this._moveFunction=o.move,this._activateOnStart=!!o.activateOnStart,o.assignEvents(this),this.reset()}reset(o){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(o)}_move(...o){const d=this._moveFunction(...o);if(d.bearingDelta||d.pitchDelta||d.around||d.panDelta)return this._active=!0,d}dragStart(o,d){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(o)&&(this._moveStateManager.startMove(o),this._lastPoint=d.length?d[0]:d,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(o,d){if(!this.isEnabled())return;const p=this._lastPoint;if(!p)return;if(o.preventDefault(),!this._moveStateManager.isValidMoveEvent(o))return void this.reset(o);const y=d.length?d[0]:d;return!this._moved&&y.dist(p)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=y,this._move(p,y))}dragEnd(o){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(o)&&(this._moved&&_.suppressClick(),this.reset(o))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Dv={0:1,2:2};class ef{constructor(o){this._correctEvent=o.checkCorrectEvent}startMove(o){const d=_.mouseButton(o);this._eventButton=d}endMove(o){delete this._eventButton}isValidStartEvent(o){return this._correctEvent(o)}isValidMoveEvent(o){return!function(d,p){const y=Dv[p];return d.buttons===void 0||(d.buttons&y)!==y}(o,this._eventButton)}isValidEndEvent(o){return _.mouseButton(o)===this._eventButton}}class ug{constructor(){this._firstTouch=void 0}_isOneFingerTouch(o){return o.targetTouches.length===1}_isSameTouchEvent(o){return o.targetTouches[0].identifier===this._firstTouch}startMove(o){this._firstTouch=o.targetTouches[0].identifier}endMove(o){delete this._firstTouch}isValidStartEvent(o){return this._isOneFingerTouch(o)}isValidMoveEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}isValidEndEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}}const Ju=v=>{v.mousedown=v.dragStart,v.mousemoveWindow=v.dragMove,v.mouseup=v.dragEnd,v.contextmenu=function(o){o.preventDefault()}},Il=({enable:v,clickTolerance:o,bearingDegreesPerPixelMoved:d=.8})=>{const p=new ef({checkCorrectEvent:y=>_.mouseButton(y)===0&&y.ctrlKey||_.mouseButton(y)===2});return new Vo({clickTolerance:o,move:(y,b)=>({bearingDelta:(b.x-y.x)*d}),moveStateManager:p,enable:v,assignEvents:Ju})},jo=({enable:v,clickTolerance:o,pitchDegreesPerPixelMoved:d=-.5})=>{const p=new ef({checkCorrectEvent:y=>_.mouseButton(y)===0&&y.ctrlKey||_.mouseButton(y)===2});return new Vo({clickTolerance:o,move:(y,b)=>({pitchDelta:(b.y-y.y)*d}),moveStateManager:p,enable:v,assignEvents:Ju})};class kt{constructor(o,d){this._minTouches=o.cooperativeGestures?2:1,this._clickTolerance=o.clickTolerance||1,this._map=d,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new l.Point(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(o,d,p){return this._calculateTransform(o,d,p)}touchmove(o,d,p){if(this._map._cooperativeGestures&&(this._minTouches===2&&p.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(o,!1,p.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(p.length<this._minTouches))return o.preventDefault(),this._calculateTransform(o,d,p)}touchend(o,d,p){this._calculateTransform(o,d,p),this._active&&p.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,d,p){p.length>0&&(this._active=!0);const y=Cs(p,d),b=new l.Point(0,0),P=new l.Point(0,0);let C=0;for(const R in y){const U=y[R],V=this._touches[R];V&&(b._add(U),P._add(U.sub(V)),C++,y[R]=U)}if(this._touches=y,C<this._minTouches||!P.mag())return;const M=P.div(C);return this._sum._add(M),this._sum.mag()<this._clickTolerance?void 0:{around:b.div(C),panDelta:M}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Qu{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(o,d,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([d[0],d[1]]))}touchmove(o,d,p){if(!this._firstTwoTouches)return;o.preventDefault();const[y,b]=this._firstTwoTouches,P=ha(p,d,y),C=ha(p,d,b);if(!P||!C)return;const M=this._aroundCenter?null:P.add(C).div(2);return this._move([P,C],M,o)}touchend(o,d,p){if(!this._firstTwoTouches)return;const[y,b]=this._firstTwoTouches,P=ha(p,d,y),C=ha(p,d,b);P&&C||(this._active&&_.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function ha(v,o,d){for(let p=0;p<v.length;p++)if(v[p].identifier===d)return o[p]}function Ml(v,o){return Math.log(v/o)/Math.LN2}class hg extends Qu{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,d){const p=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(Ml(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ml(this._distance,p),pinchAround:d}}}function Et(v,o){return 180*v.angleWith(o)/Math.PI}class tf extends Qu{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,d){const p=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Et(this._vector,p),pinchAround:d}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const d=25/(Math.PI*this._minDiameter)*360,p=Et(o,this._startVector);return Math.abs(p)<d}}function nf(v){return Math.abs(v.y)>Math.abs(v.x)}class zv extends Qu{constructor(o){super(),this._map=o}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(o,d,p){super.touchstart(o,d,p),this._currentTouchCount=p.length}_start(o){this._lastPoints=o,nf(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,d,p){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const y=o[0].sub(this._lastPoints[0]),b=o[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(y,b,p.timeStamp),this._valid?(this._lastPoints=o,this._active=!0,{pitchDelta:(y.y+b.y)/2*-.5}):void 0}gestureBeginsVertically(o,d,p){if(this._valid!==void 0)return this._valid;const y=o.mag()>=2,b=d.mag()>=2;if(!y&&!b)return;if(!y||!b)return this._firstMove===void 0&&(this._firstMove=p),p-this._firstMove<100&&void 0;const P=o.y>0==d.y>0;return nf(o)&&nf(d)&&P}}const rf={panStep:100,bearingStep:15,pitchStep:10};class dg{constructor(o){this._tr=new No(o);const d=rf;this._panStep=d.panStep,this._bearingStep=d.bearingStep,this._pitchStep=d.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let d=0,p=0,y=0,b=0,P=0;switch(o.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:o.shiftKey?p=-1:(o.preventDefault(),b=-1);break;case 39:o.shiftKey?p=1:(o.preventDefault(),b=1);break;case 38:o.shiftKey?y=1:(o.preventDefault(),P=-1);break;case 40:o.shiftKey?y=-1:(o.preventDefault(),P=1);break;default:return}return this._rotationDisabled&&(p=0,y=0),{cameraAnimation:C=>{const M=this._tr;C.easeTo({duration:300,easeId:"keyboardHandler",easing:fg,zoom:d?Math.round(M.zoom)+d*(o.shiftKey?2:1):M.zoom,bearing:M.bearing+p*this._bearingStep,pitch:M.pitch+y*this._pitchStep,offset:[-b*this._panStep,-P*this._panStep],center:M.center},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function fg(v){return v*(2-v)}const pg=4.000244140625;class Fv{constructor(o,d){this._onTimeout=p=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(p)},this._map=o,this._tr=new No(o),this._el=o.getCanvasContainer(),this._triggerRenderFrame=d,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(o){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!o[this._map._metaKey])return;o.preventDefault()}let d=o.deltaMode===WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const p=l.browser.now(),y=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,d!==0&&d%pg==0?this._type="wheel":d!==0&&Math.abs(d)<4?this._type="trackpad":y>400?(this._type=null,this._lastValue=d,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(y*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),o.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=o,this._delta-=d,this._active||this._start(o)),o.preventDefault()}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const d=_.mousePos(this._el,o),p=this._tr;this._around=l.LngLat.convert(this._aroundCenter?p.center:p.unproject(d)),this._aroundPoint=p.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._tr.transform;if(this._delta!==0){const C=this._type==="wheel"&&Math.abs(this._delta)>pg?this._wheelZoomRate:this._defaultZoomRate;let M=2/(1+Math.exp(-Math.abs(this._delta*C)));this._delta<0&&M!==0&&(M=1/M);const R=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):o.scale;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(R*M))),this._type==="wheel"&&(this._startZoom=o.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const d=typeof this._targetZoom=="number"?this._targetZoom:o.zoom,p=this._startZoom,y=this._easing;let b,P=!1;if(this._type==="wheel"&&p&&y){const C=Math.min((l.browser.now()-this._lastWheelEventTime)/200,1),M=y(C);b=l.interpolate.number(p,d,M),C<1?this._frameId||(this._frameId=!0):P=!0}else b=d,P=!0;return this._active=!0,P&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!P,zoomDelta:b-o.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let d=l.defaultEasing;if(this._prevEase){const p=this._prevEase,y=(l.browser.now()-p.start)/p.duration,b=p.easing(y+.01)-p.easing(y),P=.27/Math.sqrt(b*b+1e-4)*.01,C=Math.sqrt(.0729-P*P);d=l.bezier(P,C,.25,1)}return this._prevEase={start:l.browser.now(),duration:o,easing:d},d}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class sf{constructor(o,d){this._clickZoom=o,this._tapZoom=d}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class of{constructor(o){this._tr=new No(o),this.reset()}reset(){this._active=!1}dblclick(o,d){return o.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:this._tr.zoom+(o.shiftKey?-1:1),around:this._tr.unproject(d)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class af{constructor(){this._tap=new Ku({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(o,d,p){if(!this._swipePoint)if(this._tapTime){const y=d[0],b=o.timeStamp-this._tapTime<500,P=this._tapPoint.dist(y)<30;b&&P?p.length>0&&(this._swipePoint=y,this._swipeTouch=p[0].identifier):this.reset()}else this._tap.touchstart(o,d,p)}touchmove(o,d,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const y=d[0],b=y.y-this._swipePoint.y;return this._swipePoint=y,o.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(o,d,p)}touchend(o,d,p){if(this._tapTime)this._swipePoint&&p.length===0&&this.reset();else{const y=this._tap.touchend(o,d,p);y&&(this._tapTime=o.timeStamp,this._tapPoint=y)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class lf{constructor(o,d,p){this._el=o,this._mousePan=d,this._touchPan=p}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class qi{constructor(o,d,p){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=d,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class da{constructor(o,d,p,y){this._el=o,this._touchZoom=d,this._touchRotate=p,this._tapDragZoom=y,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Fc=v=>v.zoom||v.drag||v.pitch||v.rotate;class cf extends l.Event{}function Nc(v){return v.panDelta&&v.panDelta.mag()||v.zoomDelta||v.bearingDelta||v.pitchDelta}class uf{constructor(o,d){this.handleWindowEvent=y=>{this.handleEvent(y,`${y.type}Window`)},this.handleEvent=(y,b)=>{if(y.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const P=y.type==="renderFrame"?void 0:y,C={needsRenderFrame:!1},M={},R={},U=y.touches,V=U?this._getMapTouches(U):void 0,X=V?_.touchPos(this._el,V):_.mousePos(this._el,y);for(const{handlerName:fe,handler:oe,allowed:Pe}of this._handlers){if(!oe.isEnabled())continue;let De;this._blockedByActive(R,Pe,fe)?oe.reset():oe[b||y.type]&&(De=oe[b||y.type](y,X,V),this.mergeHandlerResult(C,M,De,fe,P),De&&De.needsRenderFrame&&this._triggerRenderFrame()),(De||oe.isActive())&&(R[fe]=oe)}const ue={};for(const fe in this._previousActiveHandlers)R[fe]||(ue[fe]=P);this._previousActiveHandlers=R,(Object.keys(ue).length||Nc(C))&&(this._changes.push([C,M,ue]),this._triggerRenderFrame()),(Object.keys(R).length||Nc(C))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:le}=C;le&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],le(this._map))},this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new sg(o),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(d);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[window,"blur",void 0]];for(const[y,b,P]of this._listeners)_.addEventListener(y,b,y===document?this.handleWindowEvent:this.handleEvent,P)}destroy(){for(const[o,d,p]of this._listeners)_.removeEventListener(o,d,o===document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(o){const d=this._map,p=d.getCanvasContainer();this._add("mapEvent",new ag(d,o));const y=d.boxZoom=new cg(d,o);this._add("boxZoom",y),o.interactive&&o.boxZoom&&y.enable();const b=new Uo(d),P=new of(d);d.doubleClickZoom=new sf(P,b),this._add("tapZoom",b),this._add("clickZoom",P),o.interactive&&o.doubleClickZoom&&d.doubleClickZoom.enable();const C=new af;this._add("tapDragZoom",C);const M=d.touchPitch=new zv(d);this._add("touchPitch",M),o.interactive&&o.touchPitch&&d.touchPitch.enable(o.touchPitch);const R=Il(o),U=jo(o);d.dragRotate=new qi(o,R,U),this._add("mouseRotate",R,["mousePitch"]),this._add("mousePitch",U,["mouseRotate"]),o.interactive&&o.dragRotate&&d.dragRotate.enable();const V=(({enable:Pe,clickTolerance:De})=>{const me=new ef({checkCorrectEvent:Ae=>_.mouseButton(Ae)===0&&!Ae.ctrlKey});return new Vo({clickTolerance:De,move:(Ae,Ue)=>({around:Ue,panDelta:Ue.sub(Ae)}),activateOnStart:!0,moveStateManager:me,enable:Pe,assignEvents:Ju})})(o),X=new kt(o,d);d.dragPan=new lf(p,V,X),this._add("mousePan",V),this._add("touchPan",X,["touchZoom","touchRotate"]),o.interactive&&o.dragPan&&d.dragPan.enable(o.dragPan);const ue=new tf,le=new hg;d.touchZoomRotate=new da(p,le,ue,C),this._add("touchRotate",ue,["touchPan","touchZoom"]),this._add("touchZoom",le,["touchPan","touchRotate"]),o.interactive&&o.touchZoomRotate&&d.touchZoomRotate.enable(o.touchZoomRotate);const fe=d.scrollZoom=new Fv(d,()=>this._triggerRenderFrame());this._add("scrollZoom",fe,["mousePan"]),o.interactive&&o.scrollZoom&&d.scrollZoom.enable(o.scrollZoom);const oe=d.keyboard=new dg(d);this._add("keyboard",oe),o.interactive&&o.keyboard&&d.keyboard.enable(),this._add("blockableMapEvent",new lg(d))}_add(o,d,p){this._handlers.push({handlerName:o,handler:d,allowed:p}),this._handlersById[o]=d}stop(o){if(!this._updatingCamera){for(const{handler:d}of this._handlers)d.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Fc(this._eventsInProgress)||this.isZooming()}_blockedByActive(o,d,p){for(const y in o)if(y!==p&&(!d||d.indexOf(y)<0))return!0;return!1}_getMapTouches(o){const d=[];for(const p of o)this._el.contains(p.target)&&d.push(p);return d}mergeHandlerResult(o,d,p,y,b){if(!p)return;l.extend(o,p);const P={handlerName:y,originalEvent:p.originalEvent||b};p.zoomDelta!==void 0&&(d.zoom=P),p.panDelta!==void 0&&(d.drag=P),p.pitchDelta!==void 0&&(d.pitch=P),p.bearingDelta!==void 0&&(d.rotate=P)}_applyChanges(){const o={},d={},p={};for(const[y,b,P]of this._changes)y.panDelta&&(o.panDelta=(o.panDelta||new l.Point(0,0))._add(y.panDelta)),y.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+y.zoomDelta),y.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+y.bearingDelta),y.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+y.pitchDelta),y.around!==void 0&&(o.around=y.around),y.pinchAround!==void 0&&(o.pinchAround=y.pinchAround),y.noInertia&&(o.noInertia=y.noInertia),l.extend(d,b),l.extend(p,P);this._updateMapTransform(o,d,p),this._changes=[]}_updateMapTransform(o,d,p){const y=this._map,b=y._getTransformForUpdate(),P=y.terrain;if(!(Nc(o)||P&&this._terrainMovement))return this._fireEvents(d,p,!0);let{panDelta:C,zoomDelta:M,bearingDelta:R,pitchDelta:U,around:V,pinchAround:X}=o;X!==void 0&&(V=X),y._stop(!0),V=V||y.transform.centerPoint;const ue=b.pointLocation(C?V.sub(C):V);R&&(b.bearing+=R),U&&(b.pitch+=U),M&&(b.zoom+=M),P?this._terrainMovement||!d.drag&&!d.zoom?d.drag&&this._terrainMovement?b.center=b.pointLocation(b.centerPoint.sub(C)):b.setLocationAtPoint(ue,V):(this._terrainMovement=!0,this._map._elevationFreeze=!0,b.setLocationAtPoint(ue,V),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,b.recalculateZoom(y.terrain)})):b.setLocationAtPoint(ue,V),y._applyUpdatedTransform(b),this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(d,p,!0)}_fireEvents(o,d,p){const y=Fc(this._eventsInProgress),b=Fc(o),P={};for(const U in o){const{originalEvent:V}=o[U];this._eventsInProgress[U]||(P[`${U}start`]=V),this._eventsInProgress[U]=o[U]}!y&&b&&this._fireEvent("movestart",b.originalEvent);for(const U in P)this._fireEvent(U,P[U]);b&&this._fireEvent("move",b.originalEvent);for(const U in o){const{originalEvent:V}=o[U];this._fireEvent(U,V)}const C={};let M;for(const U in this._eventsInProgress){const{handlerName:V,originalEvent:X}=this._eventsInProgress[U];this._handlersById[V].isActive()||(delete this._eventsInProgress[U],M=d[V]||X,C[`${U}end`]=M)}for(const U in C)this._fireEvent(U,C[U]);const R=Fc(this._eventsInProgress);if(p&&(y||b)&&!R){this._updatingCamera=!0;const U=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),V=X=>X!==0&&-this._bearingSnap<X&&X<this._bearingSnap;!U||!U.essential&&l.browser.prefersReducedMotion?(this._map.fire(new l.Event("moveend",{originalEvent:M})),V(this._map.getBearing())&&this._map.resetNorth()):(V(U.bearing||this._map.getBearing())&&(U.bearing=0),U.freezeElevation=!0,this._map.easeTo(U,{originalEvent:M})),this._updatingCamera=!1}}_fireEvent(o,d){this._map.fire(new l.Event(o,d?{originalEvent:d}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{delete this._frameId,this.handleEvent(new cf("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class mg extends l.Evented{constructor(o,d){super(),this._renderFrameCallback=()=>{const p=Math.min((l.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(p)),p<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=d.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new l.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(o,d){return this.jumpTo({center:o},d)}panBy(o,d,p){return o=l.Point.convert(o).mult(-1),this.panTo(this.transform.center,l.extend({offset:o},d),p)}panTo(o,d,p){return this.easeTo(l.extend({center:o},d),p)}getZoom(){return this.transform.zoom}setZoom(o,d){return this.jumpTo({zoom:o},d),this}zoomTo(o,d,p){return this.easeTo(l.extend({zoom:o},d),p)}zoomIn(o,d){return this.zoomTo(this.getZoom()+1,o,d),this}zoomOut(o,d){return this.zoomTo(this.getZoom()-1,o,d),this}getBearing(){return this.transform.bearing}setBearing(o,d){return this.jumpTo({bearing:o},d),this}getPadding(){return this.transform.padding}setPadding(o,d){return this.jumpTo({padding:o},d),this}rotateTo(o,d,p){return this.easeTo(l.extend({bearing:o},d),p)}resetNorth(o,d){return this.rotateTo(0,l.extend({duration:1e3},o),d),this}resetNorthPitch(o,d){return this.easeTo(l.extend({bearing:0,pitch:0,duration:1e3},o),d),this}snapToNorth(o,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,d):this}getPitch(){return this.transform.pitch}setPitch(o,d){return this.jumpTo({pitch:o},d),this}cameraForBounds(o,d){o=yt.convert(o);const p=d&&d.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),p,d)}_cameraForBoxAndBearing(o,d,p,y){const b={top:0,bottom:0,right:0,left:0};if(typeof(y=l.extend({padding:b,offset:[0,0],maxZoom:this.transform.maxZoom},y)).padding=="number"){const Ue=y.padding;y.padding={top:Ue,bottom:Ue,right:Ue,left:Ue}}y.padding=l.extend(b,y.padding);const P=this.transform,C=P.padding,M=P.project(l.LngLat.convert(o)),R=P.project(l.LngLat.convert(d)),U=M.rotate(-p*Math.PI/180),V=R.rotate(-p*Math.PI/180),X=new l.Point(Math.max(U.x,V.x),Math.max(U.y,V.y)),ue=new l.Point(Math.min(U.x,V.x),Math.min(U.y,V.y)),le=X.sub(ue),fe=(P.width-(C.left+C.right+y.padding.left+y.padding.right))/le.x,oe=(P.height-(C.top+C.bottom+y.padding.top+y.padding.bottom))/le.y;if(oe<0||fe<0)return void l.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Pe=Math.min(P.scaleZoom(P.scale*Math.min(fe,oe)),y.maxZoom),De=l.Point.convert(y.offset),me=new l.Point((y.padding.left-y.padding.right)/2,(y.padding.top-y.padding.bottom)/2).rotate(p*Math.PI/180),Ae=De.add(me).mult(P.scale/P.zoomScale(Pe));return{center:P.unproject(M.add(R).div(2).sub(Ae)),zoom:Pe,bearing:p}}fitBounds(o,d,p){return this._fitInternal(this.cameraForBounds(o,d),d,p)}fitScreenCoordinates(o,d,p,y,b){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(l.Point.convert(o)),this.transform.pointLocation(l.Point.convert(d)),p,y),y,b)}_fitInternal(o,d,p){return o?(delete(d=l.extend(o,d)).padding,d.linear?this.easeTo(d,p):this.flyTo(d,p)):this}jumpTo(o,d){this.stop();const p=this._getTransformForUpdate();let y=!1,b=!1,P=!1;return"zoom"in o&&p.zoom!==+o.zoom&&(y=!0,p.zoom=+o.zoom),o.center!==void 0&&(p.center=l.LngLat.convert(o.center)),"bearing"in o&&p.bearing!==+o.bearing&&(b=!0,p.bearing=+o.bearing),"pitch"in o&&p.pitch!==+o.pitch&&(P=!0,p.pitch=+o.pitch),o.padding==null||p.isPaddingEqual(o.padding)||(p.padding=o.padding),this._applyUpdatedTransform(p),this.fire(new l.Event("movestart",d)).fire(new l.Event("move",d)),y&&this.fire(new l.Event("zoomstart",d)).fire(new l.Event("zoom",d)).fire(new l.Event("zoomend",d)),b&&this.fire(new l.Event("rotatestart",d)).fire(new l.Event("rotate",d)).fire(new l.Event("rotateend",d)),P&&this.fire(new l.Event("pitchstart",d)).fire(new l.Event("pitch",d)).fire(new l.Event("pitchend",d)),this.fire(new l.Event("moveend",d))}calculateCameraOptionsFromTo(o,d,p,y=0){const b=l.MercatorCoordinate.fromLngLat(o,d),P=l.MercatorCoordinate.fromLngLat(p,y),C=P.x-b.x,M=P.y-b.y,R=P.z-b.z,U=Math.hypot(C,M,R);if(U===0)throw new Error("Can't calculate camera options with same From and To");const V=Math.hypot(C,M),X=this.transform.scaleZoom(this.transform.cameraToCenterDistance/U/this.transform.tileSize),ue=180*Math.atan2(C,-M)/Math.PI;let le=180*Math.acos(V/U)/Math.PI;return le=R<0?90-le:90+le,{center:P.toLngLat(),zoom:X,pitch:le,bearing:ue}}easeTo(o,d){this._stop(!1,o.easeId),((o=l.extend({offset:[0,0],duration:500,easing:l.defaultEasing},o)).animate===!1||!o.essential&&l.browser.prefersReducedMotion)&&(o.duration=0);const p=this._getTransformForUpdate(),y=this.getZoom(),b=this.getBearing(),P=this.getPitch(),C=this.getPadding(),M="zoom"in o?+o.zoom:y,R="bearing"in o?this._normalizeBearing(o.bearing,b):b,U="pitch"in o?+o.pitch:P,V="padding"in o?o.padding:p.padding,X=l.Point.convert(o.offset);let ue=p.centerPoint.add(X);const le=p.pointLocation(ue),fe=l.LngLat.convert(o.center||le);this._normalizeCenter(fe);const oe=p.project(le),Pe=p.project(fe).sub(oe),De=p.zoomScale(M-y);let me,Ae;o.around&&(me=l.LngLat.convert(o.around),Ae=p.locationPoint(me));const Ue={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||M!==y,this._rotating=this._rotating||b!==R,this._pitching=this._pitching||U!==P,this._padding=!p.isPaddingEqual(V),this._easeId=o.easeId,this._prepareEase(d,o.noMoveStart,Ue),this.terrain&&this._prepareElevation(fe),this._ease($e=>{if(this._zooming&&(p.zoom=l.interpolate.number(y,M,$e)),this._rotating&&(p.bearing=l.interpolate.number(b,R,$e)),this._pitching&&(p.pitch=l.interpolate.number(P,U,$e)),this._padding&&(p.interpolatePadding(C,V,$e),ue=p.centerPoint.add(X)),this.terrain&&!o.freezeElevation&&this._updateElevation($e),me)p.setLocationAtPoint(me,Ae);else{const Xe=p.zoomScale(p.zoom-y),tt=M>y?Math.min(2,De):Math.max(.5,De),Qe=Math.pow(tt,1-$e),ct=p.unproject(oe.add(Pe.mult($e*Qe)).mult(Xe));p.setLocationAtPoint(p.renderWorldCopies?ct.wrap():ct,ue)}this._applyUpdatedTransform(p),this._fireMoveEvents(d)},$e=>{this.terrain&&this._finalizeElevation(),this._afterEase(d,$e)},o),this}_prepareEase(o,d,p={}){this._moving=!0,d||p.moving||this.fire(new l.Event("movestart",o)),this._zooming&&!p.zooming&&this.fire(new l.Event("zoomstart",o)),this._rotating&&!p.rotating&&this.fire(new l.Event("rotatestart",o)),this._pitching&&!p.pitching&&this.fire(new l.Event("pitchstart",o))}_prepareElevation(o){this._elevationCenter=o,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(o,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(o){this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const d=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(o<1&&d!==this._elevationTarget){const p=this._elevationTarget-this._elevationStart;this._elevationStart+=o*(p-(d-(p*o+this._elevationStart))/(1-o)),this._elevationTarget=d}this.transform.elevation=l.interpolate.number(this._elevationStart,this._elevationTarget,o)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(o){if(!this.transformCameraUpdate)return;const d=o.clone(),{center:p,zoom:y,pitch:b,bearing:P,elevation:C}=this.transformCameraUpdate(d);p&&(d.center=p),y!==void 0&&(d.zoom=y),b!==void 0&&(d.pitch=b),P!==void 0&&(d.bearing=P),C!==void 0&&(d.elevation=C),this.transform.apply(d)}_fireMoveEvents(o){this.fire(new l.Event("move",o)),this._zooming&&this.fire(new l.Event("zoom",o)),this._rotating&&this.fire(new l.Event("rotate",o)),this._pitching&&this.fire(new l.Event("pitch",o))}_afterEase(o,d){if(this._easeId&&d&&this._easeId===d)return;delete this._easeId;const p=this._zooming,y=this._rotating,b=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new l.Event("zoomend",o)),y&&this.fire(new l.Event("rotateend",o)),b&&this.fire(new l.Event("pitchend",o)),this.fire(new l.Event("moveend",o))}flyTo(o,d){if(!o.essential&&l.browser.prefersReducedMotion){const Gt=l.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Gt,d)}this.stop(),o=l.extend({offset:[0,0],speed:1.2,curve:1.42,easing:l.defaultEasing},o);const p=this._getTransformForUpdate(),y=this.getZoom(),b=this.getBearing(),P=this.getPitch(),C=this.getPadding(),M="zoom"in o?l.clamp(+o.zoom,p.minZoom,p.maxZoom):y,R="bearing"in o?this._normalizeBearing(o.bearing,b):b,U="pitch"in o?+o.pitch:P,V="padding"in o?o.padding:p.padding,X=p.zoomScale(M-y),ue=l.Point.convert(o.offset);let le=p.centerPoint.add(ue);const fe=p.pointLocation(le),oe=l.LngLat.convert(o.center||fe);this._normalizeCenter(oe);const Pe=p.project(fe),De=p.project(oe).sub(Pe);let me=o.curve;const Ae=Math.max(p.width,p.height),Ue=Ae/X,$e=De.mag();if("minZoom"in o){const Gt=l.clamp(Math.min(o.minZoom,y,M),p.minZoom,p.maxZoom),Hn=Ae/p.zoomScale(Gt-y);me=Math.sqrt(Hn/$e*2)}const Xe=me*me;function tt(Gt){const Hn=(Ue*Ue-Ae*Ae+(Gt?-1:1)*Xe*Xe*$e*$e)/(2*(Gt?Ue:Ae)*Xe*$e);return Math.log(Math.sqrt(Hn*Hn+1)-Hn)}function Qe(Gt){return(Math.exp(Gt)-Math.exp(-Gt))/2}function ct(Gt){return(Math.exp(Gt)+Math.exp(-Gt))/2}const Vt=tt(!1);let An=function(Gt){return ct(Vt)/ct(Vt+me*Gt)},mt=function(Gt){return Ae*((ct(Vt)*(Qe(Hn=Vt+me*Gt)/ct(Hn))-Qe(Vt))/Xe)/$e;var Hn},cn=(tt(!0)-Vt)/me;if(Math.abs($e)<1e-6||!isFinite(cn)){if(Math.abs(Ae-Ue)<1e-6)return this.easeTo(o,d);const Gt=Ue<Ae?-1:1;cn=Math.abs(Math.log(Ue/Ae))/me,mt=function(){return 0},An=function(Hn){return Math.exp(Gt*me*Hn)}}return o.duration="duration"in o?+o.duration:1e3*cn/("screenSpeed"in o?+o.screenSpeed/me:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=b!==R,this._pitching=U!==P,this._padding=!p.isPaddingEqual(V),this._prepareEase(d,!1),this.terrain&&this._prepareElevation(oe),this._ease(Gt=>{const Hn=Gt*cn,Pn=1/An(Hn);p.zoom=Gt===1?M:y+p.scaleZoom(Pn),this._rotating&&(p.bearing=l.interpolate.number(b,R,Gt)),this._pitching&&(p.pitch=l.interpolate.number(P,U,Gt)),this._padding&&(p.interpolatePadding(C,V,Gt),le=p.centerPoint.add(ue)),this.terrain&&!o.freezeElevation&&this._updateElevation(Gt);const vn=Gt===1?oe:p.unproject(Pe.add(De.mult(mt(Hn))).mult(Pn));p.setLocationAtPoint(p.renderWorldCopies?vn.wrap():vn,le),this._applyUpdatedTransform(p),this._fireMoveEvents(d)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(d)},o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,d){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const p=this._onEaseEnd;delete this._onEaseEnd,p.call(this,d)}if(!o){const p=this.handlers;p&&p.stop(!1)}return this}_ease(o,d,p){p.animate===!1||p.duration===0?(o(1),d()):(this._easeStart=l.browser.now(),this._easeOptions=p,this._onEaseFrame=o,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(o,d){o=l.wrap(o,-180,180);const p=Math.abs(o-d);return Math.abs(o-360-d)<p&&(o-=360),Math.abs(o+360-d)<p&&(o+=360),o}_normalizeCenter(o){const d=this.transform;if(!d.renderWorldCopies||d.lngRange)return;const p=o.lng-d.center.lng;o.lng+=p>180?-360:p<-180?360:0}queryTerrainElevation(o){return this.terrain?this.terrain.getElevationForLngLatZoom(l.LngLat.convert(o),this.transform.tileZoom)-this.transform.elevation:null}}class fs{constructor(o={}){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=d=>{!d||d.sourceDataType!=="metadata"&&d.sourceDataType!=="visibility"&&d.dataType!=="style"&&d.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=o}getDefaultPosition(){return"bottom-right"}onAdd(o){return this._map=o,this._compact=this.options&&this.options.compact,this._container=_.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=_.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=_.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){_.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(o,d){const p=this._map._getUIString(`AttributionControl.${d}`);o.title=p,o.setAttribute("aria-label",p)}_updateAttributions(){if(!this._map.style)return;let o=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=o.concat(this.options.customAttribution.map(y=>typeof y!="string"?"":y)):typeof this.options.customAttribution=="string"&&o.push(this.options.customAttribution)),this._map.style.stylesheet){const y=this._map.style.stylesheet;this.styleOwner=y.owner,this.styleId=y.id}const d=this._map.style.sourceCaches;for(const y in d){const b=d[y];if(b.used||b.usedForTerrain){const P=b.getSource();P.attribution&&o.indexOf(P.attribution)<0&&o.push(P.attribution)}}o=o.filter(y=>String(y).trim()),o.sort((y,b)=>y.length-b.length),o=o.filter((y,b)=>{for(let P=b+1;P<o.length;P++)if(o[P].indexOf(y)>=0)return!1;return!0});const p=o.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,o.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class sr{constructor(o={}){this._updateCompact=()=>{const d=this._container.children;if(d.length){const p=d[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&p.classList.add("maplibregl-compact"):p.classList.remove("maplibregl-compact")}},this.options=o}getDefaultPosition(){return"bottom-left"}onAdd(o){this._map=o,this._compact=this.options&&this.options.compact,this._container=_.create("div","maplibregl-ctrl");const d=_.create("a","maplibregl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://maplibre.org/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){_.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class eh{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const d=++this._id;return this._queue.push({callback:o,id:d,cancelled:!1}),d}remove(o){const d=this._currentlyRunning,p=d?this._queue.concat(d):this._queue;for(const y of p)if(y.id===o)return void(y.cancelled=!0)}run(o=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const d=this._currentlyRunning=this._queue;this._queue=[];for(const p of d)if(!p.cancelled&&(p.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const hf={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var gg=l.createLayout([{name:"a_pos3d",type:"Int16",components:3}]);class yg extends l.Evented{constructor(o){super(),this.sourceCache=o,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,o.usedForTerrain=!0,o.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(o,d){this.sourceCache.update(o,d),this._renderableTilesKeys=[];const p={};for(const y of o.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:d}))p[y.key]=!0,this._renderableTilesKeys.push(y.key),this._tiles[y.key]||(y.posMatrix=new Float64Array(16),l.ortho(y.posMatrix,0,l.EXTENT,0,l.EXTENT,0,1),this._tiles[y.key]=new En(y,this.tileSize));for(const y in this._tiles)p[y]||delete this._tiles[y]}freeRtt(o){for(const d in this._tiles){const p=this._tiles[d];(!o||p.tileID.equals(o)||p.tileID.isChildOf(o)||o.isChildOf(p.tileID))&&(p.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(o=>this.getTileByID(o))}getTileByID(o){return this._tiles[o]}getTerrainCoords(o){const d={};for(const p of this._renderableTilesKeys){const y=this._tiles[p].tileID;if(y.canonical.equals(o.canonical)){const b=o.clone();b.posMatrix=new Float64Array(16),l.ortho(b.posMatrix,0,l.EXTENT,0,l.EXTENT,0,1),d[p]=b}else if(y.canonical.isChildOf(o.canonical)){const b=o.clone();b.posMatrix=new Float64Array(16);const P=y.canonical.z-o.canonical.z,C=y.canonical.x-(y.canonical.x>>P<<P),M=y.canonical.y-(y.canonical.y>>P<<P),R=l.EXTENT>>P;l.ortho(b.posMatrix,0,R,0,R,0,1),l.translate(b.posMatrix,b.posMatrix,[-C*R,-M*R,0]),d[p]=b}else if(o.canonical.isChildOf(y.canonical)){const b=o.clone();b.posMatrix=new Float64Array(16);const P=o.canonical.z-y.canonical.z,C=o.canonical.x-(o.canonical.x>>P<<P),M=o.canonical.y-(o.canonical.y>>P<<P),R=l.EXTENT>>P;l.ortho(b.posMatrix,0,l.EXTENT,0,l.EXTENT,0,1),l.translate(b.posMatrix,b.posMatrix,[C*R,M*R,0]),l.scale(b.posMatrix,b.posMatrix,[1/2**P,1/2**P,0]),d[p]=b}}return d}getSourceTile(o,d){const p=this.sourceCache._source;let y=o.overscaledZ-this.deltaZoom;if(y>p.maxzoom&&(y=p.maxzoom),y<p.minzoom)return null;this._sourceTileCache[o.key]||(this._sourceTileCache[o.key]=o.scaledTo(y).key);let b=this.sourceCache.getTileByID(this._sourceTileCache[o.key]);if((!b||!b.dem)&&d)for(;y>=p.minzoom&&(!b||!b.dem);)b=this.sourceCache.getTileByID(o.scaledTo(y--).key);return b}tilesAfterTime(o=Date.now()){return Object.values(this._tiles).filter(d=>d.timeAdded>=o)}}class _g{constructor(o,d,p){this.painter=o,this.sourceCache=new yg(d),this.options=p,this.exaggeration=typeof p.exaggeration=="number"?p.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(o,d,p,y=l.EXTENT){var b;if(!(d>=0&&d<y&&p>=0&&p<y))return 0;const P=this.getTerrainData(o),C=(b=P.tile)===null||b===void 0?void 0:b.dem;if(!C)return 0;const M=function(le,fe,oe){var Pe=fe[0],De=fe[1];return le[0]=oe[0]*Pe+oe[4]*De+oe[12],le[1]=oe[1]*Pe+oe[5]*De+oe[13],le}([],[d/y*l.EXTENT,p/y*l.EXTENT],P.u_terrain_matrix),R=[M[0]*C.dim,M[1]*C.dim],U=Math.floor(R[0]),V=Math.floor(R[1]),X=R[0]-U,ue=R[1]-V;return C.get(U,V)*(1-X)*(1-ue)+C.get(U+1,V)*X*(1-ue)+C.get(U,V+1)*(1-X)*ue+C.get(U+1,V+1)*X*ue}getElevationForLngLatZoom(o,d){const{tileID:p,mercatorX:y,mercatorY:b}=this._getOverscaledTileIDFromLngLatZoom(o,d);return this.getElevation(p,y%l.EXTENT,b%l.EXTENT,l.EXTENT)}getElevation(o,d,p,y=l.EXTENT){return this.getDEMElevation(o,d,p,y)*this.exaggeration}getTerrainData(o){if(!this._emptyDemTexture){const y=this.painter.context,b=new l.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new de(y,b,y.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new de(y,new l.RGBAImage({width:1,height:1}),y.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(y.gl.NEAREST,y.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=l.identity([])}const d=this.sourceCache.getSourceTile(o,!0);if(d&&d.dem&&(!d.demTexture||d.needsTerrainPrepare)){const y=this.painter.context;d.demTexture=this.painter.getTileTexture(d.dem.stride),d.demTexture?d.demTexture.update(d.dem.getPixels(),{premultiply:!1}):d.demTexture=new de(y,d.dem.getPixels(),y.gl.RGBA,{premultiply:!1}),d.demTexture.bind(y.gl.NEAREST,y.gl.CLAMP_TO_EDGE),d.needsTerrainPrepare=!1}const p=d&&d+d.tileID.key+o.key;if(p&&!this._demMatrixCache[p]){const y=this.sourceCache.sourceCache._source.maxzoom;let b=o.canonical.z-d.tileID.canonical.z;o.overscaledZ>o.canonical.z&&(o.canonical.z>=y?b=o.canonical.z-y:l.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const P=o.canonical.x-(o.canonical.x>>b<<b),C=o.canonical.y-(o.canonical.y>>b<<b),M=l.fromScaling(new Float64Array(16),[1/(l.EXTENT<<b),1/(l.EXTENT<<b),0]);l.translate(M,M,[P*l.EXTENT,C*l.EXTENT,0]),this._demMatrixCache[o.key]={matrix:M,coord:o}}return{u_depth:2,u_terrain:3,u_terrain_dim:d&&d.dem&&d.dem.dim||1,u_terrain_matrix:p?this._demMatrixCache[o.key].matrix:this._emptyDemMatrix,u_terrain_unpack:d&&d.dem&&d.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(d&&d.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:d}}getFramebuffer(o){const d=this.painter,p=d.width/devicePixelRatio,y=d.height/devicePixelRatio;return!this._fbo||this._fbo.width===p&&this._fbo.height===y||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new de(d.context,{width:p,height:y,data:null},d.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(d.context.gl.NEAREST,d.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new de(d.context,{width:p,height:y,data:null},d.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(d.context.gl.NEAREST,d.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=d.context.createFramebuffer(p,y,!0,!1),this._fbo.depthAttachment.set(d.context.createRenderbuffer(d.context.gl.DEPTH_COMPONENT16,p,y))),this._fbo.colorAttachment.set(o==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const o=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const d=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let b=0,P=0;b<this._coordsTextureSize;b++)for(let C=0;C<this._coordsTextureSize;C++,P+=4)d[P+0]=255&C,d[P+1]=255&b,d[P+2]=C>>8<<4|b>>8,d[P+3]=0;const p=new l.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(d.buffer)),y=new de(o,p,o.gl.RGBA,{premultiply:!1});return y.bind(o.gl.NEAREST,o.gl.CLAMP_TO_EDGE),this._coordsTexture=y,y}pointCoordinate(o){const d=new Uint8Array(4),p=this.painter.context,y=p.gl;p.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),y.readPixels(o.x,this.painter.height/devicePixelRatio-o.y-1,1,1,y.RGBA,y.UNSIGNED_BYTE,d),p.bindFramebuffer.set(null);const b=d[0]+(d[2]>>4<<8),P=d[1]+((15&d[2])<<8),C=this.coordsIndex[255-d[3]],M=C&&this.sourceCache.getTileByID(C);if(!M)return null;const R=this._coordsTextureSize,U=(1<<M.tileID.canonical.z)*R;return new l.MercatorCoordinate((M.tileID.canonical.x*R+b)/U,(M.tileID.canonical.y*R+P)/U,this.getElevation(M.tileID,b,P,R))}getTerrainMesh(){if(this._mesh)return this._mesh;const o=this.painter.context,d=new l.Pos3dArray,p=new l.TriangleIndexArray,y=this.meshSize,b=l.EXTENT/y,P=y*y;for(let V=0;V<=y;V++)for(let X=0;X<=y;X++)d.emplaceBack(X*b,V*b,0);for(let V=0;V<P;V+=y+1)for(let X=0;X<y;X++)p.emplaceBack(X+V,y+X+V+1,y+X+V+2),p.emplaceBack(X+V,y+X+V+2,X+V+1);const C=d.length,M=C+2*(y+1);for(const V of[0,1])for(let X=0;X<=y;X++)for(const ue of[0,1])d.emplaceBack(X*b,V*l.EXTENT,ue);for(let V=0;V<2*y;V+=2)p.emplaceBack(M+V,M+V+1,M+V+3),p.emplaceBack(M+V,M+V+3,M+V+2),p.emplaceBack(C+V,C+V+3,C+V+1),p.emplaceBack(C+V,C+V+2,C+V+3);const R=d.length,U=R+2*(y+1);for(const V of[0,1])for(let X=0;X<=y;X++)for(const ue of[0,1])d.emplaceBack(V*l.EXTENT,X*b,ue);for(let V=0;V<2*y;V+=2)p.emplaceBack(R+V,R+V+1,R+V+3),p.emplaceBack(R+V,R+V+3,R+V+2),p.emplaceBack(U+V,U+V+3,U+V+1),p.emplaceBack(U+V,U+V+2,U+V+3);return this._mesh={indexBuffer:o.createIndexBuffer(p),vertexBuffer:o.createVertexBuffer(d,gg.members),segments:l.SegmentVector.simpleSegment(0,0,d.length,p.length)},this._mesh}getMeshFrameDelta(o){return 2*Math.PI*l.earthRadius/Math.pow(2,o)/5}getMinTileElevationForLngLatZoom(o,d){var p;const{tileID:y}=this._getOverscaledTileIDFromLngLatZoom(o,d);return(p=this.getMinMaxElevation(y).minElevation)!==null&&p!==void 0?p:0}getMinMaxElevation(o){const d=this.getTerrainData(o).tile,p={minElevation:null,maxElevation:null};return d&&d.dem&&(p.minElevation=d.dem.min*this.exaggeration,p.maxElevation=d.dem.max*this.exaggeration),p}_getOverscaledTileIDFromLngLatZoom(o,d){const p=l.MercatorCoordinate.fromLngLat(o.wrap()),y=(1<<d)*l.EXTENT,b=p.x*y,P=p.y*y,C=Math.floor(b/l.EXTENT),M=Math.floor(P/l.EXTENT);return{tileID:new l.OverscaledTileID(d,0,d,C,M),mercatorX:b,mercatorY:P}}}class Nv{constructor(o,d,p){this._context=o,this._size=d,this._tileSize=p,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const o of this._objects)o.texture.destroy(),o.fbo.destroy()}_createObject(o){const d=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),p=new de(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return p.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),d.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),d.colorAttachment.set(p.texture),{id:o,fbo:d,texture:p,stamp:-1,inUse:!1}}getObjectForId(o){return this._objects[o]}useObject(o){o.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(d=>o.id!==d),this._recentlyUsed.push(o.id)}stampObject(o){o.stamp=++this._stamp}getOrCreateFreeObject(){for(const d of this._recentlyUsed)if(!this._objects[d].inUse)return this._objects[d];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const o=this._createObject(this._objects.length);return this._objects.push(o),o}freeObject(o){o.inUse=!1}freeAllObjects(){for(const o of this._objects)this.freeObject(o)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(o=>!o.inUse)===!1}}const Li={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class th{constructor(o,d){this.painter=o,this.terrain=d,this.pool=new Nv(o.context,30,d.sourceCache.tileSize*d.qualityFactor)}destruct(){this.pool.destruct()}getTexture(o){return this.pool.getObjectForId(o.rtt[this._stacks.length-1].id).texture}prepareForRender(o,d){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=o._order.filter(p=>!o._layers[p].isHidden(d)),this._coordsDescendingInv={};for(const p in o.sourceCaches){this._coordsDescendingInv[p]={};const y=o.sourceCaches[p].getVisibleCoordinates();for(const b of y){const P=this.terrain.sourceCache.getTerrainCoords(b);for(const C in P)this._coordsDescendingInv[p][C]||(this._coordsDescendingInv[p][C]=[]),this._coordsDescendingInv[p][C].push(P[C])}}this._coordsDescendingInvStr={};for(const p of o._order){const y=o._layers[p],b=y.source;if(Li[y.type]&&!this._coordsDescendingInvStr[b]){this._coordsDescendingInvStr[b]={};for(const P in this._coordsDescendingInv[b])this._coordsDescendingInvStr[b][P]=this._coordsDescendingInv[b][P].map(C=>C.key).sort().join()}}for(const p of this._renderableTiles)for(const y in this._coordsDescendingInvStr){const b=this._coordsDescendingInvStr[y][p.tileID.key];b&&b!==p.rttCoords[y]&&(p.rtt=[])}}renderLayer(o){if(o.isHidden(this.painter.transform.zoom))return!1;const d=o.type,p=this.painter,y=this._renderableLayerIds[this._renderableLayerIds.length-1]===o.id;if(Li[d]&&(this._prevType&&Li[this._prevType]||this._stacks.push([]),this._prevType=d,this._stacks[this._stacks.length-1].push(o.id),!y))return!0;if(Li[this._prevType]||Li[d]&&y){this._prevType=d;const b=this._stacks.length-1,P=this._stacks[b]||[];for(const C of this._renderableTiles){if(this.pool.isFull()&&(br(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(C),C.rtt[b]){const R=this.pool.getObjectForId(C.rtt[b].id);if(R.stamp===C.rtt[b].stamp){this.pool.useObject(R);continue}}const M=this.pool.getOrCreateFreeObject();this.pool.useObject(M),this.pool.stampObject(M),C.rtt[b]={id:M.id,stamp:M.stamp},p.context.bindFramebuffer.set(M.fbo.framebuffer),p.context.clear({color:l.Color.transparent,stencil:0}),p.currentStencilSource=void 0;for(let R=0;R<P.length;R++){const U=p.style._layers[P[R]],V=U.source?this._coordsDescendingInv[U.source][C.tileID.key]:[C.tileID];p.context.viewport.set([0,0,M.fbo.width,M.fbo.height]),p._renderTileClippingMasks(U,V),p.renderLayer(p,p.style.sourceCaches[U.source],U,V),U.source&&(C.rttCoords[U.source]=this._coordsDescendingInvStr[U.source][C.tileID.key])}}return br(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Li[d]}return!1}}const Xt=m,ln={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:l.config.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},Bc=v=>{v.touchstart=v.dragStart,v.touchmoveWindow=v.dragMove,v.touchend=v.dragEnd},df={showCompass:!0,showZoom:!0,visualizePitch:!1};class ff{constructor(o,d,p=!1){this.mousedown=P=>{this.startMouse(l.extend({},P,{ctrlKey:!0,preventDefault:()=>P.preventDefault()}),_.mousePos(this.element,P)),_.addEventListener(window,"mousemove",this.mousemove),_.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=P=>{this.moveMouse(P,_.mousePos(this.element,P))},this.mouseup=P=>{this.mouseRotate.dragEnd(P),this.mousePitch&&this.mousePitch.dragEnd(P),this.offTemp()},this.touchstart=P=>{P.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=_.touchPos(this.element,P.targetTouches)[0],this.startTouch(P,this._startPos),_.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),_.addEventListener(window,"touchend",this.touchend))},this.touchmove=P=>{P.targetTouches.length!==1?this.reset():(this._lastPos=_.touchPos(this.element,P.targetTouches)[0],this.moveTouch(P,this._lastPos))},this.touchend=P=>{P.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const y=o.dragRotate._mouseRotate.getClickTolerance(),b=o.dragRotate._mousePitch.getClickTolerance();this.element=d,this.mouseRotate=Il({clickTolerance:y,enable:!0}),this.touchRotate=(({enable:P,clickTolerance:C,bearingDegreesPerPixelMoved:M=.8})=>{const R=new ug;return new Vo({clickTolerance:C,move:(U,V)=>({bearingDelta:(V.x-U.x)*M}),moveStateManager:R,enable:P,assignEvents:Bc})})({clickTolerance:y,enable:!0}),this.map=o,p&&(this.mousePitch=jo({clickTolerance:b,enable:!0}),this.touchPitch=(({enable:P,clickTolerance:C,pitchDegreesPerPixelMoved:M=-.5})=>{const R=new ug;return new Vo({clickTolerance:C,move:(U,V)=>({pitchDelta:(V.y-U.y)*M}),moveStateManager:R,enable:P,assignEvents:Bc})})({clickTolerance:b,enable:!0})),_.addEventListener(d,"mousedown",this.mousedown),_.addEventListener(d,"touchstart",this.touchstart,{passive:!1}),_.addEventListener(d,"touchcancel",this.reset)}startMouse(o,d){this.mouseRotate.dragStart(o,d),this.mousePitch&&this.mousePitch.dragStart(o,d),_.disableDrag()}startTouch(o,d){this.touchRotate.dragStart(o,d),this.touchPitch&&this.touchPitch.dragStart(o,d),_.disableDrag()}moveMouse(o,d){const p=this.map,{bearingDelta:y}=this.mouseRotate.dragMove(o,d)||{};if(y&&p.setBearing(p.getBearing()+y),this.mousePitch){const{pitchDelta:b}=this.mousePitch.dragMove(o,d)||{};b&&p.setPitch(p.getPitch()+b)}}moveTouch(o,d){const p=this.map,{bearingDelta:y}=this.touchRotate.dragMove(o,d)||{};if(y&&p.setBearing(p.getBearing()+y),this.touchPitch){const{pitchDelta:b}=this.touchPitch.dragMove(o,d)||{};b&&p.setPitch(p.getPitch()+b)}}off(){const o=this.element;_.removeEventListener(o,"mousedown",this.mousedown),_.removeEventListener(o,"touchstart",this.touchstart,{passive:!1}),_.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),_.removeEventListener(window,"touchend",this.touchend),_.removeEventListener(o,"touchcancel",this.reset),this.offTemp()}offTemp(){_.enableDrag(),_.removeEventListener(window,"mousemove",this.mousemove),_.removeEventListener(window,"mouseup",this.mouseup),_.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),_.removeEventListener(window,"touchend",this.touchend)}}let Dr;function pf(v,o,d){if(v=new l.LngLat(v.lng,v.lat),o){const p=new l.LngLat(v.lng-360,v.lat),y=new l.LngLat(v.lng+360,v.lat),b=d.locationPoint(v).distSqr(o);d.locationPoint(p).distSqr(o)<b?v=p:d.locationPoint(y).distSqr(o)<b&&(v=y)}for(;Math.abs(v.lng-d.center.lng)>180;){const p=d.locationPoint(v);if(p.x>=0&&p.y>=0&&p.x<=d.width&&p.y<=d.height)break;v.lng>d.center.lng?v.lng-=360:v.lng+=360}return v}const As={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function vg(v,o,d){const p=v.classList;for(const y in As)p.remove(`maplibregl-${d}-anchor-${y}`);p.add(`maplibregl-${d}-anchor-${o}`)}class Ua extends l.Evented{constructor(o){if(super(),this._onKeyPress=d=>{const p=d.code,y=d.charCode||d.keyCode;p!=="Space"&&p!=="Enter"&&y!==32&&y!==13||this.togglePopup()},this._onMapClick=d=>{const p=d.originalEvent.target,y=this._element;this._popup&&(p===y||y.contains(p))&&this.togglePopup()},this._update=d=>{if(!this._map)return;const p=this._map.loaded()&&!this._map.isMoving();((d==null?void 0:d.type)==="terrain"||(d==null?void 0:d.type)==="render"&&!p)&&this._map.once("render",this._update),this._map.transform.renderWorldCopies&&(this._lngLat=pf(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let y="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?y=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(y=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let b="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?b="rotateX(0deg)":this._pitchAlignment==="map"&&(b=`rotateX(${this._map.getPitch()}deg)`),d&&d.type!=="moveend"||(this._pos=this._pos.round()),_.setTransform(this._element,`${As[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${b} ${y}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const P=this._map.unproject(this._pos),C=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=P.distanceTo(this._lngLat)>20*C?"0.2":"1.0",this._opacityTimeout=null},100))},this._onMove=d=>{if(!this._isDragging){const p=this._clickTolerance||this._map._clickTolerance;this._isDragging=d.point.dist(this._pointerdownPos)>=p}this._isDragging&&(this._pos=d.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new l.Event("dragstart"))),this.fire(new l.Event("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new l.Event("dragend")),this._state="inactive"},this._addDragHandler=d=>{this._element.contains(d.originalEvent.target)&&(d.preventDefault(),this._positionDelta=d.point.sub(this._pos).add(this._offset),this._pointerdownPos=d.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,o&&o.element)this._element=o.element,this._offset=l.Point.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=_.create("div"),this._element.setAttribute("aria-label","Map marker");const d=_.createNS("http://www.w3.org/2000/svg","svg"),p=41,y=27;d.setAttributeNS(null,"display","block"),d.setAttributeNS(null,"height",`${p}px`),d.setAttributeNS(null,"width",`${y}px`),d.setAttributeNS(null,"viewBox",`0 0 ${y} ${p}`);const b=_.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"stroke","none"),b.setAttributeNS(null,"stroke-width","1"),b.setAttributeNS(null,"fill","none"),b.setAttributeNS(null,"fill-rule","evenodd");const P=_.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"fill-rule","nonzero");const C=_.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"transform","translate(3.0, 29.0)"),C.setAttributeNS(null,"fill","#000000");const M=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Pe of M){const De=_.createNS("http://www.w3.org/2000/svg","ellipse");De.setAttributeNS(null,"opacity","0.04"),De.setAttributeNS(null,"cx","10.5"),De.setAttributeNS(null,"cy","5.80029008"),De.setAttributeNS(null,"rx",Pe.rx),De.setAttributeNS(null,"ry",Pe.ry),C.appendChild(De)}const R=_.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"fill",this._color);const U=_.createNS("http://www.w3.org/2000/svg","path");U.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),R.appendChild(U);const V=_.createNS("http://www.w3.org/2000/svg","g");V.setAttributeNS(null,"opacity","0.25"),V.setAttributeNS(null,"fill","#000000");const X=_.createNS("http://www.w3.org/2000/svg","path");X.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),V.appendChild(X);const ue=_.createNS("http://www.w3.org/2000/svg","g");ue.setAttributeNS(null,"transform","translate(6.0, 7.0)"),ue.setAttributeNS(null,"fill","#FFFFFF");const le=_.createNS("http://www.w3.org/2000/svg","g");le.setAttributeNS(null,"transform","translate(8.0, 8.0)");const fe=_.createNS("http://www.w3.org/2000/svg","circle");fe.setAttributeNS(null,"fill","#000000"),fe.setAttributeNS(null,"opacity","0.25"),fe.setAttributeNS(null,"cx","5.5"),fe.setAttributeNS(null,"cy","5.5"),fe.setAttributeNS(null,"r","5.4999962");const oe=_.createNS("http://www.w3.org/2000/svg","circle");oe.setAttributeNS(null,"fill","#FFFFFF"),oe.setAttributeNS(null,"cx","5.5"),oe.setAttributeNS(null,"cy","5.5"),oe.setAttributeNS(null,"r","5.4999962"),le.appendChild(fe),le.appendChild(oe),P.appendChild(C),P.appendChild(R),P.appendChild(V),P.appendChild(ue),P.appendChild(le),d.appendChild(P),d.setAttributeNS(null,"height",p*this._scale+"px"),d.setAttributeNS(null,"width",y*this._scale+"px"),this._element.appendChild(d),this._offset=l.Point.convert(o&&o.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",d=>{d.preventDefault()}),this._element.addEventListener("mousedown",d=>{d.preventDefault()}),vg(this._element,this._anchor,"marker"),o&&o.className)for(const d of o.className.split(" "))this._element.classList.add(d);this._popup=null}addTo(o){return this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),o.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),_.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=l.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const y=Math.abs(13.5)/Math.SQRT2;o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[y,-1*(38.1-13.5+y)],"bottom-right":[-y,-1*(38.1-13.5+y)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?o.remove():o.addTo(this._map),this):this}getOffset(){return this._offset}setOffset(o){return this._offset=l.Point.convert(o),this._update(),this}addClassName(o){this._element.classList.add(o)}removeClassName(o){this._element.classList.remove(o)}toggleClassName(o){return this._element.classList.toggle(o)}setDraggable(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const wr={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let yr=0,kl=!1;const Uc={maxWidth:100,unit:"metric"};function Vc(v,o,d){const p=d&&d.maxWidth||100,y=v._container.clientHeight/2,b=v.unproject([0,y]),P=v.unproject([p,y]),C=b.distanceTo(P);if(d&&d.unit==="imperial"){const M=3.2808*C;M>5280?Va(o,p,M/5280,v._getUIString("ScaleControl.Miles")):Va(o,p,M,v._getUIString("ScaleControl.Feet"))}else d&&d.unit==="nautical"?Va(o,p,C/1852,v._getUIString("ScaleControl.NauticalMiles")):C>=1e3?Va(o,p,C/1e3,v._getUIString("ScaleControl.Kilometers")):Va(o,p,C,v._getUIString("ScaleControl.Meters"))}function Va(v,o,d,p){const y=function(b){const P=Math.pow(10,`${Math.floor(b)}`.length-1);let C=b/P;return C=C>=10?10:C>=5?5:C>=3?3:C>=2?2:C>=1?1:function(M){const R=Math.pow(10,Math.ceil(-Math.log(M)/Math.LN10));return Math.round(M*R)/R}(C),P*C}(d);v.style.width=o*(y/d)+"px",v.innerHTML=`${y}&nbsp;${p}`}const mf={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},gf=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ll(v){if(v){if(typeof v=="number"){const o=Math.round(Math.abs(v)/Math.SQRT2);return{center:new l.Point(0,0),top:new l.Point(0,v),"top-left":new l.Point(o,o),"top-right":new l.Point(-o,o),bottom:new l.Point(0,-v),"bottom-left":new l.Point(o,-o),"bottom-right":new l.Point(-o,-o),left:new l.Point(v,0),right:new l.Point(-v,0)}}if(v instanceof l.Point||Array.isArray(v)){const o=l.Point.convert(v);return{center:o,top:o,"top-left":o,"top-right":o,bottom:o,"bottom-left":o,"bottom-right":o,left:o,right:o}}return{center:l.Point.convert(v.center||[0,0]),top:l.Point.convert(v.top||[0,0]),"top-left":l.Point.convert(v["top-left"]||[0,0]),"top-right":l.Point.convert(v["top-right"]||[0,0]),bottom:l.Point.convert(v.bottom||[0,0]),"bottom-left":l.Point.convert(v["bottom-left"]||[0,0]),"bottom-right":l.Point.convert(v["bottom-right"]||[0,0]),left:l.Point.convert(v.left||[0,0]),right:l.Point.convert(v.right||[0,0])}}return Ll(new l.Point(0,0))}const yf={extend:(v,...o)=>l.extend(v,...o),run(v){v()},logToElement(v,o=!1,d="log"){const p=window.document.getElementById(d);p&&(o&&(p.innerHTML=""),p.innerHTML+=`<br>${v}`)}},_f=m;class Vn{static get version(){return _f}static get workerCount(){return st.workerCount}static set workerCount(o){st.workerCount=o}static get maxParallelImageRequests(){return l.config.MAX_PARALLEL_IMAGE_REQUESTS}static set maxParallelImageRequests(o){l.config.MAX_PARALLEL_IMAGE_REQUESTS=o}static get workerUrl(){return l.config.WORKER_URL}static set workerUrl(o){l.config.WORKER_URL=o}static addProtocol(o,d){l.config.REGISTERED_PROTOCOLS[o]=d}static removeProtocol(o){delete l.config.REGISTERED_PROTOCOLS[o]}}return Vn.Map=class extends mg{constructor(v){if(l.PerformanceUtils.mark(l.PerformanceMarkers.create),(v=l.extend({},ln,v)).minZoom!=null&&v.maxZoom!=null&&v.minZoom>v.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(v.minPitch!=null&&v.maxPitch!=null&&v.minPitch>v.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(v.minPitch!=null&&v.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(v.maxPitch!=null&&v.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Yu(v.minZoom,v.maxZoom,v.minPitch,v.maxPitch,v.renderWorldCopies),{bearingSnap:v.bearingSnap}),this._cooperativeGesturesOnWheel=o=>{this._onCooperativeGesture(o,o[this._metaKey],1)},this._contextLost=o=>{o.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new l.Event("webglcontextlost",{originalEvent:o}))},this._contextRestored=o=>{this._setupPainter(),this.resize(),this._update(),this.fire(new l.Event("webglcontextrestored",{originalEvent:o}))},this._onMapScroll=o=>{if(o.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=v.interactive,this._cooperativeGestures=v.cooperativeGestures,this._metaKey=navigator.platform.indexOf("Mac")===0?"metaKey":"ctrlKey",this._maxTileCacheSize=v.maxTileCacheSize,this._maxTileCacheZoomLevels=v.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=v.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=v.preserveDrawingBuffer,this._antialias=v.antialias,this._trackResize=v.trackResize,this._bearingSnap=v.bearingSnap,this._refreshExpiredTiles=v.refreshExpiredTiles,this._fadeDuration=v.fadeDuration,this._crossSourceCollisions=v.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=v.collectResourceTiming,this._renderTaskQueue=new eh,this._controls=[],this._mapId=l.uniqueId(),this._locale=l.extend({},hf,v.locale),this._clickTolerance=v.clickTolerance,this._overridePixelRatio=v.pixelRatio,this._maxCanvasSize=v.maxCanvasSize,this.transformCameraUpdate=v.transformCameraUpdate,this._imageQueueHandle=H.addThrottleControl(()=>this.isMoving()),this._requestManager=new N(v.transformRequest),typeof v.container=="string"){if(this._container=document.getElementById(v.container),!this._container)throw new Error(`Container '${v.container}' not found.`)}else{if(!(v.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=v.container}if(v.maxBounds&&this.setMaxBounds(v.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let o=!1;const d=Ba(p=>{this._trackResize&&!this._removed&&this.resize(p)._update()},50);this._resizeObserver=new ResizeObserver(p=>{o?d(p):o=!0}),this._resizeObserver.observe(this._container)}this.handlers=new uf(this,v),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=v.hash&&new Oc(typeof v.hash=="string"&&v.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:v.center,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch}),v.bounds&&(this.resize(),this.fitBounds(v.bounds,l.extend({},v.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=v.localIdeographFontFamily,this._validateStyle=v.validateStyle,v.style&&this.setStyle(v.style,{localIdeographFontFamily:v.localIdeographFontFamily}),v.attributionControl&&this.addControl(new fs({customAttribution:v.customAttribution})),v.maplibreLogo&&this.addControl(new sr,v.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",o=>{this._update(o.dataType==="style"),this.fire(new l.Event(`${o.dataType}data`,o))}),this.on("dataloading",o=>{this.fire(new l.Event(`${o.dataType}dataloading`,o))}),this.on("dataabort",o=>{this.fire(new l.Event("sourcedataabort",o))})}_getMapId(){return this._mapId}addControl(v,o){if(o===void 0&&(o=v.getDefaultPosition?v.getDefaultPosition():"top-right"),!v||!v.onAdd)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const d=v.onAdd(this);this._controls.push(v);const p=this._controlPositions[o];return o.indexOf("bottom")!==-1?p.insertBefore(d,p.firstChild):p.appendChild(d),this}removeControl(v){if(!v||!v.onRemove)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(v);return o>-1&&this._controls.splice(o,1),v.onRemove(this),this}hasControl(v){return this._controls.indexOf(v)>-1}calculateCameraOptionsFromTo(v,o,d,p){return p==null&&this.terrain&&(p=this.terrain.getElevationForLngLatZoom(d,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(v,o,d,p)}resize(v){var o;const d=this._containerDimensions(),p=d[0],y=d[1],b=this._getClampedPixelRatio(p,y);if(this._resizeCanvas(p,y,b),this.painter.resize(p,y,b),this.painter.overLimit()){const C=this.painter.context.gl;this._maxCanvasSize=[C.drawingBufferWidth,C.drawingBufferHeight];const M=this._getClampedPixelRatio(p,y);this._resizeCanvas(p,y,M),this.painter.resize(p,y,M)}this.transform.resize(p,y),(o=this._requestedCameraState)===null||o===void 0||o.resize(p,y);const P=!this._moving;return P&&(this.stop(),this.fire(new l.Event("movestart",v)).fire(new l.Event("move",v))),this.fire(new l.Event("resize",v)),P&&this.fire(new l.Event("moveend",v)),this}_getClampedPixelRatio(v,o){const{0:d,1:p}=this._maxCanvasSize,y=this.getPixelRatio(),b=v*y,P=o*y;return Math.min(b>d?d/b:1,P>p?p/P:1)*y}getPixelRatio(){var v;return(v=this._overridePixelRatio)!==null&&v!==void 0?v:devicePixelRatio}setPixelRatio(v){this._overridePixelRatio=v,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(v){return this.transform.setMaxBounds(yt.convert(v)),this._update()}setMinZoom(v){if((v=v??-2)>=-2&&v<=this.transform.maxZoom)return this.transform.minZoom=v,this._update(),this.getZoom()<v&&this.setZoom(v),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(v){if((v=v??22)>=this.transform.minZoom)return this.transform.maxZoom=v,this._update(),this.getZoom()>v&&this.setZoom(v),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(v){if((v=v??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(v>=0&&v<=this.transform.maxPitch)return this.transform.minPitch=v,this._update(),this.getPitch()<v&&this.setPitch(v),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(v){if((v=v??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(v>=this.transform.minPitch)return this.transform.maxPitch=v,this._update(),this.getPitch()>v&&this.setPitch(v),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(v){return this.transform.renderWorldCopies=v,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(v){return this._cooperativeGestures=v,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(v){return this.transform.locationPoint(l.LngLat.convert(v),this.style&&this.terrain)}unproject(v){return this.transform.pointLocation(l.Point.convert(v),this.terrain)}isMoving(){var v;return this._moving||((v=this.handlers)===null||v===void 0?void 0:v.isMoving())}isZooming(){var v;return this._zooming||((v=this.handlers)===null||v===void 0?void 0:v.isZooming())}isRotating(){var v;return this._rotating||((v=this.handlers)===null||v===void 0?void 0:v.isRotating())}_createDelegatedListener(v,o,d){if(v==="mouseenter"||v==="mouseover"){let p=!1;return{layer:o,listener:d,delegates:{mousemove:b=>{const P=this.getLayer(o)?this.queryRenderedFeatures(b.point,{layers:[o]}):[];P.length?p||(p=!0,d.call(this,new ds(v,this,b.originalEvent,{features:P}))):p=!1},mouseout:()=>{p=!1}}}}if(v==="mouseleave"||v==="mouseout"){let p=!1;return{layer:o,listener:d,delegates:{mousemove:P=>{(this.getLayer(o)?this.queryRenderedFeatures(P.point,{layers:[o]}):[]).length?p=!0:p&&(p=!1,d.call(this,new ds(v,this,P.originalEvent)))},mouseout:P=>{p&&(p=!1,d.call(this,new ds(v,this,P.originalEvent)))}}}}{const p=y=>{const b=this.getLayer(o)?this.queryRenderedFeatures(y.point,{layers:[o]}):[];b.length&&(y.features=b,d.call(this,y),delete y.features)};return{layer:o,listener:d,delegates:{[v]:p}}}}on(v,o,d){if(d===void 0)return super.on(v,o);const p=this._createDelegatedListener(v,o,d);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[v]=this._delegatedListeners[v]||[],this._delegatedListeners[v].push(p);for(const y in p.delegates)this.on(y,p.delegates[y]);return this}once(v,o,d){if(d===void 0)return super.once(v,o);const p=this._createDelegatedListener(v,o,d);for(const y in p.delegates)this.once(y,p.delegates[y]);return this}off(v,o,d){return d===void 0?super.off(v,o):(this._delegatedListeners&&this._delegatedListeners[v]&&(p=>{const y=this._delegatedListeners[v];for(let b=0;b<y.length;b++){const P=y[b];if(P.layer===o&&P.listener===d){for(const C in P.delegates)this.off(C,P.delegates[C]);return y.splice(b,1),this}}})(),this)}queryRenderedFeatures(v,o){if(!this.style)return[];let d;const p=v instanceof l.Point||Array.isArray(v),y=p?v:[[0,0],[this.transform.width,this.transform.height]];if(o=o||(p?{}:v)||{},y instanceof l.Point||typeof y[0]=="number")d=[l.Point.convert(y)];else{const b=l.Point.convert(y[0]),P=l.Point.convert(y[1]);d=[b,new l.Point(P.x,b.y),P,new l.Point(b.x,P.y),b]}return this.style.queryRenderedFeatures(d,o,this.transform)}querySourceFeatures(v,o){return this.style.querySourceFeatures(v,o)}setStyle(v,o){return(o=l.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},o)).diff!==!1&&o.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&v?(this._diffStyle(v,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._updateStyle(v,o))}setTransformRequest(v){return this._requestManager.setTransformRequest(v),this}_getUIString(v){const o=this._locale[v];if(o==null)throw new Error(`Missing UI string '${v}'`);return o}_updateStyle(v,o){if(o.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(v,o));const d=this.style&&o.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!v)),v?(this.style=new Zn(this,o||{}),this.style.setEventedParent(this,{style:this.style}),typeof v=="string"?this.style.loadURL(v,o,d):this.style.loadJSON(v,o,d),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Zn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(v,o){if(typeof v=="string"){const d=this._requestManager.transformRequest(v,z.Style);l.getJSON(d,(p,y)=>{p?this.fire(new l.ErrorEvent(p)):y&&this._updateDiff(y,o)})}else typeof v=="object"&&this._updateDiff(v,o)}_updateDiff(v,o){try{this.style.setState(v,o)&&this._update(!0)}catch(d){l.warnOnce(`Unable to perform style diff: ${d.message||d.error||d}.  Rebuilding the style from scratch.`),this._updateStyle(v,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():l.warnOnce("There is no style added to the map.")}addSource(v,o){return this._lazyInitEmptyStyle(),this.style.addSource(v,o),this._update(!0)}isSourceLoaded(v){const o=this.style&&this.style.sourceCaches[v];if(o!==void 0)return o.loaded();this.fire(new l.ErrorEvent(new Error(`There is no source with ID '${v}'`)))}setTerrain(v){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),v){const o=this.style.sourceCaches[v.source];if(!o)throw new Error(`cannot load terrain, because there exists no source with ID: ${v.source}`);for(const d in this.style._layers){const p=this.style._layers[d];p.type==="hillshade"&&p.source===v.source&&l.warnOnce("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new _g(this.painter,o,v),this.painter.renderToTexture=new th(this.painter,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=d=>{d.dataType==="style"?this.terrain.sourceCache.freeRtt():d.dataType==="source"&&d.tile&&(d.sourceId!==v.source||this._elevationFreeze||(this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(d.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0;return this.fire(new l.Event("terrain",{terrain:v})),this}getTerrain(){var v,o;return(o=(v=this.terrain)===null||v===void 0?void 0:v.options)!==null&&o!==void 0?o:null}areTilesLoaded(){const v=this.style&&this.style.sourceCaches;for(const o in v){const d=v[o]._tiles;for(const p in d){const y=d[p];if(y.state!=="loaded"&&y.state!=="errored")return!1}}return!0}addSourceType(v,o,d){return this._lazyInitEmptyStyle(),this.style.addSourceType(v,o,d)}removeSource(v){return this.style.removeSource(v),this._update(!0)}getSource(v){return this.style.getSource(v)}addImage(v,o,d={}){const{pixelRatio:p=1,sdf:y=!1,stretchX:b,stretchY:P,content:C}=d;if(this._lazyInitEmptyStyle(),!(o instanceof HTMLImageElement||l.isImageBitmap(o))){if(o.width===void 0||o.height===void 0)return this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:M,height:R,data:U}=o,V=o;return this.style.addImage(v,{data:new l.RGBAImage({width:M,height:R},new Uint8Array(U)),pixelRatio:p,stretchX:b,stretchY:P,content:C,sdf:y,version:0,userImage:V}),V.onAdd&&V.onAdd(this,v),this}}{const{width:M,height:R,data:U}=l.browser.getImageData(o);this.style.addImage(v,{data:new l.RGBAImage({width:M,height:R},U),pixelRatio:p,stretchX:b,stretchY:P,content:C,sdf:y,version:0})}}updateImage(v,o){const d=this.style.getImage(v);if(!d)return this.fire(new l.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=o instanceof HTMLImageElement||l.isImageBitmap(o)?l.browser.getImageData(o):o,{width:y,height:b,data:P}=p;if(y===void 0||b===void 0)return this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(y!==d.data.width||b!==d.data.height)return this.fire(new l.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const C=!(o instanceof HTMLImageElement||l.isImageBitmap(o));return d.data.replace(P,C),this.style.updateImage(v,d),this}getImage(v){return this.style.getImage(v)}hasImage(v){return v?!!this.style.getImage(v):(this.fire(new l.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(v){this.style.removeImage(v)}loadImage(v,o){H.getImage(this._requestManager.transformRequest(v,z.Image),o)}listImages(){return this.style.listImages()}addLayer(v,o){return this._lazyInitEmptyStyle(),this.style.addLayer(v,o),this._update(!0)}moveLayer(v,o){return this.style.moveLayer(v,o),this._update(!0)}removeLayer(v){return this.style.removeLayer(v),this._update(!0)}getLayer(v){return this.style.getLayer(v)}setLayerZoomRange(v,o,d){return this.style.setLayerZoomRange(v,o,d),this._update(!0)}setFilter(v,o,d={}){return this.style.setFilter(v,o,d),this._update(!0)}getFilter(v){return this.style.getFilter(v)}setPaintProperty(v,o,d,p={}){return this.style.setPaintProperty(v,o,d,p),this._update(!0)}getPaintProperty(v,o){return this.style.getPaintProperty(v,o)}setLayoutProperty(v,o,d,p={}){return this.style.setLayoutProperty(v,o,d,p),this._update(!0)}getLayoutProperty(v,o){return this.style.getLayoutProperty(v,o)}setGlyphs(v,o={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(v,o),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(v,o,d={}){return this._lazyInitEmptyStyle(),this.style.addSprite(v,o,d,p=>{p||this._update(!0)}),this}removeSprite(v){return this._lazyInitEmptyStyle(),this.style.removeSprite(v),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(v,o={}){return this._lazyInitEmptyStyle(),this.style.setSprite(v,o,d=>{d||this._update(!0)}),this}setLight(v,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(v,o),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(v,o){return this.style.setFeatureState(v,o),this._update()}removeFeatureState(v,o){return this.style.removeFeatureState(v,o),this._update()}getFeatureState(v){return this.style.getFeatureState(v)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let v=0,o=0;return this._container&&(v=this._container.clientWidth||400,o=this._container.clientHeight||300),[v,o]}_setupContainer(){const v=this._container;v.classList.add("maplibregl-map");const o=this._canvasContainer=_.create("div","maplibregl-canvas-container",v);this._interactive&&o.classList.add("maplibregl-interactive"),this._canvas=_.create("canvas","maplibregl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const d=this._containerDimensions(),p=this._getClampedPixelRatio(d[0],d[1]);this._resizeCanvas(d[0],d[1],p);const y=this._controlContainer=_.create("div","maplibregl-control-container",v),b=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(P=>{b[P]=_.create("div",`maplibregl-ctrl-${P} `,y)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=_.create("div","maplibregl-cooperative-gesture-screen",this._container);let v=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(v=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use ⌘ + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${v}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,this._cooperativeGesturesScreen.setAttribute("aria-hidden","true"),this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){_.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(v,o,d){this._canvas.width=Math.floor(d*v),this._canvas.height=Math.floor(d*o),this._canvas.style.width=`${v}px`,this._canvas.style.height=`${o}px`}_setupPainter(){const v={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let o=null;this._canvas.addEventListener("webglcontextcreationerror",p=>{o={requestedAttributes:v},p&&(o.statusMessage=p.statusMessage,o.type=p.type)},{once:!0});const d=this._canvas.getContext("webgl2",v)||this._canvas.getContext("webgl",v);if(!d){const p="Failed to initialize WebGL";throw o?(o.message=p,new Error(JSON.stringify(o))):new Error(p)}this.painter=new Na(d,this.transform),E.testSupport(d)}_onCooperativeGesture(v,o,d){return!o&&d<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(v){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||v,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(v){return this._update(),this._renderTaskQueue.add(v)}_cancelRenderFrame(v){this._renderTaskQueue.remove(v)}_render(v){const o=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(v),this._removed)return;let d=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const y=this.transform.zoom,b=l.browser.now();this.style.zoomHistory.update(y,b);const P=new l.EvaluationParameters(y,{now:b,fadeDuration:o,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),C=P.crossFadingFactor();C===1&&C===this._crossFadingFactor||(d=!0,this._crossFadingFactor=C),this.style.update(P)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,o,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:o,showPadding:this.showPadding}),this.fire(new l.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,l.PerformanceUtils.mark(l.PerformanceMarkers.load),this.fire(new l.Event("load"))),this.style&&(this.style.hasTransitions()||d)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const p=this._sourcesDirty||this._styleDirty||this._placementDirty;return p||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new l.Event("idle")),!this._loaded||this._fullyLoaded||p||(this._fullyLoaded=!0,l.PerformanceUtils.mark(l.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var v;this._hash&&this._hash.remove();for(const d of this._controls)d.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),H.removeThrottleControl(this._imageQueueHandle),(v=this._resizeObserver)===null||v===void 0||v.disconnect();const o=this.painter.context.gl.getExtension("WEBGL_lose_context");o&&o.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),_.remove(this._canvasContainer),_.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),l.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new l.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=l.browser.frame(v=>{l.PerformanceUtils.frame(v),this._frame=null,this._render(v)}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(v){this._showTileBoundaries!==v&&(this._showTileBoundaries=v,this._update())}get showPadding(){return!!this._showPadding}set showPadding(v){this._showPadding!==v&&(this._showPadding=v,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(v){this._showCollisionBoxes!==v&&(this._showCollisionBoxes=v,v?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(v){this._showOverdrawInspector!==v&&(this._showOverdrawInspector=v,this._update())}get repaint(){return!!this._repaint}set repaint(v){this._repaint!==v&&(this._repaint=v,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(v){this._vertices=v,this._update()}get version(){return Xt}getCameraTargetElevation(){return this.transform.elevation}},Vn.NavigationControl=class{constructor(v){this._updateZoomButtons=()=>{const o=this._map.getZoom(),d=o===this._map.getMaxZoom(),p=o===this._map.getMinZoom();this._zoomInButton.disabled=d,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",d.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())},this._rotateCompassArrow=()=>{const o=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=o},this._setButtonTitle=(o,d)=>{const p=this._map._getUIString(`NavigationControl.${d}`);o.title=p,o.setAttribute("aria-label",p)},this.options=l.extend({},df,v),this._container=_.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",o=>this._map.zoomIn({},{originalEvent:o})),_.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",o=>this._map.zoomOut({},{originalEvent:o})),_.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",o=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:o}):this._map.resetNorth({},{originalEvent:o})}),this._compassIcon=_.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(v){return this._map=v,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ff(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){_.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(v,o){const d=_.create("button",v,this._container);return d.type="button",d.addEventListener("click",o),d}},Vn.GeolocateControl=class extends l.Evented{constructor(v){super(),this._onSuccess=o=>{if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new l.Event("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(o),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new l.Event("geolocate",o)),this._finish()}},this._updateCamera=o=>{const d=new l.LngLat(o.coords.longitude,o.coords.latitude),p=o.coords.accuracy,y=this._map.getBearing(),b=l.extend({bearing:y},this.options.fitBoundsOptions),P=yt.fromLngLat(d,p);this._map.fitBounds(P,b,{geolocateSource:!0})},this._updateMarker=o=>{if(o){const d=new l.LngLat(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(d).addTo(this._map),this._userLocationDotMarker.setLngLat(d).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=o=>{if(this._map){if(this.options.trackUserLocation)if(o.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(o.code===3&&kl)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new l.Event("error",o)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=o=>{if(this._map){if(this._container.addEventListener("contextmenu",d=>d.preventDefault()),this._geolocateButton=_.create("button","maplibregl-ctrl-geolocate",this._container),_.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",o===!1){l.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}else{const d=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=_.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Ua({element:this._dotElement}),this._circleElement=_.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ua({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",d=>{d.geolocateSource||this._watchState!=="ACTIVE_LOCK"||d.originalEvent&&d.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new l.Event("trackuserlocationend")))})}},this.options=l.extend({},wr,v)}onAdd(v){return this._map=v,this._container=_.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(o,d=!1){Dr===void 0||d?window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(p=>{Dr=p.state!=="denied",o(Dr)}).catch(()=>{Dr=!!window.navigator.geolocation,o(Dr)}):(Dr=!!window.navigator.geolocation,o(Dr)):o(Dr)}(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),_.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,yr=0,kl=!1}_isOutOfMapMaxBounds(v){const o=this._map.getMaxBounds(),d=v.coords;return o&&(d.longitude<o.getWest()||d.longitude>o.getEast()||d.latitude<o.getSouth()||d.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const v=this._map.getBounds(),o=v.getSouthEast(),d=v.getNorthEast(),p=o.distanceTo(d),y=Math.ceil(this._accuracy/(p/this._map._container.clientHeight)*2);this._circleElement.style.width=`${y}px`,this._circleElement.style.height=`${y}px`}trigger(){if(!this._setup)return l.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":yr--,kl=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new l.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let v;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),yr++,yr>1?(v={maximumAge:6e5,timeout:0},kl=!0):(v=this.options.positionOptions,kl=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,v)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},Vn.AttributionControl=fs,Vn.LogoControl=sr,Vn.ScaleControl=class{constructor(v){this._onMove=()=>{Vc(this._map,this._container,this.options)},this.setUnit=o=>{this.options.unit=o,Vc(this._map,this._container,this.options)},this.options=l.extend({},Uc,v)}getDefaultPosition(){return"bottom-left"}onAdd(v){return this._map=v,this._container=_.create("div","maplibregl-ctrl maplibregl-ctrl-scale",v.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){_.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},Vn.FullscreenControl=class extends l.Evented{constructor(v={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,v&&v.container&&(v.container instanceof HTMLElement?this._container=v.container:l.warnOnce("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(v){return this._map=v,this._container||(this._container=this._map.getContainer()),this._controlContainer=_.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){_.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const v=this._fullscreenButton=_.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);_.create("span","maplibregl-ctrl-icon",v).setAttribute("aria-hidden","true"),v.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const v=this._getTitle();this._fullscreenButton.setAttribute("aria-label",v),this._fullscreenButton.title=v}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new l.Event("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new l.Event("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},Vn.TerrainControl=class{constructor(v){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))},this.options=v}onAdd(v){return this._map=v,this._container=_.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=_.create("button","maplibregl-ctrl-terrain",this._container),_.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){_.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},Vn.Popup=class extends l.Evented{constructor(v){super(),this.remove=()=>(this._content&&_.remove(this._content),this._container&&(_.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new l.Event("close")),this),this._onMouseUp=o=>{this._update(o.point)},this._onMouseMove=o=>{this._update(o.point)},this._onDrag=o=>{this._update(o.point)},this._update=o=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=_.create("div","maplibregl-popup",this._map.getContainer()),this._tip=_.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const P of this.options.className.split(" "))this._container.classList.add(P);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=pf(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!o)return;const d=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat);let p=this.options.anchor;const y=Ll(this.options.offset);if(!p){const P=this._container.offsetWidth,C=this._container.offsetHeight;let M;M=d.y+y.bottom.y<C?["top"]:d.y>this._map.transform.height-C?["bottom"]:[],d.x<P/2?M.push("left"):d.x>this._map.transform.width-P/2&&M.push("right"),p=M.length===0?"bottom":M.join("-")}const b=d.add(y[p]).round();_.setTransform(this._container,`${As[p]} translate(${b.x}px,${b.y}px)`),vg(this._container,p,"popup")},this._onClose=()=>{this.remove()},this.options=l.extend(Object.create(mf),v)}addTo(v){return this._map&&this.remove(),this._map=v,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new l.Event("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(v){return this._lngLat=l.LngLat.convert(v),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(v){return this.setDOMContent(document.createTextNode(v))}setHTML(v){const o=document.createDocumentFragment(),d=document.createElement("body");let p;for(d.innerHTML=v;p=d.firstChild,p;)o.appendChild(p);return this.setDOMContent(o)}getMaxWidth(){var v;return(v=this._container)===null||v===void 0?void 0:v.style.maxWidth}setMaxWidth(v){return this.options.maxWidth=v,this._update(),this}setDOMContent(v){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=_.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(v),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(v){this._container&&this._container.classList.add(v)}removeClassName(v){this._container&&this._container.classList.remove(v)}setOffset(v){return this.options.offset=v,this._update(),this}toggleClassName(v){if(this._container)return this._container.classList.toggle(v)}_createCloseButton(){this.options.closeButton&&(this._closeButton=_.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const v=this._container.querySelector(gf);v&&v.focus()}},Vn.Marker=Ua,Vn.Style=Zn,Vn.LngLat=l.LngLat,Vn.LngLatBounds=yt,Vn.Point=l.Point,Vn.MercatorCoordinate=l.MercatorCoordinate,Vn.Evented=l.Evented,Vn.AJAXError=l.AJAXError,Vn.config=l.config,Vn.CanvasSource=pn,Vn.GeoJSONSource=Kt,Vn.ImageSource=sn,Vn.RasterDEMTileSource=$t,Vn.RasterTileSource=xt,Vn.VectorTileSource=bt,Vn.VideoSource=Qt,Vn.setRTLTextPlugin=l.setRTLTextPlugin,Vn.getRTLTextPluginStatus=l.getRTLTextPluginStatus,Vn.prewarm=function(){et().acquire(It)},Vn.clearPrewarmedResources=function(){const v=Fe;v&&(v.isPreloaded()&&v.numActive()===1?(v.release(It),Fe=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},yf.extend(Vn,{isSafari:l.isSafari,getPerformanceMetrics:l.PerformanceUtils.getPerformanceMetrics}),Vn});var h=i;return h})})(iO);var IW=iO.exports;const MW=_m(IW),kW=`#define SHADER_NAME scatterplot-layer-vertex-shader

attribute vec3 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceRadius;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusScale;
uniform float radiusMinPixels;
uniform float radiusMaxPixels;
uniform float lineWidthScale;
uniform float lineWidthMinPixels;
uniform float lineWidthMaxPixels;
uniform float stroked;
uniform bool filled;
uniform bool antialiasing;
uniform bool billboard;
uniform int radiusUnits;
uniform int lineWidthUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;


void main(void) {
  geometry.worldPosition = instancePositions;
  outerRadiusPixels = clamp(
    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),
    radiusMinPixels, radiusMaxPixels
  );
  float lineWidthPixels = clamp(
    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),
    lineWidthMinPixels, lineWidthMaxPixels
  );
  outerRadiusPixels += stroked * lineWidthPixels / 2.0;
  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;
  unitPosition = edgePadding * positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;

  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;
  
  if (billboard) {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = edgePadding * positions * outerRadiusPixels;
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,LW=`#define SHADER_NAME scatterplot-layer-fragment-shader

precision highp float;

uniform bool filled;
uniform float stroked;
uniform bool antialiasing;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition) * outerRadiusPixels;
  float inCircle = antialiasing ? 
    smoothedge(distToCenter, outerRadiusPixels) : 
    step(distToCenter, outerRadiusPixels);

  if (inCircle == 0.0) {
    discard;
  }

  if (stroked > 0.5) {
    float isLine = antialiasing ? 
      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
      step(innerUnitRadius * outerRadiusPixels, distToCenter);

    if (filled) {
      gl_FragColor = mix(vFillColor, vLineColor, isLine);
    } else {
      if (isLine == 0.0) {
        discard;
      }
      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
    }
  } else if (!filled) {
    discard;
  } else {
    gl_FragColor = vFillColor;
  }

  gl_FragColor.a *= inCircle;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,sI=[0,0,0,255],RW={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:sI},getLineColor:{type:"accessor",value:sI},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class vE extends Iu{getShaders(){return super.getShaders({vs:kW,fs:LW,modules:[hE,dE]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var n;const{gl:r}=this.context;(n=this.state.model)===null||n===void 0||n.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{radiusUnits:n,radiusScale:r,radiusMinPixels:i,radiusMaxPixels:a,stroked:h,filled:l,billboard:m,antialiasing:_,lineWidthUnits:E,lineWidthScale:S,lineWidthMinPixels:I,lineWidthMaxPixels:L}=this.props;this.state.model.setUniforms(e).setUniforms({stroked:h?1:0,filled:l,billboard:m,antialiasing:_,radiusUnits:Qp[n],radiusScale:r,radiusMinPixels:i,radiusMaxPixels:a,lineWidthUnits:Qp[E],lineWidthScale:S,lineWidthMinPixels:I,lineWidthMaxPixels:L}).draw()}_getModel(e){const n=[-1,-1,0,1,-1,0,1,1,0,-1,1,0];return new sm(e,{...this.getShaders(),id:this.props.id,geometry:new sE({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array(n)}}}),isInstanced:!0})}}K(vE,"defaultProps",RW);K(vE,"layerName","ScatterplotLayer");const oO={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function aO(t,e,n={}){return OW(t,n)!==e?(zW(t,n),!0):!1}function OW(t,e={}){return Math.sign(DW(t,e))}function DW(t,e={}){const{start:n=0,end:r=t.length}=e,i=e.size||2;let a=0;for(let h=n,l=r-i;h<r;h+=i)a+=(t[h]-t[l])*(t[h+1]+t[l+1]),l=h;return a/2}function zW(t,e){const{start:n=0,end:r=t.length,size:i=2}=e,a=(r-n)/i,h=Math.floor(a/2);for(let l=0;l<h;++l){const m=n+l*i,_=n+(a-1-l)*i;for(let E=0;E<i;++E){const S=t[m+E];t[m+E]=t[_+E],t[_+E]=S}}}function ea(t,e){const n=e.length,r=t.length;if(r>0){let i=!0;for(let a=0;a<n;a++)if(t[r-n+a]!==e[a]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)t[r+i]=e[i];return!0}function bw(t,e){const n=e.length;for(let r=0;r<n;r++)t[r]=e[r]}function om(t,e,n,r,i=[]){const a=r+e*n;for(let h=0;h<n;h++)i[h]=t[a+h];return i}function ww(t,e,n,r,i=[]){let a,h;if(n&8)a=(r[3]-t[1])/(e[1]-t[1]),h=3;else if(n&4)a=(r[1]-t[1])/(e[1]-t[1]),h=1;else if(n&2)a=(r[2]-t[0])/(e[0]-t[0]),h=2;else if(n&1)a=(r[0]-t[0])/(e[0]-t[0]),h=0;else return null;for(let l=0;l<t.length;l++)i[l]=(h&1)===l?r[h]:a*(e[l]-t[l])+t[l];return i}function r0(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function lO(t,e){const{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:a=[0,0],startIndex:h=0,endIndex:l=t.length}=e||{},m=(l-h)/n;let _=[];const E=[_],S=om(t,0,n,h);let I,L;const O=uO(S,i,a,[]),D=[];ea(_,S);for(let H=1;H<m;H++){for(I=om(t,H,n,h,I),L=r0(I,O);L;){ww(S,I,L,O,D);const z=r0(D,O);z&&(ww(S,D,z,O,D),L=z),ea(_,D),bw(S,D),NW(O,i,L),r&&_.length>n&&(_=[],E.push(_),ea(_,S)),L=r0(I,O)}ea(_,I),bw(S,I)}return r?E:E[0]}const oI=0,FW=1;function vy(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function cO(t,e=null,n){if(!t.length)return[];const{size:r=2,gridResolution:i=10,gridOffset:a=[0,0],edgeTypes:h=!1}=n||{},l=[],m=[{pos:t,types:h?new Array(t.length/r).fill(FW):null,holes:e||[]}],_=[[],[]];let E=[];for(;m.length;){const{pos:S,types:I,holes:L}=m.shift();BW(S,r,L[0]||S.length,_),E=uO(_[0],i,a,E);const O=r0(_[1],E);if(O){let D=aI(S,I,r,0,L[0]||S.length,E,O);const H={pos:D[0].pos,types:D[0].types,holes:[]},z={pos:D[1].pos,types:D[1].types,holes:[]};m.push(H,z);for(let N=0;N<L.length;N++)D=aI(S,I,r,L[N],L[N+1]||S.length,E,O),D[0]&&(H.holes.push(H.pos.length),H.pos=vy(H.pos,D[0].pos),h&&(H.types=vy(H.types,D[0].types))),D[1]&&(z.holes.push(z.pos.length),z.pos=vy(z.pos,D[1].pos),h&&(z.types=vy(z.types,D[1].types)))}else{const D={positions:S};h&&(D.edgeTypes=I),L.length&&(D.holeIndices=L),l.push(D)}}return l}function aI(t,e,n,r,i,a,h){const l=(i-r)/n,m=[],_=[],E=[],S=[],I=[];let L,O,D;const H=om(t,l-1,n,r);let z=Math.sign(h&8?H[1]-a[3]:H[0]-a[2]),N=e&&e[l-1],F=0,$=0;for(let Q=0;Q<l;Q++)L=om(t,Q,n,r,L),O=Math.sign(h&8?L[1]-a[3]:L[0]-a[2]),D=e&&e[r/n+Q],O&&z&&z!==O&&(ww(H,L,h,a,I),ea(m,I)&&E.push(N),ea(_,I)&&S.push(N)),O<=0?(ea(m,L)&&E.push(D),F-=O):E.length&&(E[E.length-1]=oI),O>=0?(ea(_,L)&&S.push(D),$+=O):S.length&&(S[S.length-1]=oI),bw(H,L),z=O,N=D;return[F?{pos:m,types:e&&E}:null,$?{pos:_,types:e&&S}:null]}function uO(t,e,n,r){const i=Math.floor((t[0]-n[0])/e)*e+n[0],a=Math.floor((t[1]-n[1])/e)*e+n[1];return r[0]=i,r[1]=a,r[2]=i+e,r[3]=a+e,r}function NW(t,e,n){n&8?(t[1]+=e,t[3]+=e):n&4?(t[1]-=e,t[3]-=e):n&2?(t[0]+=e,t[2]+=e):n&1&&(t[0]-=e,t[2]-=e)}function BW(t,e,n,r){let i=1/0,a=-1/0,h=1/0,l=-1/0;for(let m=0;m<n;m+=e){const _=t[m],E=t[m+1];i=_<i?_:i,a=_>a?_:a,h=E<h?E:h,l=E>l?E:l}return r[0][0]=i,r[0][1]=h,r[1][0]=a,r[1][1]=l,r}const UW=85.051129;function VW(t,e){const{size:n=2,startIndex:r=0,endIndex:i=t.length,normalize:a=!0}=e||{},h=t.slice(r,i);hO(h,n,0,i-r);const l=lO(h,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(a)for(const m of l)dO(m,n);return l}function jW(t,e=null,n){const{size:r=2,normalize:i=!0,edgeTypes:a=!1}=n||{};e=e||[];const h=[],l=[];let m=0,_=0;for(let S=0;S<=e.length;S++){const I=e[S]||t.length,L=_,O=$W(t,r,m,I);for(let D=O;D<I;D++)h[_++]=t[D];for(let D=m;D<O;D++)h[_++]=t[D];hO(h,r,L,_),GW(h,r,L,_,n==null?void 0:n.maxLatitude),m=I,l[S]=_}l.pop();const E=cO(h,l,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:a});if(i)for(const S of E)dO(S.positions,r);return E}function $W(t,e,n,r){let i=-1,a=-1;for(let h=n+1;h<r;h+=e){const l=Math.abs(t[h]);l>i&&(i=l,a=h-1)}return a}function GW(t,e,n,r,i=UW){const a=t[n],h=t[r-e];if(Math.abs(a-h)>180){const l=om(t,0,e,n);l[0]+=Math.round((h-a)/360)*360,ea(t,l),l[1]=Math.sign(l[1])*i,ea(t,l),l[0]=a,ea(t,l)}}function hO(t,e,n,r){let i=t[0],a;for(let h=n;h<r;h+=e){a=t[h];const l=a-i;(l>180||l<-180)&&(a-=Math.round(l/360)*360),t[h]=i=a}}function dO(t,e){let n;const r=t.length/e;for(let a=0;a<r&&(n=t[a*e],(n+180)%360===0);a++);const i=-Math.round(n/360)*360;if(i!==0)for(let a=0;a<r;a++)t[a*e]+=i}function HW(t,e,n,r){let i;if(Array.isArray(t[0])){const a=t.length*e;i=new Array(a);for(let h=0;h<t.length;h++)for(let l=0;l<e;l++)i[h*e+l]=t[h][l]||0}else i=t;return n?lO(i,{size:e,gridResolution:n}):r?VW(i,{size:e}):i}const WW=1,qW=2,Ox=4;class ZW extends eO{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?HW(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(lI(e)){let r=0;for(const i of e)r+=this.getGeometrySize(i);return r}const n=this.getPathLength(e);return n<2?0:this.isClosed(e)?n<3?0:n+2:n}updateGeometryAttributes(e,n){if(n.geometrySize!==0)if(e&&lI(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i}else this._updateSegmentTypes(e,n),this._updatePositions(e,n)}_updateSegmentTypes(e,n){const r=this.attributes.segmentTypes,i=e?this.isClosed(e):!1,{vertexStart:a,geometrySize:h}=n;r.fill(0,a,a+h),i?(r[a]=Ox,r[a+h-2]=Ox):(r[a]+=WW,r[a+h-2]+=qW),r[a+h-1]=Ox}_updatePositions(e,n){const{positions:r}=this.attributes;if(!r||!e)return;const{vertexStart:i,geometrySize:a}=n,h=new Array(3);for(let l=i,m=0;m<a;l++,m++)this.getPointOnPath(e,m,h),r[l*3]=h[0],r[l*3+1]=h[1],r[l*3+2]=h[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,n,r=[]){const{positionSize:i}=this;n*i>=e.length&&(n+=1-e.length/i);const a=n*i;return r[0]=e[a],r[1]=e[a+1],r[2]=i===3&&e[a+2]||0,r}isClosed(e){if(!this.normalize)return!!this.opts.loop;const{positionSize:n}=this,r=e.length-n;return e[0]===e[r]&&e[1]===e[r+1]&&(n===2||e[2]===e[r+2])}}function lI(t){return Array.isArray(t[0])}const XW=`#define SHADER_NAME path-layer-vertex-shader

attribute vec2 positions;

attribute float instanceTypes;
attribute vec3 instanceStartPositions;
attribute vec3 instanceEndPositions;
attribute vec3 instanceLeftPositions;
attribute vec3 instanceRightPositions;
attribute vec3 instanceLeftPositions64Low;
attribute vec3 instanceStartPositions64Low;
attribute vec3 instanceEndPositions64Low;
attribute vec3 instanceRightPositions64Low;
attribute float instanceStrokeWidths;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;

uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float jointType;
uniform float capType;
uniform float miterLimit;
uniform bool billboard;
uniform int widthUnits;

uniform float opacity;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);

float flipIfTrue(bool flag) {
  return -(float(flag) * 2. - 1.);
}
vec3 getLineJoinOffset(
  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
  vec2 width
) {
  bool isEnd = positions.x > 0.0;
  float sideOfPath = positions.y;
  float isJoint = float(sideOfPath == 0.0);

  vec3 deltaA3 = (currPoint - prevPoint);
  vec3 deltaB3 = (nextPoint - currPoint);

  mat3 rotationMatrix;
  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);
  if (needsRotation) {
    deltaA3 = deltaA3 * rotationMatrix;
    deltaB3 = deltaB3 * rotationMatrix;
  }
  vec2 deltaA = deltaA3.xy / width;
  vec2 deltaB = deltaB3.xy / width;

  float lenA = length(deltaA);
  float lenB = length(deltaB);

  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);

  vec2 perpA = vec2(-dirA.y, dirA.x);
  vec2 perpB = vec2(-dirB.y, dirB.x);
  vec2 tangent = dirA + dirB;
  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
  vec2 miterVec = vec2(-tangent.y, tangent.x);
  vec2 dir = isEnd ? dirA : dirB;
  vec2 perp = isEnd ? perpA : perpB;
  float L = isEnd ? lenA : lenB;
  float sinHalfA = abs(dot(miterVec, perp));
  float cosHalfA = abs(dot(dirA, miterVec));
  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);
  float cornerPosition = sideOfPath * turnDirection;

  float miterSize = 1.0 / max(sinHalfA, EPSILON);
  miterSize = mix(
    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
    miterSize,
    step(0.0, cornerPosition)
  );

  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
    * (sideOfPath + isJoint * turnDirection);
  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
  bool isCap = isStartCap || isEndCap;
  if (isCap) {
    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);
    vJointType = capType;
  } else {
    vJointType = jointType;
  }
  vPathLength = L;
  vCornerOffset = offsetVec;
  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
  vMiterLength = isCap ? isJoint : vMiterLength;

  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
  vPathPosition = vec2(
    dot(offsetFromStartOfPath, perp),
    dot(offsetFromStartOfPath, dir)
  );
  geometry.uv = vPathPosition;

  float isValid = step(instanceTypes, 3.5);
  vec3 offset = vec3(offsetVec * width * isValid, 0.0);

  if (needsRotation) {
    offset = rotationMatrix * offset;
  }
  return offset;
}
void clipLine(inout vec4 position, vec4 refPosition) {
  if (position.w < EPSILON) {
    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
    position = refPosition + (position - refPosition) * r;
  }
}

void main() {
  geometry.pickingColor = instancePickingColors;

  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);

  float isEnd = positions.x;

  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);

  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);

  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);

  geometry.worldPosition = currPosition;
  vec2 widthPixels = vec2(clamp(
    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels) / 2.0);
  vec3 width;

  if (billboard) {
    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);

    clipLine(prevPositionScreen, currPositionScreen);
    clipLine(nextPositionScreen, currPositionScreen);
    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));

    width = vec3(widthPixels, 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(
      prevPositionScreen.xyz / prevPositionScreen.w,
      currPositionScreen.xyz / currPositionScreen.w,
      nextPositionScreen.xyz / nextPositionScreen.w,
      project_pixel_size_to_clipspace(width.xy)
    );

    DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);
    gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);
  } else {
    prevPosition = project_position(prevPosition, prevPosition64Low);
    currPosition = project_position(currPosition, currPosition64Low);
    nextPosition = project_position(nextPosition, nextPosition64Low);

    width = vec3(project_pixel_size(widthPixels), 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);
    geometry.position = vec4(currPosition + offset, 1.0);
    gl_Position = project_common_position_to_clipspace(geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,YW=`#define SHADER_NAME path-layer-fragment-shader

precision highp float;

uniform float miterLimit;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

void main(void) {
  geometry.uv = vPathPosition;

  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
      discard;
    }
    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {
      discard;
    }
  }
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,fO=[0,0,0,255],KW={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:fO},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},Dx={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class L_ extends Iu{constructor(...e){super(...e),K(this,"state",void 0)}getShaders(){return super.getShaders({vs:XW,fs:YW,modules:[hE,dE]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:Dx,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:Dx,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:Dx,defaultValue:fO},instancePickingColors:{size:3,type:5121,accessor:(r,{index:i,target:a})=>this.encodePickingColor(r&&r.__source?r.__source.index:i,a)}}),this.setState({pathTesselator:new ZW({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:n,changeFlags:r}=e,i=this.getAttributeManager();if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPath)){const{pathTesselator:l}=this.state,m=n.data.attributes||{};l.updateGeometry({data:n.data,geometryBuffer:m.getPath,buffers:m,normalize:!n._pathType,loop:n._pathType==="loop",getGeometry:n.getPath,positionFormat:n.positionFormat,wrapLongitude:n.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:r.dataChanged}),this.setState({numInstances:l.instanceCount,startIndices:l.vertexStarts}),r.dataChanged||i.invalidateAll()}if(r.extensionsChanged){var h;const{gl:l}=this.context;(h=this.state.model)===null||h===void 0||h.delete(),this.state.model=this._getModel(l),i.invalidateAll()}}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(a=>a.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:n,capRounded:r,billboard:i,miterLimit:a,widthUnits:h,widthScale:l,widthMinPixels:m,widthMaxPixels:_}=this.props;this.state.model.setUniforms(e).setUniforms({jointType:Number(n),capType:Number(r),billboard:i,widthUnits:Qp[h],widthScale:l,miterLimit:a,widthMinPixels:m,widthMaxPixels:_}).draw()}_getModel(e){const n=[0,1,2,1,4,2,1,3,4,3,5,4],r=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new sm(e,{...this.getShaders(),id:this.props.id,geometry:new sE({drawMode:4,attributes:{indices:new Uint16Array(n),positions:{value:new Float32Array(r),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateSegmentTypes(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("segmentTypes")}}K(L_,"defaultProps",KW);K(L_,"layerName","PathLayer");var xE={exports:{}};xE.exports=R_;xE.exports.default=R_;function R_(t,e,n){n=n||2;var r=e&&e.length,i=r?e[0]*n:t.length,a=pO(t,0,i,n,!0),h=[];if(!a||a.next===a.prev)return h;var l,m,_,E,S,I,L;if(r&&(a=nq(t,e,a,n)),t.length>80*n){l=_=t[0],m=E=t[1];for(var O=n;O<i;O+=n)S=t[O],I=t[O+1],S<l&&(l=S),I<m&&(m=I),S>_&&(_=S),I>E&&(E=I);L=Math.max(_-l,E-m),L=L!==0?32767/L:0}return am(a,h,n,l,m,L,0),h}function pO(t,e,n,r,i){var a,h;if(i===Sw(t,e,n,r)>0)for(a=e;a<n;a+=r)h=cI(a,t[a],t[a+1],h);else for(a=n-r;a>=e;a-=r)h=cI(a,t[a],t[a+1],h);return h&&O_(h,h.next)&&(cm(h),h=h.next),h}function xu(t,e){if(!t)return t;e||(e=t);var n=t,r;do if(r=!1,!n.steiner&&(O_(n,n.next)||Br(n.prev,n,n.next)===0)){if(cm(n),n=e=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==e);return e}function am(t,e,n,r,i,a,h){if(t){!h&&a&&aq(t,r,i,a);for(var l=t,m,_;t.prev!==t.next;){if(m=t.prev,_=t.next,a?QW(t,r,i,a):JW(t)){e.push(m.i/n|0),e.push(t.i/n|0),e.push(_.i/n|0),cm(t),t=_.next,l=_.next;continue}if(t=_,t===l){h?h===1?(t=eq(xu(t),e,n),am(t,e,n,r,i,a,2)):h===2&&tq(t,e,n,r,i,a):am(xu(t),e,n,r,i,a,1);break}}}}function JW(t){var e=t.prev,n=t,r=t.next;if(Br(e,n,r)>=0)return!1;for(var i=e.x,a=n.x,h=r.x,l=e.y,m=n.y,_=r.y,E=i<a?i<h?i:h:a<h?a:h,S=l<m?l<_?l:_:m<_?m:_,I=i>a?i>h?i:h:a>h?a:h,L=l>m?l>_?l:_:m>_?m:_,O=r.next;O!==e;){if(O.x>=E&&O.x<=I&&O.y>=S&&O.y<=L&&Gh(i,l,a,m,h,_,O.x,O.y)&&Br(O.prev,O,O.next)>=0)return!1;O=O.next}return!0}function QW(t,e,n,r){var i=t.prev,a=t,h=t.next;if(Br(i,a,h)>=0)return!1;for(var l=i.x,m=a.x,_=h.x,E=i.y,S=a.y,I=h.y,L=l<m?l<_?l:_:m<_?m:_,O=E<S?E<I?E:I:S<I?S:I,D=l>m?l>_?l:_:m>_?m:_,H=E>S?E>I?E:I:S>I?S:I,z=Ew(L,O,e,n,r),N=Ew(D,H,e,n,r),F=t.prevZ,$=t.nextZ;F&&F.z>=z&&$&&$.z<=N;){if(F.x>=L&&F.x<=D&&F.y>=O&&F.y<=H&&F!==i&&F!==h&&Gh(l,E,m,S,_,I,F.x,F.y)&&Br(F.prev,F,F.next)>=0||(F=F.prevZ,$.x>=L&&$.x<=D&&$.y>=O&&$.y<=H&&$!==i&&$!==h&&Gh(l,E,m,S,_,I,$.x,$.y)&&Br($.prev,$,$.next)>=0))return!1;$=$.nextZ}for(;F&&F.z>=z;){if(F.x>=L&&F.x<=D&&F.y>=O&&F.y<=H&&F!==i&&F!==h&&Gh(l,E,m,S,_,I,F.x,F.y)&&Br(F.prev,F,F.next)>=0)return!1;F=F.prevZ}for(;$&&$.z<=N;){if($.x>=L&&$.x<=D&&$.y>=O&&$.y<=H&&$!==i&&$!==h&&Gh(l,E,m,S,_,I,$.x,$.y)&&Br($.prev,$,$.next)>=0)return!1;$=$.nextZ}return!0}function eq(t,e,n){var r=t;do{var i=r.prev,a=r.next.next;!O_(i,a)&&mO(i,r,r.next,a)&&lm(i,a)&&lm(a,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(a.i/n|0),cm(r),cm(r.next),r=t=a),r=r.next}while(r!==t);return xu(r)}function tq(t,e,n,r,i,a){var h=t;do{for(var l=h.next.next;l!==h.prev;){if(h.i!==l.i&&uq(h,l)){var m=gO(h,l);h=xu(h,h.next),m=xu(m,m.next),am(h,e,n,r,i,a,0),am(m,e,n,r,i,a,0);return}l=l.next}h=h.next}while(h!==t)}function nq(t,e,n,r){var i=[],a,h,l,m,_;for(a=0,h=e.length;a<h;a++)l=e[a]*r,m=a<h-1?e[a+1]*r:t.length,_=pO(t,l,m,r,!1),_===_.next&&(_.steiner=!0),i.push(cq(_));for(i.sort(rq),a=0;a<i.length;a++)n=iq(i[a],n);return n}function rq(t,e){return t.x-e.x}function iq(t,e){var n=sq(t,e);if(!n)return e;var r=gO(n,t);return xu(r,r.next),xu(n,n.next)}function sq(t,e){var n=e,r=t.x,i=t.y,a=-1/0,h;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var l=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(l<=r&&l>a&&(a=l,h=n.x<n.next.x?n:n.next,l===r))return h}n=n.next}while(n!==e);if(!h)return null;var m=h,_=h.x,E=h.y,S=1/0,I;n=h;do r>=n.x&&n.x>=_&&r!==n.x&&Gh(i<E?r:a,i,_,E,i<E?a:r,i,n.x,n.y)&&(I=Math.abs(i-n.y)/(r-n.x),lm(n,t)&&(I<S||I===S&&(n.x>h.x||n.x===h.x&&oq(h,n)))&&(h=n,S=I)),n=n.next;while(n!==m);return h}function oq(t,e){return Br(t.prev,t,e.prev)<0&&Br(e.next,t,t.next)<0}function aq(t,e,n,r){var i=t;do i.z===0&&(i.z=Ew(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,lq(i)}function lq(t){var e,n,r,i,a,h,l,m,_=1;do{for(n=t,t=null,a=null,h=0;n;){for(h++,r=n,l=0,e=0;e<_&&(l++,r=r.nextZ,!!r);e++);for(m=_;l>0||m>0&&r;)l!==0&&(m===0||!r||n.z<=r.z)?(i=n,n=n.nextZ,l--):(i=r,r=r.nextZ,m--),a?a.nextZ=i:t=i,i.prevZ=a,a=i;n=r}a.nextZ=null,_*=2}while(h>1);return t}function Ew(t,e,n,r,i){return t=(t-n)*i|0,e=(e-r)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function cq(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function Gh(t,e,n,r,i,a,h,l){return(i-h)*(e-l)>=(t-h)*(a-l)&&(t-h)*(r-l)>=(n-h)*(e-l)&&(n-h)*(a-l)>=(i-h)*(r-l)}function uq(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!hq(t,e)&&(lm(t,e)&&lm(e,t)&&dq(t,e)&&(Br(t.prev,t,e.prev)||Br(t,e.prev,e))||O_(t,e)&&Br(t.prev,t,t.next)>0&&Br(e.prev,e,e.next)>0)}function Br(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function O_(t,e){return t.x===e.x&&t.y===e.y}function mO(t,e,n,r){var i=by(Br(t,e,n)),a=by(Br(t,e,r)),h=by(Br(n,r,t)),l=by(Br(n,r,e));return!!(i!==a&&h!==l||i===0&&xy(t,n,e)||a===0&&xy(t,r,e)||h===0&&xy(n,t,r)||l===0&&xy(n,e,r))}function xy(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function by(t){return t>0?1:t<0?-1:0}function hq(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&mO(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function lm(t,e){return Br(t.prev,t,t.next)<0?Br(t,e,t.next)>=0&&Br(t,t.prev,e)>=0:Br(t,e,t.prev)<0||Br(t,t.next,e)<0}function dq(t,e){var n=t,r=!1,i=(t.x+e.x)/2,a=(t.y+e.y)/2;do n.y>a!=n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==t);return r}function gO(t,e){var n=new Tw(t.i,t.x,t.y),r=new Tw(e.i,e.x,e.y),i=t.next,a=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function cI(t,e,n,r){var i=new Tw(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function cm(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Tw(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}R_.deviation=function(t,e,n,r){var i=e&&e.length,a=i?e[0]*n:t.length,h=Math.abs(Sw(t,0,a,n));if(i)for(var l=0,m=e.length;l<m;l++){var _=e[l]*n,E=l<m-1?e[l+1]*n:t.length;h-=Math.abs(Sw(t,_,E,n))}var S=0;for(l=0;l<r.length;l+=3){var I=r[l]*n,L=r[l+1]*n,O=r[l+2]*n;S+=Math.abs((t[I]-t[O])*(t[L+1]-t[I+1])-(t[I]-t[L])*(t[O+1]-t[I+1]))}return h===0&&S===0?0:Math.abs((S-h)/h)};function Sw(t,e,n,r){for(var i=0,a=e,h=n-r;a<n;a+=r)i+=(t[h]-t[a])*(t[a+1]+t[h+1]),h=a;return i}R_.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var a=0;a<t[i].length;a++)for(var h=0;h<e;h++)n.vertices.push(t[i][a][h]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n};var fq=xE.exports;const pq=_m(fq),wy=oO.CLOCKWISE,uI=oO.COUNTER_CLOCKWISE,nc={isClosed:!0};function mq(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}function pp(t){return"positions"in t?t.positions:t}function i0(t){return"holeIndices"in t?t.holeIndices:null}function gq(t){return Array.isArray(t[0])}function yq(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function _q(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function vq(t,e,n,r){for(let i=0;i<e;i++)if(t[n+i]!==t[r-e+i])return!1;return!0}function hI(t,e,n,r,i){let a=e;const h=n.length;for(let l=0;l<h;l++)for(let m=0;m<r;m++)t[a++]=n[l][m]||0;if(!_q(n))for(let l=0;l<r;l++)t[a++]=n[0][l]||0;return nc.start=e,nc.end=a,nc.size=r,aO(t,i,nc),a}function dI(t,e,n,r,i=0,a,h){a=a||n.length;const l=a-i;if(l<=0)return e;let m=e;for(let _=0;_<l;_++)t[m++]=n[i+_];if(!vq(n,r,i,a))for(let _=0;_<r;_++)t[m++]=n[i+_];return nc.start=e,nc.end=m,nc.size=r,aO(t,h,nc),m}function yO(t,e){mq(t);const n=[],r=[];if("positions"in t){const{positions:i,holeIndices:a}=t;if(a){let h=0;for(let l=0;l<=a.length;l++)h=dI(n,h,i,e,a[l-1],a[l],l===0?wy:uI),r.push(h);return r.pop(),{positions:n,holeIndices:r}}t=i}if(!gq(t))return dI(n,0,t,e,0,n.length,wy),n;if(!yq(t)){let i=0;for(const[a,h]of t.entries())i=hI(n,i,h,e,a===0?wy:uI),r.push(i);return r.pop(),{positions:n,holeIndices:r}}return hI(n,0,t,e,wy),n}function zx(t,e,n){const r=t.length/3;let i=0;for(let a=0;a<r;a++){const h=(a+1)%r;i+=t[a*3+e]*t[h*3+n],i-=t[h*3+e]*t[a*3+n]}return Math.abs(i/2)}function fI(t,e,n,r){const i=t.length/3;for(let a=0;a<i;a++){const h=a*3,l=t[h+0],m=t[h+1],_=t[h+2];t[h+e]=l,t[h+n]=m,t[h+r]=_}}function xq(t,e,n,r){let i=i0(t);i&&(i=i.map(l=>l/e));let a=pp(t);const h=r&&e===3;if(n){const l=a.length;a=a.slice();const m=[];for(let _=0;_<l;_+=e){m[0]=a[_],m[1]=a[_+1],h&&(m[2]=a[_+2]);const E=n(m);a[_]=E[0],a[_+1]=E[1],h&&(a[_+2]=E[2])}}if(h){const l=zx(a,0,1),m=zx(a,0,2),_=zx(a,1,2);if(!l&&!m&&!_)return[];l>m&&l>_||(m>_?(n||(a=a.slice()),fI(a,0,2,1)):(n||(a=a.slice()),fI(a,2,0,1)))}return pq(a,i,e)}class bq extends eO{constructor(e){const{fp64:n,IndexType:r=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:n?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:r,size:1}}})}get(e){const{attributes:n}=this;return e==="indices"?n.indices&&n.indices.subarray(0,this.vertexCount):n[e]}updateGeometry(e){super.updateGeometry(e);const n=this.buffers.indices;if(n)this.vertexCount=(n.value||n).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const n=yO(e,this.positionSize);return this.opts.resolution?cO(pp(n),i0(n),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?jW(pp(n),i0(n),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):n}return e}getGeometrySize(e){if(pI(e)){let n=0;for(const r of e)n+=this.getGeometrySize(r);return n}return pp(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,n){if(e&&pI(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i,n.indexStart=this.indexStarts[n.geometryIndex+1]}else this._updateIndices(e,n),this._updatePositions(e,n),this._updateVertexValid(e,n)}_updateIndices(e,{geometryIndex:n,vertexStart:r,indexStart:i}){const{attributes:a,indexStarts:h,typedArrayManager:l}=this;let m=a.indices;if(!m||!e)return;let _=i;const E=xq(e,this.positionSize,this.opts.preproject,this.opts.full3d);m=l.allocate(m,i+E.length,{copy:!0});for(let S=0;S<E.length;S++)m[_++]=E[S]+r;h[n+1]=i+E.length,a.indices=m}_updatePositions(e,{vertexStart:n,geometrySize:r}){const{attributes:{positions:i},positionSize:a}=this;if(!i||!e)return;const h=pp(e);for(let l=n,m=0;m<r;l++,m++){const _=h[m*a],E=h[m*a+1],S=a>2?h[m*a+2]:0;i[l*3]=_,i[l*3+1]=E,i[l*3+2]=S}}_updateVertexValid(e,{vertexStart:n,geometrySize:r}){const{positionSize:i}=this,a=this.attributes.vertexValid,h=e&&i0(e);if(e&&e.edgeTypes?a.set(e.edgeTypes,n):a.fill(1,n,n+r),h)for(let l=0;l<h.length;l++)a[n+h[l]/i-1]=0;a[n+r-1]=0}}function pI(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const _O=`
attribute vec2 vertexPositions;
attribute float vertexValid;

uniform bool extruded;
uniform bool isWireframe;
uniform float elevationScale;
uniform float opacity;

varying vec4 vColor;

struct PolygonProps {
  vec4 fillColors;
  vec4 lineColors;
  vec3 positions;
  vec3 nextPositions;
  vec3 pickingColors;
  vec3 positions64Low;
  vec3 nextPositions64Low;
  float elevations;
};

vec3 project_offset_normal(vec3 vector) {
  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
    return normalize(vector * project_uCommonUnitsPerWorldUnit);
  }
  return project_normal(vector);
}

void calculatePosition(PolygonProps props) {
#ifdef IS_SIDE_VERTEX
  if(vertexValid < 0.5){
    gl_Position = vec4(0.);
    return;
  }
#endif

  vec3 pos;
  vec3 pos64Low;
  vec3 normal;
  vec4 colors = isWireframe ? props.lineColors : props.fillColors;

  geometry.worldPosition = props.positions;
  geometry.worldPositionAlt = props.nextPositions;
  geometry.pickingColor = props.pickingColors;

#ifdef IS_SIDE_VERTEX
  pos = mix(props.positions, props.nextPositions, vertexPositions.x);
  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);
#else
  pos = props.positions;
  pos64Low = props.positions64Low;
#endif

  if (extruded) {
    pos.z += props.elevations * vertexPositions.y * elevationScale;
  }
  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  if (extruded) {
  #ifdef IS_SIDE_VERTEX
    normal = vec3(
      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),
      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),
      0.0);
    normal = project_offset_normal(normal);
  #else
    normal = project_normal(vec3(0.0, 0.0, 1.0));
  #endif
    geometry.normal = normal;
    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);
    vColor = vec4(lightColor, colors.a * opacity);
  } else {
    vColor = vec4(colors.rgb, colors.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,wq=`#define SHADER_NAME solid-polygon-layer-vertex-shader

attribute vec3 positions;
attribute vec3 positions64Low;
attribute float elevations;
attribute vec4 fillColors;
attribute vec4 lineColors;
attribute vec3 pickingColors;

`.concat(_O,`

void main(void) {
  PolygonProps props;

  props.positions = positions;
  props.positions64Low = positions64Low;
  props.elevations = elevations;
  props.fillColors = fillColors;
  props.lineColors = lineColors;
  props.pickingColors = pickingColors;

  calculatePosition(props);
}
`),Eq=`#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX


attribute vec3 instancePositions;
attribute vec3 nextPositions;
attribute vec3 instancePositions64Low;
attribute vec3 nextPositions64Low;
attribute float instanceElevations;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

`.concat(_O,`

void main(void) {
  PolygonProps props;

  #if RING_WINDING_ORDER_CW == 1
    props.positions = instancePositions;
    props.positions64Low = instancePositions64Low;
    props.nextPositions = nextPositions;
    props.nextPositions64Low = nextPositions64Low;
  #else
    props.positions = nextPositions;
    props.positions64Low = nextPositions64Low;
    props.nextPositions = instancePositions;
    props.nextPositions64Low = instancePositions64Low;
  #endif
  props.elevations = instanceElevations;
  props.fillColors = instanceFillColors;
  props.lineColors = instanceLineColors;
  props.pickingColors = instancePickingColors;

  calculatePosition(props);
}
`),Tq=`#define SHADER_NAME solid-polygon-layer-fragment-shader

precision highp float;

varying vec4 vColor;

void main(void) {
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Y0=[0,0,0,255],Sq={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:Y0},getLineColor:{type:"accessor",value:Y0},material:!0},Ey={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class bE extends Iu{constructor(...e){super(...e),K(this,"state",void 0)}getShaders(e){return super.getShaders({vs:e==="top"?wq:Eq,fs:Tq,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[hE,S$,dE]})}get wrapLongitude(){return!1}initializeState(){const{gl:e,viewport:n}=this.context;let{coordinateSystem:r}=this.props;const{_full3d:i}=this.props;n.isGeospatial&&r===Wn.DEFAULT&&(r=Wn.LNGLAT);let a;r===Wn.LNGLAT&&(i?a=n.projectPosition.bind(n):a=n.projectFlat.bind(n)),this.setState({numInstances:0,polygonTesselator:new bq({preproject:a,fp64:this.use64bitPositions(),IndexType:!e||Q2(e,Sr.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const h=this.getAttributeManager(),l=!0;h.remove(["instancePickingColors"]),h.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:l},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:Ey,accessor:"getPolygon",update:this.calculatePositions,noAlloc:l,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:l},elevations:{size:1,transition:Ey,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:Ey,accessor:"getFillColor",defaultValue:Y0,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:Ey,accessor:"getLineColor",defaultValue:Y0,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(m,{index:_,target:E})=>this.encodePickingColor(m&&m.__source?m.__source.index:_,E),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(a=>a.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{extruded:n,filled:r,wireframe:i,elevationScale:a}=this.props,{topModel:h,sideModel:l,polygonTesselator:m}=this.state,_={...e,extruded:!!n,elevationScale:a};l&&(l.setInstanceCount(m.instanceCount-1),l.setUniforms(_),i&&(l.setDrawMode(3),l.setUniforms({isWireframe:!0}).draw()),r&&(l.setDrawMode(6),l.setUniforms({isWireframe:!1}).draw())),h&&(h.setVertexCount(m.vertexCount),h.setUniforms(_).draw())}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:n,oldProps:r,changeFlags:i}=e,a=this.getAttributeManager();if(i.extensionsChanged||n.filled!==r.filled||n.extruded!==r.extruded){var l;(l=this.state.models)===null||l===void 0||l.forEach(m=>m.delete()),this.setState(this._getModels(this.context.gl)),a.invalidateAll()}}updateGeometry({props:e,oldProps:n,changeFlags:r}){if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPolygon)){const{polygonTesselator:a}=this.state,h=e.data.attributes||{};a.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:h.getPolygon,buffers:h,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:r.dataChanged,full3d:e._full3d}),this.setState({numInstances:a.instanceCount,startIndices:a.vertexStarts}),r.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(e){const{id:n,filled:r,extruded:i}=this.props;let a,h;if(r){const l=this.getShaders("top");l.defines.NON_INSTANCED_MODEL=1,a=new sm(e,{...l,id:"".concat(n,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return i&&(h=new sm(e,{...this.getShaders("side"),id:"".concat(n,"-side"),geometry:new sE({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),h.userData.excludeAttributes={indices:!0}),{models:[h,a].filter(Boolean),topModel:a,sideModel:h}}calculateIndices(e){const{polygonTesselator:n}=this.state;e.startIndices=n.indexStarts,e.value=n.get("indices")}calculatePositions(e){const{polygonTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}K(bE,"defaultProps",Sq);K(bE,"layerName","SolidPolygonLayer");function Pq({data:t,getIndex:e,dataRange:n,replace:r}){const{startRow:i=0,endRow:a=1/0}=n,h=t.length;let l=h,m=h;for(let I=0;I<h;I++){const L=e(t[I]);if(l>I&&L>=i&&(l=I),L>=a){m=I;break}}let _=l;const S=m-l!==r.length?t.slice(m):void 0;for(let I=0;I<r.length;I++)t[_++]=r[I];if(S){for(let I=0;I<S.length;I++)t[_++]=S[I];t.length=_}return{startRow:l,endRow:l+r.length}}const vO=[0,0,0,255],Cq=[0,0,0,255],Aq={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:t=>t.polygon},getFillColor:{type:"accessor",value:Cq},getLineColor:{type:"accessor",value:vO},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0};class wE extends Q3{initializeState(){this.state={paths:[]},this.props.getLineDashArray&&hr.removed("getLineDashArray","PathStyleExtension")()}updateState({changeFlags:e}){const n=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getPolygon);if(n&&Array.isArray(e.dataChanged)){const r=this.state.paths.slice(),i=e.dataChanged.map(a=>Pq({data:r,getIndex:h=>h.__source.index,dataRange:a,replace:this._getPaths(a)}));this.setState({paths:r,pathsDiff:i})}else n&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(e={}){const{data:n,getPolygon:r,positionFormat:i,_normalize:a}=this.props,h=[],l=i==="XY"?2:3,{startRow:m,endRow:_}=e,{iterable:E,objectInfo:S}=pE(n,m,_);for(const I of E){S.index++;let L=r(I,S);a&&(L=yO(L,l));const{holeIndices:O}=L,D=L.positions||L;if(O)for(let H=0;H<=O.length;H++){const z=D.slice(O[H-1]||0,O[H]||D.length);h.push(this.getSubLayerRow({path:z},I,S.index))}else h.push(this.getSubLayerRow({path:D},I,S.index))}return h}renderLayers(){const{data:e,_dataDiff:n,stroked:r,filled:i,extruded:a,wireframe:h,_normalize:l,_windingOrder:m,elevationScale:_,transitions:E,positionFormat:S}=this.props,{lineWidthUnits:I,lineWidthScale:L,lineWidthMinPixels:O,lineWidthMaxPixels:D,lineJointRounded:H,lineMiterLimit:z,lineDashJustified:N}=this.props,{getFillColor:F,getLineColor:$,getLineWidth:Q,getLineDashArray:te,getElevation:re,getPolygon:we,updateTriggers:Ee,material:de}=this.props,{paths:Le,pathsDiff:Ge}=this.state,Be=this.getSubLayerClass("fill",bE),Oe=this.getSubLayerClass("stroke",L_),Ke=this.shouldRenderSubLayer("fill",Le)&&new Be({_dataDiff:n,extruded:a,elevationScale:_,filled:i,wireframe:h,_normalize:l,_windingOrder:m,getElevation:re,getFillColor:F,getLineColor:a&&h?$:vO,material:de,transitions:E},this.getSubLayerProps({id:"fill",updateTriggers:Ee&&{getPolygon:Ee.getPolygon,getElevation:Ee.getElevation,getFillColor:Ee.getFillColor,lineColors:a&&h,getLineColor:Ee.getLineColor}}),{data:e,positionFormat:S,getPolygon:we}),je=!a&&r&&this.shouldRenderSubLayer("stroke",Le)&&new Oe({_dataDiff:Ge&&(()=>Ge),widthUnits:I,widthScale:L,widthMinPixels:O,widthMaxPixels:D,jointRounded:H,miterLimit:z,dashJustified:N,_pathType:"loop",transitions:E&&{getWidth:E.getLineWidth,getColor:E.getLineColor,getPath:E.getPolygon},getColor:this.getSubLayerAccessor($),getWidth:this.getSubLayerAccessor(Q),getDashArray:this.getSubLayerAccessor(te)},this.getSubLayerProps({id:"stroke",updateTriggers:Ee&&{getWidth:Ee.getLineWidth,getColor:Ee.getLineColor,getDashArray:Ee.getLineDashArray}}),{data:Le,positionFormat:S,getPath:it=>it.path});return[!a&&Ke,je,a&&Ke]}}K(wE,"layerName","PolygonLayer");K(wE,"defaultProps",Aq);const Iq={fadeTrail:!0,trailLength:{type:"number",value:120,min:0},currentTime:{type:"number",value:0,min:0},getTimestamps:{type:"accessor",value:t=>t.timestamps}};class EE extends L_{getShaders(){const e=super.getShaders();return e.inject={"vs:#decl":`uniform float trailLength;
attribute float instanceTimestamps;
attribute float instanceNextTimestamps;
varying float vTime;
`,"vs:#main-end":`vTime = instanceTimestamps + (instanceNextTimestamps - instanceTimestamps) * vPathPosition.y / vPathLength;
`,"fs:#decl":`uniform bool fadeTrail;
uniform float trailLength;
uniform float currentTime;
varying float vTime;
`,"fs:#main-start":`if(vTime > currentTime || (fadeTrail && (vTime < currentTime - trailLength))) {
  discard;
}
`,"fs:DECKGL_FILTER_COLOR":`if(fadeTrail) {
  color.a *= 1.0 - (currentTime - vTime) / trailLength;
}
`},e}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({timestamps:{size:1,accessor:"getTimestamps",shaderAttributes:{instanceTimestamps:{vertexOffset:0},instanceNextTimestamps:{vertexOffset:1}}}})}draw(e){const{fadeTrail:n,trailLength:r,currentTime:i}=this.props;e.uniforms={...e.uniforms,fadeTrail:n,trailLength:r,currentTime:i},super.draw(e)}}K(EE,"layerName","TripsLayer");K(EE,"defaultProps",Iq);function xO(t,e,n=64){const r={latitude:t[1],longitude:t[0]},i=e,a=[],h=i/(111.32*Math.cos(r.latitude*Math.PI/180)),l=i/110.574;let m,_,E;for(var S=0;S<n;S++)m=S/n*(2*Math.PI),_=h*Math.cos(m),E=l*Math.sin(m),a.push([r.longitude+_,r.latitude+E]);return a.push(a[0]),a}const Mq=["footway","street_lamp","steps","pedestrian","track","path"];function bO(t){const n=`
    [out:json];(
        way[highway]${Mq.map(r=>`[highway!="${r}"]`).join("")}[footway!="*"]
        (${t[0].latitude},${t[0].longitude},${t[1].latitude},${t[1].longitude});
        node(w);
    );
    out skel;`;return fetch("https://overpass-api.de/api/interpreter",{method:"POST",body:n})}class mI{constructor(e,n){this.node1=e,this.node2=n,this.visited=!1}getOtherNode(e){return e===this.node1?this.node2:this.node1}get weight(){return Math.hypot(this.node1.latitude-this.node2.latitude,this.node1.longitude-this.node2.longitude)}}class TE{constructor(e,n,r){this.edges=[],this.reset(),this.id=e,this.latitude=n,this.longitude=r,this.visited=!1}get totalDistance(){return this.distanceFromStart+this.distanceToEnd}get neighbors(){return this.edges.map(e=>({edge:e,node:e.getOtherNode(this)}))}connectTo(e){const n=new mI(this,e);this.edges.push(n),e.edges.push(n)}reset(){this.visited=!1,this.distanceFromStart=0,this.distanceToEnd=0,this.parent=null,this.referer=null;for(const e of this.neighbors)e.edge.visited=!1}clone(e,n){if(e.has(this.id))return e.get(this.id);const r=new TE(this.id,this.latitude,this.longitude);return r.visited=this.visited,r.distanceFromStart=this.distanceFromStart,r.distanceToEnd=this.distanceToEnd,r.parent=null,r.referer=null,e.set(this.id,r),r}cloneEdges(e,n,r){this.edges=[];for(const i of e.edges){const a=`${i.node1.id}-${i.node2.id}`,h=`${i.node2.id}-${i.node1.id}`;if(r.has(a)||r.has(h)){const _=r.get(a)||r.get(h);this.edges.push(_);continue}const l=n.get(i.node1.id),m=n.get(i.node2.id);if(l&&m){const _=new mI(l,m);_.visited=i.visited,r.set(a,_),this.edges.includes(_)||this.edges.push(_),l.id!==this.id&&!l.edges.includes(_)&&l.edges.push(_),m.id!==this.id&&!m.edges.includes(_)&&m.edges.push(_)}}}}class SE{constructor(){this.startNode=null,this.nodes=new Map}getNode(e){return this.nodes.get(e)}addNode(e,n,r){const i=new TE(e,n,r);return this.nodes.set(i.id,i),i}clone(){const e=new SE,n=new Map,r=new Map;for(const[i,a]of this.nodes){const h=a.clone(n,r);e.nodes.set(i,h)}for(const[i,a]of this.nodes)e.nodes.get(i).cloneEdges(a,n,r);return this.startNode&&(e.startNode=e.nodes.get(this.startNode.id)),e}}async function gI(t,e){const n=xO([e,t],.15),r=wO(n),a=await(await bO(r)).json();let h;for(const l of a.elements){if(l.type!=="node")continue;if(!h){h=l;continue}const m=Math.sqrt(Math.pow(l.lat-t,2)+Math.pow(l.lon-e,2)),_=Math.sqrt(Math.pow(h.lat-t,2)+Math.pow(h.lon-e,2));m<_&&(h=l)}return h}async function kq(t,e){const i=(await(await bO(t)).json()).elements,a=new SE;for(const h of i)if(h.type==="node"){const l=a.addNode(h.id,h.lat,h.lon);l.id===e&&(a.startNode=l)}else if(h.type==="way"){if(!h.nodes||h.nodes.length<2)continue;for(let l=0;l<h.nodes.length-1;l++){const m=a.getNode(h.nodes[l]),_=a.getNode(h.nodes[l+1]);!m||!_||m.connectTo(_)}}if(!a.startNode)throw new Error("Start node was not found.");return a}function wO(t){const e={minLat:Number.MAX_VALUE,maxLat:-Number.MAX_VALUE,minLon:Number.MAX_VALUE,maxLon:-Number.MAX_VALUE};for(const r of t)r[0]<e.minLon&&(e.minLon=r[0]),r[0]>e.maxLon&&(e.maxLon=r[0]),r[1]<e.minLat&&(e.minLat=r[1]),r[1]>e.maxLat&&(e.maxLat=r[1]);return[{latitude:e.minLat,longitude:e.minLon},{latitude:e.maxLat,longitude:e.maxLon}]}class EO{constructor(){this.finished=!1}start(e,n){this.finished=!1,this.startNode=e,this.endNode=n}nextStep(){return[]}}class yI extends EO{constructor(){super(),this.openList=[],this.closedList=[]}start(e,n){super.start(e,n),this.openList=[this.startNode],this.closedList=[],this.startNode.distanceFromStart=0,this.startNode.distanceToEnd=0}nextStep(){if(this.openList.length===0)return this.finished=!0,[];const e=[],n=this.openList.reduce((i,a)=>a.totalDistance<i.totalDistance?a:i,this.openList[0]);this.openList.splice(this.openList.indexOf(n),1),n.visited=!0;const r=n.edges.find(i=>i.getOtherNode(n)===n.referer);if(r&&(r.visited=!0),n.id===this.endNode.id)return this.openList=[],this.finished=!0,[n];for(const i of n.neighbors){const a=i.node,h=i.edge,l=n.distanceFromStart+Math.hypot(a.longitude-n.longitude,a.latitude-n.latitude);if(a.visited&&!h.visited&&(h.visited=!0,a.referer=n,e.push(a)),this.openList.includes(a)){if(a.distanceFromStart<=l)continue}else if(this.closedList.includes(a)){if(a.distanceFromStart<=l)continue;this.closedList.splice(this.closedList.indexOf(a),1),this.openList.push(a)}else this.openList.push(a),a.distanceToEnd=Math.hypot(a.longitude-this.endNode.longitude,a.latitude-this.endNode.latitude);a.distanceFromStart=l,a.referer=n,a.parent=n}return this.closedList.push(n),[...e,n]}}class Lq extends EO{constructor(){super(),this.openList=[]}start(e,n){super.start(e,n),this.openList=[e]}nextStep(){if(this.openList.length===0)return this.finished=!0,[];const e=[],n=this.openList.shift();n.visited=!0;const r=n.edges.find(i=>i.getOtherNode(n)===n.referer);if(r&&(r.visited=!0),n.id===this.endNode.id)return this.openList=[],this.finished=!0,[n];for(const i of n.neighbors){const a=i.node,h=i.edge;if(a.visited&&!h.visited&&(h.visited=!0,a.referer=n,e.push(a)),a.visited)continue;const l=n.distanceFromStart+h.weight;if(this.openList.includes(a)){if(l>=a.distanceFromStart)continue}else this.openList.push(a);a.distanceFromStart=l,a.parent=n,a.referer=n}return[...e,n]}}const Rq="./map_style.json",Oq={longitude:-77.0428,latitude:-12.0464,zoom:11,pitch:0,bearing:0},Dq={startNodeFill:[70,183,128],startNodeBorder:[255,255,255],endNodeFill:[152,4,12],endNodeBorder:[0,0,0],path:[70,183,128],route:[165,13,32]},_I=[[70,183,128],[152,4,12],[0,123,255],[255,193,7],[108,117,125],[220,53,69],[40,167,69],[253,126,20],[111,66,193],[23,162,184],[255,105,180],[144,238,144],[255,165,0],[138,43,226],[30,144,255]],vI=[{id:"hosp1",name:"Hospital Nacional Dos De Mayo",longitude:-77.01461873374852,latitude:-12.056258406493845,type:"hospital",activated:!1,nearestNodeId:5487373126,nearestNodeLat:-12.0564312,nearestNodeLon:-77.0147157},{id:"hosp2",name:"Hospital Arzobispo Loayza",longitude:-77.0445661439587,latitude:-12.048339681656948,type:"hospital",activated:!1,nearestNodeId:10588181631,nearestNodeLat:-12.0483132,nearestNodeLon:-77.0445961},{id:"hosp3",name:"Hospital EsSalud Angamos",longitude:-77.02805791633861,latitude:-12.11361251073139,type:"hospital",activated:!1,nearestNodeId:5481227475,nearestNodeLat:-12.1135903,nearestNodeLon:-77.0281011},{id:"hosp4",name:"Hospital Santa Rosa",longitude:-77.06151026922002,latitude:-12.071818994736823,type:"hospital",activated:!1,nearestNodeId:4143760938,nearestNodeLat:-12.0717159,nearestNodeLon:-77.0615311},{id:"hosp5",name:"Hospital de Emergencias Casimiro Ulloa",longitude:-77.01803399279487,latitude:-12.128113054055287,type:"hospital",activated:!1,nearestNodeId:263635944,nearestNodeLat:-12.128576,nearestNodeLon:-77.0180559},{id:"hosp6",name:"Hospital Nacional Sergio E. Bernales",longitude:-77.03891071090206,latitude:-11.912712007917936,type:"hospital",activated:!1,nearestNodeId:5661537194,nearestNodeLat:-11.9126991,nearestNodeLon:-77.0389002},{id:"hosp7",name:"Hospital Nacional Cayetano Heredia",longitude:-77.05507342249902,latitude:-12.02274524059977,type:"hospital",activated:!1,nearestNodeId:11201081561,nearestNodeLat:-12.0226316,nearestNodeLon:-77.054931},{id:"hosp8",name:"Hospital María Auxiliadora",longitude:-76.95907157072388,latitude:-12.160562687428335,type:"hospital",activated:!1,nearestNodeId:11218904295,nearestNodeLat:-12.1604412,nearestNodeLon:-76.959014},{id:"hosp9",name:"Hospital Nacional Hipolito Unánue",longitude:-76.99330947922503,latitude:-12.039961351504228,type:"hospital",activated:!1,nearestNodeId:1273751347,nearestNodeLat:-12.0399601,nearestNodeLon:-76.993339},{id:"hosp10",name:"Hospital Hermilio Valdizán",longitude:-76.94564061174229,latitude:-12.046801020075112,type:"hospital",activated:!1,nearestNodeId:5711943173,nearestNodeLat:-12.0468424,nearestNodeLon:-76.9457034},{id:"hosp11",name:"Hospital de Vitarte",longitude:-76.9200770454144,latitude:-12.026166246008126,type:"hospital",activated:!1,nearestNodeId:4376589164,nearestNodeLat:-12.0261825,nearestNodeLon:-76.9201614},{id:"hosp12",name:"Hospital Nacional San Juan de Lurigancho",longitude:-77.00308968594325,latitude:-11.96664922748575,type:"hospital",activated:!1,nearestNodeId:9948737165,nearestNodeLat:-11.9666479,nearestNodeLon:-77.0031379},{id:"hosp13",name:"Hospital de Emergencias Villa El Salvador",longitude:-76.93403314341495,latitude:-12.233138385215074,type:"hospital",activated:!1,nearestNodeId:8381503351,nearestNodeLat:-12.2331182,nearestNodeLon:-76.9340451},{id:"hosp14",name:"Hospital Nacional Daniel Alcides Carrión",longitude:-77.12337721284975,latitude:-12.062459062154812,type:"hospital",activated:!1,nearestNodeId:1843191313,nearestNodeLat:-12.0624023,nearestNodeLon:-77.1234214},{id:"hosp15",name:"Hospital de Ventanilla",longitude:-77.12548761622809,latitude:-11.872975978739923,type:"hospital",activated:!1,nearestNodeId:10748670609,nearestNodeLat:-11.8730005,nearestNodeLon:-77.1255135},{id:"hosp16",name:"Hospital San Jose Callao",longitude:-77.09887180768905,latitude:-12.042701541196195,type:"hospital",activated:!1,nearestNodeId:9196805615,nearestNodeLat:-12.0426531,nearestNodeLon:-77.0984585},{id:"hosp17",name:"Hospital Alberto Sabogal Sologuren",longitude:-77.12328233315031,latitude:-12.064870714035564,type:"hospital",activated:!1,nearestNodeId:10702745895,nearestNodeLat:-12.0648401,nearestNodeLon:-77.1233095},{id:"hosp18",name:"Hospital Edgardo Rebagliati Martins",longitude:-77.0387573428198,latitude:-12.080060687757808,type:"hospital",activated:!1,nearestNodeId:12458030287,nearestNodeLat:-12.080051,nearestNodeLon:-77.0386949},{id:"hosp19",name:"Hospital Nacional Guillermo Almenara Irigoyen",longitude:-77.02313000403944,latitude:-12.059157792033176,type:"hospital",activated:!1,nearestNodeId:8761430660,nearestNodeLat:-12.0591487,nearestNodeLon:-77.0231622},{id:"hosp20",name:"Hospital de Emergencias Grau",longitude:-77.03098248664344,latitude:-12.059068803196865,type:"hospital",activated:!1,nearestNodeId:4560651789,nearestNodeLat:-12.0591706,nearestNodeLon:-77.0310944},{id:"cs1",name:"Centro de Emergencias San Pedro de los Chorrillos",longitude:-77.0236307021554,latitude:-12.166459745692864,type:"I-4",activated:!1,nearestNodeId:7711789560,nearestNodeLat:-12.1664074,nearestNodeLon:-77.0235877},{id:"cs2",name:"C.S.M.I. Dr. Enrique Martin Altuna ",longitude:-77.10880789564922,latitude:-11.837588368064761,type:"I-4",activated:!1,nearestNodeId:1759542281,nearestNodeLat:-11.8373371,nearestNodeLon:-77.1091195},{id:"cs3",name:"Centro de Salud Mexico",longitude:-77.08589205741765,latitude:-12.024903805405666,type:"I-4",activated:!1,nearestNodeId:599287873,nearestNodeLat:-12.0248891,nearestNodeLon:-77.0859061},{id:"cs4",name:"Centro de Salud Materno Infantil El Porvenir",longitude:-77.02088523442151,latitude:-12.067658968907425,type:"I-4",activated:!1,nearestNodeId:11839779613,nearestNodeLat:-12.0678035,nearestNodeLon:-77.0206536},{id:"cs5",name:"Centro Materno Infantil Daniel Alcides Carrión",longitude:-76.94538399744961,latitude:-12.17778919254979,type:"I-4",activated:!1,nearestNodeId:5316560589,nearestNodeLat:-12.1774791,nearestNodeLon:-76.9454099},{id:"cs6",name:"Centro Materno Infantil Manuel Barreto",longitude:-76.96859019709719,latitude:-12.152257020932733,type:"I-4",activated:!1,nearestNodeId:1796866442,nearestNodeLat:-12.1522946,nearestNodeLon:-76.9683996},{id:"cs7",name:"Centro de Salud Breña",longitude:-77.05798563569698,latitude:-12.063930246247862,type:"I-3",activated:!1,nearestNodeId:1273527183,nearestNodeLat:-12.0639769,nearestNodeLon:-77.0579848},{id:"cs8",name:"Centro de Salud San Juan de Miraflores",longitude:-76.9750951661881,latitude:-12.157920164785214,type:"I-3",activated:!1,nearestNodeId:1752594986,nearestNodeLat:-12.1582901,nearestNodeLon:-76.9751611},{id:"cs9",name:"Centro de Salud San Miguel",longitude:-77.0987104227323,latitude:-12.081391316462103,type:"I-3",activated:!1,nearestNodeId:608345636,nearestNodeLat:-12.0811894,nearestNodeLon:-77.0985912},{id:"cs10",name:"Centro de Salud San Sebastián",longitude:-77.13034088722787,latitude:-12.068505210473884,type:"I-3",activated:!1,nearestNodeId:12505658675,nearestNodeLat:-12.0685313,nearestNodeLon:-77.1303364},{id:"cs11",name:"Centro de Salud San Juan de Salinas",longitude:-77.08532160978176,latitude:-11.984167282753823,type:"I-3",activated:!1,nearestNodeId:675127437,nearestNodeLat:-11.9844165,nearestNodeLon:-77.08533},{id:"cs12",name:"Centro de Salud Santiago de Surco",longitude:-77.00614461366816,latitude:-12.147301939265757,type:"I-3",activated:!1,nearestNodeId:1273809579,nearestNodeLat:-12.147409,nearestNodeLon:-77.006215},{id:"cs13",name:"Centro de Salud San Juan de Amancaes",longitude:-77.02678055678233,latitude:-12.016397621847046,type:"I-3",activated:!1,nearestNodeId:1324511787,nearestNodeLat:-12.0164583,nearestNodeLon:-77.0268604},{id:"cs14",name:"Centro de Salud Tupac Amaru de Villa",longitude:-76.98192213332074,latitude:-12.193615002749665,type:"I-3",activated:!1,nearestNodeId:4356786035,nearestNodeLat:-12.1934769,nearestNodeLon:-76.9818136},{id:"cs15",name:"Puesto de Salud Jose Olaya",longitude:-77.03907917490714,latitude:-11.96746027706088,type:"I-2",activated:!1,nearestNodeId:1331962069,nearestNodeLat:-11.9674495,nearestNodeLon:-77.0390421},{id:"cs16",name:"Puesto de Salud San Roque",longitude:-76.98883522923848,latitude:-12.149179862633215,type:"I-2",activated:!1,nearestNodeId:2761780925,nearestNodeLat:-12.1491406,nearestNodeLon:-76.9888255},{id:"cs17",name:"CS Virgen del Rosario Carapongo ",longitude:-76.87570747956417,latitude:-12.002153850036082,type:"I-2",activated:!1,nearestNodeId:1744675966,nearestNodeLat:-12.0021172,nearestNodeLon:-76.8755921},{id:"cs18",name:"Puesto de Salud Nueva Esperanza Alta ",longitude:-76.93655297704846,latitude:-12.179280351173384,type:"I-2",activated:!1,nearestNodeId:5721442476,nearestNodeLat:-12.179372,nearestNodeLon:-76.9365953},{id:"cs19",name:"Puesto de Salud César Vallejo ",longitude:-76.93706384417936,latitude:-12.187241472425736,type:"I-2",activated:!1,nearestNodeId:1273675368,nearestNodeLat:-12.1873101,nearestNodeLon:-76.9371542},{id:"cs20",name:"Puesto de salud David Tejada de Rivero",longitude:-77.10140707056588,latitude:-11.983991925575873,type:"I-2",activated:!1,nearestNodeId:5746004215,nearestNodeLat:-11.9840228,nearestNodeLon:-77.1014501},{id:"cs21",name:"Puesto de Salud 5 de Mayo ",longitude:-76.96255219765128,latitude:-12.132306291218462,type:"I-2",activated:!1,nearestNodeId:1273792874,nearestNodeLat:-12.1324644,nearestNodeLon:-76.9623974},{id:"cs22",name:"Puesto de Salud San Francisco de La Cruz ",longitude:-76.96347929683722,latitude:-12.151716293536115,type:"I-2",activated:!1,nearestNodeId:1273878861,nearestNodeLat:-12.151677,nearestNodeLon:-76.9634167},{id:"cs23",name:"Puesto de Salud Cerro Candela ",longitude:-77.10716501662287,latitude:-11.971659113628027,type:"I-2",activated:!1,nearestNodeId:4270454131,nearestNodeLat:-11.97166,nearestNodeLon:-77.1072254},{id:"cs24",name:"Puesto de Salud Valle de Sarón ",longitude:-76.96617743659255,latitude:-12.17110733921245,type:"I-2",activated:!1,nearestNodeId:1273690643,nearestNodeLat:-12.1711143,nearestNodeLon:-76.96608},{id:"cs25",name:"Puesto de Salud José María Arguedas ",longitude:-76.95556689715677,latitude:-12.132584637364149,type:"I-2",activated:!1,nearestNodeId:1273854935,nearestNodeLat:-12.1327403,nearestNodeLon:-76.9556403},{id:"cs26",name:"Puesto de Salud 12 de Junio ",longitude:-76.92967779771037,latitude:-12.163262076391867,type:"I-2",activated:!1,nearestNodeId:4497359240,nearestNodeLat:-12.1632776,nearestNodeLon:-76.929716},{id:"cs27",name:"Puesto de Salud Villa Venturo ",longitude:-77.0126692701776,latitude:-12.187541436642757,type:"I-2",activated:!1,nearestNodeId:2132998808,nearestNodeLat:-12.1875331,nearestNodeLon:-77.0126436},{id:"cs28",name:"Puesto de Salud Vista Alegre de Villa",longitude:-76.99259410468467,latitude:-12.187158593996005,type:"I-2",activated:!1,nearestNodeId:1827925772,nearestNodeLat:-12.1871524,nearestNodeLon:-76.9927079},{id:"cs29",name:"Puesto de Salud Sagrada Familia",longitude:-76.94375167648148,latitude:-12.209242704123776,type:"I-2",activated:!1,nearestNodeId:1273974701,nearestNodeLat:-12.2091493,nearestNodeLon:-76.9436181},{id:"cs30",name:"Puesto de Salud Llanavilla",longitude:-76.94181958921094,latitude:-12.191241376806738,type:"I-2",activated:!1,nearestNodeId:4367063646,nearestNodeLat:-12.1912338,nearestNodeLon:-76.941779},{id:"cs31",name:"Puesto de Salud Virgen de las Mercedes",longitude:-77.15699697257776,latitude:-11.784963415771623,type:"I-2",activated:!1,nearestNodeId:5066864131,nearestNodeLat:-11.784972,nearestNodeLon:-77.1569654},{id:"cs32",name:"Puesto de Salud Tambo Inga",longitude:-76.8411917706252,latitude:-12.147383184099848,type:"I-1",activated:!1,nearestNodeId:3719054218,nearestNodeLat:-12.1475806,nearestNodeLon:-76.8410904},{id:"cs33",name:"Puesto de Salud San Carlos",longitude:-77.0413745812935,latitude:-11.908618969744396,type:"I-1",activated:!1,nearestNodeId:10753772732,nearestNodeLat:-11.9086025,nearestNodeLon:-77.0414029}];var rd;const Hh=class Hh{constructor(){return I1(Hh,rd)||(this.endNode=null,this.graph=null,this.finished=!1,this.startNodes=[],this.algorithms=[],this.algorithmResults=[],this.colors=[],this.independentGraphs=[],this.optimalPaths=[],WS(Hh,rd,this)),I1(Hh,rd)}getNode(e){var n;return(n=this.graph)==null?void 0:n.getNode(e)}findNearestNodeInGraph(e,n){if(!this.graph||!this.graph.nodes)return null;let r=null,i=1/0;for(const a of this.graph.nodes.values()){const h=Math.hypot(a.longitude-e,a.latitude-n);h<i&&(i=h,r=a)}return r?{...r,originalId:r.id}:null}generateColors(){this.colors=[];for(let e=0;e<this.startNodes.length;e++)this.colors.push(_I[e%_I.length])}addStartNode(e){this.startNodes.find(n=>n.id===e.id)||(this.startNodes.push(e),this.generateColors())}removeStartNode(e){const n=this.startNodes.findIndex(r=>r.id===e.id);n!==-1&&(this.startNodes.splice(n,1),this.generateColors())}clearStartNodes(){this.startNodes=[],this.algorithms=[],this.algorithmResults=[],this.colors=[],this.independentGraphs=[],this.optimalPaths=[]}reset(){if(this.finished=!1,!!this.graph){for(const e of this.graph.nodes.keys())this.graph.nodes.get(e).reset();this.algorithmResults=[];for(let e=0;e<this.startNodes.length;e++)this.algorithmResults.push({finished:!1,updatedNodes:[],color:this.colors[e]||[128,128,128],algorithmIndex:e,justFinished:!1});this.algorithms=[],this.independentGraphs=[],this.optimalPaths=[]}}start(e){this.reset(),this.algorithms=[],this.independentGraphs=[],this.optimalPaths=[];for(let n=0;n<this.startNodes.length;n++){const r=this.graph.clone();this.independentGraphs.push(r);const i=r.getNode(this.startNodes[n].id),a=r.getNode(this.endNode.id);let h;switch(e){case"astar":h=new yI;break;case"dijkstra":h=new Lq;break;default:h=new yI;break}h.start(i,a),h.sourceIndex=n,h.independentGraph=r,this.algorithms.push(h),this.optimalPaths.push(null)}}nextStep(){var r;const e=[];let n=!0;for(let i=0;i<this.algorithms.length;i++){const a=this.algorithms[i];let h=[];a.finished||(h=a.nextStep(),a.finished&&!this.optimalPaths[i]&&(this.optimalPaths[i]=this.extractOptimalPath(a,i)),n=!1);const l=h.map(_=>{const E=this.graph.getNode(_.id),S=_.referer?this.graph.getNode(_.referer.id):null;return E&&S&&(E.referer=S),{node:E,color:this.colors[i],sourceIndex:i}}),m={algorithmIndex:i,updatedNodes:l,finished:a.finished,color:this.colors[i],justFinished:a.finished&&!((r=this.algorithmResults[i])!=null&&r.finished)};e.push(m),this.algorithmResults[i]={finished:a.finished,updatedNodes:l,color:this.colors[i],algorithmIndex:i,justFinished:m.justFinished}}return n&&(this.finished=!0),e}extractOptimalPath(e,n){const r=[];let i=e.endNode;for(;i&&i.parent;)r.unshift(i.id),i=i.parent;return i&&r.unshift(i.id),r}getOptimalPath(e){return this.optimalPaths[e]}getAllOptimalPaths(){return this.optimalPaths.filter(e=>e!==null)}getColorForSource(e){return this.colors[e]||[128,128,128]}hasAnyFinished(){return this.algorithms.some(e=>e.finished)}getFinishedAlgorithms(){return this.algorithms.filter(e=>e.finished)}};rd=new WeakMap,HS(Hh,rd,void 0);let Pw=Hh;const zq={black:"#000",white:"#fff"},um=zq,Fq={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},wh=Fq,Nq={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},Eh=Nq,Bq={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},Th=Bq,Uq={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},Sh=Uq,Vq={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},Ph=Vq,jq={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},Qf=jq,$q={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},Gq=$q;function se(){return se=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},se.apply(this,arguments)}function nl(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function TO(t){if(!nl(t))return t;const e={};return Object.keys(t).forEach(n=>{e[n]=TO(t[n])}),e}function zs(t,e,n={clone:!0}){const r=n.clone?se({},t):t;return nl(t)&&nl(e)&&Object.keys(e).forEach(i=>{i!=="__proto__"&&(nl(e[i])&&i in t&&nl(t[i])?r[i]=zs(t[i],e[i],n):n.clone?r[i]=nl(e[i])?TO(e[i]):e[i]:r[i]=e[i])}),r}function vc(t){let e="https://mui.com/production-error/?code="+t;for(let n=1;n<arguments.length;n+=1)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+t+"; visit "+e+" for the full message."}function Yt(t){if(typeof t!="string")throw new Error(vc(7));return t.charAt(0).toUpperCase()+t.slice(1)}function xI(...t){return t.reduce((e,n)=>n==null?e:function(...i){e.apply(this,i),n.apply(this,i)},()=>{})}function PE(t,e=166){let n;function r(...i){const a=()=>{t.apply(this,i)};clearTimeout(n),n=setTimeout(a,e)}return r.clear=()=>{clearTimeout(n)},r}function Fx(t,e){var n,r;return Z.isValidElement(t)&&e.indexOf((n=t.type.muiName)!=null?n:(r=t.type)==null||(r=r._payload)==null||(r=r.value)==null?void 0:r.muiName)!==-1}function Xr(t){return t&&t.ownerDocument||document}function fl(t){return Xr(t).defaultView||window}function Cw(t,e){typeof t=="function"?t(e):t&&(t.current=e)}const Hq=typeof window<"u"?Z.useLayoutEffect:Z.useEffect,aa=Hq;let bI=0;function Wq(t){const[e,n]=Z.useState(t),r=t||e;return Z.useEffect(()=>{e==null&&(bI+=1,n(`mui-${bI}`))},[e]),r}const wI=Kx["useId".toString()];function CE(t){if(wI!==void 0){const e=wI();return t??e}return Wq(t)}function K0({controlled:t,default:e,name:n,state:r="value"}){const{current:i}=Z.useRef(t!==void 0),[a,h]=Z.useState(e),l=i?t:a,m=Z.useCallback(_=>{i||h(_)},[]);return[l,m]}function no(t){const e=Z.useRef(t);return aa(()=>{e.current=t}),Z.useCallback((...n)=>(0,e.current)(...n),[])}function Yr(...t){return Z.useMemo(()=>t.every(e=>e==null)?null:e=>{t.forEach(n=>{Cw(n,e)})},t)}let D_=!0,Aw=!1,EI;const qq={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function Zq(t){const{type:e,tagName:n}=t;return!!(n==="INPUT"&&qq[e]&&!t.readOnly||n==="TEXTAREA"&&!t.readOnly||t.isContentEditable)}function Xq(t){t.metaKey||t.altKey||t.ctrlKey||(D_=!0)}function Nx(){D_=!1}function Yq(){this.visibilityState==="hidden"&&Aw&&(D_=!0)}function Kq(t){t.addEventListener("keydown",Xq,!0),t.addEventListener("mousedown",Nx,!0),t.addEventListener("pointerdown",Nx,!0),t.addEventListener("touchstart",Nx,!0),t.addEventListener("visibilitychange",Yq,!0)}function Jq(t){const{target:e}=t;try{return e.matches(":focus-visible")}catch{}return D_||Zq(e)}function AE(){const t=Z.useCallback(i=>{i!=null&&Kq(i.ownerDocument)},[]),e=Z.useRef(!1);function n(){return e.current?(Aw=!0,window.clearTimeout(EI),EI=window.setTimeout(()=>{Aw=!1},100),e.current=!1,!0):!1}function r(i){return Jq(i)?(e.current=!0,!0):!1}return{isFocusVisibleRef:e,onFocus:r,onBlur:n,ref:t}}function SO(t){const e=t.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}const Qq={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:-1,overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"},eZ=Qq;function IE(t,e){const n=se({},e);return Object.keys(t).forEach(r=>{if(r.toString().match(/^(components|slots)$/))n[r]=se({},t[r],n[r]);else if(r.toString().match(/^(componentsProps|slotProps)$/)){const i=t[r]||{},a=e[r];n[r]={},!a||!Object.keys(a)?n[r]=i:!i||!Object.keys(i)?n[r]=a:(n[r]=se({},a),Object.keys(i).forEach(h=>{n[r][h]=IE(i[h],a[h])}))}else n[r]===void 0&&(n[r]=t[r])}),n}function qn(t,e,n=void 0){const r={};return Object.keys(t).forEach(i=>{r[i]=t[i].reduce((a,h)=>{if(h){const l=e(h);l!==""&&a.push(l),n&&n[h]&&a.push(n[h])}return a},[]).join(" ")}),r}const TI=t=>t,tZ=()=>{let t=TI;return{configure(e){t=e},generate(e){return t(e)},reset(){t=TI}}},nZ=tZ(),PO=nZ,rZ={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function $n(t,e,n="Mui"){const r=rZ[e];return r?`${n}-${r}`:`${PO.generate(t)}-${e}`}function Bn(t,e,n="Mui"){const r={};return e.forEach(i=>{r[i]=$n(t,i,n)}),r}const bu="$$material";function nn(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,a;for(a=0;a<r.length;a++)i=r[a],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function CO(t){var e=Object.create(null);return function(n){return e[n]===void 0&&(e[n]=t(n)),e[n]}}var iZ=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,sZ=CO(function(t){return iZ.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91});function oZ(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function aZ(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var lZ=function(){function t(n){var r=this;this._insertTag=function(i){var a;r.tags.length===0?r.insertionPoint?a=r.insertionPoint.nextSibling:r.prepend?a=r.container.firstChild:a=r.before:a=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(i,a),r.tags.push(i)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(r){r.forEach(this._insertTag)},e.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(aZ(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var a=oZ(i);try{a.insertRule(r,a.cssRules.length)}catch{}}else i.appendChild(document.createTextNode(r));this.ctr++},e.flush=function(){this.tags.forEach(function(r){return r.parentNode&&r.parentNode.removeChild(r)}),this.tags=[],this.ctr=0},t}(),rs="-ms-",J0="-moz-",Yn="-webkit-",AO="comm",ME="rule",kE="decl",cZ="@import",IO="@keyframes",uZ="@layer",hZ=Math.abs,z_=String.fromCharCode,dZ=Object.assign;function fZ(t,e){return Ui(t,0)^45?(((e<<2^Ui(t,0))<<2^Ui(t,1))<<2^Ui(t,2))<<2^Ui(t,3):0}function MO(t){return t.trim()}function pZ(t,e){return(t=e.exec(t))?t[0]:t}function Kn(t,e,n){return t.replace(e,n)}function Iw(t,e){return t.indexOf(e)}function Ui(t,e){return t.charCodeAt(e)|0}function hm(t,e,n){return t.slice(e,n)}function ba(t){return t.length}function LE(t){return t.length}function Ty(t,e){return e.push(t),t}function mZ(t,e){return t.map(e).join("")}var F_=1,Ed=1,kO=0,Bs=0,ci=0,Dd="";function N_(t,e,n,r,i,a,h){return{value:t,root:e,parent:n,type:r,props:i,children:a,line:F_,column:Ed,length:h,return:""}}function ep(t,e){return dZ(N_("",null,null,"",null,null,0),t,{length:-t.length},e)}function gZ(){return ci}function yZ(){return ci=Bs>0?Ui(Dd,--Bs):0,Ed--,ci===10&&(Ed=1,F_--),ci}function so(){return ci=Bs<kO?Ui(Dd,Bs++):0,Ed++,ci===10&&(Ed=1,F_++),ci}function Ma(){return Ui(Dd,Bs)}function s0(){return Bs}function Dm(t,e){return hm(Dd,t,e)}function dm(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function LO(t){return F_=Ed=1,kO=ba(Dd=t),Bs=0,[]}function RO(t){return Dd="",t}function o0(t){return MO(Dm(Bs-1,Mw(t===91?t+2:t===40?t+1:t)))}function _Z(t){for(;(ci=Ma())&&ci<33;)so();return dm(t)>2||dm(ci)>3?"":" "}function vZ(t,e){for(;--e&&so()&&!(ci<48||ci>102||ci>57&&ci<65||ci>70&&ci<97););return Dm(t,s0()+(e<6&&Ma()==32&&so()==32))}function Mw(t){for(;so();)switch(ci){case t:return Bs;case 34:case 39:t!==34&&t!==39&&Mw(ci);break;case 40:t===41&&Mw(t);break;case 92:so();break}return Bs}function xZ(t,e){for(;so()&&t+ci!==47+10;)if(t+ci===42+42&&Ma()===47)break;return"/*"+Dm(e,Bs-1)+"*"+z_(t===47?t:so())}function bZ(t){for(;!dm(Ma());)so();return Dm(t,Bs)}function wZ(t){return RO(a0("",null,null,null,[""],t=LO(t),0,[0],t))}function a0(t,e,n,r,i,a,h,l,m){for(var _=0,E=0,S=h,I=0,L=0,O=0,D=1,H=1,z=1,N=0,F="",$=i,Q=a,te=r,re=F;H;)switch(O=N,N=so()){case 40:if(O!=108&&Ui(re,S-1)==58){Iw(re+=Kn(o0(N),"&","&\f"),"&\f")!=-1&&(z=-1);break}case 34:case 39:case 91:re+=o0(N);break;case 9:case 10:case 13:case 32:re+=_Z(O);break;case 92:re+=vZ(s0()-1,7);continue;case 47:switch(Ma()){case 42:case 47:Ty(EZ(xZ(so(),s0()),e,n),m);break;default:re+="/"}break;case 123*D:l[_++]=ba(re)*z;case 125*D:case 59:case 0:switch(N){case 0:case 125:H=0;case 59+E:z==-1&&(re=Kn(re,/\f/g,"")),L>0&&ba(re)-S&&Ty(L>32?PI(re+";",r,n,S-1):PI(Kn(re," ","")+";",r,n,S-2),m);break;case 59:re+=";";default:if(Ty(te=SI(re,e,n,_,E,i,l,F,$=[],Q=[],S),a),N===123)if(E===0)a0(re,e,te,te,$,a,S,l,Q);else switch(I===99&&Ui(re,3)===110?100:I){case 100:case 108:case 109:case 115:a0(t,te,te,r&&Ty(SI(t,te,te,0,0,i,l,F,i,$=[],S),Q),i,Q,S,l,r?$:Q);break;default:a0(re,te,te,te,[""],Q,0,l,Q)}}_=E=L=0,D=z=1,F=re="",S=h;break;case 58:S=1+ba(re),L=O;default:if(D<1){if(N==123)--D;else if(N==125&&D++==0&&yZ()==125)continue}switch(re+=z_(N),N*D){case 38:z=E>0?1:(re+="\f",-1);break;case 44:l[_++]=(ba(re)-1)*z,z=1;break;case 64:Ma()===45&&(re+=o0(so())),I=Ma(),E=S=ba(F=re+=bZ(s0())),N++;break;case 45:O===45&&ba(re)==2&&(D=0)}}return a}function SI(t,e,n,r,i,a,h,l,m,_,E){for(var S=i-1,I=i===0?a:[""],L=LE(I),O=0,D=0,H=0;O<r;++O)for(var z=0,N=hm(t,S+1,S=hZ(D=h[O])),F=t;z<L;++z)(F=MO(D>0?I[z]+" "+N:Kn(N,/&\f/g,I[z])))&&(m[H++]=F);return N_(t,e,n,i===0?ME:l,m,_,E)}function EZ(t,e,n){return N_(t,e,n,AO,z_(gZ()),hm(t,2,-2),0)}function PI(t,e,n,r){return N_(t,e,n,kE,hm(t,0,r),hm(t,r+1,-1),r)}function ed(t,e){for(var n="",r=LE(t),i=0;i<r;i++)n+=e(t[i],i,t,e)||"";return n}function TZ(t,e,n,r){switch(t.type){case uZ:if(t.children.length)break;case cZ:case kE:return t.return=t.return||t.value;case AO:return"";case IO:return t.return=t.value+"{"+ed(t.children,r)+"}";case ME:t.value=t.props.join(",")}return ba(n=ed(t.children,r))?t.return=t.value+"{"+n+"}":""}function SZ(t){var e=LE(t);return function(n,r,i,a){for(var h="",l=0;l<e;l++)h+=t[l](n,r,i,a)||"";return h}}function PZ(t){return function(e){e.root||(e=e.return)&&t(e)}}var CZ=function(e,n,r){for(var i=0,a=0;i=a,a=Ma(),i===38&&a===12&&(n[r]=1),!dm(a);)so();return Dm(e,Bs)},AZ=function(e,n){var r=-1,i=44;do switch(dm(i)){case 0:i===38&&Ma()===12&&(n[r]=1),e[r]+=CZ(Bs-1,n,r);break;case 2:e[r]+=o0(i);break;case 4:if(i===44){e[++r]=Ma()===58?"&\f":"",n[r]=e[r].length;break}default:e[r]+=z_(i)}while(i=so());return e},IZ=function(e,n){return RO(AZ(LO(e),n))},CI=new WeakMap,MZ=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var n=e.value,r=e.parent,i=e.column===r.column&&e.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(e.props.length===1&&n.charCodeAt(0)!==58&&!CI.get(r))&&!i){CI.set(e,!0);for(var a=[],h=IZ(n,a),l=r.props,m=0,_=0;m<h.length;m++)for(var E=0;E<l.length;E++,_++)e.props[_]=a[m]?h[m].replace(/&\f/g,l[E]):l[E]+" "+h[m]}}},kZ=function(e){if(e.type==="decl"){var n=e.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(e.return="",e.value="")}};function OO(t,e){switch(fZ(t,e)){case 5103:return Yn+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Yn+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return Yn+t+J0+t+rs+t+t;case 6828:case 4268:return Yn+t+rs+t+t;case 6165:return Yn+t+rs+"flex-"+t+t;case 5187:return Yn+t+Kn(t,/(\w+).+(:[^]+)/,Yn+"box-$1$2"+rs+"flex-$1$2")+t;case 5443:return Yn+t+rs+"flex-item-"+Kn(t,/flex-|-self/,"")+t;case 4675:return Yn+t+rs+"flex-line-pack"+Kn(t,/align-content|flex-|-self/,"")+t;case 5548:return Yn+t+rs+Kn(t,"shrink","negative")+t;case 5292:return Yn+t+rs+Kn(t,"basis","preferred-size")+t;case 6060:return Yn+"box-"+Kn(t,"-grow","")+Yn+t+rs+Kn(t,"grow","positive")+t;case 4554:return Yn+Kn(t,/([^-])(transform)/g,"$1"+Yn+"$2")+t;case 6187:return Kn(Kn(Kn(t,/(zoom-|grab)/,Yn+"$1"),/(image-set)/,Yn+"$1"),t,"")+t;case 5495:case 3959:return Kn(t,/(image-set\([^]*)/,Yn+"$1$`$1");case 4968:return Kn(Kn(t,/(.+:)(flex-)?(.*)/,Yn+"box-pack:$3"+rs+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Yn+t+t;case 4095:case 3583:case 4068:case 2532:return Kn(t,/(.+)-inline(.+)/,Yn+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(ba(t)-1-e>6)switch(Ui(t,e+1)){case 109:if(Ui(t,e+4)!==45)break;case 102:return Kn(t,/(.+:)(.+)-([^]+)/,"$1"+Yn+"$2-$3$1"+J0+(Ui(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~Iw(t,"stretch")?OO(Kn(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(Ui(t,e+1)!==115)break;case 6444:switch(Ui(t,ba(t)-3-(~Iw(t,"!important")&&10))){case 107:return Kn(t,":",":"+Yn)+t;case 101:return Kn(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Yn+(Ui(t,14)===45?"inline-":"")+"box$3$1"+Yn+"$2$3$1"+rs+"$2box$3")+t}break;case 5936:switch(Ui(t,e+11)){case 114:return Yn+t+rs+Kn(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return Yn+t+rs+Kn(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return Yn+t+rs+Kn(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return Yn+t+rs+t+t}return t}var LZ=function(e,n,r,i){if(e.length>-1&&!e.return)switch(e.type){case kE:e.return=OO(e.value,e.length);break;case IO:return ed([ep(e,{value:Kn(e.value,"@","@"+Yn)})],i);case ME:if(e.length)return mZ(e.props,function(a){switch(pZ(a,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return ed([ep(e,{props:[Kn(a,/:(read-\w+)/,":"+J0+"$1")]})],i);case"::placeholder":return ed([ep(e,{props:[Kn(a,/:(plac\w+)/,":"+Yn+"input-$1")]}),ep(e,{props:[Kn(a,/:(plac\w+)/,":"+J0+"$1")]}),ep(e,{props:[Kn(a,/:(plac\w+)/,rs+"input-$1")]})],i)}return""})}},RZ=[LZ],OZ=function(e){var n=e.key;if(n==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(D){var H=D.getAttribute("data-emotion");H.indexOf(" ")!==-1&&(document.head.appendChild(D),D.setAttribute("data-s",""))})}var i=e.stylisPlugins||RZ,a={},h,l=[];h=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(D){for(var H=D.getAttribute("data-emotion").split(" "),z=1;z<H.length;z++)a[H[z]]=!0;l.push(D)});var m,_=[MZ,kZ];{var E,S=[TZ,PZ(function(D){E.insert(D)})],I=SZ(_.concat(i,S)),L=function(H){return ed(wZ(H),I)};m=function(H,z,N,F){E=N,L(H?H+"{"+z.styles+"}":z.styles),F&&(O.inserted[z.name]=!0)}}var O={key:n,sheet:new lZ({key:n,container:h,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:a,registered:{},insert:m};return O.sheet.hydrate(l),O},DO={exports:{}},rr={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mi=typeof Symbol=="function"&&Symbol.for,RE=Mi?Symbol.for("react.element"):60103,OE=Mi?Symbol.for("react.portal"):60106,B_=Mi?Symbol.for("react.fragment"):60107,U_=Mi?Symbol.for("react.strict_mode"):60108,V_=Mi?Symbol.for("react.profiler"):60114,j_=Mi?Symbol.for("react.provider"):60109,$_=Mi?Symbol.for("react.context"):60110,DE=Mi?Symbol.for("react.async_mode"):60111,G_=Mi?Symbol.for("react.concurrent_mode"):60111,H_=Mi?Symbol.for("react.forward_ref"):60112,W_=Mi?Symbol.for("react.suspense"):60113,DZ=Mi?Symbol.for("react.suspense_list"):60120,q_=Mi?Symbol.for("react.memo"):60115,Z_=Mi?Symbol.for("react.lazy"):60116,zZ=Mi?Symbol.for("react.block"):60121,FZ=Mi?Symbol.for("react.fundamental"):60117,NZ=Mi?Symbol.for("react.responder"):60118,BZ=Mi?Symbol.for("react.scope"):60119;function uo(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case RE:switch(t=t.type,t){case DE:case G_:case B_:case V_:case U_:case W_:return t;default:switch(t=t&&t.$$typeof,t){case $_:case H_:case Z_:case q_:case j_:return t;default:return e}}case OE:return e}}}function zO(t){return uo(t)===G_}rr.AsyncMode=DE;rr.ConcurrentMode=G_;rr.ContextConsumer=$_;rr.ContextProvider=j_;rr.Element=RE;rr.ForwardRef=H_;rr.Fragment=B_;rr.Lazy=Z_;rr.Memo=q_;rr.Portal=OE;rr.Profiler=V_;rr.StrictMode=U_;rr.Suspense=W_;rr.isAsyncMode=function(t){return zO(t)||uo(t)===DE};rr.isConcurrentMode=zO;rr.isContextConsumer=function(t){return uo(t)===$_};rr.isContextProvider=function(t){return uo(t)===j_};rr.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===RE};rr.isForwardRef=function(t){return uo(t)===H_};rr.isFragment=function(t){return uo(t)===B_};rr.isLazy=function(t){return uo(t)===Z_};rr.isMemo=function(t){return uo(t)===q_};rr.isPortal=function(t){return uo(t)===OE};rr.isProfiler=function(t){return uo(t)===V_};rr.isStrictMode=function(t){return uo(t)===U_};rr.isSuspense=function(t){return uo(t)===W_};rr.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===B_||t===G_||t===V_||t===U_||t===W_||t===DZ||typeof t=="object"&&t!==null&&(t.$$typeof===Z_||t.$$typeof===q_||t.$$typeof===j_||t.$$typeof===$_||t.$$typeof===H_||t.$$typeof===FZ||t.$$typeof===NZ||t.$$typeof===BZ||t.$$typeof===zZ)};rr.typeOf=uo;DO.exports=rr;var UZ=DO.exports,FO=UZ,VZ={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},jZ={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},NO={};NO[FO.ForwardRef]=VZ;NO[FO.Memo]=jZ;var $Z=!0;function GZ(t,e,n){var r="";return n.split(" ").forEach(function(i){t[i]!==void 0?e.push(t[i]+";"):r+=i+" "}),r}var BO=function(e,n,r){var i=e.key+"-"+n.name;(r===!1||$Z===!1)&&e.registered[i]===void 0&&(e.registered[i]=n.styles)},UO=function(e,n,r){BO(e,n,r);var i=e.key+"-"+n.name;if(e.inserted[n.name]===void 0){var a=n;do e.insert(n===a?"."+i:"",a,e.sheet,!0),a=a.next;while(a!==void 0)}};function HZ(t){for(var e=0,n,r=0,i=t.length;i>=4;++r,i-=4)n=t.charCodeAt(r)&255|(t.charCodeAt(++r)&255)<<8|(t.charCodeAt(++r)&255)<<16|(t.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,e=(n&65535)*1540483477+((n>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(i){case 3:e^=(t.charCodeAt(r+2)&255)<<16;case 2:e^=(t.charCodeAt(r+1)&255)<<8;case 1:e^=t.charCodeAt(r)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var WZ={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},qZ=/[A-Z]|^ms/g,ZZ=/_EMO_([^_]+?)_([^]*?)_EMO_/g,VO=function(e){return e.charCodeAt(1)===45},AI=function(e){return e!=null&&typeof e!="boolean"},Bx=CO(function(t){return VO(t)?t:t.replace(qZ,"-$&").toLowerCase()}),II=function(e,n){switch(e){case"animation":case"animationName":if(typeof n=="string")return n.replace(ZZ,function(r,i,a){return wa={name:i,styles:a,next:wa},i})}return WZ[e]!==1&&!VO(e)&&typeof n=="number"&&n!==0?n+"px":n};function fm(t,e,n){if(n==null)return"";if(n.__emotion_styles!==void 0)return n;switch(typeof n){case"boolean":return"";case"object":{if(n.anim===1)return wa={name:n.name,styles:n.styles,next:wa},n.name;if(n.styles!==void 0){var r=n.next;if(r!==void 0)for(;r!==void 0;)wa={name:r.name,styles:r.styles,next:wa},r=r.next;var i=n.styles+";";return i}return XZ(t,e,n)}case"function":{if(t!==void 0){var a=wa,h=n(t);return wa=a,fm(t,e,h)}break}}if(e==null)return n;var l=e[n];return l!==void 0?l:n}function XZ(t,e,n){var r="";if(Array.isArray(n))for(var i=0;i<n.length;i++)r+=fm(t,e,n[i])+";";else for(var a in n){var h=n[a];if(typeof h!="object")e!=null&&e[h]!==void 0?r+=a+"{"+e[h]+"}":AI(h)&&(r+=Bx(a)+":"+II(a,h)+";");else if(Array.isArray(h)&&typeof h[0]=="string"&&(e==null||e[h[0]]===void 0))for(var l=0;l<h.length;l++)AI(h[l])&&(r+=Bx(a)+":"+II(a,h[l])+";");else{var m=fm(t,e,h);switch(a){case"animation":case"animationName":{r+=Bx(a)+":"+m+";";break}default:r+=a+"{"+m+"}"}}}return r}var MI=/label:\s*([^\s;\n{]+)\s*(;|$)/g,wa,zE=function(e,n,r){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var i=!0,a="";wa=void 0;var h=e[0];h==null||h.raw===void 0?(i=!1,a+=fm(r,n,h)):a+=h[0];for(var l=1;l<e.length;l++)a+=fm(r,n,e[l]),i&&(a+=h[l]);MI.lastIndex=0;for(var m="",_;(_=MI.exec(a))!==null;)m+="-"+_[1];var E=HZ(a)+m;return{name:E,styles:a,next:wa}},YZ=function(e){return e()},jO=Kx["useInsertionEffect"]?Kx["useInsertionEffect"]:!1,KZ=jO||YZ,kI=jO||Z.useLayoutEffect,$O=Z.createContext(typeof HTMLElement<"u"?OZ({key:"css"}):null);$O.Provider;var GO=function(e){return Z.forwardRef(function(n,r){var i=Z.useContext($O);return e(n,i,r)})},X_=Z.createContext({}),JZ=GO(function(t,e){var n=t.styles,r=zE([n],void 0,Z.useContext(X_)),i=Z.useRef();return kI(function(){var a=e.key+"-global",h=new e.sheet.constructor({key:a,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),l=!1,m=document.querySelector('style[data-emotion="'+a+" "+r.name+'"]');return e.sheet.tags.length&&(h.before=e.sheet.tags[0]),m!==null&&(l=!0,m.setAttribute("data-emotion",a),h.hydrate([m])),i.current=[h,l],function(){h.flush()}},[e]),kI(function(){var a=i.current,h=a[0],l=a[1];if(l){a[1]=!1;return}if(r.next!==void 0&&UO(e,r.next,!0),h.tags.length){var m=h.tags[h.tags.length-1].nextElementSibling;h.before=m,h.flush()}e.insert("",r,h,!1)},[e,r.name]),null});function FE(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return zE(e)}var zm=function(){var e=FE.apply(void 0,arguments),n="animation-"+e.name;return{name:n,styles:"@keyframes "+n+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},QZ=sZ,eX=function(e){return e!=="theme"},LI=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?QZ:eX},RI=function(e,n,r){var i;if(n){var a=n.shouldForwardProp;i=e.__emotion_forwardProp&&a?function(h){return e.__emotion_forwardProp(h)&&a(h)}:a}return typeof i!="function"&&r&&(i=e.__emotion_forwardProp),i},tX=function(e){var n=e.cache,r=e.serialized,i=e.isStringTag;return BO(n,r,i),KZ(function(){return UO(n,r,i)}),null},nX=function t(e,n){var r=e.__emotion_real===e,i=r&&e.__emotion_base||e,a,h;n!==void 0&&(a=n.label,h=n.target);var l=RI(e,n,r),m=l||LI(i),_=!m("as");return function(){var E=arguments,S=r&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(a!==void 0&&S.push("label:"+a+";"),E[0]==null||E[0].raw===void 0)S.push.apply(S,E);else{S.push(E[0][0]);for(var I=E.length,L=1;L<I;L++)S.push(E[L],E[0][L])}var O=GO(function(D,H,z){var N=_&&D.as||i,F="",$=[],Q=D;if(D.theme==null){Q={};for(var te in D)Q[te]=D[te];Q.theme=Z.useContext(X_)}typeof D.className=="string"?F=GZ(H.registered,$,D.className):D.className!=null&&(F=D.className+" ");var re=zE(S.concat($),H.registered,Q);F+=H.key+"-"+re.name,h!==void 0&&(F+=" "+h);var we=_&&l===void 0?LI(N):m,Ee={};for(var de in D)_&&de==="as"||we(de)&&(Ee[de]=D[de]);return Ee.className=F,Ee.ref=z,Z.createElement(Z.Fragment,null,Z.createElement(tX,{cache:H,serialized:re,isStringTag:typeof N=="string"}),Z.createElement(N,Ee))});return O.displayName=a!==void 0?a:"Styled("+(typeof i=="string"?i:i.displayName||i.name||"Component")+")",O.defaultProps=e.defaultProps,O.__emotion_real=O,O.__emotion_base=i,O.__emotion_styles=S,O.__emotion_forwardProp=l,Object.defineProperty(O,"toString",{value:function(){return"."+h}}),O.withComponent=function(D,H){return t(D,se({},n,H,{shouldForwardProp:RI(O,H,!0)})).apply(void 0,S)},O}},rX=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],kw=nX.bind();rX.forEach(function(t){kw[t]=kw(t)});function iX(t){return t==null||Object.keys(t).length===0}function sX(t){const{styles:e,defaultTheme:n={}}=t,r=typeof e=="function"?i=>e(iX(i)?n:i):e;return ve.jsx(JZ,{styles:r})}/**
 * @mui/styled-engine v5.14.14
 *
 * @license MIT
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function HO(t,e){return kw(t,e)}const oX=(t,e)=>{Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=e(t.__emotion_styles))},aX=["values","unit","step"],lX=t=>{const e=Object.keys(t).map(n=>({key:n,val:t[n]}))||[];return e.sort((n,r)=>n.val-r.val),e.reduce((n,r)=>se({},n,{[r.key]:r.val}),{})};function cX(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:r=5}=t,i=nn(t,aX),a=lX(e),h=Object.keys(a);function l(I){return`@media (min-width:${typeof e[I]=="number"?e[I]:I}${n})`}function m(I){return`@media (max-width:${(typeof e[I]=="number"?e[I]:I)-r/100}${n})`}function _(I,L){const O=h.indexOf(L);return`@media (min-width:${typeof e[I]=="number"?e[I]:I}${n}) and (max-width:${(O!==-1&&typeof e[h[O]]=="number"?e[h[O]]:L)-r/100}${n})`}function E(I){return h.indexOf(I)+1<h.length?_(I,h[h.indexOf(I)+1]):l(I)}function S(I){const L=h.indexOf(I);return L===0?l(h[1]):L===h.length-1?m(h[L]):_(I,h[h.indexOf(I)+1]).replace("@media","@media not all and")}return se({keys:h,values:a,up:l,down:m,between:_,only:E,not:S,unit:n},i)}const uX={borderRadius:4},hX=uX;function Ip(t,e){return e?zs(t,e,{clone:!1}):t}const NE={xs:0,sm:600,md:900,lg:1200,xl:1536},OI={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${NE[t]}px)`};function pl(t,e,n){const r=t.theme||{};if(Array.isArray(e)){const a=r.breakpoints||OI;return e.reduce((h,l,m)=>(h[a.up(a.keys[m])]=n(e[m]),h),{})}if(typeof e=="object"){const a=r.breakpoints||OI;return Object.keys(e).reduce((h,l)=>{if(Object.keys(a.values||NE).indexOf(l)!==-1){const m=a.up(l);h[m]=n(e[l],l)}else{const m=l;h[m]=e[m]}return h},{})}return n(e)}function dX(t={}){var e;return((e=t.keys)==null?void 0:e.reduce((r,i)=>{const a=t.up(i);return r[a]={},r},{}))||{}}function fX(t,e){return t.reduce((n,r)=>{const i=n[r];return(!i||Object.keys(i).length===0)&&delete n[r],n},e)}function Y_(t,e,n=!0){if(!e||typeof e!="string")return null;if(t&&t.vars&&n){const r=`vars.${e}`.split(".").reduce((i,a)=>i&&i[a]?i[a]:null,t);if(r!=null)return r}return e.split(".").reduce((r,i)=>r&&r[i]!=null?r[i]:null,t)}function Q0(t,e,n,r=n){let i;return typeof t=="function"?i=t(n):Array.isArray(t)?i=t[n]||r:i=Y_(t,n)||r,e&&(i=e(i,r,t)),i}function er(t){const{prop:e,cssProperty:n=t.prop,themeKey:r,transform:i}=t,a=h=>{if(h[e]==null)return null;const l=h[e],m=h.theme,_=Y_(m,r)||{};return pl(h,l,S=>{let I=Q0(_,i,S);return S===I&&typeof S=="string"&&(I=Q0(_,i,`${e}${S==="default"?"":Yt(S)}`,S)),n===!1?I:{[n]:I}})};return a.propTypes={},a.filterProps=[e],a}function pX(t){const e={};return n=>(e[n]===void 0&&(e[n]=t(n)),e[n])}const mX={m:"margin",p:"padding"},gX={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},DI={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},yX=pX(t=>{if(t.length>2)if(DI[t])t=DI[t];else return[t];const[e,n]=t.split(""),r=mX[e],i=gX[n]||"";return Array.isArray(i)?i.map(a=>r+a):[r+i]}),BE=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],UE=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...BE,...UE];function Fm(t,e,n,r){var i;const a=(i=Y_(t,e,!1))!=null?i:n;return typeof a=="number"?h=>typeof h=="string"?h:a*h:Array.isArray(a)?h=>typeof h=="string"?h:a[h]:typeof a=="function"?a:()=>{}}function WO(t){return Fm(t,"spacing",8)}function Nm(t,e){if(typeof e=="string"||e==null)return e;const n=Math.abs(e),r=t(n);return e>=0?r:typeof r=="number"?-r:`-${r}`}function _X(t,e){return n=>t.reduce((r,i)=>(r[i]=Nm(e,n),r),{})}function vX(t,e,n,r){if(e.indexOf(n)===-1)return null;const i=yX(n),a=_X(i,r),h=t[n];return pl(t,h,a)}function qO(t,e){const n=WO(t.theme);return Object.keys(t).map(r=>vX(t,e,r,n)).reduce(Ip,{})}function Wr(t){return qO(t,BE)}Wr.propTypes={};Wr.filterProps=BE;function qr(t){return qO(t,UE)}qr.propTypes={};qr.filterProps=UE;function xX(t=8){if(t.mui)return t;const e=WO({spacing:t}),n=(...r)=>(r.length===0?[1]:r).map(a=>{const h=e(a);return typeof h=="number"?`${h}px`:h}).join(" ");return n.mui=!0,n}function K_(...t){const e=t.reduce((r,i)=>(i.filterProps.forEach(a=>{r[a]=i}),r),{}),n=r=>Object.keys(r).reduce((i,a)=>e[a]?Ip(i,e[a](r)):i,{});return n.propTypes={},n.filterProps=t.reduce((r,i)=>r.concat(i.filterProps),[]),n}function Sa(t){return typeof t!="number"?t:`${t}px solid`}const bX=er({prop:"border",themeKey:"borders",transform:Sa}),wX=er({prop:"borderTop",themeKey:"borders",transform:Sa}),EX=er({prop:"borderRight",themeKey:"borders",transform:Sa}),TX=er({prop:"borderBottom",themeKey:"borders",transform:Sa}),SX=er({prop:"borderLeft",themeKey:"borders",transform:Sa}),PX=er({prop:"borderColor",themeKey:"palette"}),CX=er({prop:"borderTopColor",themeKey:"palette"}),AX=er({prop:"borderRightColor",themeKey:"palette"}),IX=er({prop:"borderBottomColor",themeKey:"palette"}),MX=er({prop:"borderLeftColor",themeKey:"palette"}),J_=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const e=Fm(t.theme,"shape.borderRadius",4),n=r=>({borderRadius:Nm(e,r)});return pl(t,t.borderRadius,n)}return null};J_.propTypes={};J_.filterProps=["borderRadius"];K_(bX,wX,EX,TX,SX,PX,CX,AX,IX,MX,J_);const Q_=t=>{if(t.gap!==void 0&&t.gap!==null){const e=Fm(t.theme,"spacing",8),n=r=>({gap:Nm(e,r)});return pl(t,t.gap,n)}return null};Q_.propTypes={};Q_.filterProps=["gap"];const ev=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const e=Fm(t.theme,"spacing",8),n=r=>({columnGap:Nm(e,r)});return pl(t,t.columnGap,n)}return null};ev.propTypes={};ev.filterProps=["columnGap"];const tv=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const e=Fm(t.theme,"spacing",8),n=r=>({rowGap:Nm(e,r)});return pl(t,t.rowGap,n)}return null};tv.propTypes={};tv.filterProps=["rowGap"];const kX=er({prop:"gridColumn"}),LX=er({prop:"gridRow"}),RX=er({prop:"gridAutoFlow"}),OX=er({prop:"gridAutoColumns"}),DX=er({prop:"gridAutoRows"}),zX=er({prop:"gridTemplateColumns"}),FX=er({prop:"gridTemplateRows"}),NX=er({prop:"gridTemplateAreas"}),BX=er({prop:"gridArea"});K_(Q_,ev,tv,kX,LX,RX,OX,DX,zX,FX,NX,BX);function td(t,e){return e==="grey"?e:t}const UX=er({prop:"color",themeKey:"palette",transform:td}),VX=er({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:td}),jX=er({prop:"backgroundColor",themeKey:"palette",transform:td});K_(UX,VX,jX);function Qs(t){return t<=1&&t!==0?`${t*100}%`:t}const $X=er({prop:"width",transform:Qs}),VE=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const e=n=>{var r,i;const a=((r=t.theme)==null||(r=r.breakpoints)==null||(r=r.values)==null?void 0:r[n])||NE[n];return a?((i=t.theme)==null||(i=i.breakpoints)==null?void 0:i.unit)!=="px"?{maxWidth:`${a}${t.theme.breakpoints.unit}`}:{maxWidth:a}:{maxWidth:Qs(n)}};return pl(t,t.maxWidth,e)}return null};VE.filterProps=["maxWidth"];const GX=er({prop:"minWidth",transform:Qs}),HX=er({prop:"height",transform:Qs}),WX=er({prop:"maxHeight",transform:Qs}),qX=er({prop:"minHeight",transform:Qs});er({prop:"size",cssProperty:"width",transform:Qs});er({prop:"size",cssProperty:"height",transform:Qs});const ZX=er({prop:"boxSizing"});K_($X,VE,GX,HX,WX,qX,ZX);const XX={border:{themeKey:"borders",transform:Sa},borderTop:{themeKey:"borders",transform:Sa},borderRight:{themeKey:"borders",transform:Sa},borderBottom:{themeKey:"borders",transform:Sa},borderLeft:{themeKey:"borders",transform:Sa},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:J_},color:{themeKey:"palette",transform:td},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:td},backgroundColor:{themeKey:"palette",transform:td},p:{style:qr},pt:{style:qr},pr:{style:qr},pb:{style:qr},pl:{style:qr},px:{style:qr},py:{style:qr},padding:{style:qr},paddingTop:{style:qr},paddingRight:{style:qr},paddingBottom:{style:qr},paddingLeft:{style:qr},paddingX:{style:qr},paddingY:{style:qr},paddingInline:{style:qr},paddingInlineStart:{style:qr},paddingInlineEnd:{style:qr},paddingBlock:{style:qr},paddingBlockStart:{style:qr},paddingBlockEnd:{style:qr},m:{style:Wr},mt:{style:Wr},mr:{style:Wr},mb:{style:Wr},ml:{style:Wr},mx:{style:Wr},my:{style:Wr},margin:{style:Wr},marginTop:{style:Wr},marginRight:{style:Wr},marginBottom:{style:Wr},marginLeft:{style:Wr},marginX:{style:Wr},marginY:{style:Wr},marginInline:{style:Wr},marginInlineStart:{style:Wr},marginInlineEnd:{style:Wr},marginBlock:{style:Wr},marginBlockStart:{style:Wr},marginBlockEnd:{style:Wr},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:Q_},rowGap:{style:tv},columnGap:{style:ev},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Qs},maxWidth:{style:VE},minWidth:{transform:Qs},height:{transform:Qs},maxHeight:{transform:Qs},minHeight:{transform:Qs},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}},nv=XX;function YX(...t){const e=t.reduce((r,i)=>r.concat(Object.keys(i)),[]),n=new Set(e);return t.every(r=>n.size===Object.keys(r).length)}function KX(t,e){return typeof t=="function"?t(e):t}function JX(){function t(n,r,i,a){const h={[n]:r,theme:i},l=a[n];if(!l)return{[n]:r};const{cssProperty:m=n,themeKey:_,transform:E,style:S}=l;if(r==null)return null;if(_==="typography"&&r==="inherit")return{[n]:r};const I=Y_(i,_)||{};return S?S(h):pl(h,r,O=>{let D=Q0(I,E,O);return O===D&&typeof O=="string"&&(D=Q0(I,E,`${n}${O==="default"?"":Yt(O)}`,O)),m===!1?D:{[m]:D}})}function e(n){var r;const{sx:i,theme:a={}}=n||{};if(!i)return null;const h=(r=a.unstable_sxConfig)!=null?r:nv;function l(m){let _=m;if(typeof m=="function")_=m(a);else if(typeof m!="object")return m;if(!_)return null;const E=dX(a.breakpoints),S=Object.keys(E);let I=E;return Object.keys(_).forEach(L=>{const O=KX(_[L],a);if(O!=null)if(typeof O=="object")if(h[L])I=Ip(I,t(L,O,a,h));else{const D=pl({theme:a},O,H=>({[L]:H}));YX(D,O)?I[L]=e({sx:O,theme:a}):I=Ip(I,D)}else I=Ip(I,t(L,O,a,h))}),fX(S,I)}return Array.isArray(i)?i.map(l):l(i)}return e}const ZO=JX();ZO.filterProps=["sx"];const rv=ZO,QX=["breakpoints","palette","spacing","shape"];function jE(t={},...e){const{breakpoints:n={},palette:r={},spacing:i,shape:a={}}=t,h=nn(t,QX),l=cX(n),m=xX(i);let _=zs({breakpoints:l,direction:"ltr",components:{},palette:se({mode:"light"},r),spacing:m,shape:se({},hX,a)},h);return _=e.reduce((E,S)=>zs(E,S),_),_.unstable_sxConfig=se({},nv,h==null?void 0:h.unstable_sxConfig),_.unstable_sx=function(S){return rv({sx:S,theme:this})},_}function eY(t){return Object.keys(t).length===0}function $E(t=null){const e=Z.useContext(X_);return!e||eY(e)?t:e}const tY=jE();function iv(t=tY){return $E(t)}function nY({styles:t,themeId:e,defaultTheme:n={}}){const r=iv(n),i=typeof t=="function"?t(e&&r[e]||r):t;return ve.jsx(sX,{styles:i})}const rY=["sx"],iY=t=>{var e,n;const r={systemProps:{},otherProps:{}},i=(e=t==null||(n=t.theme)==null?void 0:n.unstable_sxConfig)!=null?e:nv;return Object.keys(t).forEach(a=>{i[a]?r.systemProps[a]=t[a]:r.otherProps[a]=t[a]}),r};function XO(t){const{sx:e}=t,n=nn(t,rY),{systemProps:r,otherProps:i}=iY(n);let a;return Array.isArray(e)?a=[r,...e]:typeof e=="function"?a=(...h)=>{const l=e(...h);return nl(l)?se({},r,l):r}:a=se({},r,e),se({},i,{sx:a})}function YO(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=YO(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function fn(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=YO(t))&&(r&&(r+=" "),r+=e);return r}const sY=["className","component"];function oY(t={}){const{themeId:e,defaultTheme:n,defaultClassName:r="MuiBox-root",generateClassName:i}=t,a=HO("div",{shouldForwardProp:l=>l!=="theme"&&l!=="sx"&&l!=="as"})(rv);return Z.forwardRef(function(m,_){const E=iv(n),S=XO(m),{className:I,component:L="div"}=S,O=nn(S,sY);return ve.jsx(a,se({as:L,ref:_,className:fn(I,i?i(r):r),theme:e&&E[e]||E},O))})}const aY=["variant"];function zI(t){return t.length===0}function KO(t){const{variant:e}=t,n=nn(t,aY);let r=e||"";return Object.keys(n).sort().forEach(i=>{i==="color"?r+=zI(r)?t[i]:Yt(t[i]):r+=`${zI(r)?i:Yt(i)}${Yt(t[i].toString())}`}),r}const lY=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function cY(t){return Object.keys(t).length===0}function uY(t){return typeof t=="string"&&t.charCodeAt(0)>96}const hY=(t,e)=>e.components&&e.components[t]&&e.components[t].styleOverrides?e.components[t].styleOverrides:null,e_=t=>{const e={};return t&&t.forEach(n=>{const r=KO(n.props);e[r]=n.style}),e},dY=(t,e)=>{let n=[];return e&&e.components&&e.components[t]&&e.components[t].variants&&(n=e.components[t].variants),e_(n)},t_=(t,e,n)=>{const{ownerState:r={}}=t,i=[];return n&&n.forEach(a=>{let h=!0;Object.keys(a.props).forEach(l=>{r[l]!==a.props[l]&&t[l]!==a.props[l]&&(h=!1)}),h&&i.push(e[KO(a.props)])}),i},fY=(t,e,n,r)=>{var i;const a=n==null||(i=n.components)==null||(i=i[r])==null?void 0:i.variants;return t_(t,e,a)};function Mp(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const pY=jE(),mY=t=>t&&t.charAt(0).toLowerCase()+t.slice(1);function l0({defaultTheme:t,theme:e,themeId:n}){return cY(e)?t:e[n]||e}function gY(t){return t?(e,n)=>n[t]:null}const FI=({styledArg:t,props:e,defaultTheme:n,themeId:r})=>{const i=t(se({},e,{theme:l0(se({},e,{defaultTheme:n,themeId:r}))}));let a;if(i&&i.variants&&(a=i.variants,delete i.variants),a){const h=t_(e,e_(a),a);return[i,...h]}return i};function yY(t={}){const{themeId:e,defaultTheme:n=pY,rootShouldForwardProp:r=Mp,slotShouldForwardProp:i=Mp}=t,a=h=>rv(se({},h,{theme:l0(se({},h,{defaultTheme:n,themeId:e}))}));return a.__mui_systemSx=!0,(h,l={})=>{oX(h,$=>$.filter(Q=>!(Q!=null&&Q.__mui_systemSx)));const{name:m,slot:_,skipVariantsResolver:E,skipSx:S,overridesResolver:I=gY(mY(_))}=l,L=nn(l,lY),O=E!==void 0?E:_&&_!=="Root"&&_!=="root"||!1,D=S||!1;let H,z=Mp;_==="Root"||_==="root"?z=r:_?z=i:uY(h)&&(z=void 0);const N=HO(h,se({shouldForwardProp:z,label:H},L)),F=($,...Q)=>{const te=Q?Q.map(de=>{if(typeof de=="function"&&de.__emotion_real!==de)return Le=>FI({styledArg:de,props:Le,defaultTheme:n,themeId:e});if(nl(de)){let Le=de,Ge;return de&&de.variants&&(Ge=de.variants,delete Le.variants,Le=Be=>{let Oe=de;return t_(Be,e_(Ge),Ge).forEach(je=>{Oe=zs(Oe,je)}),Oe}),Le}return de}):[];let re=$;if(nl($)){let de;$&&$.variants&&(de=$.variants,delete re.variants,re=Le=>{let Ge=$;return t_(Le,e_(de),de).forEach(Oe=>{Ge=zs(Ge,Oe)}),Ge})}else typeof $=="function"&&$.__emotion_real!==$&&(re=de=>FI({styledArg:$,props:de,defaultTheme:n,themeId:e}));m&&I&&te.push(de=>{const Le=l0(se({},de,{defaultTheme:n,themeId:e})),Ge=hY(m,Le);if(Ge){const Be={};return Object.entries(Ge).forEach(([Oe,Ke])=>{Be[Oe]=typeof Ke=="function"?Ke(se({},de,{theme:Le})):Ke}),I(de,Be)}return null}),m&&!O&&te.push(de=>{const Le=l0(se({},de,{defaultTheme:n,themeId:e}));return fY(de,dY(m,Le),Le,m)}),D||te.push(a);const we=te.length-Q.length;if(Array.isArray($)&&we>0){const de=new Array(we).fill("");re=[...$,...de],re.raw=[...$.raw,...de]}const Ee=N(re,...te);return h.muiName&&(Ee.muiName=h.muiName),Ee};return N.withConfig&&(F.withConfig=N.withConfig),F}}function _Y(t){const{theme:e,name:n,props:r}=t;return!e||!e.components||!e.components[n]||!e.components[n].defaultProps?r:IE(e.components[n].defaultProps,r)}function vY({props:t,name:e,defaultTheme:n,themeId:r}){let i=iv(n);return r&&(i=i[r]||i),_Y({theme:i,name:e,props:t})}function GE(t,e=0,n=1){return Math.min(Math.max(e,t),n)}function xY(t){t=t.slice(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let n=t.match(e);return n&&n[0].length===1&&(n=n.map(r=>r+r)),n?`rgb${n.length===4?"a":""}(${n.map((r,i)=>i<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3).join(", ")})`:""}function wu(t){if(t.type)return t;if(t.charAt(0)==="#")return wu(xY(t));const e=t.indexOf("("),n=t.substring(0,e);if(["rgb","rgba","hsl","hsla","color"].indexOf(n)===-1)throw new Error(vc(9,t));let r=t.substring(e+1,t.length-1),i;if(n==="color"){if(r=r.split(" "),i=r.shift(),r.length===4&&r[3].charAt(0)==="/"&&(r[3]=r[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(i)===-1)throw new Error(vc(10,i))}else r=r.split(",");return r=r.map(a=>parseFloat(a)),{type:n,values:r,colorSpace:i}}function sv(t){const{type:e,colorSpace:n}=t;let{values:r}=t;return e.indexOf("rgb")!==-1?r=r.map((i,a)=>a<3?parseInt(i,10):i):e.indexOf("hsl")!==-1&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),e.indexOf("color")!==-1?r=`${n} ${r.join(" ")}`:r=`${r.join(", ")}`,`${e}(${r})`}function bY(t){t=wu(t);const{values:e}=t,n=e[0],r=e[1]/100,i=e[2]/100,a=r*Math.min(i,1-i),h=(_,E=(_+n/30)%12)=>i-a*Math.max(Math.min(E-3,9-E,1),-1);let l="rgb";const m=[Math.round(h(0)*255),Math.round(h(8)*255),Math.round(h(4)*255)];return t.type==="hsla"&&(l+="a",m.push(e[3])),sv({type:l,values:m})}function Lw(t){t=wu(t);let e=t.type==="hsl"||t.type==="hsla"?wu(bY(t)).values:t.values;return e=e.map(n=>(t.type!=="color"&&(n/=255),n<=.03928?n/12.92:((n+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function wY(t,e){const n=Lw(t),r=Lw(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}function Ai(t,e){return t=wu(t),e=GE(e),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${e}`:t.values[3]=e,sv(t)}function pm(t,e){if(t=wu(t),e=GE(e),t.type.indexOf("hsl")!==-1)t.values[2]*=1-e;else if(t.type.indexOf("rgb")!==-1||t.type.indexOf("color")!==-1)for(let n=0;n<3;n+=1)t.values[n]*=1-e;return sv(t)}function mm(t,e){if(t=wu(t),e=GE(e),t.type.indexOf("hsl")!==-1)t.values[2]+=(100-t.values[2])*e;else if(t.type.indexOf("rgb")!==-1)for(let n=0;n<3;n+=1)t.values[n]+=(255-t.values[n])*e;else if(t.type.indexOf("color")!==-1)for(let n=0;n<3;n+=1)t.values[n]+=(1-t.values[n])*e;return sv(t)}function EY(t,e=.15){return Lw(t)>.5?pm(t,e):mm(t,e)}const TY=Z.createContext(null),JO=TY;function QO(){return Z.useContext(JO)}const SY=typeof Symbol=="function"&&Symbol.for,PY=SY?Symbol.for("mui.nested"):"__THEME_NESTED__";function CY(t,e){return typeof e=="function"?e(t):se({},t,e)}function AY(t){const{children:e,theme:n}=t,r=QO(),i=Z.useMemo(()=>{const a=r===null?n:CY(r,n);return a!=null&&(a[PY]=r!==null),a},[n,r]);return ve.jsx(JO.Provider,{value:i,children:e})}const NI={};function BI(t,e,n,r=!1){return Z.useMemo(()=>{const i=t&&e[t]||e;if(typeof n=="function"){const a=n(i),h=t?se({},e,{[t]:a}):a;return r?()=>h:h}return t?se({},e,{[t]:n}):se({},e,n)},[t,e,n,r])}function IY(t){const{children:e,theme:n,themeId:r}=t,i=$E(NI),a=QO()||NI,h=BI(r,i,n),l=BI(r,a,n,!0);return ve.jsx(AY,{theme:l,children:ve.jsx(X_.Provider,{value:h,children:e})})}function MY(t,e){return se({toolbar:{minHeight:56,[t.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}}},e)}const kY=["mode","contrastThreshold","tonalOffset"],UI={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:um.white,default:um.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},Ux={text:{primary:um.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:um.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function VI(t,e,n,r){const i=r.light||r,a=r.dark||r*1.5;t[e]||(t.hasOwnProperty(n)?t[e]=t[n]:e==="light"?t.light=mm(t.main,i):e==="dark"&&(t.dark=pm(t.main,a)))}function LY(t="light"){return t==="dark"?{main:Th[200],light:Th[50],dark:Th[400]}:{main:Th[700],light:Th[400],dark:Th[800]}}function RY(t="light"){return t==="dark"?{main:Eh[200],light:Eh[50],dark:Eh[400]}:{main:Eh[500],light:Eh[300],dark:Eh[700]}}function OY(t="light"){return t==="dark"?{main:wh[500],light:wh[300],dark:wh[700]}:{main:wh[700],light:wh[400],dark:wh[800]}}function DY(t="light"){return t==="dark"?{main:Sh[400],light:Sh[300],dark:Sh[700]}:{main:Sh[700],light:Sh[500],dark:Sh[900]}}function zY(t="light"){return t==="dark"?{main:Ph[400],light:Ph[300],dark:Ph[700]}:{main:Ph[800],light:Ph[500],dark:Ph[900]}}function FY(t="light"){return t==="dark"?{main:Qf[400],light:Qf[300],dark:Qf[700]}:{main:"#ed6c02",light:Qf[500],dark:Qf[900]}}function NY(t){const{mode:e="light",contrastThreshold:n=3,tonalOffset:r=.2}=t,i=nn(t,kY),a=t.primary||LY(e),h=t.secondary||RY(e),l=t.error||OY(e),m=t.info||DY(e),_=t.success||zY(e),E=t.warning||FY(e);function S(D){return wY(D,Ux.text.primary)>=n?Ux.text.primary:UI.text.primary}const I=({color:D,name:H,mainShade:z=500,lightShade:N=300,darkShade:F=700})=>{if(D=se({},D),!D.main&&D[z]&&(D.main=D[z]),!D.hasOwnProperty("main"))throw new Error(vc(11,H?` (${H})`:"",z));if(typeof D.main!="string")throw new Error(vc(12,H?` (${H})`:"",JSON.stringify(D.main)));return VI(D,"light",N,r),VI(D,"dark",F,r),D.contrastText||(D.contrastText=S(D.main)),D},L={dark:Ux,light:UI};return zs(se({common:se({},um),mode:e,primary:I({color:a,name:"primary"}),secondary:I({color:h,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:I({color:l,name:"error"}),warning:I({color:E,name:"warning"}),info:I({color:m,name:"info"}),success:I({color:_,name:"success"}),grey:Gq,contrastThreshold:n,getContrastText:S,augmentColor:I,tonalOffset:r},L[e]),i)}const BY=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function UY(t){return Math.round(t*1e5)/1e5}const jI={textTransform:"uppercase"},$I='"Roboto", "Helvetica", "Arial", sans-serif';function VY(t,e){const n=typeof e=="function"?e(t):e,{fontFamily:r=$I,fontSize:i=14,fontWeightLight:a=300,fontWeightRegular:h=400,fontWeightMedium:l=500,fontWeightBold:m=700,htmlFontSize:_=16,allVariants:E,pxToRem:S}=n,I=nn(n,BY),L=i/14,O=S||(z=>`${z/_*L}rem`),D=(z,N,F,$,Q)=>se({fontFamily:r,fontWeight:z,fontSize:O(N),lineHeight:F},r===$I?{letterSpacing:`${UY($/N)}em`}:{},Q,E),H={h1:D(a,96,1.167,-1.5),h2:D(a,60,1.2,-.5),h3:D(h,48,1.167,0),h4:D(h,34,1.235,.25),h5:D(h,24,1.334,0),h6:D(l,20,1.6,.15),subtitle1:D(h,16,1.75,.15),subtitle2:D(l,14,1.57,.1),body1:D(h,16,1.5,.15),body2:D(h,14,1.43,.15),button:D(l,14,1.75,.4,jI),caption:D(h,12,1.66,.4),overline:D(h,12,2.66,1,jI),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return zs(se({htmlFontSize:_,pxToRem:O,fontFamily:r,fontSize:i,fontWeightLight:a,fontWeightRegular:h,fontWeightMedium:l,fontWeightBold:m},H),I,{clone:!1})}const jY=.2,$Y=.14,GY=.12;function Rr(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${jY})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${$Y})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${GY})`].join(",")}const HY=["none",Rr(0,2,1,-1,0,1,1,0,0,1,3,0),Rr(0,3,1,-2,0,2,2,0,0,1,5,0),Rr(0,3,3,-2,0,3,4,0,0,1,8,0),Rr(0,2,4,-1,0,4,5,0,0,1,10,0),Rr(0,3,5,-1,0,5,8,0,0,1,14,0),Rr(0,3,5,-1,0,6,10,0,0,1,18,0),Rr(0,4,5,-2,0,7,10,1,0,2,16,1),Rr(0,5,5,-3,0,8,10,1,0,3,14,2),Rr(0,5,6,-3,0,9,12,1,0,3,16,2),Rr(0,6,6,-3,0,10,14,1,0,4,18,3),Rr(0,6,7,-4,0,11,15,1,0,4,20,3),Rr(0,7,8,-4,0,12,17,2,0,5,22,4),Rr(0,7,8,-4,0,13,19,2,0,5,24,4),Rr(0,7,9,-4,0,14,21,2,0,5,26,4),Rr(0,8,9,-5,0,15,22,2,0,6,28,5),Rr(0,8,10,-5,0,16,24,2,0,6,30,5),Rr(0,8,11,-5,0,17,26,2,0,6,32,5),Rr(0,9,11,-5,0,18,28,2,0,7,34,6),Rr(0,9,12,-6,0,19,29,2,0,7,36,6),Rr(0,10,13,-6,0,20,31,3,0,8,38,7),Rr(0,10,13,-6,0,21,33,3,0,8,40,7),Rr(0,10,14,-6,0,22,35,3,0,8,42,7),Rr(0,11,14,-7,0,23,36,3,0,9,44,8),Rr(0,11,15,-7,0,24,38,3,0,9,46,8)],WY=HY,qY=["duration","easing","delay"],ZY={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},XY={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function GI(t){return`${Math.round(t)}ms`}function YY(t){if(!t)return 0;const e=t/36;return Math.round((4+15*e**.25+e/5)*10)}function KY(t){const e=se({},ZY,t.easing),n=se({},XY,t.duration);return se({getAutoHeightDuration:YY,create:(i=["all"],a={})=>{const{duration:h=n.standard,easing:l=e.easeInOut,delay:m=0}=a;return nn(a,qY),(Array.isArray(i)?i:[i]).map(_=>`${_} ${typeof h=="string"?h:GI(h)} ${l} ${typeof m=="string"?m:GI(m)}`).join(",")}},t,{easing:e,duration:n})}const JY={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},QY=JY,eK=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function HE(t={},...e){const{mixins:n={},palette:r={},transitions:i={},typography:a={}}=t,h=nn(t,eK);if(t.vars)throw new Error(vc(18));const l=NY(r),m=jE(t);let _=zs(m,{mixins:MY(m.breakpoints,n),palette:l,shadows:WY.slice(),typography:VY(l,a),transitions:KY(i),zIndex:se({},QY)});return _=zs(_,h),_=e.reduce((E,S)=>zs(E,S),_),_.unstable_sxConfig=se({},nv,h==null?void 0:h.unstable_sxConfig),_.unstable_sx=function(S){return rv({sx:S,theme:this})},_}const tK=HE(),ov=tK;function Ec(){const t=iv(ov);return t[bu]||t}function Gn({props:t,name:e}){return vY({props:t,name:e,defaultTheme:ov,themeId:bu})}const la=t=>Mp(t)&&t!=="classes",WE=Mp,nK=yY({themeId:bu,defaultTheme:ov,rootShouldForwardProp:la}),At=nK,rK=["theme"];function iK(t){let{theme:e}=t,n=nn(t,rK);const r=e[bu];return ve.jsx(IY,se({},n,{themeId:r?bu:void 0,theme:r||e}))}const sK=t=>{let e;return t<1?e=5.11916*t**2:e=4.5*Math.log(t+1)+2,(e/100).toFixed(2)},HI=sK;function oK(t){return $n("MuiSvgIcon",t)}Bn("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const aK=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],lK=t=>{const{color:e,fontSize:n,classes:r}=t,i={root:["root",e!=="inherit"&&`color${Yt(e)}`,`fontSize${Yt(n)}`]};return qn(i,oK,r)},cK=At("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.color!=="inherit"&&e[`color${Yt(n.color)}`],e[`fontSize${Yt(n.fontSize)}`]]}})(({theme:t,ownerState:e})=>{var n,r,i,a,h,l,m,_,E,S,I,L,O;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:e.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:(n=t.transitions)==null||(r=n.create)==null?void 0:r.call(n,"fill",{duration:(i=t.transitions)==null||(i=i.duration)==null?void 0:i.shorter}),fontSize:{inherit:"inherit",small:((a=t.typography)==null||(h=a.pxToRem)==null?void 0:h.call(a,20))||"1.25rem",medium:((l=t.typography)==null||(m=l.pxToRem)==null?void 0:m.call(l,24))||"1.5rem",large:((_=t.typography)==null||(E=_.pxToRem)==null?void 0:E.call(_,35))||"2.1875rem"}[e.fontSize],color:(S=(I=(t.vars||t).palette)==null||(I=I[e.color])==null?void 0:I.main)!=null?S:{action:(L=(t.vars||t).palette)==null||(L=L.action)==null?void 0:L.active,disabled:(O=(t.vars||t).palette)==null||(O=O.action)==null?void 0:O.disabled,inherit:void 0}[e.color]}}),eD=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiSvgIcon"}),{children:i,className:a,color:h="inherit",component:l="svg",fontSize:m="medium",htmlColor:_,inheritViewBox:E=!1,titleAccess:S,viewBox:I="0 0 24 24"}=r,L=nn(r,aK),O=Z.isValidElement(i)&&i.type==="svg",D=se({},r,{color:h,component:l,fontSize:m,instanceFontSize:e.fontSize,inheritViewBox:E,viewBox:I,hasSvgAsChild:O}),H={};E||(H.viewBox=I);const z=lK(D);return ve.jsxs(cK,se({as:l,className:fn(z.root,a),focusable:"false",color:_,"aria-hidden":S?void 0:!0,role:S?"img":void 0,ref:n},H,L,O&&i.props,{ownerState:D,children:[O?i.props.children:i,S?ve.jsx("title",{children:S}):null]}))});eD.muiName="SvgIcon";const WI=eD;function vl(t,e){function n(r,i){return ve.jsx(WI,se({"data-testid":`${e}Icon`,ref:i},r,{children:t}))}return n.muiName=WI.muiName,Z.memo(Z.forwardRef(n))}var dr={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qE=Symbol.for("react.element"),ZE=Symbol.for("react.portal"),av=Symbol.for("react.fragment"),lv=Symbol.for("react.strict_mode"),cv=Symbol.for("react.profiler"),uv=Symbol.for("react.provider"),hv=Symbol.for("react.context"),uK=Symbol.for("react.server_context"),dv=Symbol.for("react.forward_ref"),fv=Symbol.for("react.suspense"),pv=Symbol.for("react.suspense_list"),mv=Symbol.for("react.memo"),gv=Symbol.for("react.lazy"),hK=Symbol.for("react.offscreen"),tD;tD=Symbol.for("react.module.reference");function Do(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case qE:switch(t=t.type,t){case av:case cv:case lv:case fv:case pv:return t;default:switch(t=t&&t.$$typeof,t){case uK:case hv:case dv:case gv:case mv:case uv:return t;default:return e}}case ZE:return e}}}dr.ContextConsumer=hv;dr.ContextProvider=uv;dr.Element=qE;dr.ForwardRef=dv;dr.Fragment=av;dr.Lazy=gv;dr.Memo=mv;dr.Portal=ZE;dr.Profiler=cv;dr.StrictMode=lv;dr.Suspense=fv;dr.SuspenseList=pv;dr.isAsyncMode=function(){return!1};dr.isConcurrentMode=function(){return!1};dr.isContextConsumer=function(t){return Do(t)===hv};dr.isContextProvider=function(t){return Do(t)===uv};dr.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===qE};dr.isForwardRef=function(t){return Do(t)===dv};dr.isFragment=function(t){return Do(t)===av};dr.isLazy=function(t){return Do(t)===gv};dr.isMemo=function(t){return Do(t)===mv};dr.isPortal=function(t){return Do(t)===ZE};dr.isProfiler=function(t){return Do(t)===cv};dr.isStrictMode=function(t){return Do(t)===lv};dr.isSuspense=function(t){return Do(t)===fv};dr.isSuspenseList=function(t){return Do(t)===pv};dr.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===av||t===cv||t===lv||t===fv||t===pv||t===hK||typeof t=="object"&&t!==null&&(t.$$typeof===gv||t.$$typeof===mv||t.$$typeof===uv||t.$$typeof===hv||t.$$typeof===dv||t.$$typeof===tD||t.getModuleId!==void 0)};dr.typeOf=Do;function Rw(t,e){return Rw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Rw(t,e)}function nD(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,Rw(t,e)}const qI={disabled:!1},n_=cr.createContext(null);var dK=function(e){return e.scrollTop},mp="unmounted",eu="exited",tu="entering",Ih="entered",Ow="exiting",xl=function(t){nD(e,t);function e(r,i){var a;a=t.call(this,r,i)||this;var h=i,l=h&&!h.isMounting?r.enter:r.appear,m;return a.appearStatus=null,r.in?l?(m=eu,a.appearStatus=tu):m=Ih:r.unmountOnExit||r.mountOnEnter?m=mp:m=eu,a.state={status:m},a.nextCallback=null,a}e.getDerivedStateFromProps=function(i,a){var h=i.in;return h&&a.status===mp?{status:eu}:null};var n=e.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(i){var a=null;if(i!==this.props){var h=this.state.status;this.props.in?h!==tu&&h!==Ih&&(a=tu):(h===tu||h===Ih)&&(a=Ow)}this.updateStatus(!1,a)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var i=this.props.timeout,a,h,l;return a=h=l=i,i!=null&&typeof i!="number"&&(a=i.exit,h=i.enter,l=i.appear!==void 0?i.appear:h),{exit:a,enter:h,appear:l}},n.updateStatus=function(i,a){if(i===void 0&&(i=!1),a!==null)if(this.cancelNextCallback(),a===tu){if(this.props.unmountOnExit||this.props.mountOnEnter){var h=this.props.nodeRef?this.props.nodeRef.current:oy.findDOMNode(this);h&&dK(h)}this.performEnter(i)}else this.performExit();else this.props.unmountOnExit&&this.state.status===eu&&this.setState({status:mp})},n.performEnter=function(i){var a=this,h=this.props.enter,l=this.context?this.context.isMounting:i,m=this.props.nodeRef?[l]:[oy.findDOMNode(this),l],_=m[0],E=m[1],S=this.getTimeouts(),I=l?S.appear:S.enter;if(!i&&!h||qI.disabled){this.safeSetState({status:Ih},function(){a.props.onEntered(_)});return}this.props.onEnter(_,E),this.safeSetState({status:tu},function(){a.props.onEntering(_,E),a.onTransitionEnd(I,function(){a.safeSetState({status:Ih},function(){a.props.onEntered(_,E)})})})},n.performExit=function(){var i=this,a=this.props.exit,h=this.getTimeouts(),l=this.props.nodeRef?void 0:oy.findDOMNode(this);if(!a||qI.disabled){this.safeSetState({status:eu},function(){i.props.onExited(l)});return}this.props.onExit(l),this.safeSetState({status:Ow},function(){i.props.onExiting(l),i.onTransitionEnd(h.exit,function(){i.safeSetState({status:eu},function(){i.props.onExited(l)})})})},n.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(i,a){a=this.setNextCallback(a),this.setState(i,a)},n.setNextCallback=function(i){var a=this,h=!0;return this.nextCallback=function(l){h&&(h=!1,a.nextCallback=null,i(l))},this.nextCallback.cancel=function(){h=!1},this.nextCallback},n.onTransitionEnd=function(i,a){this.setNextCallback(a);var h=this.props.nodeRef?this.props.nodeRef.current:oy.findDOMNode(this),l=i==null&&!this.props.addEndListener;if(!h||l){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var m=this.props.nodeRef?[this.nextCallback]:[h,this.nextCallback],_=m[0],E=m[1];this.props.addEndListener(_,E)}i!=null&&setTimeout(this.nextCallback,i)},n.render=function(){var i=this.state.status;if(i===mp)return null;var a=this.props,h=a.children;a.in,a.mountOnEnter,a.unmountOnExit,a.appear,a.enter,a.exit,a.timeout,a.addEndListener,a.onEnter,a.onEntering,a.onEntered,a.onExit,a.onExiting,a.onExited,a.nodeRef;var l=nn(a,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return cr.createElement(n_.Provider,{value:null},typeof h=="function"?h(i,l):cr.cloneElement(cr.Children.only(h),l))},e}(cr.Component);xl.contextType=n_;xl.propTypes={};function Ch(){}xl.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Ch,onEntering:Ch,onEntered:Ch,onExit:Ch,onExiting:Ch,onExited:Ch};xl.UNMOUNTED=mp;xl.EXITED=eu;xl.ENTERING=tu;xl.ENTERED=Ih;xl.EXITING=Ow;const XE=xl;function fK(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function YE(t,e){var n=function(a){return e&&Z.isValidElement(a)?e(a):a},r=Object.create(null);return t&&Z.Children.map(t,function(i){return i}).forEach(function(i){r[i.key]=n(i)}),r}function pK(t,e){t=t||{},e=e||{};function n(E){return E in e?e[E]:t[E]}var r=Object.create(null),i=[];for(var a in t)a in e?i.length&&(r[a]=i,i=[]):i.push(a);var h,l={};for(var m in e){if(r[m])for(h=0;h<r[m].length;h++){var _=r[m][h];l[r[m][h]]=n(_)}l[m]=n(m)}for(h=0;h<i.length;h++)l[i[h]]=n(i[h]);return l}function ou(t,e,n){return n[e]!=null?n[e]:t.props[e]}function mK(t,e){return YE(t.children,function(n){return Z.cloneElement(n,{onExited:e.bind(null,n),in:!0,appear:ou(n,"appear",t),enter:ou(n,"enter",t),exit:ou(n,"exit",t)})})}function gK(t,e,n){var r=YE(t.children),i=pK(e,r);return Object.keys(i).forEach(function(a){var h=i[a];if(Z.isValidElement(h)){var l=a in e,m=a in r,_=e[a],E=Z.isValidElement(_)&&!_.props.in;m&&(!l||E)?i[a]=Z.cloneElement(h,{onExited:n.bind(null,h),in:!0,exit:ou(h,"exit",t),enter:ou(h,"enter",t)}):!m&&l&&!E?i[a]=Z.cloneElement(h,{in:!1}):m&&l&&Z.isValidElement(_)&&(i[a]=Z.cloneElement(h,{onExited:n.bind(null,h),in:_.props.in,exit:ou(h,"exit",t),enter:ou(h,"enter",t)}))}}),i}var yK=Object.values||function(t){return Object.keys(t).map(function(e){return t[e]})},_K={component:"div",childFactory:function(e){return e}},KE=function(t){nD(e,t);function e(r,i){var a;a=t.call(this,r,i)||this;var h=a.handleExited.bind(fK(a));return a.state={contextValue:{isMounting:!0},handleExited:h,firstRender:!0},a}var n=e.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(i,a){var h=a.children,l=a.handleExited,m=a.firstRender;return{children:m?mK(i,l):gK(i,h,l),firstRender:!1}},n.handleExited=function(i,a){var h=YE(this.props.children);i.key in h||(i.props.onExited&&i.props.onExited(a),this.mounted&&this.setState(function(l){var m=se({},l.children);return delete m[i.key],{children:m}}))},n.render=function(){var i=this.props,a=i.component,h=i.childFactory,l=nn(i,["component","childFactory"]),m=this.state.contextValue,_=yK(this.state.children).map(h);return delete l.appear,delete l.enter,delete l.exit,a===null?cr.createElement(n_.Provider,{value:m},_):cr.createElement(n_.Provider,{value:m},cr.createElement(a,l,_))},e}(cr.Component);KE.propTypes={};KE.defaultProps=_K;const vK=KE,JE=t=>t.scrollTop;function Td(t,e){var n,r;const{timeout:i,easing:a,style:h={}}=t;return{duration:(n=h.transitionDuration)!=null?n:typeof i=="number"?i:i[e.mode]||0,easing:(r=h.transitionTimingFunction)!=null?r:typeof a=="object"?a[e.mode]:a,delay:h.transitionDelay}}function xK(t){return $n("MuiPaper",t)}Bn("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const bK=["className","component","elevation","square","variant"],wK=t=>{const{square:e,elevation:n,variant:r,classes:i}=t,a={root:["root",r,!e&&"rounded",r==="elevation"&&`elevation${n}`]};return qn(a,xK,i)},EK=At("div",{name:"MuiPaper",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],!n.square&&e.rounded,n.variant==="elevation"&&e[`elevation${n.elevation}`]]}})(({theme:t,ownerState:e})=>{var n;return se({backgroundColor:(t.vars||t).palette.background.paper,color:(t.vars||t).palette.text.primary,transition:t.transitions.create("box-shadow")},!e.square&&{borderRadius:t.shape.borderRadius},e.variant==="outlined"&&{border:`1px solid ${(t.vars||t).palette.divider}`},e.variant==="elevation"&&se({boxShadow:(t.vars||t).shadows[e.elevation]},!t.vars&&t.palette.mode==="dark"&&{backgroundImage:`linear-gradient(${Ai("#fff",HI(e.elevation))}, ${Ai("#fff",HI(e.elevation))})`},t.vars&&{backgroundImage:(n=t.vars.overlays)==null?void 0:n[e.elevation]}))}),TK=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiPaper"}),{className:i,component:a="div",elevation:h=1,square:l=!1,variant:m="elevation"}=r,_=nn(r,bK),E=se({},r,{component:a,elevation:h,square:l,variant:m}),S=wK(E);return ve.jsx(EK,se({as:a,ownerState:E,className:fn(S.root,i),ref:n},_))}),yv=TK;function SK(t){const{className:e,classes:n,pulsate:r=!1,rippleX:i,rippleY:a,rippleSize:h,in:l,onExited:m,timeout:_}=t,[E,S]=Z.useState(!1),I=fn(e,n.ripple,n.rippleVisible,r&&n.ripplePulsate),L={width:h,height:h,top:-(h/2)+a,left:-(h/2)+i},O=fn(n.child,E&&n.childLeaving,r&&n.childPulsate);return!l&&!E&&S(!0),Z.useEffect(()=>{if(!l&&m!=null){const D=setTimeout(m,_);return()=>{clearTimeout(D)}}},[m,l,_]),ve.jsx("span",{className:I,style:L,children:ve.jsx("span",{className:O})})}const PK=Bn("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),To=PK,CK=["center","classes","className"];let _v=t=>t,ZI,XI,YI,KI;const Dw=550,AK=80,IK=zm(ZI||(ZI=_v`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),MK=zm(XI||(XI=_v`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),kK=zm(YI||(YI=_v`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),LK=At("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),RK=At(SK,{name:"MuiTouchRipple",slot:"Ripple"})(KI||(KI=_v`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),To.rippleVisible,IK,Dw,({theme:t})=>t.transitions.easing.easeInOut,To.ripplePulsate,({theme:t})=>t.transitions.duration.shorter,To.child,To.childLeaving,MK,Dw,({theme:t})=>t.transitions.easing.easeInOut,To.childPulsate,kK,({theme:t})=>t.transitions.easing.easeInOut),OK=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiTouchRipple"}),{center:i=!1,classes:a={},className:h}=r,l=nn(r,CK),[m,_]=Z.useState([]),E=Z.useRef(0),S=Z.useRef(null);Z.useEffect(()=>{S.current&&(S.current(),S.current=null)},[m]);const I=Z.useRef(!1),L=Z.useRef(0),O=Z.useRef(null),D=Z.useRef(null);Z.useEffect(()=>()=>{L.current&&clearTimeout(L.current)},[]);const H=Z.useCallback($=>{const{pulsate:Q,rippleX:te,rippleY:re,rippleSize:we,cb:Ee}=$;_(de=>[...de,ve.jsx(RK,{classes:{ripple:fn(a.ripple,To.ripple),rippleVisible:fn(a.rippleVisible,To.rippleVisible),ripplePulsate:fn(a.ripplePulsate,To.ripplePulsate),child:fn(a.child,To.child),childLeaving:fn(a.childLeaving,To.childLeaving),childPulsate:fn(a.childPulsate,To.childPulsate)},timeout:Dw,pulsate:Q,rippleX:te,rippleY:re,rippleSize:we},E.current)]),E.current+=1,S.current=Ee},[a]),z=Z.useCallback(($={},Q={},te=()=>{})=>{const{pulsate:re=!1,center:we=i||Q.pulsate,fakeElement:Ee=!1}=Q;if(($==null?void 0:$.type)==="mousedown"&&I.current){I.current=!1;return}($==null?void 0:$.type)==="touchstart"&&(I.current=!0);const de=Ee?null:D.current,Le=de?de.getBoundingClientRect():{width:0,height:0,left:0,top:0};let Ge,Be,Oe;if(we||$===void 0||$.clientX===0&&$.clientY===0||!$.clientX&&!$.touches)Ge=Math.round(Le.width/2),Be=Math.round(Le.height/2);else{const{clientX:Ke,clientY:je}=$.touches&&$.touches.length>0?$.touches[0]:$;Ge=Math.round(Ke-Le.left),Be=Math.round(je-Le.top)}if(we)Oe=Math.sqrt((2*Le.width**2+Le.height**2)/3),Oe%2===0&&(Oe+=1);else{const Ke=Math.max(Math.abs((de?de.clientWidth:0)-Ge),Ge)*2+2,je=Math.max(Math.abs((de?de.clientHeight:0)-Be),Be)*2+2;Oe=Math.sqrt(Ke**2+je**2)}$!=null&&$.touches?O.current===null&&(O.current=()=>{H({pulsate:re,rippleX:Ge,rippleY:Be,rippleSize:Oe,cb:te})},L.current=setTimeout(()=>{O.current&&(O.current(),O.current=null)},AK)):H({pulsate:re,rippleX:Ge,rippleY:Be,rippleSize:Oe,cb:te})},[i,H]),N=Z.useCallback(()=>{z({},{pulsate:!0})},[z]),F=Z.useCallback(($,Q)=>{if(clearTimeout(L.current),($==null?void 0:$.type)==="touchend"&&O.current){O.current(),O.current=null,L.current=setTimeout(()=>{F($,Q)});return}O.current=null,_(te=>te.length>0?te.slice(1):te),S.current=Q},[]);return Z.useImperativeHandle(n,()=>({pulsate:N,start:z,stop:F}),[N,z,F]),ve.jsx(LK,se({className:fn(To.root,a.root,h),ref:D},l,{children:ve.jsx(vK,{component:null,exit:!0,children:m})}))}),DK=OK;function zK(t){return $n("MuiButtonBase",t)}const FK=Bn("MuiButtonBase",["root","disabled","focusVisible"]),NK=FK,BK=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],UK=t=>{const{disabled:e,focusVisible:n,focusVisibleClassName:r,classes:i}=t,h=qn({root:["root",e&&"disabled",n&&"focusVisible"]},zK,i);return n&&r&&(h.root+=` ${r}`),h},VK=At("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(t,e)=>e.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${NK.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),jK=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiButtonBase"}),{action:i,centerRipple:a=!1,children:h,className:l,component:m="button",disabled:_=!1,disableRipple:E=!1,disableTouchRipple:S=!1,focusRipple:I=!1,LinkComponent:L="a",onBlur:O,onClick:D,onContextMenu:H,onDragLeave:z,onFocus:N,onFocusVisible:F,onKeyDown:$,onKeyUp:Q,onMouseDown:te,onMouseLeave:re,onMouseUp:we,onTouchEnd:Ee,onTouchMove:de,onTouchStart:Le,tabIndex:Ge=0,TouchRippleProps:Be,touchRippleRef:Oe,type:Ke}=r,je=nn(r,BK),it=Z.useRef(null),Me=Z.useRef(null),qe=Yr(Me,Oe),{isFocusVisibleRef:ut,onFocus:zt,onBlur:vt,ref:yt}=AE(),[at,bt]=Z.useState(!1);_&&at&&bt(!1),Z.useImperativeHandle(i,()=>({focusVisible:()=>{bt(!0),it.current.focus()}}),[]);const[xt,$t]=Z.useState(!1);Z.useEffect(()=>{$t(!0)},[]);const Kt=xt&&!E&&!_;Z.useEffect(()=>{at&&I&&!E&&xt&&Me.current.pulsate()},[E,I,at,xt]);function Ct(ot,Zt,Mt=S){return no(Ne=>(Zt&&Zt(Ne),!Mt&&Me.current&&Me.current[ot](Ne),!0))}const sn=Ct("start",te),Qt=Ct("stop",H),pn=Ct("stop",z),Wt=Ct("stop",we),Ot=Ct("stop",ot=>{at&&ot.preventDefault(),re&&re(ot)}),Dt=Ct("start",Le),wn=Ct("stop",Ee),mn=Ct("stop",de),En=Ct("stop",ot=>{vt(ot),ut.current===!1&&bt(!1),O&&O(ot)},!1),zn=no(ot=>{it.current||(it.current=ot.currentTarget),zt(ot),ut.current===!0&&(bt(!0),F&&F(ot)),N&&N(ot)}),Re=()=>{const ot=it.current;return m&&m!=="button"&&!(ot.tagName==="A"&&ot.href)},Bt=Z.useRef(!1),Rn=no(ot=>{I&&!Bt.current&&at&&Me.current&&ot.key===" "&&(Bt.current=!0,Me.current.stop(ot,()=>{Me.current.start(ot)})),ot.target===ot.currentTarget&&Re()&&ot.key===" "&&ot.preventDefault(),$&&$(ot),ot.target===ot.currentTarget&&Re()&&ot.key==="Enter"&&!_&&(ot.preventDefault(),D&&D(ot))}),an=no(ot=>{I&&ot.key===" "&&Me.current&&at&&!ot.defaultPrevented&&(Bt.current=!1,Me.current.stop(ot,()=>{Me.current.pulsate(ot)})),Q&&Q(ot),D&&ot.target===ot.currentTarget&&Re()&&ot.key===" "&&!ot.defaultPrevented&&D(ot)});let It=m;It==="button"&&(je.href||je.to)&&(It=L);const st={};It==="button"?(st.type=Ke===void 0?"button":Ke,st.disabled=_):(!je.href&&!je.to&&(st.role="button"),_&&(st["aria-disabled"]=_));const _t=Yr(n,yt,it),Fe=se({},r,{centerRipple:a,component:m,disabled:_,disableRipple:E,disableTouchRipple:S,focusRipple:I,tabIndex:Ge,focusVisible:at}),et=UK(Fe);return ve.jsxs(VK,se({as:It,className:fn(et.root,l),ownerState:Fe,onBlur:En,onClick:D,onContextMenu:Qt,onFocus:zn,onKeyDown:Rn,onKeyUp:an,onMouseDown:sn,onMouseLeave:Ot,onMouseUp:Wt,onDragLeave:pn,onTouchEnd:wn,onTouchMove:mn,onTouchStart:Dt,ref:_t,tabIndex:_?-1:Ge,type:Ke},st,je,{children:[h,Kt?ve.jsx(DK,se({ref:qe,center:a},Be)):null]}))}),QE=jK;function $K(t){return $n("MuiAlert",t)}const GK=Bn("MuiAlert",["root","action","icon","message","filled","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]),JI=GK;function HK(t){return $n("MuiIconButton",t)}const WK=Bn("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),qK=WK,ZK=["edge","children","className","color","disabled","disableFocusRipple","size"],XK=t=>{const{classes:e,disabled:n,color:r,edge:i,size:a}=t,h={root:["root",n&&"disabled",r!=="default"&&`color${Yt(r)}`,i&&`edge${Yt(i)}`,`size${Yt(a)}`]};return qn(h,HK,e)},YK=At(QE,{name:"MuiIconButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.color!=="default"&&e[`color${Yt(n.color)}`],n.edge&&e[`edge${Yt(n.edge)}`],e[`size${Yt(n.size)}`]]}})(({theme:t,ownerState:e})=>se({textAlign:"center",flex:"0 0 auto",fontSize:t.typography.pxToRem(24),padding:8,borderRadius:"50%",overflow:"visible",color:(t.vars||t).palette.action.active,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest})},!e.disableRipple&&{"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:Ai(t.palette.action.active,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},e.edge==="start"&&{marginLeft:e.size==="small"?-3:-12},e.edge==="end"&&{marginRight:e.size==="small"?-3:-12}),({theme:t,ownerState:e})=>{var n;const r=(n=(t.vars||t).palette)==null?void 0:n[e.color];return se({},e.color==="inherit"&&{color:"inherit"},e.color!=="inherit"&&e.color!=="default"&&se({color:r==null?void 0:r.main},!e.disableRipple&&{"&:hover":se({},r&&{backgroundColor:t.vars?`rgba(${r.mainChannel} / ${t.vars.palette.action.hoverOpacity})`:Ai(r.main,t.palette.action.hoverOpacity)},{"@media (hover: none)":{backgroundColor:"transparent"}})}),e.size==="small"&&{padding:5,fontSize:t.typography.pxToRem(18)},e.size==="large"&&{padding:12,fontSize:t.typography.pxToRem(28)},{[`&.${qK.disabled}`]:{backgroundColor:"transparent",color:(t.vars||t).palette.action.disabled}})}),KK=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiIconButton"}),{edge:i=!1,children:a,className:h,color:l="default",disabled:m=!1,disableFocusRipple:_=!1,size:E="medium"}=r,S=nn(r,ZK),I=se({},r,{edge:i,color:l,disabled:m,disableFocusRipple:_,size:E}),L=XK(I);return ve.jsx(YK,se({className:fn(L.root,h),centerRipple:!0,focusRipple:!_,disabled:m,ref:n,ownerState:I},S,{children:a}))}),zw=KK,JK=vl(ve.jsx("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined"),QK=vl(ve.jsx("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined"),eJ=vl(ve.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline"),tJ=vl(ve.jsx("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined"),nJ=vl(ve.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),rJ=["action","children","className","closeText","color","components","componentsProps","icon","iconMapping","onClose","role","severity","slotProps","slots","variant"],iJ=t=>{const{variant:e,color:n,severity:r,classes:i}=t,a={root:["root",`${e}${Yt(n||r)}`,`${e}`],icon:["icon"],message:["message"],action:["action"]};return qn(a,$K,i)},sJ=At(yv,{name:"MuiAlert",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],e[`${n.variant}${Yt(n.color||n.severity)}`]]}})(({theme:t,ownerState:e})=>{const n=t.palette.mode==="light"?pm:mm,r=t.palette.mode==="light"?mm:pm,i=e.color||e.severity;return se({},t.typography.body2,{backgroundColor:"transparent",display:"flex",padding:"6px 16px"},i&&e.variant==="standard"&&{color:t.vars?t.vars.palette.Alert[`${i}Color`]:n(t.palette[i].light,.6),backgroundColor:t.vars?t.vars.palette.Alert[`${i}StandardBg`]:r(t.palette[i].light,.9),[`& .${JI.icon}`]:t.vars?{color:t.vars.palette.Alert[`${i}IconColor`]}:{color:t.palette[i].main}},i&&e.variant==="outlined"&&{color:t.vars?t.vars.palette.Alert[`${i}Color`]:n(t.palette[i].light,.6),border:`1px solid ${(t.vars||t).palette[i].light}`,[`& .${JI.icon}`]:t.vars?{color:t.vars.palette.Alert[`${i}IconColor`]}:{color:t.palette[i].main}},i&&e.variant==="filled"&&se({fontWeight:t.typography.fontWeightMedium},t.vars?{color:t.vars.palette.Alert[`${i}FilledColor`],backgroundColor:t.vars.palette.Alert[`${i}FilledBg`]}:{backgroundColor:t.palette.mode==="dark"?t.palette[i].dark:t.palette[i].main,color:t.palette.getContrastText(t.palette[i].main)}))}),oJ=At("div",{name:"MuiAlert",slot:"Icon",overridesResolver:(t,e)=>e.icon})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),aJ=At("div",{name:"MuiAlert",slot:"Message",overridesResolver:(t,e)=>e.message})({padding:"8px 0",minWidth:0,overflow:"auto"}),QI=At("div",{name:"MuiAlert",slot:"Action",overridesResolver:(t,e)=>e.action})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),eM={success:ve.jsx(JK,{fontSize:"inherit"}),warning:ve.jsx(QK,{fontSize:"inherit"}),error:ve.jsx(eJ,{fontSize:"inherit"}),info:ve.jsx(tJ,{fontSize:"inherit"})},lJ=Z.forwardRef(function(e,n){var r,i,a,h,l,m;const _=Gn({props:e,name:"MuiAlert"}),{action:E,children:S,className:I,closeText:L="Close",color:O,components:D={},componentsProps:H={},icon:z,iconMapping:N=eM,onClose:F,role:$="alert",severity:Q="success",slotProps:te={},slots:re={},variant:we="standard"}=_,Ee=nn(_,rJ),de=se({},_,{color:O,severity:Q,variant:we}),Le=iJ(de),Ge=(r=(i=re.closeButton)!=null?i:D.CloseButton)!=null?r:zw,Be=(a=(h=re.closeIcon)!=null?h:D.CloseIcon)!=null?a:nJ,Oe=(l=te.closeButton)!=null?l:H.closeButton,Ke=(m=te.closeIcon)!=null?m:H.closeIcon;return ve.jsxs(sJ,se({role:$,elevation:0,ownerState:de,className:fn(Le.root,I),ref:n},Ee,{children:[z!==!1?ve.jsx(oJ,{ownerState:de,className:Le.icon,children:z||N[Q]||eM[Q]}):null,ve.jsx(aJ,{ownerState:de,className:Le.message,children:S}),E!=null?ve.jsx(QI,{ownerState:de,className:Le.action,children:E}):null,E==null&&F?ve.jsx(QI,{ownerState:de,className:Le.action,children:ve.jsx(Ge,se({size:"small","aria-label":L,title:L,color:"inherit",onClick:F},Oe,{children:ve.jsx(Be,se({fontSize:"small"},Ke))}))}):null]}))}),cJ=lJ;function uJ(t){return $n("MuiTypography",t)}Bn("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const hJ=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],dJ=t=>{const{align:e,gutterBottom:n,noWrap:r,paragraph:i,variant:a,classes:h}=t,l={root:["root",a,t.align!=="inherit"&&`align${Yt(e)}`,n&&"gutterBottom",r&&"noWrap",i&&"paragraph"]};return qn(l,uJ,h)},fJ=At("span",{name:"MuiTypography",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.variant&&e[n.variant],n.align!=="inherit"&&e[`align${Yt(n.align)}`],n.noWrap&&e.noWrap,n.gutterBottom&&e.gutterBottom,n.paragraph&&e.paragraph]}})(({theme:t,ownerState:e})=>se({margin:0},e.variant==="inherit"&&{font:"inherit"},e.variant!=="inherit"&&t.typography[e.variant],e.align!=="inherit"&&{textAlign:e.align},e.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},e.gutterBottom&&{marginBottom:"0.35em"},e.paragraph&&{marginBottom:16})),tM={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},pJ={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},mJ=t=>pJ[t]||t,gJ=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiTypography"}),i=mJ(r.color),a=XO(se({},r,{color:i})),{align:h="inherit",className:l,component:m,gutterBottom:_=!1,noWrap:E=!1,paragraph:S=!1,variant:I="body1",variantMapping:L=tM}=a,O=nn(a,hJ),D=se({},a,{align:h,color:i,className:l,component:m,gutterBottom:_,noWrap:E,paragraph:S,variant:I,variantMapping:L}),H=m||(S?"p":L[I]||tM[I])||"span",z=dJ(D);return ve.jsx(fJ,se({as:H,ref:n,ownerState:D,className:fn(z.root,l)},O))}),c0=gJ;function mc(t){return typeof t=="string"}function gp(t,e,n){return t===void 0||mc(t)?e:se({},e,{ownerState:se({},e.ownerState,n)})}function yJ(t,e,n=(r,i)=>r===i){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}const _J={disableDefaultClasses:!1},vJ=Z.createContext(_J);function xJ(t){const{disableDefaultClasses:e}=Z.useContext(vJ);return n=>e?"":t(n)}function hu(t,e=[]){if(t===void 0)return{};const n={};return Object.keys(t).filter(r=>r.match(/^on[A-Z]/)&&typeof t[r]=="function"&&!e.includes(r)).forEach(r=>{n[r]=t[r]}),n}function bJ(t,e,n){return typeof t=="function"?t(e,n):t}function nM(t){if(t===void 0)return{};const e={};return Object.keys(t).filter(n=>!(n.match(/^on[A-Z]/)&&typeof t[n]=="function")).forEach(n=>{e[n]=t[n]}),e}function wJ(t){const{getSlotProps:e,additionalProps:n,externalSlotProps:r,externalForwardedProps:i,className:a}=t;if(!e){const L=fn(i==null?void 0:i.className,r==null?void 0:r.className,a,n==null?void 0:n.className),O=se({},n==null?void 0:n.style,i==null?void 0:i.style,r==null?void 0:r.style),D=se({},n,i,r);return L.length>0&&(D.className=L),Object.keys(O).length>0&&(D.style=O),{props:D,internalRef:void 0}}const h=hu(se({},i,r)),l=nM(r),m=nM(i),_=e(h),E=fn(_==null?void 0:_.className,n==null?void 0:n.className,a,i==null?void 0:i.className,r==null?void 0:r.className),S=se({},_==null?void 0:_.style,n==null?void 0:n.style,i==null?void 0:i.style,r==null?void 0:r.style),I=se({},_,n,m,l);return E.length>0&&(I.className=E),Object.keys(S).length>0&&(I.style=S),{props:I,internalRef:_.ref}}const EJ=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function is(t){var e;const{elementType:n,externalSlotProps:r,ownerState:i,skipResolvingSlotProps:a=!1}=t,h=nn(t,EJ),l=a?{}:bJ(r,i),{props:m,internalRef:_}=wJ(se({},h,{externalSlotProps:l})),E=Yr(_,l==null?void 0:l.ref,(e=t.additionalProps)==null?void 0:e.ref);return gp(n,se({},m,{ref:E}),i)}function rM(t){return t.substring(2).toLowerCase()}function TJ(t,e){return e.documentElement.clientWidth<t.clientX||e.documentElement.clientHeight<t.clientY}function SJ(t){const{children:e,disableReactTree:n=!1,mouseEvent:r="onClick",onClickAway:i,touchEvent:a="onTouchEnd"}=t,h=Z.useRef(!1),l=Z.useRef(null),m=Z.useRef(!1),_=Z.useRef(!1);Z.useEffect(()=>(setTimeout(()=>{m.current=!0},0),()=>{m.current=!1}),[]);const E=Yr(e.ref,l),S=no(O=>{const D=_.current;_.current=!1;const H=Xr(l.current);if(!m.current||!l.current||"clientX"in O&&TJ(O,H))return;if(h.current){h.current=!1;return}let z;O.composedPath?z=O.composedPath().indexOf(l.current)>-1:z=!H.documentElement.contains(O.target)||l.current.contains(O.target),!z&&(n||!D)&&i(O)}),I=O=>D=>{_.current=!0;const H=e.props[O];H&&H(D)},L={ref:E};return a!==!1&&(L[a]=I(a)),Z.useEffect(()=>{if(a!==!1){const O=rM(a),D=Xr(l.current),H=()=>{h.current=!0};return D.addEventListener(O,S),D.addEventListener("touchmove",H),()=>{D.removeEventListener(O,S),D.removeEventListener("touchmove",H)}}},[S,a]),r!==!1&&(L[r]=I(r)),Z.useEffect(()=>{if(r!==!1){const O=rM(r),D=Xr(l.current);return D.addEventListener(O,S),()=>{D.removeEventListener(O,S)}}},[S,r]),ve.jsx(Z.Fragment,{children:Z.cloneElement(e,L)})}const PJ=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function CJ(t){const e=parseInt(t.getAttribute("tabindex")||"",10);return Number.isNaN(e)?t.contentEditable==="true"||(t.nodeName==="AUDIO"||t.nodeName==="VIDEO"||t.nodeName==="DETAILS")&&t.getAttribute("tabindex")===null?0:t.tabIndex:e}function AJ(t){if(t.tagName!=="INPUT"||t.type!=="radio"||!t.name)return!1;const e=r=>t.ownerDocument.querySelector(`input[type="radio"]${r}`);let n=e(`[name="${t.name}"]:checked`);return n||(n=e(`[name="${t.name}"]`)),n!==t}function IJ(t){return!(t.disabled||t.tagName==="INPUT"&&t.type==="hidden"||AJ(t))}function MJ(t){const e=[],n=[];return Array.from(t.querySelectorAll(PJ)).forEach((r,i)=>{const a=CJ(r);a===-1||!IJ(r)||(a===0?e.push(r):n.push({documentOrder:i,tabIndex:a,node:r}))}),n.sort((r,i)=>r.tabIndex===i.tabIndex?r.documentOrder-i.documentOrder:r.tabIndex-i.tabIndex).map(r=>r.node).concat(e)}function kJ(){return!0}function LJ(t){const{children:e,disableAutoFocus:n=!1,disableEnforceFocus:r=!1,disableRestoreFocus:i=!1,getTabbable:a=MJ,isEnabled:h=kJ,open:l}=t,m=Z.useRef(!1),_=Z.useRef(null),E=Z.useRef(null),S=Z.useRef(null),I=Z.useRef(null),L=Z.useRef(!1),O=Z.useRef(null),D=Yr(e.ref,O),H=Z.useRef(null);Z.useEffect(()=>{!l||!O.current||(L.current=!n)},[n,l]),Z.useEffect(()=>{if(!l||!O.current)return;const F=Xr(O.current);return O.current.contains(F.activeElement)||(O.current.hasAttribute("tabIndex")||O.current.setAttribute("tabIndex","-1"),L.current&&O.current.focus()),()=>{i||(S.current&&S.current.focus&&(m.current=!0,S.current.focus()),S.current=null)}},[l]),Z.useEffect(()=>{if(!l||!O.current)return;const F=Xr(O.current),$=re=>{H.current=re,!(r||!h()||re.key!=="Tab")&&F.activeElement===O.current&&re.shiftKey&&(m.current=!0,E.current&&E.current.focus())},Q=()=>{const re=O.current;if(re===null)return;if(!F.hasFocus()||!h()||m.current){m.current=!1;return}if(re.contains(F.activeElement)||r&&F.activeElement!==_.current&&F.activeElement!==E.current)return;if(F.activeElement!==I.current)I.current=null;else if(I.current!==null)return;if(!L.current)return;let we=[];if((F.activeElement===_.current||F.activeElement===E.current)&&(we=a(O.current)),we.length>0){var Ee,de;const Le=!!((Ee=H.current)!=null&&Ee.shiftKey&&((de=H.current)==null?void 0:de.key)==="Tab"),Ge=we[0],Be=we[we.length-1];typeof Ge!="string"&&typeof Be!="string"&&(Le?Be.focus():Ge.focus())}else re.focus()};F.addEventListener("focusin",Q),F.addEventListener("keydown",$,!0);const te=setInterval(()=>{F.activeElement&&F.activeElement.tagName==="BODY"&&Q()},50);return()=>{clearInterval(te),F.removeEventListener("focusin",Q),F.removeEventListener("keydown",$,!0)}},[n,r,i,h,l,a]);const z=F=>{S.current===null&&(S.current=F.relatedTarget),L.current=!0,I.current=F.target;const $=e.props.onFocus;$&&$(F)},N=F=>{S.current===null&&(S.current=F.relatedTarget),L.current=!0};return ve.jsxs(Z.Fragment,{children:[ve.jsx("div",{tabIndex:l?0:-1,onFocus:N,ref:_,"data-testid":"sentinelStart"}),Z.cloneElement(e,{ref:D,onFocus:z}),ve.jsx("div",{tabIndex:l?0:-1,onFocus:N,ref:E,"data-testid":"sentinelEnd"})]})}var Fs="top",Ro="bottom",Oo="right",Ns="left",eT="auto",Bm=[Fs,Ro,Oo,Ns],Sd="start",gm="end",RJ="clippingParents",rD="viewport",tp="popper",OJ="reference",iM=Bm.reduce(function(t,e){return t.concat([e+"-"+Sd,e+"-"+gm])},[]),iD=[].concat(Bm,[eT]).reduce(function(t,e){return t.concat([e,e+"-"+Sd,e+"-"+gm])},[]),DJ="beforeRead",zJ="read",FJ="afterRead",NJ="beforeMain",BJ="main",UJ="afterMain",VJ="beforeWrite",jJ="write",$J="afterWrite",GJ=[DJ,zJ,FJ,NJ,BJ,UJ,VJ,jJ,$J];function Oa(t){return t?(t.nodeName||"").toLowerCase():null}function ao(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function Eu(t){var e=ao(t).Element;return t instanceof e||t instanceof Element}function Mo(t){var e=ao(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function tT(t){if(typeof ShadowRoot>"u")return!1;var e=ao(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function HJ(t){var e=t.state;Object.keys(e.elements).forEach(function(n){var r=e.styles[n]||{},i=e.attributes[n]||{},a=e.elements[n];!Mo(a)||!Oa(a)||(Object.assign(a.style,r),Object.keys(i).forEach(function(h){var l=i[h];l===!1?a.removeAttribute(h):a.setAttribute(h,l===!0?"":l)}))})}function WJ(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach(function(r){var i=e.elements[r],a=e.attributes[r]||{},h=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:n[r]),l=h.reduce(function(m,_){return m[_]="",m},{});!Mo(i)||!Oa(i)||(Object.assign(i.style,l),Object.keys(a).forEach(function(m){i.removeAttribute(m)}))})}}const qJ={name:"applyStyles",enabled:!0,phase:"write",fn:HJ,effect:WJ,requires:["computeStyles"]};function ka(t){return t.split("-")[0]}var du=Math.max,r_=Math.min,Pd=Math.round;function Fw(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function sD(){return!/^((?!chrome|android).)*safari/i.test(Fw())}function Cd(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!1);var r=t.getBoundingClientRect(),i=1,a=1;e&&Mo(t)&&(i=t.offsetWidth>0&&Pd(r.width)/t.offsetWidth||1,a=t.offsetHeight>0&&Pd(r.height)/t.offsetHeight||1);var h=Eu(t)?ao(t):window,l=h.visualViewport,m=!sD()&&n,_=(r.left+(m&&l?l.offsetLeft:0))/i,E=(r.top+(m&&l?l.offsetTop:0))/a,S=r.width/i,I=r.height/a;return{width:S,height:I,top:E,right:_+S,bottom:E+I,left:_,x:_,y:E}}function nT(t){var e=Cd(t),n=t.offsetWidth,r=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:r}}function oD(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&tT(n)){var r=e;do{if(r&&t.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function ml(t){return ao(t).getComputedStyle(t)}function ZJ(t){return["table","td","th"].indexOf(Oa(t))>=0}function Tc(t){return((Eu(t)?t.ownerDocument:t.document)||window.document).documentElement}function vv(t){return Oa(t)==="html"?t:t.assignedSlot||t.parentNode||(tT(t)?t.host:null)||Tc(t)}function sM(t){return!Mo(t)||ml(t).position==="fixed"?null:t.offsetParent}function XJ(t){var e=/firefox/i.test(Fw()),n=/Trident/i.test(Fw());if(n&&Mo(t)){var r=ml(t);if(r.position==="fixed")return null}var i=vv(t);for(tT(i)&&(i=i.host);Mo(i)&&["html","body"].indexOf(Oa(i))<0;){var a=ml(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function Um(t){for(var e=ao(t),n=sM(t);n&&ZJ(n)&&ml(n).position==="static";)n=sM(n);return n&&(Oa(n)==="html"||Oa(n)==="body"&&ml(n).position==="static")?e:n||XJ(t)||e}function rT(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function kp(t,e,n){return du(t,r_(e,n))}function YJ(t,e,n){var r=kp(t,e,n);return r>n?n:r}function aD(){return{top:0,right:0,bottom:0,left:0}}function lD(t){return Object.assign({},aD(),t)}function cD(t,e){return e.reduce(function(n,r){return n[r]=t,n},{})}var KJ=function(e,n){return e=typeof e=="function"?e(Object.assign({},n.rects,{placement:n.placement})):e,lD(typeof e!="number"?e:cD(e,Bm))};function JJ(t){var e,n=t.state,r=t.name,i=t.options,a=n.elements.arrow,h=n.modifiersData.popperOffsets,l=ka(n.placement),m=rT(l),_=[Ns,Oo].indexOf(l)>=0,E=_?"height":"width";if(!(!a||!h)){var S=KJ(i.padding,n),I=nT(a),L=m==="y"?Fs:Ns,O=m==="y"?Ro:Oo,D=n.rects.reference[E]+n.rects.reference[m]-h[m]-n.rects.popper[E],H=h[m]-n.rects.reference[m],z=Um(a),N=z?m==="y"?z.clientHeight||0:z.clientWidth||0:0,F=D/2-H/2,$=S[L],Q=N-I[E]-S[O],te=N/2-I[E]/2+F,re=kp($,te,Q),we=m;n.modifiersData[r]=(e={},e[we]=re,e.centerOffset=re-te,e)}}function QJ(t){var e=t.state,n=t.options,r=n.element,i=r===void 0?"[data-popper-arrow]":r;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||oD(e.elements.popper,i)&&(e.elements.arrow=i))}const eQ={name:"arrow",enabled:!0,phase:"main",fn:JJ,effect:QJ,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Ad(t){return t.split("-")[1]}var tQ={top:"auto",right:"auto",bottom:"auto",left:"auto"};function nQ(t,e){var n=t.x,r=t.y,i=e.devicePixelRatio||1;return{x:Pd(n*i)/i||0,y:Pd(r*i)/i||0}}function oM(t){var e,n=t.popper,r=t.popperRect,i=t.placement,a=t.variation,h=t.offsets,l=t.position,m=t.gpuAcceleration,_=t.adaptive,E=t.roundOffsets,S=t.isFixed,I=h.x,L=I===void 0?0:I,O=h.y,D=O===void 0?0:O,H=typeof E=="function"?E({x:L,y:D}):{x:L,y:D};L=H.x,D=H.y;var z=h.hasOwnProperty("x"),N=h.hasOwnProperty("y"),F=Ns,$=Fs,Q=window;if(_){var te=Um(n),re="clientHeight",we="clientWidth";if(te===ao(n)&&(te=Tc(n),ml(te).position!=="static"&&l==="absolute"&&(re="scrollHeight",we="scrollWidth")),te=te,i===Fs||(i===Ns||i===Oo)&&a===gm){$=Ro;var Ee=S&&te===Q&&Q.visualViewport?Q.visualViewport.height:te[re];D-=Ee-r.height,D*=m?1:-1}if(i===Ns||(i===Fs||i===Ro)&&a===gm){F=Oo;var de=S&&te===Q&&Q.visualViewport?Q.visualViewport.width:te[we];L-=de-r.width,L*=m?1:-1}}var Le=Object.assign({position:l},_&&tQ),Ge=E===!0?nQ({x:L,y:D},ao(n)):{x:L,y:D};if(L=Ge.x,D=Ge.y,m){var Be;return Object.assign({},Le,(Be={},Be[$]=N?"0":"",Be[F]=z?"0":"",Be.transform=(Q.devicePixelRatio||1)<=1?"translate("+L+"px, "+D+"px)":"translate3d("+L+"px, "+D+"px, 0)",Be))}return Object.assign({},Le,(e={},e[$]=N?D+"px":"",e[F]=z?L+"px":"",e.transform="",e))}function rQ(t){var e=t.state,n=t.options,r=n.gpuAcceleration,i=r===void 0?!0:r,a=n.adaptive,h=a===void 0?!0:a,l=n.roundOffsets,m=l===void 0?!0:l,_={placement:ka(e.placement),variation:Ad(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,oM(Object.assign({},_,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:h,roundOffsets:m})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,oM(Object.assign({},_,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:m})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const iQ={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:rQ,data:{}};var Sy={passive:!0};function sQ(t){var e=t.state,n=t.instance,r=t.options,i=r.scroll,a=i===void 0?!0:i,h=r.resize,l=h===void 0?!0:h,m=ao(e.elements.popper),_=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&_.forEach(function(E){E.addEventListener("scroll",n.update,Sy)}),l&&m.addEventListener("resize",n.update,Sy),function(){a&&_.forEach(function(E){E.removeEventListener("scroll",n.update,Sy)}),l&&m.removeEventListener("resize",n.update,Sy)}}const oQ={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:sQ,data:{}};var aQ={left:"right",right:"left",bottom:"top",top:"bottom"};function u0(t){return t.replace(/left|right|bottom|top/g,function(e){return aQ[e]})}var lQ={start:"end",end:"start"};function aM(t){return t.replace(/start|end/g,function(e){return lQ[e]})}function iT(t){var e=ao(t),n=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:n,scrollTop:r}}function sT(t){return Cd(Tc(t)).left+iT(t).scrollLeft}function cQ(t,e){var n=ao(t),r=Tc(t),i=n.visualViewport,a=r.clientWidth,h=r.clientHeight,l=0,m=0;if(i){a=i.width,h=i.height;var _=sD();(_||!_&&e==="fixed")&&(l=i.offsetLeft,m=i.offsetTop)}return{width:a,height:h,x:l+sT(t),y:m}}function uQ(t){var e,n=Tc(t),r=iT(t),i=(e=t.ownerDocument)==null?void 0:e.body,a=du(n.scrollWidth,n.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),h=du(n.scrollHeight,n.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),l=-r.scrollLeft+sT(t),m=-r.scrollTop;return ml(i||n).direction==="rtl"&&(l+=du(n.clientWidth,i?i.clientWidth:0)-a),{width:a,height:h,x:l,y:m}}function oT(t){var e=ml(t),n=e.overflow,r=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+i+r)}function uD(t){return["html","body","#document"].indexOf(Oa(t))>=0?t.ownerDocument.body:Mo(t)&&oT(t)?t:uD(vv(t))}function Lp(t,e){var n;e===void 0&&(e=[]);var r=uD(t),i=r===((n=t.ownerDocument)==null?void 0:n.body),a=ao(r),h=i?[a].concat(a.visualViewport||[],oT(r)?r:[]):r,l=e.concat(h);return i?l:l.concat(Lp(vv(h)))}function Nw(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function hQ(t,e){var n=Cd(t,!1,e==="fixed");return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}function lM(t,e,n){return e===rD?Nw(cQ(t,n)):Eu(e)?hQ(e,n):Nw(uQ(Tc(t)))}function dQ(t){var e=Lp(vv(t)),n=["absolute","fixed"].indexOf(ml(t).position)>=0,r=n&&Mo(t)?Um(t):t;return Eu(r)?e.filter(function(i){return Eu(i)&&oD(i,r)&&Oa(i)!=="body"}):[]}function fQ(t,e,n,r){var i=e==="clippingParents"?dQ(t):[].concat(e),a=[].concat(i,[n]),h=a[0],l=a.reduce(function(m,_){var E=lM(t,_,r);return m.top=du(E.top,m.top),m.right=r_(E.right,m.right),m.bottom=r_(E.bottom,m.bottom),m.left=du(E.left,m.left),m},lM(t,h,r));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}function hD(t){var e=t.reference,n=t.element,r=t.placement,i=r?ka(r):null,a=r?Ad(r):null,h=e.x+e.width/2-n.width/2,l=e.y+e.height/2-n.height/2,m;switch(i){case Fs:m={x:h,y:e.y-n.height};break;case Ro:m={x:h,y:e.y+e.height};break;case Oo:m={x:e.x+e.width,y:l};break;case Ns:m={x:e.x-n.width,y:l};break;default:m={x:e.x,y:e.y}}var _=i?rT(i):null;if(_!=null){var E=_==="y"?"height":"width";switch(a){case Sd:m[_]=m[_]-(e[E]/2-n[E]/2);break;case gm:m[_]=m[_]+(e[E]/2-n[E]/2);break}}return m}function ym(t,e){e===void 0&&(e={});var n=e,r=n.placement,i=r===void 0?t.placement:r,a=n.strategy,h=a===void 0?t.strategy:a,l=n.boundary,m=l===void 0?RJ:l,_=n.rootBoundary,E=_===void 0?rD:_,S=n.elementContext,I=S===void 0?tp:S,L=n.altBoundary,O=L===void 0?!1:L,D=n.padding,H=D===void 0?0:D,z=lD(typeof H!="number"?H:cD(H,Bm)),N=I===tp?OJ:tp,F=t.rects.popper,$=t.elements[O?N:I],Q=fQ(Eu($)?$:$.contextElement||Tc(t.elements.popper),m,E,h),te=Cd(t.elements.reference),re=hD({reference:te,element:F,strategy:"absolute",placement:i}),we=Nw(Object.assign({},F,re)),Ee=I===tp?we:te,de={top:Q.top-Ee.top+z.top,bottom:Ee.bottom-Q.bottom+z.bottom,left:Q.left-Ee.left+z.left,right:Ee.right-Q.right+z.right},Le=t.modifiersData.offset;if(I===tp&&Le){var Ge=Le[i];Object.keys(de).forEach(function(Be){var Oe=[Oo,Ro].indexOf(Be)>=0?1:-1,Ke=[Fs,Ro].indexOf(Be)>=0?"y":"x";de[Be]+=Ge[Ke]*Oe})}return de}function pQ(t,e){e===void 0&&(e={});var n=e,r=n.placement,i=n.boundary,a=n.rootBoundary,h=n.padding,l=n.flipVariations,m=n.allowedAutoPlacements,_=m===void 0?iD:m,E=Ad(r),S=E?l?iM:iM.filter(function(O){return Ad(O)===E}):Bm,I=S.filter(function(O){return _.indexOf(O)>=0});I.length===0&&(I=S);var L=I.reduce(function(O,D){return O[D]=ym(t,{placement:D,boundary:i,rootBoundary:a,padding:h})[ka(D)],O},{});return Object.keys(L).sort(function(O,D){return L[O]-L[D]})}function mQ(t){if(ka(t)===eT)return[];var e=u0(t);return[aM(t),e,aM(e)]}function gQ(t){var e=t.state,n=t.options,r=t.name;if(!e.modifiersData[r]._skip){for(var i=n.mainAxis,a=i===void 0?!0:i,h=n.altAxis,l=h===void 0?!0:h,m=n.fallbackPlacements,_=n.padding,E=n.boundary,S=n.rootBoundary,I=n.altBoundary,L=n.flipVariations,O=L===void 0?!0:L,D=n.allowedAutoPlacements,H=e.options.placement,z=ka(H),N=z===H,F=m||(N||!O?[u0(H)]:mQ(H)),$=[H].concat(F).reduce(function(at,bt){return at.concat(ka(bt)===eT?pQ(e,{placement:bt,boundary:E,rootBoundary:S,padding:_,flipVariations:O,allowedAutoPlacements:D}):bt)},[]),Q=e.rects.reference,te=e.rects.popper,re=new Map,we=!0,Ee=$[0],de=0;de<$.length;de++){var Le=$[de],Ge=ka(Le),Be=Ad(Le)===Sd,Oe=[Fs,Ro].indexOf(Ge)>=0,Ke=Oe?"width":"height",je=ym(e,{placement:Le,boundary:E,rootBoundary:S,altBoundary:I,padding:_}),it=Oe?Be?Oo:Ns:Be?Ro:Fs;Q[Ke]>te[Ke]&&(it=u0(it));var Me=u0(it),qe=[];if(a&&qe.push(je[Ge]<=0),l&&qe.push(je[it]<=0,je[Me]<=0),qe.every(function(at){return at})){Ee=Le,we=!1;break}re.set(Le,qe)}if(we)for(var ut=O?3:1,zt=function(bt){var xt=$.find(function($t){var Kt=re.get($t);if(Kt)return Kt.slice(0,bt).every(function(Ct){return Ct})});if(xt)return Ee=xt,"break"},vt=ut;vt>0;vt--){var yt=zt(vt);if(yt==="break")break}e.placement!==Ee&&(e.modifiersData[r]._skip=!0,e.placement=Ee,e.reset=!0)}}const yQ={name:"flip",enabled:!0,phase:"main",fn:gQ,requiresIfExists:["offset"],data:{_skip:!1}};function cM(t,e,n){return n===void 0&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function uM(t){return[Fs,Oo,Ro,Ns].some(function(e){return t[e]>=0})}function _Q(t){var e=t.state,n=t.name,r=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,h=ym(e,{elementContext:"reference"}),l=ym(e,{altBoundary:!0}),m=cM(h,r),_=cM(l,i,a),E=uM(m),S=uM(_);e.modifiersData[n]={referenceClippingOffsets:m,popperEscapeOffsets:_,isReferenceHidden:E,hasPopperEscaped:S},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":E,"data-popper-escaped":S})}const vQ={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:_Q};function xQ(t,e,n){var r=ka(t),i=[Ns,Fs].indexOf(r)>=0?-1:1,a=typeof n=="function"?n(Object.assign({},e,{placement:t})):n,h=a[0],l=a[1];return h=h||0,l=(l||0)*i,[Ns,Oo].indexOf(r)>=0?{x:l,y:h}:{x:h,y:l}}function bQ(t){var e=t.state,n=t.options,r=t.name,i=n.offset,a=i===void 0?[0,0]:i,h=iD.reduce(function(E,S){return E[S]=xQ(S,e.rects,a),E},{}),l=h[e.placement],m=l.x,_=l.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=m,e.modifiersData.popperOffsets.y+=_),e.modifiersData[r]=h}const wQ={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:bQ};function EQ(t){var e=t.state,n=t.name;e.modifiersData[n]=hD({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const TQ={name:"popperOffsets",enabled:!0,phase:"read",fn:EQ,data:{}};function SQ(t){return t==="x"?"y":"x"}function PQ(t){var e=t.state,n=t.options,r=t.name,i=n.mainAxis,a=i===void 0?!0:i,h=n.altAxis,l=h===void 0?!1:h,m=n.boundary,_=n.rootBoundary,E=n.altBoundary,S=n.padding,I=n.tether,L=I===void 0?!0:I,O=n.tetherOffset,D=O===void 0?0:O,H=ym(e,{boundary:m,rootBoundary:_,padding:S,altBoundary:E}),z=ka(e.placement),N=Ad(e.placement),F=!N,$=rT(z),Q=SQ($),te=e.modifiersData.popperOffsets,re=e.rects.reference,we=e.rects.popper,Ee=typeof D=="function"?D(Object.assign({},e.rects,{placement:e.placement})):D,de=typeof Ee=="number"?{mainAxis:Ee,altAxis:Ee}:Object.assign({mainAxis:0,altAxis:0},Ee),Le=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,Ge={x:0,y:0};if(te){if(a){var Be,Oe=$==="y"?Fs:Ns,Ke=$==="y"?Ro:Oo,je=$==="y"?"height":"width",it=te[$],Me=it+H[Oe],qe=it-H[Ke],ut=L?-we[je]/2:0,zt=N===Sd?re[je]:we[je],vt=N===Sd?-we[je]:-re[je],yt=e.elements.arrow,at=L&&yt?nT(yt):{width:0,height:0},bt=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:aD(),xt=bt[Oe],$t=bt[Ke],Kt=kp(0,re[je],at[je]),Ct=F?re[je]/2-ut-Kt-xt-de.mainAxis:zt-Kt-xt-de.mainAxis,sn=F?-re[je]/2+ut+Kt+$t+de.mainAxis:vt+Kt+$t+de.mainAxis,Qt=e.elements.arrow&&Um(e.elements.arrow),pn=Qt?$==="y"?Qt.clientTop||0:Qt.clientLeft||0:0,Wt=(Be=Le==null?void 0:Le[$])!=null?Be:0,Ot=it+Ct-Wt-pn,Dt=it+sn-Wt,wn=kp(L?r_(Me,Ot):Me,it,L?du(qe,Dt):qe);te[$]=wn,Ge[$]=wn-it}if(l){var mn,En=$==="x"?Fs:Ns,zn=$==="x"?Ro:Oo,Re=te[Q],Bt=Q==="y"?"height":"width",Rn=Re+H[En],an=Re-H[zn],It=[Fs,Ns].indexOf(z)!==-1,st=(mn=Le==null?void 0:Le[Q])!=null?mn:0,_t=It?Rn:Re-re[Bt]-we[Bt]-st+de.altAxis,Fe=It?Re+re[Bt]+we[Bt]-st-de.altAxis:an,et=L&&It?YJ(_t,Re,Fe):kp(L?_t:Rn,Re,L?Fe:an);te[Q]=et,Ge[Q]=et-Re}e.modifiersData[r]=Ge}}const CQ={name:"preventOverflow",enabled:!0,phase:"main",fn:PQ,requiresIfExists:["offset"]};function AQ(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function IQ(t){return t===ao(t)||!Mo(t)?iT(t):AQ(t)}function MQ(t){var e=t.getBoundingClientRect(),n=Pd(e.width)/t.offsetWidth||1,r=Pd(e.height)/t.offsetHeight||1;return n!==1||r!==1}function kQ(t,e,n){n===void 0&&(n=!1);var r=Mo(e),i=Mo(e)&&MQ(e),a=Tc(e),h=Cd(t,i,n),l={scrollLeft:0,scrollTop:0},m={x:0,y:0};return(r||!r&&!n)&&((Oa(e)!=="body"||oT(a))&&(l=IQ(e)),Mo(e)?(m=Cd(e,!0),m.x+=e.clientLeft,m.y+=e.clientTop):a&&(m.x=sT(a))),{x:h.left+l.scrollLeft-m.x,y:h.top+l.scrollTop-m.y,width:h.width,height:h.height}}function LQ(t){var e=new Map,n=new Set,r=[];t.forEach(function(a){e.set(a.name,a)});function i(a){n.add(a.name);var h=[].concat(a.requires||[],a.requiresIfExists||[]);h.forEach(function(l){if(!n.has(l)){var m=e.get(l);m&&i(m)}}),r.push(a)}return t.forEach(function(a){n.has(a.name)||i(a)}),r}function RQ(t){var e=LQ(t);return GJ.reduce(function(n,r){return n.concat(e.filter(function(i){return i.phase===r}))},[])}function OQ(t){var e;return function(){return e||(e=new Promise(function(n){Promise.resolve().then(function(){e=void 0,n(t())})})),e}}function DQ(t){var e=t.reduce(function(n,r){var i=n[r.name];return n[r.name]=i?Object.assign({},i,r,{options:Object.assign({},i.options,r.options),data:Object.assign({},i.data,r.data)}):r,n},{});return Object.keys(e).map(function(n){return e[n]})}var hM={placement:"bottom",modifiers:[],strategy:"absolute"};function dM(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function zQ(t){t===void 0&&(t={});var e=t,n=e.defaultModifiers,r=n===void 0?[]:n,i=e.defaultOptions,a=i===void 0?hM:i;return function(l,m,_){_===void 0&&(_=a);var E={placement:"bottom",orderedModifiers:[],options:Object.assign({},hM,a),modifiersData:{},elements:{reference:l,popper:m},attributes:{},styles:{}},S=[],I=!1,L={state:E,setOptions:function(z){var N=typeof z=="function"?z(E.options):z;D(),E.options=Object.assign({},a,E.options,N),E.scrollParents={reference:Eu(l)?Lp(l):l.contextElement?Lp(l.contextElement):[],popper:Lp(m)};var F=RQ(DQ([].concat(r,E.options.modifiers)));return E.orderedModifiers=F.filter(function($){return $.enabled}),O(),L.update()},forceUpdate:function(){if(!I){var z=E.elements,N=z.reference,F=z.popper;if(dM(N,F)){E.rects={reference:kQ(N,Um(F),E.options.strategy==="fixed"),popper:nT(F)},E.reset=!1,E.placement=E.options.placement,E.orderedModifiers.forEach(function(de){return E.modifiersData[de.name]=Object.assign({},de.data)});for(var $=0;$<E.orderedModifiers.length;$++){if(E.reset===!0){E.reset=!1,$=-1;continue}var Q=E.orderedModifiers[$],te=Q.fn,re=Q.options,we=re===void 0?{}:re,Ee=Q.name;typeof te=="function"&&(E=te({state:E,options:we,name:Ee,instance:L})||E)}}}},update:OQ(function(){return new Promise(function(H){L.forceUpdate(),H(E)})}),destroy:function(){D(),I=!0}};if(!dM(l,m))return L;L.setOptions(_).then(function(H){!I&&_.onFirstUpdate&&_.onFirstUpdate(H)});function O(){E.orderedModifiers.forEach(function(H){var z=H.name,N=H.options,F=N===void 0?{}:N,$=H.effect;if(typeof $=="function"){var Q=$({state:E,name:z,instance:L,options:F}),te=function(){};S.push(Q||te)}})}function D(){S.forEach(function(H){return H()}),S=[]}return L}}var FQ=[oQ,TQ,iQ,qJ,wQ,yQ,CQ,eQ,vQ],NQ=zQ({defaultModifiers:FQ});function BQ(t){return typeof t=="function"?t():t}const dD=Z.forwardRef(function(e,n){const{children:r,container:i,disablePortal:a=!1}=e,[h,l]=Z.useState(null),m=Yr(Z.isValidElement(r)?r.ref:null,n);if(aa(()=>{a||l(BQ(i)||document.body)},[i,a]),aa(()=>{if(h&&!a)return Cw(n,h),()=>{Cw(n,null)}},[n,h,a]),a){if(Z.isValidElement(r)){const _={ref:m};return Z.cloneElement(r,_)}return ve.jsx(Z.Fragment,{children:r})}return ve.jsx(Z.Fragment,{children:h&&Rd.createPortal(r,h)})});function UQ(t){return $n("MuiPopper",t)}Bn("MuiPopper",["root"]);const VQ=["anchorEl","children","direction","disablePortal","modifiers","open","placement","popperOptions","popperRef","slotProps","slots","TransitionProps","ownerState"],jQ=["anchorEl","children","container","direction","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","style","transition","slotProps","slots"];function $Q(t,e){if(e==="ltr")return t;switch(t){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return t}}function Bw(t){return typeof t=="function"?t():t}function GQ(t){return t.nodeType!==void 0}const HQ=()=>qn({root:["root"]},xJ(UQ)),WQ={},qQ=Z.forwardRef(function(e,n){var r;const{anchorEl:i,children:a,direction:h,disablePortal:l,modifiers:m,open:_,placement:E,popperOptions:S,popperRef:I,slotProps:L={},slots:O={},TransitionProps:D}=e,H=nn(e,VQ),z=Z.useRef(null),N=Yr(z,n),F=Z.useRef(null),$=Yr(F,I),Q=Z.useRef($);aa(()=>{Q.current=$},[$]),Z.useImperativeHandle(I,()=>F.current,[]);const te=$Q(E,h),[re,we]=Z.useState(te),[Ee,de]=Z.useState(Bw(i));Z.useEffect(()=>{F.current&&F.current.forceUpdate()}),Z.useEffect(()=>{i&&de(Bw(i))},[i]),aa(()=>{if(!Ee||!_)return;const Ke=Me=>{we(Me.placement)};let je=[{name:"preventOverflow",options:{altBoundary:l}},{name:"flip",options:{altBoundary:l}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:Me})=>{Ke(Me)}}];m!=null&&(je=je.concat(m)),S&&S.modifiers!=null&&(je=je.concat(S.modifiers));const it=NQ(Ee,z.current,se({placement:te},S,{modifiers:je}));return Q.current(it),()=>{it.destroy(),Q.current(null)}},[Ee,l,m,_,S,te]);const Le={placement:re};D!==null&&(Le.TransitionProps=D);const Ge=HQ(),Be=(r=O.root)!=null?r:"div",Oe=is({elementType:Be,externalSlotProps:L.root,externalForwardedProps:H,additionalProps:{role:"tooltip",ref:N},ownerState:e,className:Ge.root});return ve.jsx(Be,se({},Oe,{children:typeof a=="function"?a(Le):a}))}),ZQ=Z.forwardRef(function(e,n){const{anchorEl:r,children:i,container:a,direction:h="ltr",disablePortal:l=!1,keepMounted:m=!1,modifiers:_,open:E,placement:S="bottom",popperOptions:I=WQ,popperRef:L,style:O,transition:D=!1,slotProps:H={},slots:z={}}=e,N=nn(e,jQ),[F,$]=Z.useState(!0),Q=()=>{$(!1)},te=()=>{$(!0)};if(!m&&!E&&(!D||F))return null;let re;if(a)re=a;else if(r){const de=Bw(r);re=de&&GQ(de)?Xr(de).body:Xr(null).body}const we=!E&&m&&(!D||F)?"none":void 0,Ee=D?{in:E,onEnter:Q,onExited:te}:void 0;return ve.jsx(dD,{disablePortal:l,container:re,children:ve.jsx(qQ,se({anchorEl:r,direction:h,disablePortal:l,modifiers:_,ref:n,open:D?!F:E,placement:S,popperOptions:I,popperRef:L,slotProps:H,slots:z},N,{style:se({position:"fixed",top:0,left:0,display:we},O),TransitionProps:Ee,children:i}))})});function XQ(t){const e=Xr(t);return e.body===t?fl(t).innerWidth>e.documentElement.clientWidth:t.scrollHeight>t.clientHeight}function Rp(t,e){e?t.setAttribute("aria-hidden","true"):t.removeAttribute("aria-hidden")}function fM(t){return parseInt(fl(t).getComputedStyle(t).paddingRight,10)||0}function YQ(t){const n=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(t.tagName)!==-1,r=t.tagName==="INPUT"&&t.getAttribute("type")==="hidden";return n||r}function pM(t,e,n,r,i){const a=[e,n,...r];[].forEach.call(t.children,h=>{const l=a.indexOf(h)===-1,m=!YQ(h);l&&m&&Rp(h,i)})}function Vx(t,e){let n=-1;return t.some((r,i)=>e(r)?(n=i,!0):!1),n}function KQ(t,e){const n=[],r=t.container;if(!e.disableScrollLock){if(XQ(r)){const h=SO(Xr(r));n.push({value:r.style.paddingRight,property:"padding-right",el:r}),r.style.paddingRight=`${fM(r)+h}px`;const l=Xr(r).querySelectorAll(".mui-fixed");[].forEach.call(l,m=>{n.push({value:m.style.paddingRight,property:"padding-right",el:m}),m.style.paddingRight=`${fM(m)+h}px`})}let a;if(r.parentNode instanceof DocumentFragment)a=Xr(r).body;else{const h=r.parentElement,l=fl(r);a=(h==null?void 0:h.nodeName)==="HTML"&&l.getComputedStyle(h).overflowY==="scroll"?h:r}n.push({value:a.style.overflow,property:"overflow",el:a},{value:a.style.overflowX,property:"overflow-x",el:a},{value:a.style.overflowY,property:"overflow-y",el:a}),a.style.overflow="hidden"}return()=>{n.forEach(({value:a,el:h,property:l})=>{a?h.style.setProperty(l,a):h.style.removeProperty(l)})}}function JQ(t){const e=[];return[].forEach.call(t.children,n=>{n.getAttribute("aria-hidden")==="true"&&e.push(n)}),e}class QQ{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(e,n){let r=this.modals.indexOf(e);if(r!==-1)return r;r=this.modals.length,this.modals.push(e),e.modalRef&&Rp(e.modalRef,!1);const i=JQ(n);pM(n,e.mount,e.modalRef,i,!0);const a=Vx(this.containers,h=>h.container===n);return a!==-1?(this.containers[a].modals.push(e),r):(this.containers.push({modals:[e],container:n,restore:null,hiddenSiblings:i}),r)}mount(e,n){const r=Vx(this.containers,a=>a.modals.indexOf(e)!==-1),i=this.containers[r];i.restore||(i.restore=KQ(i,n))}remove(e,n=!0){const r=this.modals.indexOf(e);if(r===-1)return r;const i=Vx(this.containers,h=>h.modals.indexOf(e)!==-1),a=this.containers[i];if(a.modals.splice(a.modals.indexOf(e),1),this.modals.splice(r,1),a.modals.length===0)a.restore&&a.restore(),e.modalRef&&Rp(e.modalRef,n),pM(a.container,e.mount,e.modalRef,a.hiddenSiblings,!1),this.containers.splice(i,1);else{const h=a.modals[a.modals.length-1];h.modalRef&&Rp(h.modalRef,!1)}return r}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}}function eee(t){return typeof t=="function"?t():t}function tee(t){return t?t.props.hasOwnProperty("in"):!1}const nee=new QQ;function ree(t){const{container:e,disableEscapeKeyDown:n=!1,disableScrollLock:r=!1,manager:i=nee,closeAfterTransition:a=!1,onTransitionEnter:h,onTransitionExited:l,children:m,onClose:_,open:E,rootRef:S}=t,I=Z.useRef({}),L=Z.useRef(null),O=Z.useRef(null),D=Yr(O,S),[H,z]=Z.useState(!E),N=tee(m);let F=!0;(t["aria-hidden"]==="false"||t["aria-hidden"]===!1)&&(F=!1);const $=()=>Xr(L.current),Q=()=>(I.current.modalRef=O.current,I.current.mount=L.current,I.current),te=()=>{i.mount(Q(),{disableScrollLock:r}),O.current&&(O.current.scrollTop=0)},re=no(()=>{const je=eee(e)||$().body;i.add(Q(),je),O.current&&te()}),we=Z.useCallback(()=>i.isTopModal(Q()),[i]),Ee=no(je=>{L.current=je,je&&(E&&we()?te():O.current&&Rp(O.current,F))}),de=Z.useCallback(()=>{i.remove(Q(),F)},[F,i]);Z.useEffect(()=>()=>{de()},[de]),Z.useEffect(()=>{E?re():(!N||!a)&&de()},[E,de,N,a,re]);const Le=je=>it=>{var Me;(Me=je.onKeyDown)==null||Me.call(je,it),!(it.key!=="Escape"||!we())&&(n||(it.stopPropagation(),_&&_(it,"escapeKeyDown")))},Ge=je=>it=>{var Me;(Me=je.onClick)==null||Me.call(je,it),it.target===it.currentTarget&&_&&_(it,"backdropClick")};return{getRootProps:(je={})=>{const it=hu(t);delete it.onTransitionEnter,delete it.onTransitionExited;const Me=se({},it,je);return se({role:"presentation"},Me,{onKeyDown:Le(Me),ref:D})},getBackdropProps:(je={})=>{const it=je;return se({"aria-hidden":!0},it,{onClick:Ge(it),open:E})},getTransitionProps:()=>{const je=()=>{z(!1),h&&h()},it=()=>{z(!0),l&&l(),a&&de()};return{onEnter:xI(je,m==null?void 0:m.props.onEnter),onExited:xI(it,m==null?void 0:m.props.onExited)}},rootRef:D,portalRef:Ee,isTopModal:we,exited:H,hasTransition:N}}const iee=2;function fD(t,e){return t-e}function np(t,e,n){return t==null?e:Math.min(Math.max(e,t),n)}function mM(t,e){var n;const{index:r}=(n=t.reduce((i,a,h)=>{const l=Math.abs(e-a);return i===null||l<i.distance||l===i.distance?{distance:l,index:h}:i},null))!=null?n:{};return r}function Py(t,e){if(e.current!==void 0&&t.changedTouches){const n=t;for(let r=0;r<n.changedTouches.length;r+=1){const i=n.changedTouches[r];if(i.identifier===e.current)return{x:i.clientX,y:i.clientY}}return!1}return{x:t.clientX,y:t.clientY}}function i_(t,e,n){return(t-e)*100/(n-e)}function see(t,e,n){return(n-e)*t+e}function oee(t){if(Math.abs(t)<1){const n=t.toExponential().split("e-"),r=n[0].split(".")[1];return(r?r.length:0)+parseInt(n[1],10)}const e=t.toString().split(".")[1];return e?e.length:0}function aee(t,e,n){const r=Math.round((t-n)/e)*e+n;return Number(r.toFixed(oee(e)))}function gM({values:t,newValue:e,index:n}){const r=t.slice();return r[n]=e,r.sort(fD)}function Cy({sliderRef:t,activeIndex:e,setActive:n}){var r,i;const a=Xr(t.current);if(!((r=t.current)!=null&&r.contains(a.activeElement))||Number(a==null||(i=a.activeElement)==null?void 0:i.getAttribute("data-index"))!==e){var h;(h=t.current)==null||h.querySelector(`[type="range"][data-index="${e}"]`).focus()}n&&n(e)}function Ay(t,e){return typeof t=="number"&&typeof e=="number"?t===e:typeof t=="object"&&typeof e=="object"?yJ(t,e):!1}const lee={horizontal:{offset:t=>({left:`${t}%`}),leap:t=>({width:`${t}%`})},"horizontal-reverse":{offset:t=>({right:`${t}%`}),leap:t=>({width:`${t}%`})},vertical:{offset:t=>({bottom:`${t}%`}),leap:t=>({height:`${t}%`})}},cee=t=>t;let Iy;function jx(){return Iy===void 0&&(typeof CSS<"u"&&typeof CSS.supports=="function"?Iy=CSS.supports("touch-action","none"):Iy=!0),Iy}function uee(t){const{"aria-labelledby":e,defaultValue:n,disabled:r=!1,disableSwap:i=!1,isRtl:a=!1,marks:h=!1,max:l=100,min:m=0,name:_,onChange:E,onChangeCommitted:S,orientation:I="horizontal",rootRef:L,scale:O=cee,step:D=1,tabIndex:H,value:z}=t,N=Z.useRef(),[F,$]=Z.useState(-1),[Q,te]=Z.useState(-1),[re,we]=Z.useState(!1),Ee=Z.useRef(0),[de,Le]=K0({controlled:z,default:n??m,name:"Slider"}),Ge=E&&((st,_t,Fe)=>{const et=st.nativeEvent||st,ot=new et.constructor(et.type,et);Object.defineProperty(ot,"target",{writable:!0,value:{value:_t,name:_}}),E(ot,_t,Fe)}),Be=Array.isArray(de);let Oe=Be?de.slice().sort(fD):[de];Oe=Oe.map(st=>np(st,m,l));const Ke=h===!0&&D!==null?[...Array(Math.floor((l-m)/D)+1)].map((st,_t)=>({value:m+D*_t})):h||[],je=Ke.map(st=>st.value),{isFocusVisibleRef:it,onBlur:Me,onFocus:qe,ref:ut}=AE(),[zt,vt]=Z.useState(-1),yt=Z.useRef(),at=Yr(ut,yt),bt=Yr(L,at),xt=st=>_t=>{var Fe;const et=Number(_t.currentTarget.getAttribute("data-index"));qe(_t),it.current===!0&&vt(et),te(et),st==null||(Fe=st.onFocus)==null||Fe.call(st,_t)},$t=st=>_t=>{var Fe;Me(_t),it.current===!1&&vt(-1),te(-1),st==null||(Fe=st.onBlur)==null||Fe.call(st,_t)};aa(()=>{if(r&&yt.current.contains(document.activeElement)){var st;(st=document.activeElement)==null||st.blur()}},[r]),r&&F!==-1&&$(-1),r&&zt!==-1&&vt(-1);const Kt=st=>_t=>{var Fe;(Fe=st.onChange)==null||Fe.call(st,_t);const et=Number(_t.currentTarget.getAttribute("data-index")),ot=Oe[et],Zt=je.indexOf(ot);let Mt=_t.target.valueAsNumber;if(Ke&&D==null){const Ne=je[je.length-1];Mt>Ne?Mt=Ne:Mt<je[0]?Mt=je[0]:Mt=Mt<ot?je[Zt-1]:je[Zt+1]}if(Mt=np(Mt,m,l),Be){i&&(Mt=np(Mt,Oe[et-1]||-1/0,Oe[et+1]||1/0));const Ne=Mt;Mt=gM({values:Oe,newValue:Mt,index:et});let Ye=et;i||(Ye=Mt.indexOf(Ne)),Cy({sliderRef:yt,activeIndex:Ye})}Le(Mt),vt(et),Ge&&!Ay(Mt,de)&&Ge(_t,Mt,et),S&&S(_t,Mt)},Ct=Z.useRef();let sn=I;a&&I==="horizontal"&&(sn+="-reverse");const Qt=({finger:st,move:_t=!1})=>{const{current:Fe}=yt,{width:et,height:ot,bottom:Zt,left:Mt}=Fe.getBoundingClientRect();let Ne;sn.indexOf("vertical")===0?Ne=(Zt-st.y)/ot:Ne=(st.x-Mt)/et,sn.indexOf("-reverse")!==-1&&(Ne=1-Ne);let Ye;if(Ye=see(Ne,m,l),D)Ye=aee(Ye,D,m);else{const gn=mM(je,Ye);Ye=je[gn]}Ye=np(Ye,m,l);let St=0;if(Be){_t?St=Ct.current:St=mM(Oe,Ye),i&&(Ye=np(Ye,Oe[St-1]||-1/0,Oe[St+1]||1/0));const gn=Ye;Ye=gM({values:Oe,newValue:Ye,index:St}),i&&_t||(St=Ye.indexOf(gn),Ct.current=St)}return{newValue:Ye,activeIndex:St}},pn=no(st=>{const _t=Py(st,N);if(!_t)return;if(Ee.current+=1,st.type==="mousemove"&&st.buttons===0){Wt(st);return}const{newValue:Fe,activeIndex:et}=Qt({finger:_t,move:!0});Cy({sliderRef:yt,activeIndex:et,setActive:$}),Le(Fe),!re&&Ee.current>iee&&we(!0),Ge&&!Ay(Fe,de)&&Ge(st,Fe,et)}),Wt=no(st=>{const _t=Py(st,N);if(we(!1),!_t)return;const{newValue:Fe}=Qt({finger:_t,move:!0});$(-1),st.type==="touchend"&&te(-1),S&&S(st,Fe),N.current=void 0,Dt()}),Ot=no(st=>{if(r)return;jx()||st.preventDefault();const _t=st.changedTouches[0];_t!=null&&(N.current=_t.identifier);const Fe=Py(st,N);if(Fe!==!1){const{newValue:ot,activeIndex:Zt}=Qt({finger:Fe});Cy({sliderRef:yt,activeIndex:Zt,setActive:$}),Le(ot),Ge&&!Ay(ot,de)&&Ge(st,ot,Zt)}Ee.current=0;const et=Xr(yt.current);et.addEventListener("touchmove",pn),et.addEventListener("touchend",Wt)}),Dt=Z.useCallback(()=>{const st=Xr(yt.current);st.removeEventListener("mousemove",pn),st.removeEventListener("mouseup",Wt),st.removeEventListener("touchmove",pn),st.removeEventListener("touchend",Wt)},[Wt,pn]);Z.useEffect(()=>{const{current:st}=yt;return st.addEventListener("touchstart",Ot,{passive:jx()}),()=>{st.removeEventListener("touchstart",Ot,{passive:jx()}),Dt()}},[Dt,Ot]),Z.useEffect(()=>{r&&Dt()},[r,Dt]);const wn=st=>_t=>{var Fe;if((Fe=st.onMouseDown)==null||Fe.call(st,_t),r||_t.defaultPrevented||_t.button!==0)return;_t.preventDefault();const et=Py(_t,N);if(et!==!1){const{newValue:Zt,activeIndex:Mt}=Qt({finger:et});Cy({sliderRef:yt,activeIndex:Mt,setActive:$}),Le(Zt),Ge&&!Ay(Zt,de)&&Ge(_t,Zt,Mt)}Ee.current=0;const ot=Xr(yt.current);ot.addEventListener("mousemove",pn),ot.addEventListener("mouseup",Wt)},mn=i_(Be?Oe[0]:m,m,l),En=i_(Oe[Oe.length-1],m,l)-mn,zn=(st={})=>{const _t=hu(st),Fe={onMouseDown:wn(_t||{})},et=se({},_t,Fe);return se({},st,{ref:bt},et)},Re=st=>_t=>{var Fe;(Fe=st.onMouseOver)==null||Fe.call(st,_t);const et=Number(_t.currentTarget.getAttribute("data-index"));te(et)},Bt=st=>_t=>{var Fe;(Fe=st.onMouseLeave)==null||Fe.call(st,_t),te(-1)};return{active:F,axis:sn,axisProps:lee,dragging:re,focusedThumbIndex:zt,getHiddenInputProps:(st={})=>{var _t;const Fe=hu(st),et={onChange:Kt(Fe||{}),onFocus:xt(Fe||{}),onBlur:$t(Fe||{})},ot=se({},Fe,et);return se({tabIndex:H,"aria-labelledby":e,"aria-orientation":I,"aria-valuemax":O(l),"aria-valuemin":O(m),name:_,type:"range",min:t.min,max:t.max,step:t.step===null&&t.marks?"any":(_t=t.step)!=null?_t:void 0,disabled:r},st,ot,{style:se({},eZ,{direction:a?"rtl":"ltr",width:"100%",height:"100%"})})},getRootProps:zn,getThumbProps:(st={})=>{const _t=hu(st),Fe={onMouseOver:Re(_t||{}),onMouseLeave:Bt(_t||{})};return se({},st,_t,Fe)},marks:Ke,open:Q,range:Be,rootRef:bt,trackLeap:En,trackOffset:mn,values:Oe,getThumbStyle:st=>({pointerEvents:F!==-1&&F!==st?"none":void 0})}}function hee(t={}){const{autoHideDuration:e=null,disableWindowBlurListener:n=!1,onClose:r,open:i,resumeHideDuration:a}=t,h=Z.useRef();Z.useEffect(()=>{if(!i)return;function z(N){N.defaultPrevented||(N.key==="Escape"||N.key==="Esc")&&(r==null||r(N,"escapeKeyDown"))}return document.addEventListener("keydown",z),()=>{document.removeEventListener("keydown",z)}},[i,r]);const l=no((z,N)=>{r==null||r(z,N)}),m=no(z=>{!r||z==null||(clearTimeout(h.current),h.current=setTimeout(()=>{l(null,"timeout")},z))});Z.useEffect(()=>(i&&m(e),()=>{clearTimeout(h.current)}),[i,e,m]);const _=z=>{r==null||r(z,"clickaway")},E=()=>{clearTimeout(h.current)},S=Z.useCallback(()=>{e!=null&&m(a??e*.5)},[e,a,m]),I=z=>N=>{const F=z.onBlur;F==null||F(N),S()},L=z=>N=>{const F=z.onFocus;F==null||F(N),E()},O=z=>N=>{const F=z.onMouseEnter;F==null||F(N),E()},D=z=>N=>{const F=z.onMouseLeave;F==null||F(N),S()};return Z.useEffect(()=>{if(!n&&i)return window.addEventListener("focus",S),window.addEventListener("blur",E),()=>{window.removeEventListener("focus",S),window.removeEventListener("blur",E)}},[n,S,i]),{getRootProps:(z={})=>{const N=se({},hu(t),hu(z));return se({role:"presentation"},z,N,{onBlur:I(N),onFocus:L(N),onMouseEnter:O(N),onMouseLeave:D(N)})},onClickAway:_}}const dee=["onChange","maxRows","minRows","style","value"];function My(t){return parseInt(t,10)||0}const fee={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function yM(t){return t==null||Object.keys(t).length===0||t.outerHeightStyle===0&&!t.overflow}const pee=Z.forwardRef(function(e,n){const{onChange:r,maxRows:i,minRows:a=1,style:h,value:l}=e,m=nn(e,dee),{current:_}=Z.useRef(l!=null),E=Z.useRef(null),S=Yr(n,E),I=Z.useRef(null),L=Z.useRef(0),[O,D]=Z.useState({outerHeightStyle:0}),H=Z.useCallback(()=>{const $=E.current,te=fl($).getComputedStyle($);if(te.width==="0px")return{outerHeightStyle:0};const re=I.current;re.style.width=te.width,re.value=$.value||e.placeholder||"x",re.value.slice(-1)===`
`&&(re.value+=" ");const we=te.boxSizing,Ee=My(te.paddingBottom)+My(te.paddingTop),de=My(te.borderBottomWidth)+My(te.borderTopWidth),Le=re.scrollHeight;re.value="x";const Ge=re.scrollHeight;let Be=Le;a&&(Be=Math.max(Number(a)*Ge,Be)),i&&(Be=Math.min(Number(i)*Ge,Be)),Be=Math.max(Be,Ge);const Oe=Be+(we==="border-box"?Ee+de:0),Ke=Math.abs(Be-Le)<=1;return{outerHeightStyle:Oe,overflow:Ke}},[i,a,e.placeholder]),z=($,Q)=>{const{outerHeightStyle:te,overflow:re}=Q;return L.current<20&&(te>0&&Math.abs(($.outerHeightStyle||0)-te)>1||$.overflow!==re)?(L.current+=1,{overflow:re,outerHeightStyle:te}):$},N=Z.useCallback(()=>{const $=H();yM($)||D(Q=>z(Q,$))},[H]);aa(()=>{const $=()=>{const Le=H();yM(Le)||Rd.flushSync(()=>{D(Ge=>z(Ge,Le))})},Q=()=>{L.current=0,$()};let te;const re=PE(Q),we=E.current,Ee=fl(we);Ee.addEventListener("resize",re);let de;return typeof ResizeObserver<"u"&&(de=new ResizeObserver(Q),de.observe(we)),()=>{re.clear(),cancelAnimationFrame(te),Ee.removeEventListener("resize",re),de&&de.disconnect()}},[H]),aa(()=>{N()}),Z.useEffect(()=>{L.current=0},[l]);const F=$=>{L.current=0,_||N(),r&&r($)};return ve.jsxs(Z.Fragment,{children:[ve.jsx("textarea",se({value:l,onChange:F,ref:S,rows:a,style:se({height:O.outerHeightStyle,overflow:O.overflow?"hidden":void 0},h)},m)),ve.jsx("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:I,tabIndex:-1,style:se({},fee.shadow,h,{paddingTop:0,paddingBottom:0})})]})}),mee=["anchorEl","component","components","componentsProps","container","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","transition","slots","slotProps"],gee=At(ZQ,{name:"MuiPopper",slot:"Root",overridesResolver:(t,e)=>e.root})({}),yee=Z.forwardRef(function(e,n){var r;const i=$E(),a=Gn({props:e,name:"MuiPopper"}),{anchorEl:h,component:l,components:m,componentsProps:_,container:E,disablePortal:S,keepMounted:I,modifiers:L,open:O,placement:D,popperOptions:H,popperRef:z,transition:N,slots:F,slotProps:$}=a,Q=nn(a,mee),te=(r=F==null?void 0:F.root)!=null?r:m==null?void 0:m.Root,re=se({anchorEl:h,container:E,disablePortal:S,keepMounted:I,modifiers:L,open:O,placement:D,popperOptions:H,popperRef:z,transition:N},Q);return ve.jsx(gee,se({as:l,direction:i==null?void 0:i.direction,slots:{root:te},slotProps:$??_},re,{ref:n}))}),pD=yee;function zd({props:t,states:e,muiFormControl:n}){return e.reduce((r,i)=>(r[i]=t[i],n&&typeof t[i]>"u"&&(r[i]=n[i]),r),{})}const _ee=Z.createContext(void 0),xv=_ee;function ku(){return Z.useContext(xv)}function mD(t){return ve.jsx(nY,se({},t,{defaultTheme:ov,themeId:bu}))}function _M(t){return t!=null&&!(Array.isArray(t)&&t.length===0)}function s_(t,e=!1){return t&&(_M(t.value)&&t.value!==""||e&&_M(t.defaultValue)&&t.defaultValue!=="")}function vee(t){return t.startAdornment}function xee(t){return $n("MuiInputBase",t)}const bee=Bn("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),Id=bee,wee=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","slotProps","slots","startAdornment","type","value"],bv=(t,e)=>{const{ownerState:n}=t;return[e.root,n.formControl&&e.formControl,n.startAdornment&&e.adornedStart,n.endAdornment&&e.adornedEnd,n.error&&e.error,n.size==="small"&&e.sizeSmall,n.multiline&&e.multiline,n.color&&e[`color${Yt(n.color)}`],n.fullWidth&&e.fullWidth,n.hiddenLabel&&e.hiddenLabel]},wv=(t,e)=>{const{ownerState:n}=t;return[e.input,n.size==="small"&&e.inputSizeSmall,n.multiline&&e.inputMultiline,n.type==="search"&&e.inputTypeSearch,n.startAdornment&&e.inputAdornedStart,n.endAdornment&&e.inputAdornedEnd,n.hiddenLabel&&e.inputHiddenLabel]},Eee=t=>{const{classes:e,color:n,disabled:r,error:i,endAdornment:a,focused:h,formControl:l,fullWidth:m,hiddenLabel:_,multiline:E,readOnly:S,size:I,startAdornment:L,type:O}=t,D={root:["root",`color${Yt(n)}`,r&&"disabled",i&&"error",m&&"fullWidth",h&&"focused",l&&"formControl",I&&I!=="medium"&&`size${Yt(I)}`,E&&"multiline",L&&"adornedStart",a&&"adornedEnd",_&&"hiddenLabel",S&&"readOnly"],input:["input",r&&"disabled",O==="search"&&"inputTypeSearch",E&&"inputMultiline",I==="small"&&"inputSizeSmall",_&&"inputHiddenLabel",L&&"inputAdornedStart",a&&"inputAdornedEnd",S&&"readOnly"]};return qn(D,xee,e)},Ev=At("div",{name:"MuiInputBase",slot:"Root",overridesResolver:bv})(({theme:t,ownerState:e})=>se({},t.typography.body1,{color:(t.vars||t).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${Id.disabled}`]:{color:(t.vars||t).palette.text.disabled,cursor:"default"}},e.multiline&&se({padding:"4px 0 5px"},e.size==="small"&&{paddingTop:1}),e.fullWidth&&{width:"100%"})),Tv=At("input",{name:"MuiInputBase",slot:"Input",overridesResolver:wv})(({theme:t,ownerState:e})=>{const n=t.palette.mode==="light",r=se({color:"currentColor"},t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:n?.42:.5},{transition:t.transitions.create("opacity",{duration:t.transitions.duration.shorter})}),i={opacity:"0 !important"},a=t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:n?.42:.5};return se({font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":r,"&::-moz-placeholder":r,"&:-ms-input-placeholder":r,"&::-ms-input-placeholder":r,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${Id.formControl} &`]:{"&::-webkit-input-placeholder":i,"&::-moz-placeholder":i,"&:-ms-input-placeholder":i,"&::-ms-input-placeholder":i,"&:focus::-webkit-input-placeholder":a,"&:focus::-moz-placeholder":a,"&:focus:-ms-input-placeholder":a,"&:focus::-ms-input-placeholder":a},[`&.${Id.disabled}`]:{opacity:1,WebkitTextFillColor:(t.vars||t).palette.text.disabled},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},e.size==="small"&&{paddingTop:1},e.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},e.type==="search"&&{MozAppearance:"textfield"})}),Tee=ve.jsx(mD,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),See=Z.forwardRef(function(e,n){var r;const i=Gn({props:e,name:"MuiInputBase"}),{"aria-describedby":a,autoComplete:h,autoFocus:l,className:m,components:_={},componentsProps:E={},defaultValue:S,disabled:I,disableInjectingGlobalStyles:L,endAdornment:O,fullWidth:D=!1,id:H,inputComponent:z="input",inputProps:N={},inputRef:F,maxRows:$,minRows:Q,multiline:te=!1,name:re,onBlur:we,onChange:Ee,onClick:de,onFocus:Le,onKeyDown:Ge,onKeyUp:Be,placeholder:Oe,readOnly:Ke,renderSuffix:je,rows:it,slotProps:Me={},slots:qe={},startAdornment:ut,type:zt="text",value:vt}=i,yt=nn(i,wee),at=N.value!=null?N.value:vt,{current:bt}=Z.useRef(at!=null),xt=Z.useRef(),$t=Z.useCallback(et=>{},[]),Kt=Yr(xt,F,N.ref,$t),[Ct,sn]=Z.useState(!1),Qt=ku(),pn=zd({props:i,muiFormControl:Qt,states:["color","disabled","error","hiddenLabel","size","required","filled"]});pn.focused=Qt?Qt.focused:Ct,Z.useEffect(()=>{!Qt&&I&&Ct&&(sn(!1),we&&we())},[Qt,I,Ct,we]);const Wt=Qt&&Qt.onFilled,Ot=Qt&&Qt.onEmpty,Dt=Z.useCallback(et=>{s_(et)?Wt&&Wt():Ot&&Ot()},[Wt,Ot]);aa(()=>{bt&&Dt({value:at})},[at,Dt,bt]);const wn=et=>{if(pn.disabled){et.stopPropagation();return}Le&&Le(et),N.onFocus&&N.onFocus(et),Qt&&Qt.onFocus?Qt.onFocus(et):sn(!0)},mn=et=>{we&&we(et),N.onBlur&&N.onBlur(et),Qt&&Qt.onBlur?Qt.onBlur(et):sn(!1)},En=(et,...ot)=>{if(!bt){const Zt=et.target||xt.current;if(Zt==null)throw new Error(vc(1));Dt({value:Zt.value})}N.onChange&&N.onChange(et,...ot),Ee&&Ee(et,...ot)};Z.useEffect(()=>{Dt(xt.current)},[]);const zn=et=>{xt.current&&et.currentTarget===et.target&&xt.current.focus(),de&&de(et)};let Re=z,Bt=N;te&&Re==="input"&&(it?Bt=se({type:void 0,minRows:it,maxRows:it},Bt):Bt=se({type:void 0,maxRows:$,minRows:Q},Bt),Re=pee);const Rn=et=>{Dt(et.animationName==="mui-auto-fill-cancel"?xt.current:{value:"x"})};Z.useEffect(()=>{Qt&&Qt.setAdornedStart(!!ut)},[Qt,ut]);const an=se({},i,{color:pn.color||"primary",disabled:pn.disabled,endAdornment:O,error:pn.error,focused:pn.focused,formControl:Qt,fullWidth:D,hiddenLabel:pn.hiddenLabel,multiline:te,size:pn.size,startAdornment:ut,type:zt}),It=Eee(an),st=qe.root||_.Root||Ev,_t=Me.root||E.root||{},Fe=qe.input||_.Input||Tv;return Bt=se({},Bt,(r=Me.input)!=null?r:E.input),ve.jsxs(Z.Fragment,{children:[!L&&Tee,ve.jsxs(st,se({},_t,!mc(st)&&{ownerState:se({},an,_t.ownerState)},{ref:n,onClick:zn},yt,{className:fn(It.root,_t.className,m,Ke&&"MuiInputBase-readOnly"),children:[ut,ve.jsx(xv.Provider,{value:null,children:ve.jsx(Fe,se({ownerState:an,"aria-invalid":pn.error,"aria-describedby":a,autoComplete:h,autoFocus:l,defaultValue:S,disabled:pn.disabled,id:H,onAnimationStart:Rn,name:re,placeholder:Oe,readOnly:Ke,required:pn.required,rows:it,value:at,onKeyDown:Ge,onKeyUp:Be,type:zt},Bt,!mc(Fe)&&{as:Re,ownerState:se({},an,Bt.ownerState)},{ref:Kt,className:fn(It.input,Bt.className,Ke&&"MuiInputBase-readOnly"),onBlur:mn,onChange:En,onFocus:wn}))}),O,je?je(se({},pn,{startAdornment:ut})):null]}))]})}),aT=See;function Pee(t){return $n("MuiInput",t)}const Cee=se({},Id,Bn("MuiInput",["root","underline","input"])),rp=Cee;function Aee(t){return $n("MuiOutlinedInput",t)}const Iee=se({},Id,Bn("MuiOutlinedInput",["root","notchedOutline","input"])),Wl=Iee;function Mee(t){return $n("MuiFilledInput",t)}const kee=se({},Id,Bn("MuiFilledInput",["root","underline","input"])),Yc=kee,Lee=vl(ve.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),Ree=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],Oee={entering:{opacity:1},entered:{opacity:1}},Dee=Z.forwardRef(function(e,n){const r=Ec(),i={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},{addEndListener:a,appear:h=!0,children:l,easing:m,in:_,onEnter:E,onEntered:S,onEntering:I,onExit:L,onExited:O,onExiting:D,style:H,timeout:z=i,TransitionComponent:N=XE}=e,F=nn(e,Ree),$=Z.useRef(null),Q=Yr($,l.ref,n),te=Oe=>Ke=>{if(Oe){const je=$.current;Ke===void 0?Oe(je):Oe(je,Ke)}},re=te(I),we=te((Oe,Ke)=>{JE(Oe);const je=Td({style:H,timeout:z,easing:m},{mode:"enter"});Oe.style.webkitTransition=r.transitions.create("opacity",je),Oe.style.transition=r.transitions.create("opacity",je),E&&E(Oe,Ke)}),Ee=te(S),de=te(D),Le=te(Oe=>{const Ke=Td({style:H,timeout:z,easing:m},{mode:"exit"});Oe.style.webkitTransition=r.transitions.create("opacity",Ke),Oe.style.transition=r.transitions.create("opacity",Ke),L&&L(Oe)}),Ge=te(O),Be=Oe=>{a&&a($.current,Oe)};return ve.jsx(N,se({appear:h,in:_,nodeRef:$,onEnter:we,onEntered:Ee,onEntering:re,onExit:Le,onExited:Ge,onExiting:de,addEndListener:Be,timeout:z},F,{children:(Oe,Ke)=>Z.cloneElement(l,se({style:se({opacity:0,visibility:Oe==="exited"&&!_?"hidden":void 0},Oee[Oe],H,l.props.style),ref:Q},Ke))}))}),gD=Dee;function zee(t){return $n("MuiBackdrop",t)}Bn("MuiBackdrop",["root","invisible"]);const Fee=["children","className","component","components","componentsProps","invisible","open","slotProps","slots","TransitionComponent","transitionDuration"],Nee=t=>{const{classes:e,invisible:n}=t;return qn({root:["root",n&&"invisible"]},zee,e)},Bee=At("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.invisible&&e.invisible]}})(({ownerState:t})=>se({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},t.invisible&&{backgroundColor:"transparent"})),Uee=Z.forwardRef(function(e,n){var r,i,a;const h=Gn({props:e,name:"MuiBackdrop"}),{children:l,className:m,component:_="div",components:E={},componentsProps:S={},invisible:I=!1,open:L,slotProps:O={},slots:D={},TransitionComponent:H=gD,transitionDuration:z}=h,N=nn(h,Fee),F=se({},h,{component:_,invisible:I}),$=Nee(F),Q=(r=O.root)!=null?r:S.root;return ve.jsx(H,se({in:L,timeout:z},N,{children:ve.jsx(Bee,se({"aria-hidden":!0},Q,{as:(i=(a=D.root)!=null?a:E.Root)!=null?i:_,className:fn($.root,m,Q==null?void 0:Q.className),ownerState:se({},F,Q==null?void 0:Q.ownerState),classes:$,ref:n,children:l}))}))}),Vee=Uee,jee=HE(),$ee=oY({themeId:bu,defaultTheme:jee,defaultClassName:"MuiBox-root",generateClassName:PO.generate}),$x=$ee;function Gee(t){return $n("MuiButton",t)}const Hee=Bn("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),ky=Hee,Wee=Z.createContext({}),qee=Wee,Zee=Z.createContext(void 0),Xee=Zee,Yee=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],Kee=t=>{const{color:e,disableElevation:n,fullWidth:r,size:i,variant:a,classes:h}=t,l={root:["root",a,`${a}${Yt(e)}`,`size${Yt(i)}`,`${a}Size${Yt(i)}`,e==="inherit"&&"colorInherit",n&&"disableElevation",r&&"fullWidth"],label:["label"],startIcon:["startIcon",`iconSize${Yt(i)}`],endIcon:["endIcon",`iconSize${Yt(i)}`]},m=qn(l,Gee,h);return se({},h,m)},yD=t=>se({},t.size==="small"&&{"& > *:nth-of-type(1)":{fontSize:18}},t.size==="medium"&&{"& > *:nth-of-type(1)":{fontSize:20}},t.size==="large"&&{"& > *:nth-of-type(1)":{fontSize:22}}),Jee=At(QE,{shouldForwardProp:t=>la(t)||t==="classes",name:"MuiButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],e[`${n.variant}${Yt(n.color)}`],e[`size${Yt(n.size)}`],e[`${n.variant}Size${Yt(n.size)}`],n.color==="inherit"&&e.colorInherit,n.disableElevation&&e.disableElevation,n.fullWidth&&e.fullWidth]}})(({theme:t,ownerState:e})=>{var n,r;const i=t.palette.mode==="light"?t.palette.grey[300]:t.palette.grey[800],a=t.palette.mode==="light"?t.palette.grey.A100:t.palette.grey[700];return se({},t.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":se({textDecoration:"none",backgroundColor:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:Ai(t.palette.text.primary,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="text"&&e.color!=="inherit"&&{backgroundColor:t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:Ai(t.palette[e.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="outlined"&&e.color!=="inherit"&&{border:`1px solid ${(t.vars||t).palette[e.color].main}`,backgroundColor:t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:Ai(t.palette[e.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="contained"&&{backgroundColor:t.vars?t.vars.palette.Button.inheritContainedHoverBg:a,boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2],backgroundColor:(t.vars||t).palette.grey[300]}},e.variant==="contained"&&e.color!=="inherit"&&{backgroundColor:(t.vars||t).palette[e.color].dark,"@media (hover: none)":{backgroundColor:(t.vars||t).palette[e.color].main}}),"&:active":se({},e.variant==="contained"&&{boxShadow:(t.vars||t).shadows[8]}),[`&.${ky.focusVisible}`]:se({},e.variant==="contained"&&{boxShadow:(t.vars||t).shadows[6]}),[`&.${ky.disabled}`]:se({color:(t.vars||t).palette.action.disabled},e.variant==="outlined"&&{border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`},e.variant==="contained"&&{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground})},e.variant==="text"&&{padding:"6px 8px"},e.variant==="text"&&e.color!=="inherit"&&{color:(t.vars||t).palette[e.color].main},e.variant==="outlined"&&{padding:"5px 15px",border:"1px solid currentColor"},e.variant==="outlined"&&e.color!=="inherit"&&{color:(t.vars||t).palette[e.color].main,border:t.vars?`1px solid rgba(${t.vars.palette[e.color].mainChannel} / 0.5)`:`1px solid ${Ai(t.palette[e.color].main,.5)}`},e.variant==="contained"&&{color:t.vars?t.vars.palette.text.primary:(n=(r=t.palette).getContrastText)==null?void 0:n.call(r,t.palette.grey[300]),backgroundColor:t.vars?t.vars.palette.Button.inheritContainedBg:i,boxShadow:(t.vars||t).shadows[2]},e.variant==="contained"&&e.color!=="inherit"&&{color:(t.vars||t).palette[e.color].contrastText,backgroundColor:(t.vars||t).palette[e.color].main},e.color==="inherit"&&{color:"inherit",borderColor:"currentColor"},e.size==="small"&&e.variant==="text"&&{padding:"4px 5px",fontSize:t.typography.pxToRem(13)},e.size==="large"&&e.variant==="text"&&{padding:"8px 11px",fontSize:t.typography.pxToRem(15)},e.size==="small"&&e.variant==="outlined"&&{padding:"3px 9px",fontSize:t.typography.pxToRem(13)},e.size==="large"&&e.variant==="outlined"&&{padding:"7px 21px",fontSize:t.typography.pxToRem(15)},e.size==="small"&&e.variant==="contained"&&{padding:"4px 10px",fontSize:t.typography.pxToRem(13)},e.size==="large"&&e.variant==="contained"&&{padding:"8px 22px",fontSize:t.typography.pxToRem(15)},e.fullWidth&&{width:"100%"})},({ownerState:t})=>t.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${ky.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${ky.disabled}`]:{boxShadow:"none"}}),Qee=At("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.startIcon,e[`iconSize${Yt(n.size)}`]]}})(({ownerState:t})=>se({display:"inherit",marginRight:8,marginLeft:-4},t.size==="small"&&{marginLeft:-2},yD(t))),ete=At("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.endIcon,e[`iconSize${Yt(n.size)}`]]}})(({ownerState:t})=>se({display:"inherit",marginRight:-4,marginLeft:8},t.size==="small"&&{marginRight:-2},yD(t))),tte=Z.forwardRef(function(e,n){const r=Z.useContext(qee),i=Z.useContext(Xee),a=IE(r,e),h=Gn({props:a,name:"MuiButton"}),{children:l,color:m="primary",component:_="button",className:E,disabled:S=!1,disableElevation:I=!1,disableFocusRipple:L=!1,endIcon:O,focusVisibleClassName:D,fullWidth:H=!1,size:z="medium",startIcon:N,type:F,variant:$="text"}=h,Q=nn(h,Yee),te=se({},h,{color:m,component:_,disabled:S,disableElevation:I,disableFocusRipple:L,fullWidth:H,size:z,type:F,variant:$}),re=Kee(te),we=N&&ve.jsx(Qee,{className:re.startIcon,ownerState:te,children:N}),Ee=O&&ve.jsx(ete,{className:re.endIcon,ownerState:te,children:O}),de=i||"";return ve.jsxs(Jee,se({ownerState:te,className:fn(r.className,re.root,E,de),component:_,disabled:S,focusRipple:!L,focusVisibleClassName:fn(re.focusVisible,D),ref:n,type:F},Q,{classes:re,children:[we,l,Ee]}))}),Uw=tte;function nte(t){return $n("MuiCircularProgress",t)}Bn("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const rte=["className","color","disableShrink","size","style","thickness","value","variant"];let Sv=t=>t,vM,xM,bM,wM;const ql=44,ite=zm(vM||(vM=Sv`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`)),ste=zm(xM||(xM=Sv`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -125px;
  }
`)),ote=t=>{const{classes:e,variant:n,color:r,disableShrink:i}=t,a={root:["root",n,`color${Yt(r)}`],svg:["svg"],circle:["circle",`circle${Yt(n)}`,i&&"circleDisableShrink"]};return qn(a,nte,e)},ate=At("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],e[`color${Yt(n.color)}`]]}})(({ownerState:t,theme:e})=>se({display:"inline-block"},t.variant==="determinate"&&{transition:e.transitions.create("transform")},t.color!=="inherit"&&{color:(e.vars||e).palette[t.color].main}),({ownerState:t})=>t.variant==="indeterminate"&&FE(bM||(bM=Sv`
      animation: ${0} 1.4s linear infinite;
    `),ite)),lte=At("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(t,e)=>e.svg})({display:"block"}),cte=At("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.circle,e[`circle${Yt(n.variant)}`],n.disableShrink&&e.circleDisableShrink]}})(({ownerState:t,theme:e})=>se({stroke:"currentColor"},t.variant==="determinate"&&{transition:e.transitions.create("stroke-dashoffset")},t.variant==="indeterminate"&&{strokeDasharray:"80px, 200px",strokeDashoffset:0}),({ownerState:t})=>t.variant==="indeterminate"&&!t.disableShrink&&FE(wM||(wM=Sv`
      animation: ${0} 1.4s ease-in-out infinite;
    `),ste)),ute=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiCircularProgress"}),{className:i,color:a="primary",disableShrink:h=!1,size:l=40,style:m,thickness:_=3.6,value:E=0,variant:S="indeterminate"}=r,I=nn(r,rte),L=se({},r,{color:a,disableShrink:h,size:l,thickness:_,value:E,variant:S}),O=ote(L),D={},H={},z={};if(S==="determinate"){const N=2*Math.PI*((ql-_)/2);D.strokeDasharray=N.toFixed(3),z["aria-valuenow"]=Math.round(E),D.strokeDashoffset=`${((100-E)/100*N).toFixed(3)}px`,H.transform="rotate(-90deg)"}return ve.jsx(ate,se({className:fn(O.root,i),style:se({width:l,height:l},H,m),ownerState:L,ref:n,role:"progressbar"},z,I,{children:ve.jsx(lte,{className:O.svg,ownerState:L,viewBox:`${ql/2} ${ql/2} ${ql} ${ql}`,children:ve.jsx(cte,{className:O.circle,style:D,ownerState:L,cx:ql,cy:ql,r:(ql-_)/2,fill:"none",strokeWidth:_})})}))}),hte=ute,dte=(t,e)=>se({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%"},e&&!t.vars&&{colorScheme:t.palette.mode}),fte=t=>se({color:(t.vars||t).palette.text.primary},t.typography.body1,{backgroundColor:(t.vars||t).palette.background.default,"@media print":{backgroundColor:(t.vars||t).palette.common.white}}),pte=(t,e=!1)=>{var n;const r={};e&&t.colorSchemes&&Object.entries(t.colorSchemes).forEach(([h,l])=>{var m;r[t.getColorSchemeSelector(h).replace(/\s*&/,"")]={colorScheme:(m=l.palette)==null?void 0:m.mode}});let i=se({html:dte(t,e),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:t.typography.fontWeightBold},body:se({margin:0},fte(t),{"&::backdrop":{backgroundColor:(t.vars||t).palette.background.default}})},r);const a=(n=t.components)==null||(n=n.MuiCssBaseline)==null?void 0:n.styleOverrides;return a&&(i=[i,a]),i};function mte(t){const e=Gn({props:t,name:"MuiCssBaseline"}),{children:n,enableColorScheme:r=!1}=e;return ve.jsxs(Z.Fragment,{children:[ve.jsx(mD,{styles:i=>pte(i,r)}),n]})}function gte(t){return $n("MuiModal",t)}Bn("MuiModal",["root","hidden","backdrop"]);const yte=["BackdropComponent","BackdropProps","classes","className","closeAfterTransition","children","container","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","onBackdropClick","onClose","onTransitionEnter","onTransitionExited","open","slotProps","slots","theme"],_te=t=>{const{open:e,exited:n,classes:r}=t;return qn({root:["root",!e&&n&&"hidden"],backdrop:["backdrop"]},gte,r)},vte=At("div",{name:"MuiModal",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,!n.open&&n.exited&&e.hidden]}})(({theme:t,ownerState:e})=>se({position:"fixed",zIndex:(t.vars||t).zIndex.modal,right:0,bottom:0,top:0,left:0},!e.open&&e.exited&&{visibility:"hidden"})),xte=At(Vee,{name:"MuiModal",slot:"Backdrop",overridesResolver:(t,e)=>e.backdrop})({zIndex:-1}),bte=Z.forwardRef(function(e,n){var r,i,a,h,l,m;const _=Gn({name:"MuiModal",props:e}),{BackdropComponent:E=xte,BackdropProps:S,className:I,closeAfterTransition:L=!1,children:O,container:D,component:H,components:z={},componentsProps:N={},disableAutoFocus:F=!1,disableEnforceFocus:$=!1,disableEscapeKeyDown:Q=!1,disablePortal:te=!1,disableRestoreFocus:re=!1,disableScrollLock:we=!1,hideBackdrop:Ee=!1,keepMounted:de=!1,onBackdropClick:Le,open:Ge,slotProps:Be,slots:Oe}=_,Ke=nn(_,yte),je=se({},_,{closeAfterTransition:L,disableAutoFocus:F,disableEnforceFocus:$,disableEscapeKeyDown:Q,disablePortal:te,disableRestoreFocus:re,disableScrollLock:we,hideBackdrop:Ee,keepMounted:de}),{getRootProps:it,getBackdropProps:Me,getTransitionProps:qe,portalRef:ut,isTopModal:zt,exited:vt,hasTransition:yt}=ree(se({},je,{rootRef:n})),at=se({},je,{exited:vt}),bt=_te(at),xt={};if(O.props.tabIndex===void 0&&(xt.tabIndex="-1"),yt){const{onEnter:Wt,onExited:Ot}=qe();xt.onEnter=Wt,xt.onExited=Ot}const $t=(r=(i=Oe==null?void 0:Oe.root)!=null?i:z.Root)!=null?r:vte,Kt=(a=(h=Oe==null?void 0:Oe.backdrop)!=null?h:z.Backdrop)!=null?a:E,Ct=(l=Be==null?void 0:Be.root)!=null?l:N.root,sn=(m=Be==null?void 0:Be.backdrop)!=null?m:N.backdrop,Qt=is({elementType:$t,externalSlotProps:Ct,externalForwardedProps:Ke,getSlotProps:it,additionalProps:{ref:n,as:H},ownerState:at,className:fn(I,Ct==null?void 0:Ct.className,bt==null?void 0:bt.root,!at.open&&at.exited&&(bt==null?void 0:bt.hidden))}),pn=is({elementType:Kt,externalSlotProps:sn,additionalProps:S,getSlotProps:Wt=>Me(se({},Wt,{onClick:Ot=>{Le&&Le(Ot),Wt!=null&&Wt.onClick&&Wt.onClick(Ot)}})),className:fn(sn==null?void 0:sn.className,S==null?void 0:S.className,bt==null?void 0:bt.backdrop),ownerState:at});return!de&&!Ge&&(!yt||vt)?null:ve.jsx(dD,{ref:ut,container:D,disablePortal:te,children:ve.jsxs($t,se({},Qt,{children:[!Ee&&E?ve.jsx(Kt,se({},pn)):null,ve.jsx(LJ,{disableEnforceFocus:$,disableAutoFocus:F,disableRestoreFocus:re,isEnabled:zt,open:Ge,children:Z.cloneElement(O,xt)})]}))})}),_D=bte,wte=Bn("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),EM=wte,Ete=["addEndListener","appear","children","container","direction","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function Tte(t,e,n){const r=e.getBoundingClientRect(),i=n&&n.getBoundingClientRect(),a=fl(e);let h;if(e.fakeTransform)h=e.fakeTransform;else{const _=a.getComputedStyle(e);h=_.getPropertyValue("-webkit-transform")||_.getPropertyValue("transform")}let l=0,m=0;if(h&&h!=="none"&&typeof h=="string"){const _=h.split("(")[1].split(")")[0].split(",");l=parseInt(_[4],10),m=parseInt(_[5],10)}return t==="left"?i?`translateX(${i.right+l-r.left}px)`:`translateX(${a.innerWidth+l-r.left}px)`:t==="right"?i?`translateX(-${r.right-i.left-l}px)`:`translateX(-${r.left+r.width-l}px)`:t==="up"?i?`translateY(${i.bottom+m-r.top}px)`:`translateY(${a.innerHeight+m-r.top}px)`:i?`translateY(-${r.top-i.top+r.height-m}px)`:`translateY(-${r.top+r.height-m}px)`}function Ste(t){return typeof t=="function"?t():t}function Ly(t,e,n){const r=Ste(n),i=Tte(t,e,r);i&&(e.style.webkitTransform=i,e.style.transform=i)}const Pte=Z.forwardRef(function(e,n){const r=Ec(),i={enter:r.transitions.easing.easeOut,exit:r.transitions.easing.sharp},a={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},{addEndListener:h,appear:l=!0,children:m,container:_,direction:E="down",easing:S=i,in:I,onEnter:L,onEntered:O,onEntering:D,onExit:H,onExited:z,onExiting:N,style:F,timeout:$=a,TransitionComponent:Q=XE}=e,te=nn(e,Ete),re=Z.useRef(null),we=Yr(m.ref,re,n),Ee=Me=>qe=>{Me&&(qe===void 0?Me(re.current):Me(re.current,qe))},de=Ee((Me,qe)=>{Ly(E,Me,_),JE(Me),L&&L(Me,qe)}),Le=Ee((Me,qe)=>{const ut=Td({timeout:$,style:F,easing:S},{mode:"enter"});Me.style.webkitTransition=r.transitions.create("-webkit-transform",se({},ut)),Me.style.transition=r.transitions.create("transform",se({},ut)),Me.style.webkitTransform="none",Me.style.transform="none",D&&D(Me,qe)}),Ge=Ee(O),Be=Ee(N),Oe=Ee(Me=>{const qe=Td({timeout:$,style:F,easing:S},{mode:"exit"});Me.style.webkitTransition=r.transitions.create("-webkit-transform",qe),Me.style.transition=r.transitions.create("transform",qe),Ly(E,Me,_),H&&H(Me)}),Ke=Ee(Me=>{Me.style.webkitTransition="",Me.style.transition="",z&&z(Me)}),je=Me=>{h&&h(re.current,Me)},it=Z.useCallback(()=>{re.current&&Ly(E,re.current,_)},[E,_]);return Z.useEffect(()=>{if(I||E==="down"||E==="right")return;const Me=PE(()=>{re.current&&Ly(E,re.current,_)}),qe=fl(re.current);return qe.addEventListener("resize",Me),()=>{Me.clear(),qe.removeEventListener("resize",Me)}},[E,I,_]),Z.useEffect(()=>{I||it()},[I,it]),ve.jsx(Q,se({nodeRef:re,onEnter:de,onEntered:Ge,onEntering:Le,onExit:Oe,onExited:Ke,onExiting:Be,addEndListener:je,appear:l,in:I,timeout:$},te,{children:(Me,qe)=>Z.cloneElement(m,se({ref:we,style:se({visibility:Me==="exited"&&!I?"hidden":void 0},F,m.props.style)},qe))}))}),Cte=Pte;function Ate(t){return $n("MuiDrawer",t)}Bn("MuiDrawer",["root","docked","paper","paperAnchorLeft","paperAnchorRight","paperAnchorTop","paperAnchorBottom","paperAnchorDockedLeft","paperAnchorDockedRight","paperAnchorDockedTop","paperAnchorDockedBottom","modal"]);const Ite=["BackdropProps"],Mte=["anchor","BackdropProps","children","className","elevation","hideBackdrop","ModalProps","onClose","open","PaperProps","SlideProps","TransitionComponent","transitionDuration","variant"],vD=(t,e)=>{const{ownerState:n}=t;return[e.root,(n.variant==="permanent"||n.variant==="persistent")&&e.docked,e.modal]},kte=t=>{const{classes:e,anchor:n,variant:r}=t,i={root:["root"],docked:[(r==="permanent"||r==="persistent")&&"docked"],modal:["modal"],paper:["paper",`paperAnchor${Yt(n)}`,r!=="temporary"&&`paperAnchorDocked${Yt(n)}`]};return qn(i,Ate,e)},Lte=At(_D,{name:"MuiDrawer",slot:"Root",overridesResolver:vD})(({theme:t})=>({zIndex:(t.vars||t).zIndex.drawer})),TM=At("div",{shouldForwardProp:la,name:"MuiDrawer",slot:"Docked",skipVariantsResolver:!1,overridesResolver:vD})({flex:"0 0 auto"}),Rte=At(yv,{name:"MuiDrawer",slot:"Paper",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.paper,e[`paperAnchor${Yt(n.anchor)}`],n.variant!=="temporary"&&e[`paperAnchorDocked${Yt(n.anchor)}`]]}})(({theme:t,ownerState:e})=>se({overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:(t.vars||t).zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:0},e.anchor==="left"&&{left:0},e.anchor==="top"&&{top:0,left:0,right:0,height:"auto",maxHeight:"100%"},e.anchor==="right"&&{right:0},e.anchor==="bottom"&&{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"},e.anchor==="left"&&e.variant!=="temporary"&&{borderRight:`1px solid ${(t.vars||t).palette.divider}`},e.anchor==="top"&&e.variant!=="temporary"&&{borderBottom:`1px solid ${(t.vars||t).palette.divider}`},e.anchor==="right"&&e.variant!=="temporary"&&{borderLeft:`1px solid ${(t.vars||t).palette.divider}`},e.anchor==="bottom"&&e.variant!=="temporary"&&{borderTop:`1px solid ${(t.vars||t).palette.divider}`})),xD={left:"right",right:"left",top:"down",bottom:"up"};function Ote(t){return["left","right"].indexOf(t)!==-1}function Dte(t,e){return t.direction==="rtl"&&Ote(e)?xD[e]:e}const zte=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiDrawer"}),i=Ec(),a={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{anchor:h="left",BackdropProps:l,children:m,className:_,elevation:E=16,hideBackdrop:S=!1,ModalProps:{BackdropProps:I}={},onClose:L,open:O=!1,PaperProps:D={},SlideProps:H,TransitionComponent:z=Cte,transitionDuration:N=a,variant:F="temporary"}=r,$=nn(r.ModalProps,Ite),Q=nn(r,Mte),te=Z.useRef(!1);Z.useEffect(()=>{te.current=!0},[]);const re=Dte(i,h),Ee=se({},r,{anchor:h,elevation:E,open:O,variant:F},Q),de=kte(Ee),Le=ve.jsx(Rte,se({elevation:F==="temporary"?E:0,square:!0},D,{className:fn(de.paper,D.className),ownerState:Ee,children:m}));if(F==="permanent")return ve.jsx(TM,se({className:fn(de.root,de.docked,_),ownerState:Ee,ref:n},Q,{children:Le}));const Ge=ve.jsx(z,se({in:O,direction:xD[re],timeout:N,appear:te.current},H,{children:Le}));return F==="persistent"?ve.jsx(TM,se({className:fn(de.root,de.docked,_),ownerState:Ee,ref:n},Q,{children:Ge})):ve.jsx(Lte,se({BackdropProps:se({},l,I,{transitionDuration:N}),className:fn(de.root,de.modal,_),open:O,ownerState:Ee,onClose:L,hideBackdrop:S,ref:n},Q,$,{children:Ge}))}),Fte=zte,Nte=["disableUnderline","components","componentsProps","fullWidth","hiddenLabel","inputComponent","multiline","slotProps","slots","type"],Bte=t=>{const{classes:e,disableUnderline:n}=t,i=qn({root:["root",!n&&"underline"],input:["input"]},Mee,e);return se({},e,i)},Ute=At(Ev,{shouldForwardProp:t=>la(t)||t==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[...bv(t,e),!n.disableUnderline&&e.underline]}})(({theme:t,ownerState:e})=>{var n;const r=t.palette.mode==="light",i=r?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",a=r?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",h=r?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",l=r?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return se({position:"relative",backgroundColor:t.vars?t.vars.palette.FilledInput.bg:a,borderTopLeftRadius:(t.vars||t).shape.borderRadius,borderTopRightRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),"&:hover":{backgroundColor:t.vars?t.vars.palette.FilledInput.hoverBg:h,"@media (hover: none)":{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:a}},[`&.${Yc.focused}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:a},[`&.${Yc.disabled}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.disabledBg:l}},!e.disableUnderline&&{"&:after":{borderBottom:`2px solid ${(n=(t.vars||t).palette[e.color||"primary"])==null?void 0:n.main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Yc.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Yc.error}`]:{"&:before, &:after":{borderBottomColor:(t.vars||t).palette.error.main}},"&:before":{borderBottom:`1px solid ${t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / ${t.vars.opacity.inputUnderline})`:i}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Yc.disabled}, .${Yc.error}):before`]:{borderBottom:`1px solid ${(t.vars||t).palette.text.primary}`},[`&.${Yc.disabled}:before`]:{borderBottomStyle:"dotted"}},e.startAdornment&&{paddingLeft:12},e.endAdornment&&{paddingRight:12},e.multiline&&se({padding:"25px 12px 8px"},e.size==="small"&&{paddingTop:21,paddingBottom:4},e.hiddenLabel&&{paddingTop:16,paddingBottom:17}))}),Vte=At(Tv,{name:"MuiFilledInput",slot:"Input",overridesResolver:wv})(({theme:t,ownerState:e})=>se({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12},!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:t.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:t.palette.mode==="light"?null:"#fff",caretColor:t.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},t.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},e.size==="small"&&{paddingTop:21,paddingBottom:4},e.hiddenLabel&&{paddingTop:16,paddingBottom:17},e.multiline&&{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0},e.startAdornment&&{paddingLeft:0},e.endAdornment&&{paddingRight:0},e.hiddenLabel&&e.size==="small"&&{paddingTop:8,paddingBottom:9})),bD=Z.forwardRef(function(e,n){var r,i,a,h;const l=Gn({props:e,name:"MuiFilledInput"}),{components:m={},componentsProps:_,fullWidth:E=!1,inputComponent:S="input",multiline:I=!1,slotProps:L,slots:O={},type:D="text"}=l,H=nn(l,Nte),z=se({},l,{fullWidth:E,inputComponent:S,multiline:I,type:D}),N=Bte(l),F={root:{ownerState:z},input:{ownerState:z}},$=L??_?zs(L??_,F):F,Q=(r=(i=O.root)!=null?i:m.Root)!=null?r:Ute,te=(a=(h=O.input)!=null?h:m.Input)!=null?a:Vte;return ve.jsx(aT,se({slots:{root:Q,input:te},componentsProps:$,fullWidth:E,inputComponent:S,multiline:I,ref:n,type:D},H,{classes:N}))});bD.muiName="Input";const wD=bD;function jte(t){return $n("MuiFormControl",t)}Bn("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const $te=["children","className","color","component","disabled","error","focused","fullWidth","hiddenLabel","margin","required","size","variant"],Gte=t=>{const{classes:e,margin:n,fullWidth:r}=t,i={root:["root",n!=="none"&&`margin${Yt(n)}`,r&&"fullWidth"]};return qn(i,jte,e)},Hte=At("div",{name:"MuiFormControl",slot:"Root",overridesResolver:({ownerState:t},e)=>se({},e.root,e[`margin${Yt(t.margin)}`],t.fullWidth&&e.fullWidth)})(({ownerState:t})=>se({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},t.margin==="normal"&&{marginTop:16,marginBottom:8},t.margin==="dense"&&{marginTop:8,marginBottom:4},t.fullWidth&&{width:"100%"})),Wte=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiFormControl"}),{children:i,className:a,color:h="primary",component:l="div",disabled:m=!1,error:_=!1,focused:E,fullWidth:S=!1,hiddenLabel:I=!1,margin:L="none",required:O=!1,size:D="medium",variant:H="outlined"}=r,z=nn(r,$te),N=se({},r,{color:h,component:l,disabled:m,error:_,fullWidth:S,hiddenLabel:I,margin:L,required:O,size:D,variant:H}),F=Gte(N),[$,Q]=Z.useState(()=>{let Be=!1;return i&&Z.Children.forEach(i,Oe=>{if(!Fx(Oe,["Input","Select"]))return;const Ke=Fx(Oe,["Select"])?Oe.props.input:Oe;Ke&&vee(Ke.props)&&(Be=!0)}),Be}),[te,re]=Z.useState(()=>{let Be=!1;return i&&Z.Children.forEach(i,Oe=>{Fx(Oe,["Input","Select"])&&(s_(Oe.props,!0)||s_(Oe.props.inputProps,!0))&&(Be=!0)}),Be}),[we,Ee]=Z.useState(!1);m&&we&&Ee(!1);const de=E!==void 0&&!m?E:we;let Le;const Ge=Z.useMemo(()=>({adornedStart:$,setAdornedStart:Q,color:h,disabled:m,error:_,filled:te,focused:de,fullWidth:S,hiddenLabel:I,size:D,onBlur:()=>{Ee(!1)},onEmpty:()=>{re(!1)},onFilled:()=>{re(!0)},onFocus:()=>{Ee(!0)},registerEffect:Le,required:O,variant:H}),[$,h,m,_,te,de,S,I,Le,O,D,H]);return ve.jsx(xv.Provider,{value:Ge,children:ve.jsx(Hte,se({as:l,ownerState:N,className:fn(F.root,a),ref:n},z,{children:i}))})}),ED=Wte;function qte(t){return $n("MuiFormHelperText",t)}const Zte=Bn("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]),SM=Zte;var PM;const Xte=["children","className","component","disabled","error","filled","focused","margin","required","variant"],Yte=t=>{const{classes:e,contained:n,size:r,disabled:i,error:a,filled:h,focused:l,required:m}=t,_={root:["root",i&&"disabled",a&&"error",r&&`size${Yt(r)}`,n&&"contained",l&&"focused",h&&"filled",m&&"required"]};return qn(_,qte,e)},Kte=At("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.size&&e[`size${Yt(n.size)}`],n.contained&&e.contained,n.filled&&e.filled]}})(({theme:t,ownerState:e})=>se({color:(t.vars||t).palette.text.secondary},t.typography.caption,{textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${SM.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${SM.error}`]:{color:(t.vars||t).palette.error.main}},e.size==="small"&&{marginTop:4},e.contained&&{marginLeft:14,marginRight:14})),Jte=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiFormHelperText"}),{children:i,className:a,component:h="p"}=r,l=nn(r,Xte),m=ku(),_=zd({props:r,muiFormControl:m,states:["variant","size","disabled","error","filled","focused","required"]}),E=se({},r,{component:h,contained:_.variant==="filled"||_.variant==="outlined",variant:_.variant,size:_.size,disabled:_.disabled,error:_.error,filled:_.filled,focused:_.focused,required:_.required}),S=Yte(E);return ve.jsx(Kte,se({as:h,ownerState:E,className:fn(S.root,a),ref:n},l,{children:i===" "?PM||(PM=ve.jsx("span",{className:"notranslate",children:"​"})):i}))}),Qte=Jte;function ene(t){return $n("MuiFormLabel",t)}const tne=Bn("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),Op=tne,nne=["children","className","color","component","disabled","error","filled","focused","required"],rne=t=>{const{classes:e,color:n,focused:r,disabled:i,error:a,filled:h,required:l}=t,m={root:["root",`color${Yt(n)}`,i&&"disabled",a&&"error",h&&"filled",r&&"focused",l&&"required"],asterisk:["asterisk",a&&"error"]};return qn(m,ene,e)},ine=At("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:({ownerState:t},e)=>se({},e.root,t.color==="secondary"&&e.colorSecondary,t.filled&&e.filled)})(({theme:t,ownerState:e})=>se({color:(t.vars||t).palette.text.secondary},t.typography.body1,{lineHeight:"1.4375em",padding:0,position:"relative",[`&.${Op.focused}`]:{color:(t.vars||t).palette[e.color].main},[`&.${Op.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${Op.error}`]:{color:(t.vars||t).palette.error.main}})),sne=At("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(t,e)=>e.asterisk})(({theme:t})=>({[`&.${Op.error}`]:{color:(t.vars||t).palette.error.main}})),one=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiFormLabel"}),{children:i,className:a,component:h="label"}=r,l=nn(r,nne),m=ku(),_=zd({props:r,muiFormControl:m,states:["color","required","focused","disabled","error","filled"]}),E=se({},r,{color:_.color||"primary",component:h,disabled:_.disabled,error:_.error,filled:_.filled,focused:_.focused,required:_.required}),S=rne(E);return ve.jsxs(ine,se({as:h,ownerState:E,className:fn(S.root,a),ref:n},l,{children:[i,_.required&&ve.jsxs(sne,{ownerState:E,"aria-hidden":!0,className:S.asterisk,children:[" ","*"]})]}))}),ane=one,lne=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function Vw(t){return`scale(${t}, ${t**2})`}const cne={entering:{opacity:1,transform:Vw(1)},entered:{opacity:1,transform:"none"}},Gx=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),TD=Z.forwardRef(function(e,n){const{addEndListener:r,appear:i=!0,children:a,easing:h,in:l,onEnter:m,onEntered:_,onEntering:E,onExit:S,onExited:I,onExiting:L,style:O,timeout:D="auto",TransitionComponent:H=XE}=e,z=nn(e,lne),N=Z.useRef(),F=Z.useRef(),$=Ec(),Q=Z.useRef(null),te=Yr(Q,a.ref,n),re=Ke=>je=>{if(Ke){const it=Q.current;je===void 0?Ke(it):Ke(it,je)}},we=re(E),Ee=re((Ke,je)=>{JE(Ke);const{duration:it,delay:Me,easing:qe}=Td({style:O,timeout:D,easing:h},{mode:"enter"});let ut;D==="auto"?(ut=$.transitions.getAutoHeightDuration(Ke.clientHeight),F.current=ut):ut=it,Ke.style.transition=[$.transitions.create("opacity",{duration:ut,delay:Me}),$.transitions.create("transform",{duration:Gx?ut:ut*.666,delay:Me,easing:qe})].join(","),m&&m(Ke,je)}),de=re(_),Le=re(L),Ge=re(Ke=>{const{duration:je,delay:it,easing:Me}=Td({style:O,timeout:D,easing:h},{mode:"exit"});let qe;D==="auto"?(qe=$.transitions.getAutoHeightDuration(Ke.clientHeight),F.current=qe):qe=je,Ke.style.transition=[$.transitions.create("opacity",{duration:qe,delay:it}),$.transitions.create("transform",{duration:Gx?qe:qe*.666,delay:Gx?it:it||qe*.333,easing:Me})].join(","),Ke.style.opacity=0,Ke.style.transform=Vw(.75),S&&S(Ke)}),Be=re(I),Oe=Ke=>{D==="auto"&&(N.current=setTimeout(Ke,F.current||0)),r&&r(Q.current,Ke)};return Z.useEffect(()=>()=>{clearTimeout(N.current)},[]),ve.jsx(H,se({appear:i,in:l,nodeRef:Q,onEnter:Ee,onEntered:de,onEntering:we,onExit:Ge,onExited:Be,onExiting:Le,addEndListener:Oe,timeout:D==="auto"?null:D},z,{children:(Ke,je)=>Z.cloneElement(a,se({style:se({opacity:0,transform:Vw(.75),visibility:Ke==="exited"&&!l?"hidden":void 0},cne[Ke],O,a.props.style),ref:te},je))}))});TD.muiSupportAuto=!0;const o_=TD,une=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","slotProps","slots","type"],hne=t=>{const{classes:e,disableUnderline:n}=t,i=qn({root:["root",!n&&"underline"],input:["input"]},Pee,e);return se({},e,i)},dne=At(Ev,{shouldForwardProp:t=>la(t)||t==="classes",name:"MuiInput",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[...bv(t,e),!n.disableUnderline&&e.underline]}})(({theme:t,ownerState:e})=>{let r=t.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return t.vars&&(r=`rgba(${t.vars.palette.common.onBackgroundChannel} / ${t.vars.opacity.inputUnderline})`),se({position:"relative"},e.formControl&&{"label + &":{marginTop:16}},!e.disableUnderline&&{"&:after":{borderBottom:`2px solid ${(t.vars||t).palette[e.color].main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${rp.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${rp.error}`]:{"&:before, &:after":{borderBottomColor:(t.vars||t).palette.error.main}},"&:before":{borderBottom:`1px solid ${r}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${rp.disabled}, .${rp.error}):before`]:{borderBottom:`2px solid ${(t.vars||t).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${r}`}},[`&.${rp.disabled}:before`]:{borderBottomStyle:"dotted"}})}),fne=At(Tv,{name:"MuiInput",slot:"Input",overridesResolver:wv})({}),SD=Z.forwardRef(function(e,n){var r,i,a,h;const l=Gn({props:e,name:"MuiInput"}),{disableUnderline:m,components:_={},componentsProps:E,fullWidth:S=!1,inputComponent:I="input",multiline:L=!1,slotProps:O,slots:D={},type:H="text"}=l,z=nn(l,une),N=hne(l),$={root:{ownerState:{disableUnderline:m}}},Q=O??E?zs(O??E,$):$,te=(r=(i=D.root)!=null?i:_.Root)!=null?r:dne,re=(a=(h=D.input)!=null?h:_.Input)!=null?a:fne;return ve.jsx(aT,se({slots:{root:te,input:re},slotProps:Q,fullWidth:S,inputComponent:I,multiline:L,ref:n,type:H},z,{classes:N}))});SD.muiName="Input";const PD=SD;function pne(t){return $n("MuiInputAdornment",t)}const mne=Bn("MuiInputAdornment",["root","filled","standard","outlined","positionStart","positionEnd","disablePointerEvents","hiddenLabel","sizeSmall"]),CM=mne;var AM;const gne=["children","className","component","disablePointerEvents","disableTypography","position","variant"],yne=(t,e)=>{const{ownerState:n}=t;return[e.root,e[`position${Yt(n.position)}`],n.disablePointerEvents===!0&&e.disablePointerEvents,e[n.variant]]},_ne=t=>{const{classes:e,disablePointerEvents:n,hiddenLabel:r,position:i,size:a,variant:h}=t,l={root:["root",n&&"disablePointerEvents",i&&`position${Yt(i)}`,h,r&&"hiddenLabel",a&&`size${Yt(a)}`]};return qn(l,pne,e)},vne=At("div",{name:"MuiInputAdornment",slot:"Root",overridesResolver:yne})(({theme:t,ownerState:e})=>se({display:"flex",height:"0.01em",maxHeight:"2em",alignItems:"center",whiteSpace:"nowrap",color:(t.vars||t).palette.action.active},e.variant==="filled"&&{[`&.${CM.positionStart}&:not(.${CM.hiddenLabel})`]:{marginTop:16}},e.position==="start"&&{marginRight:8},e.position==="end"&&{marginLeft:8},e.disablePointerEvents===!0&&{pointerEvents:"none"})),xne=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiInputAdornment"}),{children:i,className:a,component:h="div",disablePointerEvents:l=!1,disableTypography:m=!1,position:_,variant:E}=r,S=nn(r,gne),I=ku()||{};let L=E;E&&I.variant,I&&!L&&(L=I.variant);const O=se({},r,{hiddenLabel:I.hiddenLabel,size:I.size,disablePointerEvents:l,position:_,variant:L}),D=_ne(O);return ve.jsx(xv.Provider,{value:null,children:ve.jsx(vne,se({as:h,ownerState:O,className:fn(D.root,a),ref:n},S,{children:typeof i=="string"&&!m?ve.jsx(c0,{color:"text.secondary",children:i}):ve.jsxs(Z.Fragment,{children:[_==="start"?AM||(AM=ve.jsx("span",{className:"notranslate",children:"​"})):null,i]})}))})}),bne=xne;function wne(t){return $n("MuiInputLabel",t)}Bn("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const Ene=["disableAnimation","margin","shrink","variant","className"],Tne=t=>{const{classes:e,formControl:n,size:r,shrink:i,disableAnimation:a,variant:h,required:l}=t,m={root:["root",n&&"formControl",!a&&"animated",i&&"shrink",r&&r!=="normal"&&`size${Yt(r)}`,h],asterisk:[l&&"asterisk"]},_=qn(m,wne,e);return se({},e,_)},Sne=At(ane,{shouldForwardProp:t=>la(t)||t==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[{[`& .${Op.asterisk}`]:e.asterisk},e.root,n.formControl&&e.formControl,n.size==="small"&&e.sizeSmall,n.shrink&&e.shrink,!n.disableAnimation&&e.animated,e[n.variant]]}})(({theme:t,ownerState:e})=>se({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},e.formControl&&{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"},e.size==="small"&&{transform:"translate(0, 17px) scale(1)"},e.shrink&&{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"},!e.disableAnimation&&{transition:t.transitions.create(["color","transform","max-width"],{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut})},e.variant==="filled"&&se({zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},e.size==="small"&&{transform:"translate(12px, 13px) scale(1)"},e.shrink&&se({userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"},e.size==="small"&&{transform:"translate(12px, 4px) scale(0.75)"})),e.variant==="outlined"&&se({zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},e.size==="small"&&{transform:"translate(14px, 9px) scale(1)"},e.shrink&&{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}))),Pne=Z.forwardRef(function(e,n){const r=Gn({name:"MuiInputLabel",props:e}),{disableAnimation:i=!1,shrink:a,className:h}=r,l=nn(r,Ene),m=ku();let _=a;typeof _>"u"&&m&&(_=m.filled||m.focused||m.adornedStart);const E=zd({props:r,muiFormControl:m,states:["size","variant","required"]}),S=se({},r,{disableAnimation:i,formControl:m,shrink:_,size:E.size,variant:E.variant,required:E.required}),I=Tne(S);return ve.jsx(Sne,se({"data-shrink":_,ownerState:S,ref:n,className:fn(I.root,h)},l,{classes:I}))}),CD=Pne,Cne=Z.createContext({}),jw=Cne;function Ane(t){return $n("MuiList",t)}Bn("MuiList",["root","padding","dense","subheader"]);const Ine=["children","className","component","dense","disablePadding","subheader"],Mne=t=>{const{classes:e,disablePadding:n,dense:r,subheader:i}=t;return qn({root:["root",!n&&"padding",r&&"dense",i&&"subheader"]},Ane,e)},kne=At("ul",{name:"MuiList",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,!n.disablePadding&&e.padding,n.dense&&e.dense,n.subheader&&e.subheader]}})(({ownerState:t})=>se({listStyle:"none",margin:0,padding:0,position:"relative"},!t.disablePadding&&{paddingTop:8,paddingBottom:8},t.subheader&&{paddingTop:0})),Lne=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiList"}),{children:i,className:a,component:h="ul",dense:l=!1,disablePadding:m=!1,subheader:_}=r,E=nn(r,Ine),S=Z.useMemo(()=>({dense:l}),[l]),I=se({},r,{component:h,dense:l,disablePadding:m}),L=Mne(I);return ve.jsx(jw.Provider,{value:S,children:ve.jsxs(kne,se({as:h,className:fn(L.root,a),ref:n,ownerState:I},E,{children:[_,i]}))})}),Rne=Lne,One=Bn("MuiListItemIcon",["root","alignItemsFlexStart"]),IM=One,Dne=Bn("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]),MM=Dne,zne=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function Hx(t,e,n){return t===e?t.firstChild:e&&e.nextElementSibling?e.nextElementSibling:n?null:t.firstChild}function kM(t,e,n){return t===e?n?t.firstChild:t.lastChild:e&&e.previousElementSibling?e.previousElementSibling:n?null:t.lastChild}function AD(t,e){if(e===void 0)return!0;let n=t.innerText;return n===void 0&&(n=t.textContent),n=n.trim().toLowerCase(),n.length===0?!1:e.repeating?n[0]===e.keys[0]:n.indexOf(e.keys.join(""))===0}function ip(t,e,n,r,i,a){let h=!1,l=i(t,e,e?n:!1);for(;l;){if(l===t.firstChild){if(h)return!1;h=!0}const m=r?!1:l.disabled||l.getAttribute("aria-disabled")==="true";if(!l.hasAttribute("tabindex")||!AD(l,a)||m)l=i(t,l,n);else return l.focus(),!0}return!1}const Fne=Z.forwardRef(function(e,n){const{actions:r,autoFocus:i=!1,autoFocusItem:a=!1,children:h,className:l,disabledItemsFocusable:m=!1,disableListWrap:_=!1,onKeyDown:E,variant:S="selectedMenu"}=e,I=nn(e,zne),L=Z.useRef(null),O=Z.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});aa(()=>{i&&L.current.focus()},[i]),Z.useImperativeHandle(r,()=>({adjustStyleForScrollbar:(F,$)=>{const Q=!L.current.style.width;if(F.clientHeight<L.current.clientHeight&&Q){const te=`${SO(Xr(F))}px`;L.current.style[$.direction==="rtl"?"paddingLeft":"paddingRight"]=te,L.current.style.width=`calc(100% + ${te})`}return L.current}}),[]);const D=F=>{const $=L.current,Q=F.key,te=Xr($).activeElement;if(Q==="ArrowDown")F.preventDefault(),ip($,te,_,m,Hx);else if(Q==="ArrowUp")F.preventDefault(),ip($,te,_,m,kM);else if(Q==="Home")F.preventDefault(),ip($,null,_,m,Hx);else if(Q==="End")F.preventDefault(),ip($,null,_,m,kM);else if(Q.length===1){const re=O.current,we=Q.toLowerCase(),Ee=performance.now();re.keys.length>0&&(Ee-re.lastTime>500?(re.keys=[],re.repeating=!0,re.previousKeyMatched=!0):re.repeating&&we!==re.keys[0]&&(re.repeating=!1)),re.lastTime=Ee,re.keys.push(we);const de=te&&!re.repeating&&AD(te,re);re.previousKeyMatched&&(de||ip($,te,!1,m,Hx,re))?F.preventDefault():re.previousKeyMatched=!1}E&&E(F)},H=Yr(L,n);let z=-1;Z.Children.forEach(h,(F,$)=>{if(!Z.isValidElement(F)){z===$&&(z+=1,z>=h.length&&(z=-1));return}F.props.disabled||(S==="selectedMenu"&&F.props.selected||z===-1)&&(z=$),z===$&&(F.props.disabled||F.props.muiSkipListHighlight||F.type.muiSkipListHighlight)&&(z+=1,z>=h.length&&(z=-1))});const N=Z.Children.map(h,(F,$)=>{if($===z){const Q={};return a&&(Q.autoFocus=!0),F.props.tabIndex===void 0&&S==="selectedMenu"&&(Q.tabIndex=0),Z.cloneElement(F,Q)}return F});return ve.jsx(Rne,se({role:"menu",ref:H,className:l,onKeyDown:D,tabIndex:i?0:-1},I,{children:N}))}),Nne=Fne;function Bne(t){return $n("MuiPopover",t)}Bn("MuiPopover",["root","paper"]);const Une=["onEntering"],Vne=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","slots","slotProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps","disableScrollLock"],jne=["slotProps"];function LM(t,e){let n=0;return typeof e=="number"?n=e:e==="center"?n=t.height/2:e==="bottom"&&(n=t.height),n}function RM(t,e){let n=0;return typeof e=="number"?n=e:e==="center"?n=t.width/2:e==="right"&&(n=t.width),n}function OM(t){return[t.horizontal,t.vertical].map(e=>typeof e=="number"?`${e}px`:e).join(" ")}function Wx(t){return typeof t=="function"?t():t}const $ne=t=>{const{classes:e}=t;return qn({root:["root"],paper:["paper"]},Bne,e)},Gne=At(_D,{name:"MuiPopover",slot:"Root",overridesResolver:(t,e)=>e.root})({}),ID=At(yv,{name:"MuiPopover",slot:"Paper",overridesResolver:(t,e)=>e.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),Hne=Z.forwardRef(function(e,n){var r,i,a;const h=Gn({props:e,name:"MuiPopover"}),{action:l,anchorEl:m,anchorOrigin:_={vertical:"top",horizontal:"left"},anchorPosition:E,anchorReference:S="anchorEl",children:I,className:L,container:O,elevation:D=8,marginThreshold:H=16,open:z,PaperProps:N={},slots:F,slotProps:$,transformOrigin:Q={vertical:"top",horizontal:"left"},TransitionComponent:te=o_,transitionDuration:re="auto",TransitionProps:{onEntering:we}={},disableScrollLock:Ee=!1}=h,de=nn(h.TransitionProps,Une),Le=nn(h,Vne),Ge=(r=$==null?void 0:$.paper)!=null?r:N,Be=Z.useRef(),Oe=Yr(Be,Ge.ref),Ke=se({},h,{anchorOrigin:_,anchorReference:S,elevation:D,marginThreshold:H,externalPaperSlotProps:Ge,transformOrigin:Q,TransitionComponent:te,transitionDuration:re,TransitionProps:de}),je=$ne(Ke),it=Z.useCallback(()=>{if(S==="anchorPosition")return E;const Wt=Wx(m),Dt=(Wt&&Wt.nodeType===1?Wt:Xr(Be.current).body).getBoundingClientRect();return{top:Dt.top+LM(Dt,_.vertical),left:Dt.left+RM(Dt,_.horizontal)}},[m,_.horizontal,_.vertical,E,S]),Me=Z.useCallback(Wt=>({vertical:LM(Wt,Q.vertical),horizontal:RM(Wt,Q.horizontal)}),[Q.horizontal,Q.vertical]),qe=Z.useCallback(Wt=>{const Ot={width:Wt.offsetWidth,height:Wt.offsetHeight},Dt=Me(Ot);if(S==="none")return{top:null,left:null,transformOrigin:OM(Dt)};const wn=it();let mn=wn.top-Dt.vertical,En=wn.left-Dt.horizontal;const zn=mn+Ot.height,Re=En+Ot.width,Bt=fl(Wx(m)),Rn=Bt.innerHeight-H,an=Bt.innerWidth-H;if(H!==null&&mn<H){const It=mn-H;mn-=It,Dt.vertical+=It}else if(H!==null&&zn>Rn){const It=zn-Rn;mn-=It,Dt.vertical+=It}if(H!==null&&En<H){const It=En-H;En-=It,Dt.horizontal+=It}else if(Re>an){const It=Re-an;En-=It,Dt.horizontal+=It}return{top:`${Math.round(mn)}px`,left:`${Math.round(En)}px`,transformOrigin:OM(Dt)}},[m,S,it,Me,H]),[ut,zt]=Z.useState(z),vt=Z.useCallback(()=>{const Wt=Be.current;if(!Wt)return;const Ot=qe(Wt);Ot.top!==null&&(Wt.style.top=Ot.top),Ot.left!==null&&(Wt.style.left=Ot.left),Wt.style.transformOrigin=Ot.transformOrigin,zt(!0)},[qe]);Z.useEffect(()=>(Ee&&window.addEventListener("scroll",vt),()=>window.removeEventListener("scroll",vt)),[m,Ee,vt]);const yt=(Wt,Ot)=>{we&&we(Wt,Ot),vt()},at=()=>{zt(!1)};Z.useEffect(()=>{z&&vt()}),Z.useImperativeHandle(l,()=>z?{updatePosition:()=>{vt()}}:null,[z,vt]),Z.useEffect(()=>{if(!z)return;const Wt=PE(()=>{vt()}),Ot=fl(m);return Ot.addEventListener("resize",Wt),()=>{Wt.clear(),Ot.removeEventListener("resize",Wt)}},[m,z,vt]);let bt=re;re==="auto"&&!te.muiSupportAuto&&(bt=void 0);const xt=O||(m?Xr(Wx(m)).body:void 0),$t=(i=F==null?void 0:F.root)!=null?i:Gne,Kt=(a=F==null?void 0:F.paper)!=null?a:ID,Ct=is({elementType:Kt,externalSlotProps:se({},Ge,{style:ut?Ge.style:se({},Ge.style,{opacity:0})}),additionalProps:{elevation:D,ref:Oe},ownerState:Ke,className:fn(je.paper,Ge==null?void 0:Ge.className)}),sn=is({elementType:$t,externalSlotProps:($==null?void 0:$.root)||{},externalForwardedProps:Le,additionalProps:{ref:n,slotProps:{backdrop:{invisible:!0}},container:xt,open:z},ownerState:Ke,className:fn(je.root,L)}),{slotProps:Qt}=sn,pn=nn(sn,jne);return ve.jsx($t,se({},pn,!mc($t)&&{slotProps:Qt,disableScrollLock:Ee},{children:ve.jsx(te,se({appear:!0,in:z,onEntering:yt,onExited:at,timeout:bt},de,{children:ve.jsx(Kt,se({},Ct,{children:I}))}))}))}),MD=Hne;function Wne(t){return $n("MuiMenu",t)}Bn("MuiMenu",["root","paper","list"]);const qne=["onEntering"],Zne=["autoFocus","children","className","disableAutoFocusItem","MenuListProps","onClose","open","PaperProps","PopoverClasses","transitionDuration","TransitionProps","variant","slots","slotProps"],Xne={vertical:"top",horizontal:"right"},Yne={vertical:"top",horizontal:"left"},Kne=t=>{const{classes:e}=t;return qn({root:["root"],paper:["paper"],list:["list"]},Wne,e)},Jne=At(MD,{shouldForwardProp:t=>la(t)||t==="classes",name:"MuiMenu",slot:"Root",overridesResolver:(t,e)=>e.root})({}),Qne=At(ID,{name:"MuiMenu",slot:"Paper",overridesResolver:(t,e)=>e.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),ere=At(Nne,{name:"MuiMenu",slot:"List",overridesResolver:(t,e)=>e.list})({outline:0}),tre=Z.forwardRef(function(e,n){var r,i;const a=Gn({props:e,name:"MuiMenu"}),{autoFocus:h=!0,children:l,className:m,disableAutoFocusItem:_=!1,MenuListProps:E={},onClose:S,open:I,PaperProps:L={},PopoverClasses:O,transitionDuration:D="auto",TransitionProps:{onEntering:H}={},variant:z="selectedMenu",slots:N={},slotProps:F={}}=a,$=nn(a.TransitionProps,qne),Q=nn(a,Zne),te=Ec(),re=te.direction==="rtl",we=se({},a,{autoFocus:h,disableAutoFocusItem:_,MenuListProps:E,onEntering:H,PaperProps:L,transitionDuration:D,TransitionProps:$,variant:z}),Ee=Kne(we),de=h&&!_&&I,Le=Z.useRef(null),Ge=(qe,ut)=>{Le.current&&Le.current.adjustStyleForScrollbar(qe,te),H&&H(qe,ut)},Be=qe=>{qe.key==="Tab"&&(qe.preventDefault(),S&&S(qe,"tabKeyDown"))};let Oe=-1;Z.Children.map(l,(qe,ut)=>{Z.isValidElement(qe)&&(qe.props.disabled||(z==="selectedMenu"&&qe.props.selected||Oe===-1)&&(Oe=ut))});const Ke=(r=N.paper)!=null?r:Qne,je=(i=F.paper)!=null?i:L,it=is({elementType:N.root,externalSlotProps:F.root,ownerState:we,className:[Ee.root,m]}),Me=is({elementType:Ke,externalSlotProps:je,ownerState:we,className:Ee.paper});return ve.jsx(Jne,se({onClose:S,anchorOrigin:{vertical:"bottom",horizontal:re?"right":"left"},transformOrigin:re?Xne:Yne,slots:{paper:Ke,root:N.root},slotProps:{root:it,paper:Me},open:I,ref:n,transitionDuration:D,TransitionProps:se({onEntering:Ge},$),ownerState:we},Q,{classes:O,children:ve.jsx(ere,se({onKeyDown:Be,actions:Le,autoFocus:h&&(Oe===-1||_),autoFocusItem:de,variant:z},E,{className:fn(Ee.list,E.className),children:l}))}))}),nre=tre;function rre(t){return $n("MuiMenuItem",t)}const ire=Bn("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),sp=ire,sre=["autoFocus","component","dense","divider","disableGutters","focusVisibleClassName","role","tabIndex","className"],ore=(t,e)=>{const{ownerState:n}=t;return[e.root,n.dense&&e.dense,n.divider&&e.divider,!n.disableGutters&&e.gutters]},are=t=>{const{disabled:e,dense:n,divider:r,disableGutters:i,selected:a,classes:h}=t,m=qn({root:["root",n&&"dense",e&&"disabled",!i&&"gutters",r&&"divider",a&&"selected"]},rre,h);return se({},h,m)},lre=At(QE,{shouldForwardProp:t=>la(t)||t==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:ore})(({theme:t,ownerState:e})=>se({},t.typography.body1,{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap"},!e.disableGutters&&{paddingLeft:16,paddingRight:16},e.divider&&{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"},{"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${sp.selected}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:Ai(t.palette.primary.main,t.palette.action.selectedOpacity),[`&.${sp.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:Ai(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},[`&.${sp.selected}:hover`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:Ai(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:Ai(t.palette.primary.main,t.palette.action.selectedOpacity)}},[`&.${sp.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${sp.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},[`& + .${EM.root}`]:{marginTop:t.spacing(1),marginBottom:t.spacing(1)},[`& + .${EM.inset}`]:{marginLeft:52},[`& .${MM.root}`]:{marginTop:0,marginBottom:0},[`& .${MM.inset}`]:{paddingLeft:36},[`& .${IM.root}`]:{minWidth:36}},!e.dense&&{[t.breakpoints.up("sm")]:{minHeight:"auto"}},e.dense&&se({minHeight:32,paddingTop:4,paddingBottom:4},t.typography.body2,{[`& .${IM.root} svg`]:{fontSize:"1.25rem"}}))),cre=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiMenuItem"}),{autoFocus:i=!1,component:a="li",dense:h=!1,divider:l=!1,disableGutters:m=!1,focusVisibleClassName:_,role:E="menuitem",tabIndex:S,className:I}=r,L=nn(r,sre),O=Z.useContext(jw),D=Z.useMemo(()=>({dense:h||O.dense||!1,disableGutters:m}),[O.dense,h,m]),H=Z.useRef(null);aa(()=>{i&&H.current&&H.current.focus()},[i]);const z=se({},r,{dense:D.dense,divider:l,disableGutters:m}),N=are(r),F=Yr(H,n);let $;return r.disabled||($=S!==void 0?S:-1),ve.jsx(jw.Provider,{value:D,children:ve.jsx(lre,se({ref:F,role:E,tabIndex:$,component:a,focusVisibleClassName:fn(N.focusVisible,_),className:fn(N.root,I)},L,{ownerState:z,classes:N}))})}),DM=cre;function ure(t){return $n("MuiNativeSelect",t)}const hre=Bn("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),lT=hre,dre=["className","disabled","error","IconComponent","inputRef","variant"],fre=t=>{const{classes:e,variant:n,disabled:r,multiple:i,open:a,error:h}=t,l={select:["select",n,r&&"disabled",i&&"multiple",h&&"error"],icon:["icon",`icon${Yt(n)}`,a&&"iconOpen",r&&"disabled"]};return qn(l,ure,e)},kD=({ownerState:t,theme:e})=>se({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":se({},e.vars?{backgroundColor:`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.05)`}:{backgroundColor:e.palette.mode==="light"?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)"},{borderRadius:0}),"&::-ms-expand":{display:"none"},[`&.${lT.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(e.vars||e).palette.background.paper},"&&&":{paddingRight:24,minWidth:16}},t.variant==="filled"&&{"&&&":{paddingRight:32}},t.variant==="outlined"&&{borderRadius:(e.vars||e).shape.borderRadius,"&:focus":{borderRadius:(e.vars||e).shape.borderRadius},"&&&":{paddingRight:32}}),pre=At("select",{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:la,overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.select,e[n.variant],n.error&&e.error,{[`&.${lT.multiple}`]:e.multiple}]}})(kD),LD=({ownerState:t,theme:e})=>se({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(e.vars||e).palette.action.active,[`&.${lT.disabled}`]:{color:(e.vars||e).palette.action.disabled}},t.open&&{transform:"rotate(180deg)"},t.variant==="filled"&&{right:7},t.variant==="outlined"&&{right:7}),mre=At("svg",{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.icon,n.variant&&e[`icon${Yt(n.variant)}`],n.open&&e.iconOpen]}})(LD),gre=Z.forwardRef(function(e,n){const{className:r,disabled:i,error:a,IconComponent:h,inputRef:l,variant:m="standard"}=e,_=nn(e,dre),E=se({},e,{disabled:i,variant:m,error:a}),S=fre(E);return ve.jsxs(Z.Fragment,{children:[ve.jsx(pre,se({ownerState:E,className:fn(S.select,r),disabled:i,ref:l||n},_)),e.multiple?null:ve.jsx(mre,{as:h,ownerState:E,className:S.icon})]})}),yre=gre;var zM;const _re=["children","classes","className","label","notched"],vre=At("fieldset")({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),xre=At("legend")(({ownerState:t,theme:e})=>se({float:"unset",width:"auto",overflow:"hidden"},!t.withLabel&&{padding:0,lineHeight:"11px",transition:e.transitions.create("width",{duration:150,easing:e.transitions.easing.easeOut})},t.withLabel&&se({display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:e.transitions.create("max-width",{duration:50,easing:e.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}},t.notched&&{maxWidth:"100%",transition:e.transitions.create("max-width",{duration:100,easing:e.transitions.easing.easeOut,delay:50})})));function bre(t){const{className:e,label:n,notched:r}=t,i=nn(t,_re),a=n!=null&&n!=="",h=se({},t,{notched:r,withLabel:a});return ve.jsx(vre,se({"aria-hidden":!0,className:e,ownerState:h},i,{children:ve.jsx(xre,{ownerState:h,children:a?ve.jsx("span",{children:n}):zM||(zM=ve.jsx("span",{className:"notranslate",children:"​"}))})}))}const wre=["components","fullWidth","inputComponent","label","multiline","notched","slots","type"],Ere=t=>{const{classes:e}=t,r=qn({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},Aee,e);return se({},e,r)},Tre=At(Ev,{shouldForwardProp:t=>la(t)||t==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:bv})(({theme:t,ownerState:e})=>{const n=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return se({position:"relative",borderRadius:(t.vars||t).shape.borderRadius,[`&:hover .${Wl.notchedOutline}`]:{borderColor:(t.vars||t).palette.text.primary},"@media (hover: none)":{[`&:hover .${Wl.notchedOutline}`]:{borderColor:t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:n}},[`&.${Wl.focused} .${Wl.notchedOutline}`]:{borderColor:(t.vars||t).palette[e.color].main,borderWidth:2},[`&.${Wl.error} .${Wl.notchedOutline}`]:{borderColor:(t.vars||t).palette.error.main},[`&.${Wl.disabled} .${Wl.notchedOutline}`]:{borderColor:(t.vars||t).palette.action.disabled}},e.startAdornment&&{paddingLeft:14},e.endAdornment&&{paddingRight:14},e.multiline&&se({padding:"16.5px 14px"},e.size==="small"&&{padding:"8.5px 14px"}))}),Sre=At(bre,{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(t,e)=>e.notchedOutline})(({theme:t})=>{const e=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:e}}),Pre=At(Tv,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:wv})(({theme:t,ownerState:e})=>se({padding:"16.5px 14px"},!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:t.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:t.palette.mode==="light"?null:"#fff",caretColor:t.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},t.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},e.size==="small"&&{padding:"8.5px 14px"},e.multiline&&{padding:0},e.startAdornment&&{paddingLeft:0},e.endAdornment&&{paddingRight:0})),RD=Z.forwardRef(function(e,n){var r,i,a,h,l;const m=Gn({props:e,name:"MuiOutlinedInput"}),{components:_={},fullWidth:E=!1,inputComponent:S="input",label:I,multiline:L=!1,notched:O,slots:D={},type:H="text"}=m,z=nn(m,wre),N=Ere(m),F=ku(),$=zd({props:m,muiFormControl:F,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),Q=se({},m,{color:$.color||"primary",disabled:$.disabled,error:$.error,focused:$.focused,formControl:F,fullWidth:E,hiddenLabel:$.hiddenLabel,multiline:L,size:$.size,type:H}),te=(r=(i=D.root)!=null?i:_.Root)!=null?r:Tre,re=(a=(h=D.input)!=null?h:_.Input)!=null?a:Pre;return ve.jsx(aT,se({slots:{root:te,input:re},renderSuffix:we=>ve.jsx(Sre,{ownerState:Q,className:N.notchedOutline,label:I!=null&&I!==""&&$.required?l||(l=ve.jsxs(Z.Fragment,{children:[I," ","*"]})):I,notched:typeof O<"u"?O:!!(we.startAdornment||we.filled||we.focused)}),fullWidth:E,inputComponent:S,multiline:L,ref:n,type:H},z,{classes:se({},N,{notchedOutline:null})}))});RD.muiName="Input";const OD=RD;function Cre(t){return $n("MuiSelect",t)}const Are=Bn("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),op=Are;var FM;const Ire=["aria-describedby","aria-label","autoFocus","autoWidth","children","className","defaultOpen","defaultValue","disabled","displayEmpty","error","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"],Mre=At("div",{name:"MuiSelect",slot:"Select",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[{[`&.${op.select}`]:e.select},{[`&.${op.select}`]:e[n.variant]},{[`&.${op.error}`]:e.error},{[`&.${op.multiple}`]:e.multiple}]}})(kD,{[`&.${op.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),kre=At("svg",{name:"MuiSelect",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.icon,n.variant&&e[`icon${Yt(n.variant)}`],n.open&&e.iconOpen]}})(LD),Lre=At("input",{shouldForwardProp:t=>WE(t)&&t!=="classes",name:"MuiSelect",slot:"NativeInput",overridesResolver:(t,e)=>e.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function NM(t,e){return typeof e=="object"&&e!==null?t===e:String(t)===String(e)}function Rre(t){return t==null||typeof t=="string"&&!t.trim()}const Ore=t=>{const{classes:e,variant:n,disabled:r,multiple:i,open:a,error:h}=t,l={select:["select",n,r&&"disabled",i&&"multiple",h&&"error"],icon:["icon",`icon${Yt(n)}`,a&&"iconOpen",r&&"disabled"],nativeInput:["nativeInput"]};return qn(l,Cre,e)},Dre=Z.forwardRef(function(e,n){var r;const{"aria-describedby":i,"aria-label":a,autoFocus:h,autoWidth:l,children:m,className:_,defaultOpen:E,defaultValue:S,disabled:I,displayEmpty:L,error:O=!1,IconComponent:D,inputRef:H,labelId:z,MenuProps:N={},multiple:F,name:$,onBlur:Q,onChange:te,onClose:re,onFocus:we,onOpen:Ee,open:de,readOnly:Le,renderValue:Ge,SelectDisplayProps:Be={},tabIndex:Oe,value:Ke,variant:je="standard"}=e,it=nn(e,Ire),[Me,qe]=K0({controlled:Ke,default:S,name:"Select"}),[ut,zt]=K0({controlled:de,default:E,name:"Select"}),vt=Z.useRef(null),yt=Z.useRef(null),[at,bt]=Z.useState(null),{current:xt}=Z.useRef(de!=null),[$t,Kt]=Z.useState(),Ct=Yr(n,H),sn=Z.useCallback(Ye=>{yt.current=Ye,Ye&&bt(Ye)},[]),Qt=at==null?void 0:at.parentNode;Z.useImperativeHandle(Ct,()=>({focus:()=>{yt.current.focus()},node:vt.current,value:Me}),[Me]),Z.useEffect(()=>{E&&ut&&at&&!xt&&(Kt(l?null:Qt.clientWidth),yt.current.focus())},[at,l]),Z.useEffect(()=>{h&&yt.current.focus()},[h]),Z.useEffect(()=>{if(!z)return;const Ye=Xr(yt.current).getElementById(z);if(Ye){const St=()=>{getSelection().isCollapsed&&yt.current.focus()};return Ye.addEventListener("click",St),()=>{Ye.removeEventListener("click",St)}}},[z]);const pn=(Ye,St)=>{Ye?Ee&&Ee(St):re&&re(St),xt||(Kt(l?null:Qt.clientWidth),zt(Ye))},Wt=Ye=>{Ye.button===0&&(Ye.preventDefault(),yt.current.focus(),pn(!0,Ye))},Ot=Ye=>{pn(!1,Ye)},Dt=Z.Children.toArray(m),wn=Ye=>{const St=Dt.find(gn=>gn.props.value===Ye.target.value);St!==void 0&&(qe(St.props.value),te&&te(Ye,St))},mn=Ye=>St=>{let gn;if(St.currentTarget.hasAttribute("tabindex")){if(F){gn=Array.isArray(Me)?Me.slice():[];const yn=Me.indexOf(Ye.props.value);yn===-1?gn.push(Ye.props.value):gn.splice(yn,1)}else gn=Ye.props.value;if(Ye.props.onClick&&Ye.props.onClick(St),Me!==gn&&(qe(gn),te)){const yn=St.nativeEvent||St,nt=new yn.constructor(yn.type,yn);Object.defineProperty(nt,"target",{writable:!0,value:{value:gn,name:$}}),te(nt,Ye)}F||pn(!1,St)}},En=Ye=>{Le||[" ","ArrowUp","ArrowDown","Enter"].indexOf(Ye.key)!==-1&&(Ye.preventDefault(),pn(!0,Ye))},zn=at!==null&&ut,Re=Ye=>{!zn&&Q&&(Object.defineProperty(Ye,"target",{writable:!0,value:{value:Me,name:$}}),Q(Ye))};delete it["aria-invalid"];let Bt,Rn;const an=[];let It=!1;(s_({value:Me})||L)&&(Ge?Bt=Ge(Me):It=!0);const st=Dt.map(Ye=>{if(!Z.isValidElement(Ye))return null;let St;if(F){if(!Array.isArray(Me))throw new Error(vc(2));St=Me.some(gn=>NM(gn,Ye.props.value)),St&&It&&an.push(Ye.props.children)}else St=NM(Me,Ye.props.value),St&&It&&(Rn=Ye.props.children);return Z.cloneElement(Ye,{"aria-selected":St?"true":"false",onClick:mn(Ye),onKeyUp:gn=>{gn.key===" "&&gn.preventDefault(),Ye.props.onKeyUp&&Ye.props.onKeyUp(gn)},role:"option",selected:St,value:void 0,"data-value":Ye.props.value})});It&&(F?an.length===0?Bt=null:Bt=an.reduce((Ye,St,gn)=>(Ye.push(St),gn<an.length-1&&Ye.push(", "),Ye),[]):Bt=Rn);let _t=$t;!l&&xt&&at&&(_t=Qt.clientWidth);let Fe;typeof Oe<"u"?Fe=Oe:Fe=I?null:0;const et=Be.id||($?`mui-component-select-${$}`:void 0),ot=se({},e,{variant:je,value:Me,open:zn,error:O}),Zt=Ore(ot),Mt=se({},N.PaperProps,(r=N.slotProps)==null?void 0:r.paper),Ne=CE();return ve.jsxs(Z.Fragment,{children:[ve.jsx(Mre,se({ref:sn,tabIndex:Fe,role:"combobox","aria-controls":Ne,"aria-disabled":I?"true":void 0,"aria-expanded":zn?"true":"false","aria-haspopup":"listbox","aria-label":a,"aria-labelledby":[z,et].filter(Boolean).join(" ")||void 0,"aria-describedby":i,onKeyDown:En,onMouseDown:I||Le?null:Wt,onBlur:Re,onFocus:we},Be,{ownerState:ot,className:fn(Be.className,Zt.select,_),id:et,children:Rre(Bt)?FM||(FM=ve.jsx("span",{className:"notranslate",children:"​"})):Bt})),ve.jsx(Lre,se({"aria-invalid":O,value:Array.isArray(Me)?Me.join(","):Me,name:$,ref:vt,"aria-hidden":!0,onChange:wn,tabIndex:-1,disabled:I,className:Zt.nativeInput,autoFocus:h,ownerState:ot},it)),ve.jsx(kre,{as:D,className:Zt.icon,ownerState:ot}),ve.jsx(nre,se({id:`menu-${$||""}`,anchorEl:Qt,open:zn,onClose:Ot,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},N,{MenuListProps:se({"aria-labelledby":z,role:"listbox","aria-multiselectable":F?"true":void 0,disableListWrap:!0,id:Ne},N.MenuListProps),slotProps:se({},N.slotProps,{paper:se({},Mt,{style:se({minWidth:_t},Mt!=null?Mt.style:null)})}),children:st}))]})}),zre=Dre,Fre=["autoWidth","children","classes","className","defaultOpen","displayEmpty","IconComponent","id","input","inputProps","label","labelId","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"],Nre=["root"],Bre=t=>{const{classes:e}=t;return e},cT={name:"MuiSelect",overridesResolver:(t,e)=>e.root,shouldForwardProp:t=>la(t)&&t!=="variant",slot:"Root"},Ure=At(PD,cT)(""),Vre=At(OD,cT)(""),jre=At(wD,cT)(""),DD=Z.forwardRef(function(e,n){const r=Gn({name:"MuiSelect",props:e}),{autoWidth:i=!1,children:a,classes:h={},className:l,defaultOpen:m=!1,displayEmpty:_=!1,IconComponent:E=Lee,id:S,input:I,inputProps:L,label:O,labelId:D,MenuProps:H,multiple:z=!1,native:N=!1,onClose:F,onOpen:$,open:Q,renderValue:te,SelectDisplayProps:re,variant:we="outlined"}=r,Ee=nn(r,Fre),de=N?yre:zre,Le=ku(),Ge=zd({props:r,muiFormControl:Le,states:["variant","error"]}),Be=Ge.variant||we,Oe=se({},r,{variant:Be,classes:h}),Ke=Bre(Oe),je=nn(Ke,Nre),it=I||{standard:ve.jsx(Ure,{ownerState:Oe}),outlined:ve.jsx(Vre,{label:O,ownerState:Oe}),filled:ve.jsx(jre,{ownerState:Oe})}[Be],Me=Yr(n,it.ref);return ve.jsx(Z.Fragment,{children:Z.cloneElement(it,se({inputComponent:de,inputProps:se({children:a,error:Ge.error,IconComponent:E,variant:Be,type:void 0,multiple:z},N?{id:S}:{autoWidth:i,defaultOpen:m,displayEmpty:_,labelId:D,MenuProps:H,onClose:F,onOpen:$,open:Q,renderValue:te,SelectDisplayProps:se({id:S},re)},L,{classes:L?zs(je,L.classes):je},I?I.props.inputProps:{})},z&&N&&Be==="outlined"?{notched:!0}:{},{ref:Me,className:fn(it.props.className,l,Ke.root)},!I&&{variant:Be},Ee))})});DD.muiName="Select";const zD=DD,$re=t=>!t||!mc(t),Gre=$re;function Hre(t){return $n("MuiSlider",t)}const Wre=Bn("MuiSlider",["root","active","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","disabled","dragging","focusVisible","mark","markActive","marked","markLabel","markLabelActive","rail","sizeSmall","thumb","thumbColorPrimary","thumbColorSecondary","thumbColorError","thumbColorSuccess","thumbColorInfo","thumbColorWarning","track","trackInverted","trackFalse","thumbSizeSmall","valueLabel","valueLabelOpen","valueLabelCircle","valueLabelLabel","vertical"]),ta=Wre,qre=t=>{const{open:e}=t;return{offset:fn(e&&ta.valueLabelOpen),circle:ta.valueLabelCircle,label:ta.valueLabelLabel}};function Zre(t){const{children:e,className:n,value:r}=t,i=qre(t);return e?Z.cloneElement(e,{className:fn(e.props.className)},ve.jsxs(Z.Fragment,{children:[e.props.children,ve.jsx("span",{className:fn(i.offset,n),"aria-hidden":!0,children:ve.jsx("span",{className:i.circle,children:ve.jsx("span",{className:i.label,children:r})})})]})):null}const Xre=["aria-label","aria-valuetext","aria-labelledby","component","components","componentsProps","color","classes","className","disableSwap","disabled","getAriaLabel","getAriaValueText","marks","max","min","name","onChange","onChangeCommitted","orientation","size","step","scale","slotProps","slots","tabIndex","track","value","valueLabelDisplay","valueLabelFormat"];function BM(t){return t}const Yre=At("span",{name:"MuiSlider",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[`color${Yt(n.color)}`],n.size!=="medium"&&e[`size${Yt(n.size)}`],n.marked&&e.marked,n.orientation==="vertical"&&e.vertical,n.track==="inverted"&&e.trackInverted,n.track===!1&&e.trackFalse]}})(({theme:t,ownerState:e})=>se({borderRadius:12,boxSizing:"content-box",display:"inline-block",position:"relative",cursor:"pointer",touchAction:"none",color:(t.vars||t).palette[e.color].main,WebkitTapHighlightColor:"transparent"},e.orientation==="horizontal"&&se({height:4,width:"100%",padding:"13px 0","@media (pointer: coarse)":{padding:"20px 0"}},e.size==="small"&&{height:2},e.marked&&{marginBottom:20}),e.orientation==="vertical"&&se({height:"100%",width:4,padding:"0 13px","@media (pointer: coarse)":{padding:"0 20px"}},e.size==="small"&&{width:2},e.marked&&{marginRight:44}),{"@media print":{colorAdjust:"exact"},[`&.${ta.disabled}`]:{pointerEvents:"none",cursor:"default",color:(t.vars||t).palette.grey[400]},[`&.${ta.dragging}`]:{[`& .${ta.thumb}, & .${ta.track}`]:{transition:"none"}}})),Kre=At("span",{name:"MuiSlider",slot:"Rail",overridesResolver:(t,e)=>e.rail})(({ownerState:t})=>se({display:"block",position:"absolute",borderRadius:"inherit",backgroundColor:"currentColor",opacity:.38},t.orientation==="horizontal"&&{width:"100%",height:"inherit",top:"50%",transform:"translateY(-50%)"},t.orientation==="vertical"&&{height:"100%",width:"inherit",left:"50%",transform:"translateX(-50%)"},t.track==="inverted"&&{opacity:1})),Jre=At("span",{name:"MuiSlider",slot:"Track",overridesResolver:(t,e)=>e.track})(({theme:t,ownerState:e})=>{const n=t.palette.mode==="light"?mm(t.palette[e.color].main,.62):pm(t.palette[e.color].main,.5);return se({display:"block",position:"absolute",borderRadius:"inherit",border:"1px solid currentColor",backgroundColor:"currentColor",transition:t.transitions.create(["left","width","bottom","height"],{duration:t.transitions.duration.shortest})},e.size==="small"&&{border:"none"},e.orientation==="horizontal"&&{height:"inherit",top:"50%",transform:"translateY(-50%)"},e.orientation==="vertical"&&{width:"inherit",left:"50%",transform:"translateX(-50%)"},e.track===!1&&{display:"none"},e.track==="inverted"&&{backgroundColor:t.vars?t.vars.palette.Slider[`${e.color}Track`]:n,borderColor:t.vars?t.vars.palette.Slider[`${e.color}Track`]:n})}),Qre=At("span",{name:"MuiSlider",slot:"Thumb",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.thumb,e[`thumbColor${Yt(n.color)}`],n.size!=="medium"&&e[`thumbSize${Yt(n.size)}`]]}})(({theme:t,ownerState:e})=>se({position:"absolute",width:20,height:20,boxSizing:"border-box",borderRadius:"50%",outline:0,backgroundColor:"currentColor",display:"flex",alignItems:"center",justifyContent:"center",transition:t.transitions.create(["box-shadow","left","bottom"],{duration:t.transitions.duration.shortest})},e.size==="small"&&{width:12,height:12},e.orientation==="horizontal"&&{top:"50%",transform:"translate(-50%, -50%)"},e.orientation==="vertical"&&{left:"50%",transform:"translate(-50%, 50%)"},{"&:before":se({position:"absolute",content:'""',borderRadius:"inherit",width:"100%",height:"100%",boxShadow:(t.vars||t).shadows[2]},e.size==="small"&&{boxShadow:"none"}),"&::after":{position:"absolute",content:'""',borderRadius:"50%",width:42,height:42,top:"50%",left:"50%",transform:"translate(-50%, -50%)"},[`&:hover, &.${ta.focusVisible}`]:{boxShadow:`0px 0px 0px 8px ${t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / 0.16)`:Ai(t.palette[e.color].main,.16)}`,"@media (hover: none)":{boxShadow:"none"}},[`&.${ta.active}`]:{boxShadow:`0px 0px 0px 14px ${t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / 0.16)`:Ai(t.palette[e.color].main,.16)}`},[`&.${ta.disabled}`]:{"&:hover":{boxShadow:"none"}}})),eie=At(Zre,{name:"MuiSlider",slot:"ValueLabel",overridesResolver:(t,e)=>e.valueLabel})(({theme:t,ownerState:e})=>se({[`&.${ta.valueLabelOpen}`]:{transform:`${e.orientation==="vertical"?"translateY(-50%)":"translateY(-100%)"} scale(1)`},zIndex:1,whiteSpace:"nowrap"},t.typography.body2,{fontWeight:500,transition:t.transitions.create(["transform"],{duration:t.transitions.duration.shortest}),transform:`${e.orientation==="vertical"?"translateY(-50%)":"translateY(-100%)"} scale(0)`,position:"absolute",backgroundColor:(t.vars||t).palette.grey[600],borderRadius:2,color:(t.vars||t).palette.common.white,display:"flex",alignItems:"center",justifyContent:"center",padding:"0.25rem 0.75rem"},e.orientation==="horizontal"&&{top:"-10px",transformOrigin:"bottom center","&:before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, 50%) rotate(45deg)",backgroundColor:"inherit",bottom:0,left:"50%"}},e.orientation==="vertical"&&{right:e.size==="small"?"20px":"30px",top:"50%",transformOrigin:"right center","&:before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, -50%) rotate(45deg)",backgroundColor:"inherit",right:-8,top:"50%"}},e.size==="small"&&{fontSize:t.typography.pxToRem(12),padding:"0.25rem 0.5rem"})),tie=At("span",{name:"MuiSlider",slot:"Mark",shouldForwardProp:t=>WE(t)&&t!=="markActive",overridesResolver:(t,e)=>{const{markActive:n}=t;return[e.mark,n&&e.markActive]}})(({theme:t,ownerState:e,markActive:n})=>se({position:"absolute",width:2,height:2,borderRadius:1,backgroundColor:"currentColor"},e.orientation==="horizontal"&&{top:"50%",transform:"translate(-1px, -50%)"},e.orientation==="vertical"&&{left:"50%",transform:"translate(-50%, 1px)"},n&&{backgroundColor:(t.vars||t).palette.background.paper,opacity:.8})),nie=At("span",{name:"MuiSlider",slot:"MarkLabel",shouldForwardProp:t=>WE(t)&&t!=="markLabelActive",overridesResolver:(t,e)=>e.markLabel})(({theme:t,ownerState:e,markLabelActive:n})=>se({},t.typography.body2,{color:(t.vars||t).palette.text.secondary,position:"absolute",whiteSpace:"nowrap"},e.orientation==="horizontal"&&{top:30,transform:"translateX(-50%)","@media (pointer: coarse)":{top:40}},e.orientation==="vertical"&&{left:36,transform:"translateY(50%)","@media (pointer: coarse)":{left:44}},n&&{color:(t.vars||t).palette.text.primary})),rie=t=>{const{disabled:e,dragging:n,marked:r,orientation:i,track:a,classes:h,color:l,size:m}=t,_={root:["root",e&&"disabled",n&&"dragging",r&&"marked",i==="vertical"&&"vertical",a==="inverted"&&"trackInverted",a===!1&&"trackFalse",l&&`color${Yt(l)}`,m&&`size${Yt(m)}`],rail:["rail"],track:["track"],mark:["mark"],markActive:["markActive"],markLabel:["markLabel"],markLabelActive:["markLabelActive"],valueLabel:["valueLabel"],thumb:["thumb",e&&"disabled",m&&`thumbSize${Yt(m)}`,l&&`thumbColor${Yt(l)}`],active:["active"],disabled:["disabled"],focusVisible:["focusVisible"]};return qn(_,Hre,h)},iie=({children:t})=>t,sie=Z.forwardRef(function(e,n){var r,i,a,h,l,m,_,E,S,I,L,O,D,H,z,N,F,$,Q,te,re,we,Ee,de;const Le=Gn({props:e,name:"MuiSlider"}),Be=Ec().direction==="rtl",{"aria-label":Oe,"aria-valuetext":Ke,"aria-labelledby":je,component:it="span",components:Me={},componentsProps:qe={},color:ut="primary",classes:zt,className:vt,disableSwap:yt=!1,disabled:at=!1,getAriaLabel:bt,getAriaValueText:xt,marks:$t=!1,max:Kt=100,min:Ct=0,orientation:sn="horizontal",size:Qt="medium",step:pn=1,scale:Wt=BM,slotProps:Ot,slots:Dt,track:wn="normal",valueLabelDisplay:mn="off",valueLabelFormat:En=BM}=Le,zn=nn(Le,Xre),Re=se({},Le,{isRtl:Be,max:Kt,min:Ct,classes:zt,disabled:at,disableSwap:yt,orientation:sn,marks:$t,color:ut,size:Qt,step:pn,scale:Wt,track:wn,valueLabelDisplay:mn,valueLabelFormat:En}),{axisProps:Bt,getRootProps:Rn,getHiddenInputProps:an,getThumbProps:It,open:st,active:_t,axis:Fe,focusedThumbIndex:et,range:ot,dragging:Zt,marks:Mt,values:Ne,trackOffset:Ye,trackLeap:St,getThumbStyle:gn}=uee(se({},Re,{rootRef:n}));Re.marked=Mt.length>0&&Mt.some(ft=>ft.label),Re.dragging=Zt,Re.focusedThumbIndex=et;const yn=rie(Re),nt=(r=(i=Dt==null?void 0:Dt.root)!=null?i:Me.Root)!=null?r:Yre,on=(a=(h=Dt==null?void 0:Dt.rail)!=null?h:Me.Rail)!=null?a:Kre,rn=(l=(m=Dt==null?void 0:Dt.track)!=null?m:Me.Track)!=null?l:Jre,Cr=(_=(E=Dt==null?void 0:Dt.thumb)!=null?E:Me.Thumb)!=null?_:Qre,li=(S=(I=Dt==null?void 0:Dt.valueLabel)!=null?I:Me.ValueLabel)!=null?S:eie,un=(L=(O=Dt==null?void 0:Dt.mark)!=null?O:Me.Mark)!=null?L:tie,Kr=(D=(H=Dt==null?void 0:Dt.markLabel)!=null?H:Me.MarkLabel)!=null?D:nie,xi=(z=(N=Dt==null?void 0:Dt.input)!=null?N:Me.Input)!=null?z:"input",he=(F=Ot==null?void 0:Ot.root)!=null?F:qe.root,G=($=Ot==null?void 0:Ot.rail)!=null?$:qe.rail,q=(Q=Ot==null?void 0:Ot.track)!=null?Q:qe.track,ne=(te=Ot==null?void 0:Ot.thumb)!=null?te:qe.thumb,ce=(re=Ot==null?void 0:Ot.valueLabel)!=null?re:qe.valueLabel,_e=(we=Ot==null?void 0:Ot.mark)!=null?we:qe.mark,Se=(Ee=Ot==null?void 0:Ot.markLabel)!=null?Ee:qe.markLabel,Te=(de=Ot==null?void 0:Ot.input)!=null?de:qe.input,ge=is({elementType:nt,getSlotProps:Rn,externalSlotProps:he,externalForwardedProps:zn,additionalProps:se({},Gre(nt)&&{as:it}),ownerState:se({},Re,he==null?void 0:he.ownerState),className:[yn.root,vt]}),Ce=is({elementType:on,externalSlotProps:G,ownerState:Re,className:yn.rail}),He=is({elementType:rn,externalSlotProps:q,additionalProps:{style:se({},Bt[Fe].offset(Ye),Bt[Fe].leap(St))},ownerState:se({},Re,q==null?void 0:q.ownerState),className:yn.track}),We=is({elementType:Cr,getSlotProps:It,externalSlotProps:ne,ownerState:se({},Re,ne==null?void 0:ne.ownerState),className:yn.thumb}),Ze=is({elementType:li,externalSlotProps:ce,ownerState:se({},Re,ce==null?void 0:ce.ownerState),className:yn.valueLabel}),Pt=is({elementType:un,externalSlotProps:_e,ownerState:Re,className:yn.mark}),tn=is({elementType:Kr,externalSlotProps:Se,ownerState:Re,className:yn.markLabel}),Lt=is({elementType:xi,getSlotProps:an,externalSlotProps:Te,ownerState:Re});return ve.jsxs(nt,se({},ge,{children:[ve.jsx(on,se({},Ce)),ve.jsx(rn,se({},He)),Mt.filter(ft=>ft.value>=Ct&&ft.value<=Kt).map((ft,Ft)=>{const xn=i_(ft.value,Ct,Kt),bn=Bt[Fe].offset(xn);let dn;return wn===!1?dn=Ne.indexOf(ft.value)!==-1:dn=wn==="normal"&&(ot?ft.value>=Ne[0]&&ft.value<=Ne[Ne.length-1]:ft.value<=Ne[0])||wn==="inverted"&&(ot?ft.value<=Ne[0]||ft.value>=Ne[Ne.length-1]:ft.value>=Ne[0]),ve.jsxs(Z.Fragment,{children:[ve.jsx(un,se({"data-index":Ft},Pt,!mc(un)&&{markActive:dn},{style:se({},bn,Pt.style),className:fn(Pt.className,dn&&yn.markActive)})),ft.label!=null?ve.jsx(Kr,se({"aria-hidden":!0,"data-index":Ft},tn,!mc(Kr)&&{markLabelActive:dn},{style:se({},bn,tn.style),className:fn(yn.markLabel,tn.className,dn&&yn.markLabelActive),children:ft.label})):null]},Ft)}),Ne.map((ft,Ft)=>{const xn=i_(ft,Ct,Kt),bn=Bt[Fe].offset(xn),dn=mn==="off"?iie:li;return ve.jsx(dn,se({},!mc(dn)&&{valueLabelFormat:En,valueLabelDisplay:mn,value:typeof En=="function"?En(Wt(ft),Ft):En,index:Ft,open:st===Ft||_t===Ft||mn==="on",disabled:at},Ze,{children:ve.jsx(Cr,se({"data-index":Ft},We,{className:fn(yn.thumb,We.className,_t===Ft&&yn.active,et===Ft&&yn.focusVisible),style:se({},bn,gn(Ft),We.style),children:ve.jsx(xi,se({"data-index":Ft,"aria-label":bt?bt(Ft):Oe,"aria-valuenow":Wt(ft),"aria-labelledby":je,"aria-valuetext":xt?xt(Wt(ft),Ft):Ke,value:Ne[Ft]},Lt))}))}),Ft)})]}))}),uT=sie;function oie(t){return $n("MuiSnackbarContent",t)}Bn("MuiSnackbarContent",["root","message","action"]);const aie=["action","className","message","role"],lie=t=>{const{classes:e}=t;return qn({root:["root"],action:["action"],message:["message"]},oie,e)},cie=At(yv,{name:"MuiSnackbarContent",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t})=>{const e=t.palette.mode==="light"?.8:.98,n=EY(t.palette.background.default,e);return se({},t.typography.body2,{color:t.vars?t.vars.palette.SnackbarContent.color:t.palette.getContrastText(n),backgroundColor:t.vars?t.vars.palette.SnackbarContent.bg:n,display:"flex",alignItems:"center",flexWrap:"wrap",padding:"6px 16px",borderRadius:(t.vars||t).shape.borderRadius,flexGrow:1,[t.breakpoints.up("sm")]:{flexGrow:"initial",minWidth:288}})}),uie=At("div",{name:"MuiSnackbarContent",slot:"Message",overridesResolver:(t,e)=>e.message})({padding:"8px 0"}),hie=At("div",{name:"MuiSnackbarContent",slot:"Action",overridesResolver:(t,e)=>e.action})({display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}),die=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiSnackbarContent"}),{action:i,className:a,message:h,role:l="alert"}=r,m=nn(r,aie),_=r,E=lie(_);return ve.jsxs(cie,se({role:l,square:!0,elevation:6,className:fn(E.root,a),ownerState:_,ref:n},m,{children:[ve.jsx(uie,{className:E.message,ownerState:_,children:h}),i?ve.jsx(hie,{className:E.action,ownerState:_,children:i}):null]}))}),fie=die;function pie(t){return $n("MuiSnackbar",t)}Bn("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft"]);const mie=["onEnter","onExited"],gie=["action","anchorOrigin","autoHideDuration","children","className","ClickAwayListenerProps","ContentProps","disableWindowBlurListener","message","onBlur","onClose","onFocus","onMouseEnter","onMouseLeave","open","resumeHideDuration","TransitionComponent","transitionDuration","TransitionProps"],yie=t=>{const{classes:e,anchorOrigin:n}=t,r={root:["root",`anchorOrigin${Yt(n.vertical)}${Yt(n.horizontal)}`]};return qn(r,pie,e)},UM=At("div",{name:"MuiSnackbar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[`anchorOrigin${Yt(n.anchorOrigin.vertical)}${Yt(n.anchorOrigin.horizontal)}`]]}})(({theme:t,ownerState:e})=>{const n={left:"50%",right:"auto",transform:"translateX(-50%)"};return se({zIndex:(t.vars||t).zIndex.snackbar,position:"fixed",display:"flex",left:8,right:8,justifyContent:"center",alignItems:"center"},e.anchorOrigin.vertical==="top"?{top:8}:{bottom:8},e.anchorOrigin.horizontal==="left"&&{justifyContent:"flex-start"},e.anchorOrigin.horizontal==="right"&&{justifyContent:"flex-end"},{[t.breakpoints.up("sm")]:se({},e.anchorOrigin.vertical==="top"?{top:24}:{bottom:24},e.anchorOrigin.horizontal==="center"&&n,e.anchorOrigin.horizontal==="left"&&{left:24,right:"auto"},e.anchorOrigin.horizontal==="right"&&{right:24,left:"auto"})})}),_ie=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiSnackbar"}),i=Ec(),a={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{action:h,anchorOrigin:{vertical:l,horizontal:m}={vertical:"bottom",horizontal:"left"},autoHideDuration:_=null,children:E,className:S,ClickAwayListenerProps:I,ContentProps:L,disableWindowBlurListener:O=!1,message:D,open:H,TransitionComponent:z=o_,transitionDuration:N=a,TransitionProps:{onEnter:F,onExited:$}={}}=r,Q=nn(r.TransitionProps,mie),te=nn(r,gie),re=se({},r,{anchorOrigin:{vertical:l,horizontal:m},autoHideDuration:_,disableWindowBlurListener:O,TransitionComponent:z,transitionDuration:N}),we=yie(re),{getRootProps:Ee,onClickAway:de}=hee(se({},re)),[Le,Ge]=Z.useState(!0),Be=is({elementType:UM,getSlotProps:Ee,externalForwardedProps:te,ownerState:re,additionalProps:{ref:n},className:[we.root,S]}),Oe=je=>{Ge(!0),$&&$(je)},Ke=(je,it)=>{Ge(!1),F&&F(je,it)};return!H&&Le?null:ve.jsx(SJ,se({onClickAway:de},I,{children:ve.jsx(UM,se({},Be,{children:ve.jsx(z,se({appear:!0,in:H,timeout:N,direction:l==="top"?"down":"up",onEnter:Ke,onExited:Oe},Q,{children:E||ve.jsx(fie,se({message:D,action:h},L))}))}))}))}),vie=_ie;function xie(t){return $n("MuiTooltip",t)}const bie=Bn("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]),rc=bie,wie=["arrow","children","classes","components","componentsProps","describeChild","disableFocusListener","disableHoverListener","disableInteractive","disableTouchListener","enterDelay","enterNextDelay","enterTouchDelay","followCursor","id","leaveDelay","leaveTouchDelay","onClose","onOpen","open","placement","PopperComponent","PopperProps","slotProps","slots","title","TransitionComponent","TransitionProps"];function Eie(t){return Math.round(t*1e5)/1e5}const Tie=t=>{const{classes:e,disableInteractive:n,arrow:r,touch:i,placement:a}=t,h={popper:["popper",!n&&"popperInteractive",r&&"popperArrow"],tooltip:["tooltip",r&&"tooltipArrow",i&&"touch",`tooltipPlacement${Yt(a.split("-")[0])}`],arrow:["arrow"]};return qn(h,xie,e)},Sie=At(pD,{name:"MuiTooltip",slot:"Popper",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.popper,!n.disableInteractive&&e.popperInteractive,n.arrow&&e.popperArrow,!n.open&&e.popperClose]}})(({theme:t,ownerState:e,open:n})=>se({zIndex:(t.vars||t).zIndex.tooltip,pointerEvents:"none"},!e.disableInteractive&&{pointerEvents:"auto"},!n&&{pointerEvents:"none"},e.arrow&&{[`&[data-popper-placement*="bottom"] .${rc.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${rc.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${rc.arrow}`]:se({},e.isRtl?{right:0,marginRight:"-0.71em"}:{left:0,marginLeft:"-0.71em"},{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}}),[`&[data-popper-placement*="left"] .${rc.arrow}`]:se({},e.isRtl?{left:0,marginLeft:"-0.71em"}:{right:0,marginRight:"-0.71em"},{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}})})),Pie=At("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.tooltip,n.touch&&e.touch,n.arrow&&e.tooltipArrow,e[`tooltipPlacement${Yt(n.placement.split("-")[0])}`]]}})(({theme:t,ownerState:e})=>se({backgroundColor:t.vars?t.vars.palette.Tooltip.bg:Ai(t.palette.grey[700],.92),borderRadius:(t.vars||t).shape.borderRadius,color:(t.vars||t).palette.common.white,fontFamily:t.typography.fontFamily,padding:"4px 8px",fontSize:t.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:t.typography.fontWeightMedium},e.arrow&&{position:"relative",margin:0},e.touch&&{padding:"8px 16px",fontSize:t.typography.pxToRem(14),lineHeight:`${Eie(16/14)}em`,fontWeight:t.typography.fontWeightRegular},{[`.${rc.popper}[data-popper-placement*="left"] &`]:se({transformOrigin:"right center"},e.isRtl?se({marginLeft:"14px"},e.touch&&{marginLeft:"24px"}):se({marginRight:"14px"},e.touch&&{marginRight:"24px"})),[`.${rc.popper}[data-popper-placement*="right"] &`]:se({transformOrigin:"left center"},e.isRtl?se({marginRight:"14px"},e.touch&&{marginRight:"24px"}):se({marginLeft:"14px"},e.touch&&{marginLeft:"24px"})),[`.${rc.popper}[data-popper-placement*="top"] &`]:se({transformOrigin:"center bottom",marginBottom:"14px"},e.touch&&{marginBottom:"24px"}),[`.${rc.popper}[data-popper-placement*="bottom"] &`]:se({transformOrigin:"center top",marginTop:"14px"},e.touch&&{marginTop:"24px"})})),Cie=At("span",{name:"MuiTooltip",slot:"Arrow",overridesResolver:(t,e)=>e.arrow})(({theme:t})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:t.vars?t.vars.palette.Tooltip.bg:Ai(t.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}}));let Ry=!1,qx=null,ap={x:0,y:0};function Oy(t,e){return n=>{e&&e(n),t(n)}}const Aie=Z.forwardRef(function(e,n){var r,i,a,h,l,m,_,E,S,I,L,O,D,H,z,N,F,$,Q;const te=Gn({props:e,name:"MuiTooltip"}),{arrow:re=!1,children:we,components:Ee={},componentsProps:de={},describeChild:Le=!1,disableFocusListener:Ge=!1,disableHoverListener:Be=!1,disableInteractive:Oe=!1,disableTouchListener:Ke=!1,enterDelay:je=100,enterNextDelay:it=0,enterTouchDelay:Me=700,followCursor:qe=!1,id:ut,leaveDelay:zt=0,leaveTouchDelay:vt=1500,onClose:yt,onOpen:at,open:bt,placement:xt="bottom",PopperComponent:$t,PopperProps:Kt={},slotProps:Ct={},slots:sn={},title:Qt,TransitionComponent:pn=o_,TransitionProps:Wt}=te,Ot=nn(te,wie),Dt=Z.isValidElement(we)?we:ve.jsx("span",{children:we}),wn=Ec(),mn=wn.direction==="rtl",[En,zn]=Z.useState(),[Re,Bt]=Z.useState(null),Rn=Z.useRef(!1),an=Oe||qe,It=Z.useRef(),st=Z.useRef(),_t=Z.useRef(),Fe=Z.useRef(),[et,ot]=K0({controlled:bt,default:!1,name:"Tooltip",state:"open"});let Zt=et;const Mt=CE(ut),Ne=Z.useRef(),Ye=Z.useCallback(()=>{Ne.current!==void 0&&(document.body.style.WebkitUserSelect=Ne.current,Ne.current=void 0),clearTimeout(Fe.current)},[]);Z.useEffect(()=>()=>{clearTimeout(It.current),clearTimeout(st.current),clearTimeout(_t.current),Ye()},[Ye]);const St=Ut=>{clearTimeout(qx),Ry=!0,ot(!0),at&&!Zt&&at(Ut)},gn=no(Ut=>{clearTimeout(qx),qx=setTimeout(()=>{Ry=!1},800+zt),ot(!1),yt&&Zt&&yt(Ut),clearTimeout(It.current),It.current=setTimeout(()=>{Rn.current=!1},wn.transitions.duration.shortest)}),yn=Ut=>{Rn.current&&Ut.type!=="touchstart"||(En&&En.removeAttribute("title"),clearTimeout(st.current),clearTimeout(_t.current),je||Ry&&it?st.current=setTimeout(()=>{St(Ut)},Ry?it:je):St(Ut))},nt=Ut=>{clearTimeout(st.current),clearTimeout(_t.current),_t.current=setTimeout(()=>{gn(Ut)},zt)},{isFocusVisibleRef:on,onBlur:rn,onFocus:Cr,ref:li}=AE(),[,un]=Z.useState(!1),Kr=Ut=>{rn(Ut),on.current===!1&&(un(!1),nt(Ut))},xi=Ut=>{En||zn(Ut.currentTarget),Cr(Ut),on.current===!0&&(un(!0),yn(Ut))},he=Ut=>{Rn.current=!0;const On=Dt.props;On.onTouchStart&&On.onTouchStart(Ut)},G=yn,q=nt,ne=Ut=>{he(Ut),clearTimeout(_t.current),clearTimeout(It.current),Ye(),Ne.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",Fe.current=setTimeout(()=>{document.body.style.WebkitUserSelect=Ne.current,yn(Ut)},Me)},ce=Ut=>{Dt.props.onTouchEnd&&Dt.props.onTouchEnd(Ut),Ye(),clearTimeout(_t.current),_t.current=setTimeout(()=>{gn(Ut)},vt)};Z.useEffect(()=>{if(!Zt)return;function Ut(On){(On.key==="Escape"||On.key==="Esc")&&gn(On)}return document.addEventListener("keydown",Ut),()=>{document.removeEventListener("keydown",Ut)}},[gn,Zt]);const _e=Yr(Dt.ref,li,zn,n);!Qt&&Qt!==0&&(Zt=!1);const Se=Z.useRef(),Te=Ut=>{const On=Dt.props;On.onMouseMove&&On.onMouseMove(Ut),ap={x:Ut.clientX,y:Ut.clientY},Se.current&&Se.current.update()},ge={},Ce=typeof Qt=="string";Le?(ge.title=!Zt&&Ce&&!Be?Qt:null,ge["aria-describedby"]=Zt?Mt:null):(ge["aria-label"]=Ce?Qt:null,ge["aria-labelledby"]=Zt&&!Ce?Mt:null);const He=se({},ge,Ot,Dt.props,{className:fn(Ot.className,Dt.props.className),onTouchStart:he,ref:_e},qe?{onMouseMove:Te}:{}),We={};Ke||(He.onTouchStart=ne,He.onTouchEnd=ce),Be||(He.onMouseOver=Oy(G,He.onMouseOver),He.onMouseLeave=Oy(q,He.onMouseLeave),an||(We.onMouseOver=G,We.onMouseLeave=q)),Ge||(He.onFocus=Oy(xi,He.onFocus),He.onBlur=Oy(Kr,He.onBlur),an||(We.onFocus=xi,We.onBlur=Kr));const Ze=Z.useMemo(()=>{var Ut;let On=[{name:"arrow",enabled:!!Re,options:{element:Re,padding:4}}];return(Ut=Kt.popperOptions)!=null&&Ut.modifiers&&(On=On.concat(Kt.popperOptions.modifiers)),se({},Kt.popperOptions,{modifiers:On})},[Re,Kt]),Pt=se({},te,{isRtl:mn,arrow:re,disableInteractive:an,placement:xt,PopperComponentProp:$t,touch:Rn.current}),tn=Tie(Pt),Lt=(r=(i=sn.popper)!=null?i:Ee.Popper)!=null?r:Sie,ft=(a=(h=(l=sn.transition)!=null?l:Ee.Transition)!=null?h:pn)!=null?a:o_,Ft=(m=(_=sn.tooltip)!=null?_:Ee.Tooltip)!=null?m:Pie,xn=(E=(S=sn.arrow)!=null?S:Ee.Arrow)!=null?E:Cie,bn=gp(Lt,se({},Kt,(I=Ct.popper)!=null?I:de.popper,{className:fn(tn.popper,Kt==null?void 0:Kt.className,(L=(O=Ct.popper)!=null?O:de.popper)==null?void 0:L.className)}),Pt),dn=gp(ft,se({},Wt,(D=Ct.transition)!=null?D:de.transition),Pt),_n=gp(Ft,se({},(H=Ct.tooltip)!=null?H:de.tooltip,{className:fn(tn.tooltip,(z=(N=Ct.tooltip)!=null?N:de.tooltip)==null?void 0:z.className)}),Pt),Ar=gp(xn,se({},(F=Ct.arrow)!=null?F:de.arrow,{className:fn(tn.arrow,($=(Q=Ct.arrow)!=null?Q:de.arrow)==null?void 0:$.className)}),Pt);return ve.jsxs(Z.Fragment,{children:[Z.cloneElement(Dt,He),ve.jsx(Lt,se({as:$t??pD,placement:xt,anchorEl:qe?{getBoundingClientRect:()=>({top:ap.y,left:ap.x,right:ap.x,bottom:ap.y,width:0,height:0})}:En,popperRef:Se,open:En?Zt:!1,id:Mt,transition:!0},We,bn,{popperOptions:Ze,children:({TransitionProps:Ut})=>ve.jsx(ft,se({timeout:wn.transitions.duration.shorter},Ut,dn,{children:ve.jsxs(Ft,se({},_n,{children:[Qt,re?ve.jsx(xn,se({},Ar,{ref:Bt})):null]}))}))}))]})}),Iie=Aie;function Mie(t){return $n("MuiTextField",t)}Bn("MuiTextField",["root"]);const kie=["autoComplete","autoFocus","children","className","color","defaultValue","disabled","error","FormHelperTextProps","fullWidth","helperText","id","InputLabelProps","inputProps","InputProps","inputRef","label","maxRows","minRows","multiline","name","onBlur","onChange","onFocus","placeholder","required","rows","select","SelectProps","type","value","variant"],Lie={standard:PD,filled:wD,outlined:OD},Rie=t=>{const{classes:e}=t;return qn({root:["root"]},Mie,e)},Oie=At(ED,{name:"MuiTextField",slot:"Root",overridesResolver:(t,e)=>e.root})({}),Die=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiTextField"}),{autoComplete:i,autoFocus:a=!1,children:h,className:l,color:m="primary",defaultValue:_,disabled:E=!1,error:S=!1,FormHelperTextProps:I,fullWidth:L=!1,helperText:O,id:D,InputLabelProps:H,inputProps:z,InputProps:N,inputRef:F,label:$,maxRows:Q,minRows:te,multiline:re=!1,name:we,onBlur:Ee,onChange:de,onFocus:Le,placeholder:Ge,required:Be=!1,rows:Oe,select:Ke=!1,SelectProps:je,type:it,value:Me,variant:qe="outlined"}=r,ut=nn(r,kie),zt=se({},r,{autoFocus:a,color:m,disabled:E,error:S,fullWidth:L,multiline:re,required:Be,select:Ke,variant:qe}),vt=Rie(zt),yt={};qe==="outlined"&&(H&&typeof H.shrink<"u"&&(yt.notched=H.shrink),yt.label=$),Ke&&((!je||!je.native)&&(yt.id=void 0),yt["aria-describedby"]=void 0);const at=CE(D),bt=O&&at?`${at}-helper-text`:void 0,xt=$&&at?`${at}-label`:void 0,$t=Lie[qe],Kt=ve.jsx($t,se({"aria-describedby":bt,autoComplete:i,autoFocus:a,defaultValue:_,fullWidth:L,multiline:re,name:we,rows:Oe,maxRows:Q,minRows:te,type:it,value:Me,id:at,inputRef:F,onBlur:Ee,onChange:de,onFocus:Le,placeholder:Ge,inputProps:z},yt,N));return ve.jsxs(Oie,se({className:fn(vt.root,l),disabled:E,error:S,fullWidth:L,ref:n,required:Be,color:m,variant:qe,ownerState:zt},ut,{children:[$!=null&&$!==""&&ve.jsx(CD,se({htmlFor:at,id:xt},H,{children:$})),Ke?ve.jsx(zD,se({"aria-describedby":bt,id:at,labelId:xt,value:Me,input:Kt},je,{children:h})):Kt,O&&ve.jsx(Qte,se({id:bt},I,{children:O}))]}))}),zie=Die,Fie="linear-gradient(45deg, #ccc 25%, transparent 25%), linear-gradient(135deg, #ccc 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #ccc 75%), linear-gradient(135deg, transparent 75%, #ccc 75%) /*! @noflip */",Nie="linear-gradient(to top, #000000, transparent), linear-gradient(to right, #ffffff, transparent) /*! @noflip */",Bie={Button:At(Uw)(()=>({backgroundSize:"8px 8px",backgroundPosition:"0 0, 4px 0, 4px -4px, 0px 4px",transition:"none",boxShadow:"0 4px 6px rgba(50, 50, 93, 0.11), 0 1px 3px rgba(0, 0, 0, 0.08)",border:0,borderRadius:4,width:"24px",aspectRatio:"1 / 1",height:"24px",minWidth:0}))},Uie=t=>{const{bgColor:e,className:n,disablePopover:r,isBgColorValid:i,...a}=t;return ve.jsx(Bie.Button,{disableTouchRipple:!0,style:{backgroundColor:i?e:void 0,backgroundImage:i?void 0:Fie,cursor:r?"default":void 0},className:`MuiColorInput-Button ${n||""}`,...a})},Vie={Container:At("div")(()=>({width:300,padding:8}))},jie=({children:t,className:e,position:n="start",...r})=>ve.jsx(MD,{className:`MuiColorInput-Popover ${e||""}`,anchorOrigin:{vertical:"bottom",horizontal:n==="start"?"left":"right"},transformOrigin:{vertical:"top",horizontal:n==="start"?"left":"right"},...r,children:ve.jsx(Vie.Container,{children:t})}),$ie={Slider:At(uT,{shouldForwardProp:t=>t!=="$rgbaFrom"&&t!=="$rgbaTo"})(()=>({height:8,"& .MuiSlider-rail":{opacity:1,background:"linear-gradient(to right, rgba(var(--rgb-r), var(--rgb-g), var(--rgb-b), 0) 0%, rgba(var(--rgb-r), var(--rgb-g), var(--rgb-b), 1) 100%)"},"& .MuiSlider-track":{color:"transparent",border:0},"& .MuiSlider-thumb":{backgroundColor:"#ffffff",border:"3px solid currentColor"}}))},Gie=t=>{const{rgbColor:e,style:n,className:r,...i}=t,a={"--rgb-r":e.r,"--rgb-g":e.g,"--rgb-b":e.b,...n};return ve.jsx($ie.Slider,{className:`MuiColorInput-AlphaSlider ${r||""}`,style:a,...i})},Dy={up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight"},Hie={ArrowUp:{type:"hsvV",value:1},ArrowDown:{type:"hsvV",value:-1},ArrowLeft:{type:"hsvS",value:-1},ArrowRight:{type:"hsvS",value:1}};function Wie(t){return t===Dy.up||t===Dy.down||t===Dy.left||t===Dy.right}function a_(t,e,n){return Math.max(e,Math.min(t,n))}function VM(t){return typeof t=="number"}function jM(t,e,n){const r=t.toLocaleString("en",{useGrouping:!1,minimumFractionDigits:e,maximumFractionDigits:n});return Number(r)}function qie(t,e,n){const r=t.getBoundingClientRect(),i=e-r.left,a=n-r.top;return{x:a_(i/r.width,0,1),y:a_(1-a/r.height,0,1)}}function Zie(t){const e=cr.useRef();return e.current=t,cr.useCallback((...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}const $M={Space:At("div")(()=>({width:"100%",height:"180px",boxSizing:"border-box",outline:0,position:"relative",backgroundImage:Nie})),Thumb:At("div")(()=>({position:"absolute",border:"3px solid #ffffff",borderRadius:"50%",width:"20px",height:"20px",marginLeft:"-10px /*! @noflip */",marginBottom:"-10px /*! @noflip */",outline:0,boxSizing:"border-box",willChange:"left, bottom",transition:"box-shadow 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms","&:hover":{boxShadow:"0px 0px 0px 4px rgba(255 255 255 / 0.16)"},"&.MuiColorInput-Thumb-active":{boxShadow:"0px 0px 0px 8px rgba(255 255 255 / 0.16)"},"@media (hover: none)":{boxShadow:"none"}}))},Xie=t=>{const{hsv:e,onChange:n,currentHue:r}=t,i=cr.useRef(!1),a=cr.useRef(null),[h,l]=cr.useState(!1),m=Zie((D,H)=>{if(!a.current)return;const{x:z,y:N}=qie(a.current,D,H);n({s:z,v:N}),a.current&&document.activeElement!==a.current&&a.current.focus()}),_=cr.useCallback(()=>{i.current&&(i.current=!1,l(!1))},[]),E=cr.useCallback(D=>{i.current&&m(D.clientX,D.clientY)},[]);cr.useEffect(()=>(document.addEventListener("pointermove",E,!1),document.addEventListener("pointerup",_,!1),()=>{document.removeEventListener("pointermove",E,!1),document.removeEventListener("pointerup",_,!1)}),[_,E]);const S=D=>{D.preventDefault(),i.current=!0,m(D.clientX,D.clientY),l(!0)},I=D=>{if(Wie(D.key)){D.preventDefault();const{type:H,value:z}=Hie[D.key],N=D.shiftKey?10:1,F=H==="hsvS"?e.s:e.v,$=a_(F+z*N*.01,0,1);l(!0),n({s:H==="hsvS"?$:e.s,v:H==="hsvV"?$:e.v})}},L=e.s*100,O=e.v*100;return ve.jsx($M.Space,{onPointerDown:S,ref:a,className:"MuiColorInput-ColorSpace",style:{backgroundColor:`hsl(${r} 100% 50%)`,touchAction:"none"},role:"slider","aria-valuetext":`Saturation ${jM(L,0,0)}%, Brightness ${jM(O,0,0)}%`,onKeyDown:I,tabIndex:0,children:ve.jsx($M.Thumb,{"aria-label":"Color space thumb",className:h?"MuiColorInput-Thumb-active":"",style:{left:`${L}%`,bottom:`${O}%`}})})},Yie={Slider:At(uT)(()=>({height:8,"& .MuiSlider-rail":{opacity:1,background:"linear-gradient(to right, rgb(255, 0, 0) 0%, rgb(255, 255, 0) 17%, rgb(0, 255, 0) 33%, rgb(0, 255, 255) 50%, rgb(0, 0, 255) 67%, rgb(255, 0, 255) 83%, rgb(255, 0, 0) 100%) /*! @noflip */"},"& .MuiSlider-track":{color:"transparent",border:0},"& .MuiSlider-thumb":{backgroundColor:"#ffffff",border:"3px solid currentColor"}}))},Kie=t=>{const{className:e,...n}=t;return ve.jsx(Yie.Slider,{className:`MuiColorInput-HueSlider ${e||""}`,...n})};function Jie(t){return typeof t=="string"}function ji(t,e){Qie(t)&&(t="100%");const n=ese(t);return t=e===360?t:Math.min(e,Math.max(0,parseFloat(t))),n&&(t=parseInt(String(t*e),10)/100),Math.abs(t-e)<1e-6?1:(e===360?t=(t<0?t%e+e:t%e)/parseFloat(String(e)):t=t%e/parseFloat(String(e)),t)}function zy(t){return Math.min(1,Math.max(0,t))}function Qie(t){return typeof t=="string"&&t.indexOf(".")!==-1&&parseFloat(t)===1}function ese(t){return typeof t=="string"&&t.indexOf("%")!==-1}function FD(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function Fy(t){return Number(t)<=1?`${Number(t)*100}%`:t}function au(t){return t.length===1?"0"+t:String(t)}function tse(t,e,n){return{r:ji(t,255)*255,g:ji(e,255)*255,b:ji(n,255)*255}}function GM(t,e,n){t=ji(t,255),e=ji(e,255),n=ji(n,255);const r=Math.max(t,e,n),i=Math.min(t,e,n);let a=0,h=0;const l=(r+i)/2;if(r===i)h=0,a=0;else{const m=r-i;switch(h=l>.5?m/(2-r-i):m/(r+i),r){case t:a=(e-n)/m+(e<n?6:0);break;case e:a=(n-t)/m+2;break;case n:a=(t-e)/m+4;break}a/=6}return{h:a,s:h,l}}function Zx(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*(6*n):n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function nse(t,e,n){let r,i,a;if(t=ji(t,360),e=ji(e,100),n=ji(n,100),e===0)i=n,a=n,r=n;else{const h=n<.5?n*(1+e):n+e-n*e,l=2*n-h;r=Zx(l,h,t+1/3),i=Zx(l,h,t),a=Zx(l,h,t-1/3)}return{r:r*255,g:i*255,b:a*255}}function HM(t,e,n){t=ji(t,255),e=ji(e,255),n=ji(n,255);const r=Math.max(t,e,n),i=Math.min(t,e,n);let a=0;const h=r,l=r-i,m=r===0?0:l/r;if(r===i)a=0;else{switch(r){case t:a=(e-n)/l+(e<n?6:0);break;case e:a=(n-t)/l+2;break;case n:a=(t-e)/l+4;break}a/=6}return{h:a,s:m,v:h}}function rse(t,e,n){t=ji(t,360)*6,e=ji(e,100),n=ji(n,100);const r=Math.floor(t),i=t-r,a=n*(1-e),h=n*(1-i*e),l=n*(1-(1-i)*e),m=r%6,_=[n,h,a,a,l,n][m],E=[l,n,n,h,a,a][m],S=[a,a,l,n,n,h][m];return{r:_*255,g:E*255,b:S*255}}function WM(t,e,n,r){const i=[au(Math.round(t).toString(16)),au(Math.round(e).toString(16)),au(Math.round(n).toString(16))];return r&&i[0].startsWith(i[0].charAt(1))&&i[1].startsWith(i[1].charAt(1))&&i[2].startsWith(i[2].charAt(1))?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function ise(t,e,n,r,i){const a=[au(Math.round(t).toString(16)),au(Math.round(e).toString(16)),au(Math.round(n).toString(16)),au(sse(r))];return i&&a[0].startsWith(a[0].charAt(1))&&a[1].startsWith(a[1].charAt(1))&&a[2].startsWith(a[2].charAt(1))&&a[3].startsWith(a[3].charAt(1))?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}function sse(t){return Math.round(parseFloat(t)*255).toString(16)}function qM(t){return Zs(t)/255}function Zs(t){return parseInt(t,16)}function ose(t){return{r:t>>16,g:(t&65280)>>8,b:t&255}}const $w={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function ase(t){let e={r:0,g:0,b:0},n=1,r=null,i=null,a=null,h=!1,l=!1;return typeof t=="string"&&(t=use(t)),typeof t=="object"&&(Ka(t.r)&&Ka(t.g)&&Ka(t.b)?(e=tse(t.r,t.g,t.b),h=!0,l=String(t.r).substr(-1)==="%"?"prgb":"rgb"):Ka(t.h)&&Ka(t.s)&&Ka(t.v)?(r=Fy(t.s),i=Fy(t.v),e=rse(t.h,r,i),h=!0,l="hsv"):Ka(t.h)&&Ka(t.s)&&Ka(t.l)&&(r=Fy(t.s),a=Fy(t.l),e=nse(t.h,r,a),h=!0,l="hsl"),Object.prototype.hasOwnProperty.call(t,"a")&&(n=t.a)),n=FD(n),{ok:h,format:t.format||l,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:n}}const lse="[-\\+]?\\d+%?",cse="[-\\+]?\\d*\\.\\d+%?",ic=`(?:${cse})|(?:${lse})`,Xx=`[\\s|\\(]+(${ic})[,|\\s]+(${ic})[,|\\s]+(${ic})\\s*\\)?`,Yx=`[\\s|\\(]+(${ic})[,|\\s]+(${ic})[,|\\s]+(${ic})[,|\\s]+(${ic})\\s*\\)?`,Xo={CSS_UNIT:new RegExp(ic),rgb:new RegExp("rgb"+Xx),rgba:new RegExp("rgba"+Yx),hsl:new RegExp("hsl"+Xx),hsla:new RegExp("hsla"+Yx),hsv:new RegExp("hsv"+Xx),hsva:new RegExp("hsva"+Yx),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function use(t){if(t=t.trim().toLowerCase(),t.length===0)return!1;let e=!1;if($w[t])t=$w[t],e=!0;else if(t==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};let n=Xo.rgb.exec(t);return n?{r:n[1],g:n[2],b:n[3]}:(n=Xo.rgba.exec(t),n?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=Xo.hsl.exec(t),n?{h:n[1],s:n[2],l:n[3]}:(n=Xo.hsla.exec(t),n?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=Xo.hsv.exec(t),n?{h:n[1],s:n[2],v:n[3]}:(n=Xo.hsva.exec(t),n?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=Xo.hex8.exec(t),n?{r:Zs(n[1]),g:Zs(n[2]),b:Zs(n[3]),a:qM(n[4]),format:e?"name":"hex8"}:(n=Xo.hex6.exec(t),n?{r:Zs(n[1]),g:Zs(n[2]),b:Zs(n[3]),format:e?"name":"hex"}:(n=Xo.hex4.exec(t),n?{r:Zs(n[1]+n[1]),g:Zs(n[2]+n[2]),b:Zs(n[3]+n[3]),a:qM(n[4]+n[4]),format:e?"name":"hex8"}:(n=Xo.hex3.exec(t),n?{r:Zs(n[1]+n[1]),g:Zs(n[2]+n[2]),b:Zs(n[3]+n[3]),format:e?"name":"hex"}:!1)))))))))}function Ka(t){return!!Xo.CSS_UNIT.exec(String(t))}class lr{constructor(e="",n={}){if(e instanceof lr)return e;typeof e=="number"&&(e=ose(e)),this.originalInput=e;const r=ase(e);this.originalInput=e,this.r=r.r,this.g=r.g,this.b=r.b,this.a=r.a,this.roundA=Math.round(100*this.a)/100,this.format=n.format??r.format,this.gradientType=n.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=r.ok}isDark(){return this.getBrightness()<128}isLight(){return!this.isDark()}getBrightness(){const e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3}getLuminance(){const e=this.toRgb();let n,r,i;const a=e.r/255,h=e.g/255,l=e.b/255;return a<=.03928?n=a/12.92:n=Math.pow((a+.055)/1.055,2.4),h<=.03928?r=h/12.92:r=Math.pow((h+.055)/1.055,2.4),l<=.03928?i=l/12.92:i=Math.pow((l+.055)/1.055,2.4),.2126*n+.7152*r+.0722*i}getAlpha(){return this.a}setAlpha(e){return this.a=FD(e),this.roundA=Math.round(100*this.a)/100,this}isMonochrome(){const{s:e}=this.toHsl();return e===0}toHsv(){const e=HM(this.r,this.g,this.b);return{h:e.h*360,s:e.s,v:e.v,a:this.a}}toHsvString(){const e=HM(this.r,this.g,this.b),n=Math.round(e.h*360),r=Math.round(e.s*100),i=Math.round(e.v*100);return this.a===1?`hsv(${n}, ${r}%, ${i}%)`:`hsva(${n}, ${r}%, ${i}%, ${this.roundA})`}toHsl(){const e=GM(this.r,this.g,this.b);return{h:e.h*360,s:e.s,l:e.l,a:this.a}}toHslString(){const e=GM(this.r,this.g,this.b),n=Math.round(e.h*360),r=Math.round(e.s*100),i=Math.round(e.l*100);return this.a===1?`hsl(${n}, ${r}%, ${i}%)`:`hsla(${n}, ${r}%, ${i}%, ${this.roundA})`}toHex(e=!1){return WM(this.r,this.g,this.b,e)}toHexString(e=!1){return"#"+this.toHex(e)}toHex8(e=!1){return ise(this.r,this.g,this.b,this.a,e)}toHex8String(e=!1){return"#"+this.toHex8(e)}toHexShortString(e=!1){return this.a===1?this.toHexString(e):this.toHex8String(e)}toRgb(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}}toRgbString(){const e=Math.round(this.r),n=Math.round(this.g),r=Math.round(this.b);return this.a===1?`rgb(${e}, ${n}, ${r})`:`rgba(${e}, ${n}, ${r}, ${this.roundA})`}toPercentageRgb(){const e=n=>`${Math.round(ji(n,255)*100)}%`;return{r:e(this.r),g:e(this.g),b:e(this.b),a:this.a}}toPercentageRgbString(){const e=n=>Math.round(ji(n,255)*100);return this.a===1?`rgb(${e(this.r)}%, ${e(this.g)}%, ${e(this.b)}%)`:`rgba(${e(this.r)}%, ${e(this.g)}%, ${e(this.b)}%, ${this.roundA})`}toName(){if(this.a===0)return"transparent";if(this.a<1)return!1;const e="#"+WM(this.r,this.g,this.b,!1);for(const[n,r]of Object.entries($w))if(e===r)return n;return!1}toString(e){const n=!!e;e=e??this.format;let r=!1;const i=this.a<1&&this.a>=0;return!n&&i&&(e.startsWith("hex")||e==="name")?e==="name"&&this.a===0?this.toName():this.toRgbString():(e==="rgb"&&(r=this.toRgbString()),e==="prgb"&&(r=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(r=this.toHexString()),e==="hex3"&&(r=this.toHexString(!0)),e==="hex4"&&(r=this.toHex8String(!0)),e==="hex8"&&(r=this.toHex8String()),e==="name"&&(r=this.toName()),e==="hsl"&&(r=this.toHslString()),e==="hsv"&&(r=this.toHsvString()),r||this.toHexString())}toNumber(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)}clone(){return new lr(this.toString())}lighten(e=10){const n=this.toHsl();return n.l+=e/100,n.l=zy(n.l),new lr(n)}brighten(e=10){const n=this.toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(255*-(e/100)))),n.g=Math.max(0,Math.min(255,n.g-Math.round(255*-(e/100)))),n.b=Math.max(0,Math.min(255,n.b-Math.round(255*-(e/100)))),new lr(n)}darken(e=10){const n=this.toHsl();return n.l-=e/100,n.l=zy(n.l),new lr(n)}tint(e=10){return this.mix("white",e)}shade(e=10){return this.mix("black",e)}desaturate(e=10){const n=this.toHsl();return n.s-=e/100,n.s=zy(n.s),new lr(n)}saturate(e=10){const n=this.toHsl();return n.s+=e/100,n.s=zy(n.s),new lr(n)}greyscale(){return this.desaturate(100)}spin(e){const n=this.toHsl(),r=(n.h+e)%360;return n.h=r<0?360+r:r,new lr(n)}mix(e,n=50){const r=this.toRgb(),i=new lr(e).toRgb(),a=n/100,h={r:(i.r-r.r)*a+r.r,g:(i.g-r.g)*a+r.g,b:(i.b-r.b)*a+r.b,a:(i.a-r.a)*a+r.a};return new lr(h)}analogous(e=6,n=30){const r=this.toHsl(),i=360/n,a=[this];for(r.h=(r.h-(i*e>>1)+720)%360;--e;)r.h=(r.h+i)%360,a.push(new lr(r));return a}complement(){const e=this.toHsl();return e.h=(e.h+180)%360,new lr(e)}monochromatic(e=6){const n=this.toHsv(),{h:r}=n,{s:i}=n;let{v:a}=n;const h=[],l=1/e;for(;e--;)h.push(new lr({h:r,s:i,v:a})),a=(a+l)%1;return h}splitcomplement(){const e=this.toHsl(),{h:n}=e;return[this,new lr({h:(n+72)%360,s:e.s,l:e.l}),new lr({h:(n+216)%360,s:e.s,l:e.l})]}onBackground(e){const n=this.toRgb(),r=new lr(e).toRgb(),i=n.a+r.a*(1-n.a);return new lr({r:(n.r*n.a+r.r*r.a*(1-n.a))/i,g:(n.g*n.a+r.g*r.a*(1-n.a))/i,b:(n.b*n.a+r.b*r.a*(1-n.a))/i,a:i})}triad(){return this.polyad(3)}tetrad(){return this.polyad(4)}polyad(e){const n=this.toHsl(),{h:r}=n,i=[this],a=360/e;for(let h=1;h<e;h++)i.push(new lr({h:(r+h*a)%360,s:n.s,l:n.l}));return i}equals(e){return this.toRgbString()===new lr(e).toRgbString()}}function nd(t,e){return t.toString(e)}function ZM(t,e,n){return new lr(t,n)}function hse(t){return Jie(t)?t:new lr(t).toString()}const dse=t=>{const{currentColor:e,format:n,onChange:r,isAlphaHidden:i}=t,[a,h]=cr.useState(e.toHsv()),l=(E,S)=>{if(!VM(S))return;const I=a_(360*S/100,0,359);h(O=>({...O,h:I}));const L=new lr({...a,a:e.toHsv().a,h:I});r==null||r(nd(L,n))},m=(E,S)=>{if(!VM(S))return;const I=e.clone().setAlpha(S);r==null||r(nd(I,n))},_=({s:E,v:S})=>{const I=new lr({h:a.h,a:e.toHsv().a,s:E,v:S});h(L=>({...L,s:E,v:S})),r==null||r(nd(I,n))};return ve.jsxs($x,{className:"MuiColorInput-PopoverBody",children:[ve.jsx(Xie,{currentHue:a.h,hsv:a,onChange:_}),ve.jsx($x,{mt:"10px",px:"3px",children:ve.jsx(Kie,{min:0,max:100,step:1,onChange:l,"aria-label":"hue",value:a.h*100/360})}),i?null:ve.jsx($x,{mt:"10px",px:"3px",children:ve.jsx(Gie,{min:0,max:1,step:.01,"aria-label":"alpha",rgbColor:e.toRgb(),onChange:m,value:e.getAlpha()})})]})},fse=cr.forwardRef((t,e)=>{const{className:n,...r}=t;return ve.jsx(zie,{className:`MuiColorInput-TextField ${n||""}`,ref:e,...r})}),pse="black",mse="rgb";function gse(t){return typeof t=="object"&&!Array.isArray(t)&&t!==null}function XM(t,e){typeof e=="function"?e(t):e&&gse(e)&&"current"in e&&(e.current=t)}cr.forwardRef((t,e)=>{const{value:n,format:r,onChange:i,adornmentPosition:a="start",PopoverProps:h,Adornment:l=Uie,fallbackValue:m,isAlphaHidden:_,disablePopover:E,...S}=t,{onBlur:I,InputProps:L,...O}=S,{onClose:D,...H}=h||{},z=m||pse,N=O.disabled||(L==null?void 0:L.disabled)||!1,F=cr.useRef(null),$=cr.useRef(null),[Q,te]=cr.useState(null),re=r||mse,we=ZM(n,z,{format:re}),[Ee,de]=cr.useState(n),[Le,Ge]=cr.useState(n),Be=bt=>{bt.preventDefault(),bt.stopPropagation(),!N&&!E&&te(F.current)},Oe=bt=>{const xt=new lr(bt);i==null||i(bt,{hex:xt.isValid?xt.toHexString():"",hsv:xt.isValid?xt.toHsvString():"",hsl:xt.isValid?xt.toHslString():"",rgb:xt.isValid?xt.toRgbString():"",hex8:xt.isValid?xt.toHex8String():""})},Ke=bt=>{const xt=bt.target.value;if(de(xt),xt==="")Ge(""),Oe("");else{const $t=new lr(xt),Kt=nd($t,re);Ge(Kt),Oe(Kt)}},je=(...bt)=>{D==null||D(...bt),te(null),queueMicrotask(()=>{var xt;(xt=$.current)==null||xt.focus()})},it=bt=>{I==null||I(bt);const xt=new lr(Ee);if(xt.isValid)xt.format!==re&&de(nd(xt,re));else{if(Ee==="")return;const $t=new lr(z),Kt=nd($t,re);de(Kt),Ge(Kt),Oe(Kt)}};cr.useEffect(()=>{if(n!==Le){const bt=ZM(n).originalInput;Ge(bt),de(bt)}},[n,Le,z]);const Me=bt=>{de(bt),Ge(bt),Oe(bt)},qe=bt=>{F.current=bt,e&&XM(bt,e)},ut=bt=>{$.current=bt,$&&XM(bt,$)},zt=!!Q,vt=zt?"color-popover":void 0,yt=ve.jsx(bne,{position:a,children:ve.jsx(l,{disabled:N,"aria-describedby":vt,disablePopover:E||!1,component:E?"span":void 0,bgColor:we.toString(),isBgColorValid:!!(Ee!==""&&we.isValid),onClick:E?void 0:Be})}),at=a==="start"?{startAdornment:yt}:{endAdornment:yt};return ve.jsxs(ve.Fragment,{children:[ve.jsx(fse,{ref:qe,spellCheck:"false",type:"text",autoComplete:"off",onChange:Ke,value:hse(Ee),onBlur:it,inputRef:ut,disabled:N,InputProps:{...at,...L},...O}),E?null:ve.jsx(jie,{id:vt,open:zt,position:a,anchorEl:Q,onClose:je,...H,children:ve.jsx(dse,{onChange:Me,currentColor:we,format:re,isAlphaHidden:_})})]})});const yse=vl(ve.jsx("path",{d:"M6 19h4V5H6v14zm8-14v14h4V5h-4z"}),"Pause"),_se=vl(ve.jsx("path",{d:"M8 5v14l11-7z"}),"PlayArrow"),vse=vl(ve.jsx("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"}),"Settings"),xse=At(uT)(()=>({color:"#46B780","& .MuiSlider-thumb":{"&:hover, &.Mui-focusVisible":{boxShadow:`0px 0px 0px 8px ${Ai("#46B780",.16)}`},"&.Mui-active":{boxShadow:`0px 0px 0px 14px ${Ai("#46B780",.16)}`}},"& .MuiSlider-rail":{color:"#A8AFB3",opacity:1}}));function YM({disabled:t,value:e,min:n,max:r,step:i,onInput:a,onChange:h,onChangeCommited:l,defaultValue:m,marks:_,style:E}){return ve.jsx(xse,{disabled:t,value:e,min:n,max:r,step:i,onInput:a,onChangeCommitted:l,onChange:h,defaultValue:m,marks:_,style:E})}const ND=Z.forwardRef(({canStart:t,started:e,animationEnded:n,playbackOn:r,time:i,maxTime:a,settings:h,colors:l,loading:m,timeChanged:_,placeEnd:E,changeRadius:S,changeAlgorithm:I,setPlaceEnd:L,setSettings:O,setColors:D,startPathfinding:H,toggleAnimation:z,clearPath:N,multiSource:F,setMultiSource:$,startNodes:Q,setStartNodes:te},re)=>{const[we,Ee]=Z.useState(!1),[de,Le]=Z.useState({open:!1,message:"",type:"error"}),Ge=Z.useRef(!1),Be=Z.useRef(!1);Z.useImperativeHandle(re,()=>({showSnack(je,it="error"){Le({open:!0,message:je,type:it})}}));function Oe(){Le({...de,open:!1})}function Ke(){if(t){if(!e&&i===0){H();return}z()}}return window.onkeydown=je=>{je.code==="ArrowRight"&&!Ge.current&&!Be.current&&(!e||n)?(Ge.current=!0,z(!1,1)):je.code==="ArrowLeft"&&!Be.current&&!Ge.current&&n&&(Be.current=!0,z(!1,-1))},window.onkeyup=je=>{je.code==="Space"?(je.preventDefault(),Ke()):je.code==="ArrowRight"&&Ge.current?(Ge.current=!1,z(!1,1)):je.code==="ArrowLeft"&&n&&Be.current?(Be.current=!1,z(!1,1)):je.code==="KeyR"&&(n||!e)&&N()},ve.jsxs(ve.Fragment,{children:[ve.jsxs("div",{className:"nav-top",children:[ve.jsx(zw,{disabled:!t,onClick:Ke,style:{backgroundColor:"#46B780",width:50,height:50},size:"large",children:!e||n&&!r?ve.jsx(_se,{style:{color:"#fff",width:26,height:26},fontSize:"inherit"}):ve.jsx(yse,{style:{color:"#fff",width:26,height:26},fontSize:"inherit"})}),ve.jsx("div",{className:"side",children:ve.jsx(Uw,{disabled:!n&&e,onClick:N,style:{color:"#fff",backgroundColor:"#404156",paddingInline:30,paddingBlock:7},variant:"contained",children:"Limpiar ruta"})})]}),F&&ve.jsx("div",{className:"multi-source-info",style:{position:"absolute",top:"80px",left:"50%",transform:"translateX(-50%)",backgroundColor:"rgba(42, 43, 55, 0.9)",color:"#fff",padding:"8px 16px",borderRadius:"8px",fontSize:"14px",zIndex:1e3},children:ve.jsxs(c0,{variant:"body2",children:["Modo Multi-Source: ",Q.length," punto",Q.length!==1?"s":""," de inicio seleccionado",Q.length!==1?"s":"",Q.length>0&&ve.jsx("span",{style:{marginLeft:"8px"},children:"(Click para añadir/quitar, Click derecho para destino)"})]})}),ve.jsx("div",{className:"nav-right",children:ve.jsx(Iie,{title:"Open settings",children:ve.jsx(zw,{onClick:()=>{Ee(!0)},style:{backgroundColor:"#2A2B37",width:36,height:36},size:"large",children:ve.jsx(vse,{style:{color:"#fff",width:24,height:24},fontSize:"inherit"})})})}),ve.jsx("div",{className:"loader-container",children:ve.jsx(gD,{in:m,style:{transitionDelay:m?"50ms":"0ms"},unmountOnExit:!0,children:ve.jsx(hte,{color:"inherit"})})}),ve.jsx(vie,{anchorOrigin:{vertical:"bottom",horizontal:"right"},open:de.open,autoHideDuration:4e3,onClose:Oe,children:ve.jsx(cJ,{onClose:Oe,severity:de.type,style:{width:"100%",color:"#fff"},children:de.message})}),ve.jsx("div",{className:"mobile-controls",children:ve.jsx(Uw,{onClick:()=>{L(!E)},style:{color:"#fff",backgroundColor:"#404156",paddingInline:30,paddingBlock:7},variant:"contained",children:E?"placing end node":"placing start node"})}),ve.jsx(Fte,{className:"side-drawer",anchor:"left",open:we,onClose:()=>{Ee(!1)},children:ve.jsxs("div",{className:"sidebar-container",children:[ve.jsxs(ED,{variant:"filled",children:[ve.jsx(CD,{style:{fontSize:14},id:"algo-select",children:"Algorithm"}),ve.jsxs(zD,{labelId:"algo-select",value:h.algorithm,onChange:je=>{I(je.target.value)},required:!0,style:{backgroundColor:"#404156",color:"#fff",width:"100%",paddingLeft:1},inputProps:{MenuProps:{MenuListProps:{sx:{backgroundColor:"#404156"}}}},size:"small",disabled:!n&&e,children:[ve.jsx(DM,{value:"astar",children:"A* algorithm"}),ve.jsx(DM,{value:"dijkstra",children:"Dijkstra's algorithm"})]})]}),ve.jsxs("div",{className:"side slider-container",children:[ve.jsxs(c0,{id:"area-slider",children:["Area radius: ",h.radius,"km"]}),ve.jsx(YM,{disabled:e&&!n,min:2,max:4,step:.5,value:h.radius,onChangeCommited:()=>{S(h.radius)},onChange:je=>{O({...h,radius:Number(je.target.value)})},className:"slider","aria-labelledby":"area-slider",style:{marginBottom:1},marks:[{value:2,label:"2km"},{value:4,label:"4km"}]})]}),ve.jsxs("div",{className:"side slider-container",children:[ve.jsx(c0,{id:"speed-slider",children:"Velocidad de Animación"}),ve.jsx(YM,{min:1,max:30,value:h.speed,onChange:je=>{O({...h,speed:Number(je.target.value)})},className:"slider","aria-labelledby":"speed-slider",style:{marginBottom:1}})]})]})})]})});ND.displayName="Interface";function bse(t,e,n,r,i,a){const[h,l]=Z.useState(t),m=Date.now(),_=Z.useRef();return Z.useEffect(()=>{function E(){const I=Date.now()-m;if(I<r){const L=I/r,O=a?n+L*(e-n):e+L*(n-e);l(O),_.current=requestAnimationFrame(E)}else l(a?e:n)}if(i)return _.current=requestAnimationFrame(E),()=>{cancelAnimationFrame(_.current)}},[e,n,r,i,a]),h}function wse(){var _t;const[t,e]=Z.useState([]),[n,r]=Z.useState({}),[i,a]=Z.useState(null),[h,l]=Z.useState([]),[m,_]=Z.useState([]),[E,S]=Z.useState(),[I,L]=Z.useState(0),[O,D]=Z.useState(!1),[H,z]=Z.useState(!1),[N,F]=Z.useState(1),[$,Q]=Z.useState(!1),[te,re]=Z.useState(null),[we,Ee]=Z.useState({x:0,y:0}),[de,Le]=Z.useState(!1),[Ge,Be]=Z.useState({algorithm:"astar",radius:4,speed:5}),[Oe,Ke]=Z.useState(Dq),[je,it]=Z.useState(Oq),Me=Z.useRef(),qe=Z.useRef(),ut=Z.useRef(),zt=Z.useRef(),vt=Z.useRef(0),yt=Z.useRef([]),at=Z.useRef(new Pw),bt=Z.useRef([]),xt=Z.useRef(!1),$t=Z.useRef([]),Kt=bse(0,0,1,400,qe.current,$);function Ct(Fe,et,ot,Zt){const Ne=(ot-Fe)*Math.PI/180,Ye=(Zt-et)*Math.PI/180,St=Math.sin(Ne/2)*Math.sin(Ne/2)+Math.cos(Fe*Math.PI/180)*Math.cos(ot*Math.PI/180)*Math.sin(Ye/2)*Math.sin(Ye/2);return 6371*(2*Math.atan2(Math.sqrt(St),Math.sqrt(1-St)))}function sn(Fe){if(!Fe||Fe.length<2)return 0;let et=0;for(let ot=0;ot<Fe.length-1;ot++){const Zt=at.current.getNode(Fe[ot]),Mt=at.current.getNode(Fe[ot+1]);Zt&&Mt&&(et+=Ct(Zt.latitude,Zt.longitude,Mt.latitude,Mt.longitude))}return et}async function Qt(Fe,et,ot){const Zt=[];for(const Mt of vI){const Ne=Ct(Fe,et,Mt.latitude,Mt.longitude);if(Ne<=ot){const Ye=await gI(Mt.latitude,Mt.longitude);Ye&&Zt.push({...Mt,activated:!0,node:Ye,distance:Ne})}}return e(Zt),r({}),Zt.length>0?Me.current.showSnack(`${Zt.length} hospital(es) activado(s) dentro del radio.`,"success"):Me.current.showSnack("No hay hospitales dentro del radio seleccionado.","info"),Zt}function pn(Fe,et){Fe.object?(re(Fe.object),Ee({x:et.offsetX,y:et.offsetY})):re(null)}function Wt(Fe){te&&Ee({x:Fe.offsetX,y:Fe.offsetY})}async function Ot(Fe,et,ot=null){if(E&&!O)return;if(Q(!1),qe.current=!0,mn(),de){Me.current.showSnack("Por favor espera a que carguen todos los datos.","info");return}const Zt=setTimeout(()=>{Le(!0)},300),Mt=await gI(Fe.coordinate[1],Fe.coordinate[0]);if(!Mt){Me.current.showSnack("No se encontró un camino en los alrededores, prueba otra ubicación."),clearTimeout(Zt),Le(!1);return}a(Mt);const Ne=ot??Ge.radius,Ye=xO([Mt.lon,Mt.lat],Ne);l([{contour:Ye}]),(await Qt(Mt.lat,Mt.lon,Ne)).length>0?kq(wO(Ye),Mt.id).then(gn=>{at.current.graph=gn;const yn=at.current.getNode(Mt.id);yn&&(at.current.endNode=yn),clearTimeout(Zt),Le(!1)}):(clearTimeout(Zt),Le(!1))}function Dt(){Q(!0),setTimeout(()=>{if(mn(),!at.current.graph||t.length===0||!i){Me.current.showSnack("Por favor, selecciona un punto de destino para activar hospitales.","error"),S(!1);return}at.current.clearStartNodes(),t.forEach(et=>{const ot=at.current.getNode(et.node.id);ot&&at.current.addStartNode(ot)});const Fe=at.current.getNode(i.id);Fe&&(at.current.endNode=Fe),at.current.start(Ge.algorithm),bt.current=new Array(t.length).fill(null),xt.current=!1,$t.current=[],S(!0)},400)}function wn(Fe=!0,et=1){if(!(I===0&&!O)){if(F(et),O){Fe&&I>=vt.current&&L(0),S(!0),z(!H);return}S(!E),E&&(zt.current=null)}}function mn(){S(!1),_([]),L(0),at.current.graph&&at.current.reset(),xt.current=!1,$t.current=[],bt.current=new Array(t.length).fill(null),yt.current=[],vt.current=0,zt.current=null,D(!1),r({})}function En(Fe){const et=at.current.nextStep();for(const Ne of et)if(!Ne.finished)for(const Ye of Ne.updatedNodes)Ye.node&&Ye.node.referer&&Re(Ye.node,Ye.node.referer,"path",1,Ne.color);const ot=at.current.finished;if(ot&&!xt.current){const Ne=at.current.getAllOptimalPaths(),Ye={};t.forEach((St,gn)=>{const yn=Ne[gn];if(yn&&yn.length>1){const nt=sn(yn);Ye[St.id]=nt}}),r(Ye),setTimeout(()=>{xt.current=!0,$t.current=Ne.map(St=>St&&St.length>1?{path:St,currentIndex:St.length-2,finished:!1}:{path:[],currentIndex:-1,finished:!0})},500)}let Zt=!1;if(xt.current&&$t.current.length>0)for(let Ne=0;Ne<$t.current.length;Ne++){const Ye=$t.current[Ne];if(!Ye.finished&&Ye.currentIndex>=0){const St=Math.max(3,Math.floor(Ge.speed/2));for(let gn=0;gn<St&&Ye.currentIndex>=0&&!Ye.finished;gn++){const yn=Ye.path[Ye.currentIndex],nt=Ye.path[Ye.currentIndex+1],on=at.current.getNode(yn),rn=at.current.getNode(nt);if(on&&rn&&(Re(on,rn,"route",.1,[255,255,255]),Ye.currentIndex--,Zt=!0),Ye.currentIndex<0){Ye.finished=!0;break}}}}const Mt=!xt.current||$t.current.length>0&&$t.current.every(Ne=>Ne.finished);if(D(I>=vt.current&&ot&&Mt&&!Zt),zt.current!=null&&!O){const Ne=Fe-zt.current;L(Ye=>Ye+Ne*N)}if(zt.current!=null&&O&&H){const Ne=Fe-zt.current;I>=vt.current&&N!==-1&&z(!1),L(Ye=>Math.max(Math.min(Ye+Ne*2*N,vt.current),0))}}function zn(Fe){for(let et=0;et<Ge.speed;et++)En(Fe);zt.current=Fe,ut.current=requestAnimationFrame(zn)}function Re(Fe,et,ot="path",Zt=1,Mt=null){if(!Fe||!et)return;const Ye=Math.hypot(Fe.longitude-et.longitude,Fe.latitude-et.latitude)*5e4*Zt,St=Mt||ot;yt.current=[...yt.current,{path:[[et.longitude,et.latitude],[Fe.longitude,Fe.latitude]],timestamps:[vt.current,vt.current+Ye],color:St,customColor:Mt!==null}],vt.current+=Ye,_(()=>yt.current)}function Bt(Fe){Be(Fe);const et={settings:Fe,colors:Oe};localStorage.setItem("path_settings",JSON.stringify(et))}function Rn(Fe){Ke(Fe);const et={settings:Ge,colors:Fe};localStorage.setItem("path_settings",JSON.stringify(et))}function an(Fe){mn(),Bt({...Ge,algorithm:Fe})}function It(Fe){Bt({...Ge,radius:Fe}),i&&Ot({coordinate:[i.lon,i.lat]},{},Fe)}function st(Fe){it({...je,longitude:Fe.longitude,latitude:Fe.latitude,zoom:12,transitionDuration:1e3,transitionInterpolator:new jH})}return Z.useEffect(()=>{if(E)return ut.current=requestAnimationFrame(zn),()=>cancelAnimationFrame(ut.current)},[E,I,O,H]),Z.useEffect(()=>{navigator.geolocation.getCurrentPosition(ot=>{st(ot.coords)});const Fe=localStorage.getItem("path_settings");if(!Fe)return;const et=JSON.parse(Fe);Be(et.settings),Ke(et.colors)},[]),ve.jsxs(ve.Fragment,{children:[ve.jsxs("div",{onContextMenu:Fe=>{Fe.preventDefault()},onMouseMove:Wt,style:{position:"relative"},children:[ve.jsxs(tW,{initialViewState:je,controller:{doubleClickZoom:!1,keyboard:!1},onClick:Ot,children:[ve.jsx(wE,{id:"selection-radius",data:h,pickable:!0,stroked:!0,getPolygon:Fe=>Fe.contour,getFillColor:[80,210,0,10],getLineColor:[9,142,46,175],getLineWidth:3,opacity:Kt}),ve.jsx(EE,{id:"pathfinding-layer",data:m,opacity:1,widthMinPixels:3,widthMaxPixels:5,fadeTrail:!1,currentTime:I,getColor:Fe=>Fe.customColor?Fe.color:Oe[Fe.color]||Fe.color,updateTriggers:{getColor:[Oe.path,Oe.route,m]}}),ve.jsx(vE,{id:"start-end-points",data:[...t.map((Fe,et)=>({coordinates:[Fe.longitude,Fe.latitude],color:at.current.colors[et]?at.current.colors[et]:Oe.startNodeFill,lineColor:Oe.startNodeBorder,isStart:!0,index:et,name:Fe.name,type:Fe.type,isActivated:!0,hospitalId:Fe.id,routeDistance:n[Fe.id]})),...vI.filter(Fe=>!t.find(et=>et.id===Fe.id)).map(Fe=>({coordinates:[Fe.longitude,Fe.latitude],color:[128,128,128],lineColor:[64,64,64],isStart:!1,name:Fe.name,type:Fe.type,isActivated:!1,hospitalId:Fe.id,routeDistance:null})),...i?[{coordinates:[i.lon,i.lat],color:Oe.endNodeFill,lineColor:Oe.endNodeBorder,isStart:!1,name:"Punto de Destino",type:"destino",isActivated:!1,hospitalId:null,routeDistance:null}]:[]],pickable:!0,opacity:1,stroked:!0,filled:!0,radiusScale:1,radiusMinPixels:8,radiusMaxPixels:25,lineWidthMinPixels:1,lineWidthMaxPixels:3,getPosition:Fe=>Fe.coordinates,getFillColor:Fe=>Fe.color,getLineColor:Fe=>Fe.lineColor,onHover:pn,updateTriggers:{getFillColor:[t,Oe,(_t=at.current)==null?void 0:_t.colors],data:[t,n,i]}}),ve.jsx(AW,{reuseMaps:!0,mapLib:MW,mapStyle:Rq,doubleClickZoom:!1})]}),te&&ve.jsxs("div",{style:{position:"absolute",left:we.x+10,top:we.y-10,backgroundColor:"rgba(0, 0, 0, 0.9)",color:"white",padding:"10px 14px",borderRadius:"8px",fontSize:"13px",fontWeight:"500",pointerEvents:"none",zIndex:1e3,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",maxWidth:"280px",minWidth:"200px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[ve.jsx("div",{style:{fontWeight:"bold",marginBottom:"4px",fontSize:"14px"},children:te.name}),ve.jsxs("div",{style:{fontSize:"12px",color:te.isActivated?"#4ade80":"#9ca3af",textTransform:"capitalize",marginBottom:"4px"},children:[te.type," ",te.isActivated?"(Activado)":""]}),te.isActivated&&te.routeDistance!==null&&te.routeDistance!==void 0&&ve.jsxs("div",{style:{fontSize:"12px",color:"#60a5fa",borderTop:"1px solid rgba(255, 255, 255, 0.1)",paddingTop:"4px",marginTop:"4px"},children:["🛣️ Distancia de ruta: ",ve.jsxs("strong",{children:[te.routeDistance.toFixed(2)," km"]})]}),te.isActivated&&(te.routeDistance===null||te.routeDistance===void 0)&&ve.jsx("div",{style:{fontSize:"12px",color:"#fbbf24",borderTop:"1px solid rgba(255, 255, 255, 0.1)",paddingTop:"4px",marginTop:"4px"},children:"🔄 Ejecuta el algoritmo para ver la distancia"})]})]}),ve.jsx(ND,{ref:Me,canStart:t.length>0&&i,started:E,animationEnded:O,playbackOn:H,time:I,startPathfinding:Dt,toggleAnimation:wn,clearPath:mn,timeChanged:L,maxTime:vt.current,settings:Ge,setSettings:Bt,changeAlgorithm:an,colors:Oe,setColors:Rn,loading:de,activatedHospitals:t,endNode:i,changeRadius:It})]})}const Ese=HE({palette:{mode:"dark"}});function Tse(){return ve.jsxs(iK,{theme:Ese,children:[ve.jsx(mte,{}),ve.jsx(wse,{})]})}Jx.createRoot(document.getElementById("root")).render(ve.jsx(cr.StrictMode,{children:ve.jsx(Tse,{})}));export{R4 as c,_m as g};
